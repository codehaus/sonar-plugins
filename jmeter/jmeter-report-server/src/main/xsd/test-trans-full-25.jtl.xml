<?xml version="1.0" encoding="UTF-8"?>
<testResults version="1.2"
xmlns="http://xmlbeans.testresults.server.report.jmeter.excentia.es"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://xmlbeans.testresults.server.report.jmeter.excentia.es jtl.xsd">

<httpSample t="66" lt="66" ts="1315464951976" s="false" lb="/iceweb/" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" by="696"/>
<httpSample t="3" lt="2" ts="1315464952051" s="true" lb="/iceweb/styles/style.css" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" by="2962"/>
<httpSample t="3" lt="3" ts="1315464952054" s="true" lb="/iceweb/js/json.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" by="8178"/>
<httpSample t="4" lt="2" ts="1315464952058" s="true" lb="/iceweb/js/jquery-1.4.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" by="158797"/>
<httpSample t="3" lt="3" ts="1315464952063" s="true" lb="/iceweb/js/common.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" by="1545"/>
<httpSample t="3" lt="2" ts="1315464952067" s="true" lb="/iceweb/js/flexigrid/CentroPagedGrid.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" by="42752"/>
<httpSample t="3" lt="2" ts="1315464952071" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/flexigrid.css" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" by="14353"/>
<httpSample t="3" lt="3" ts="1315464952074" s="true" lb="/iceweb/js/ajax.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" by="12255"/>
<httpSample t="3" lt="3" ts="1315464952078" s="true" lb="/iceweb/js/OpenLayersExt.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" by="12804"/>
<httpSample t="14" lt="3" ts="1315464952082" s="true" lb="/iceweb/js/OpenLayers/OpenLayers.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" by="712189"/>
<httpSample t="2" lt="2" ts="1315464952097" s="true" lb="/iceweb/img/printer.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="3980"/>
<httpSample t="3" lt="3" ts="1315464952100" s="true" lb="/iceweb/img/GvSig_FondoCabecera.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="700"/>
<httpSample t="3" lt="3" ts="1315464952104" s="true" lb="/iceweb/img/GvSig_cabecera.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="14745"/>
<httpSample t="5" lt="5" ts="1315464952108" s="false" lb="/iceweb/styles/img/south-mini.png" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" by="667"/>
<httpSample t="3" lt="3" ts="1315464952114" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/wbg.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="1236"/>
<httpSample t="3" lt="3" ts="1315464952118" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/prev.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="554"/>
<httpSample t="3" lt="3" ts="1315464952122" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/fhbg.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="1204"/>
<httpSample t="3" lt="3" ts="1315464952125" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/next.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="553"/>
<httpSample t="3" lt="3" ts="1315464952129" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/line.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="1185"/>
<httpSample t="3" lt="3" ts="1315464952132" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/load.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="1195"/>
<httpSample t="2" lt="2" ts="1315464952136" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/first.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="585"/>
<httpSample t="3" lt="3" ts="1315464952139" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/last.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="588"/>
<httpSample t="3" lt="3" ts="1315464952143" s="true" lb="/iceweb/js/OpenLayers/img/east-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="3386"/>
<httpSample t="3" lt="3" ts="1315464952147" s="true" lb="/iceweb/js/OpenLayers/img/zoom-minus-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="3273"/>
<httpSample t="4" lt="4" ts="1315464952151" s="true" lb="/iceweb/js/OpenLayers/img/layer-switcher-minimize.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="3226"/>
<httpSample t="5" lt="5" ts="1315464952156" s="true" lb="/iceweb/js/OpenLayers/img/zoom-world-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="4108"/>
<httpSample t="4" lt="4" ts="1315464952162" s="true" lb="/iceweb/js/OpenLayers/img/zoom-plus-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="3361"/>
<httpSample t="2" lt="2" ts="1315464952167" s="true" lb="/iceweb/js/OpenLayers/img/north-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="3381"/>
<httpSample t="3" lt="3" ts="1315464952170" s="true" lb="/iceweb/js/OpenLayers/img/south-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="3373"/>
<httpSample t="2" lt="2" ts="1315464952174" s="true" lb="/iceweb/js/OpenLayers/img/west-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="3403"/>
<httpSample t="21" lt="21" ts="1315464952177" s="false" lb="/iceweb/restful/Centro/findPagedByVentanaAndFilter" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" by="734"/>
<httpSample t="22" lt="22" ts="1315464952199" s="false" lb="/iceweb/restful/Centro/findMarcasCuadriculaByFilter" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" by="735"/>
<httpSample t="5" lt="5" ts="1315464952222" s="true" lb="/iceweb/js/OpenLayers/img/layer-switcher-maximize.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="3360"/>
<httpSample t="4" lt="4" ts="1315464952229" s="true" lb="/iceweb/img/pub.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="1335"/>
<httpSample t="3" lt="3" ts="1315464952234" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/load.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="2106"/>
<httpSample t="3" lt="2" ts="1315464952238" s="true" lb="/iceweb/img/mix.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="1140"/>
<httpSample t="3" lt="3" ts="1315464952241" s="true" lb="/iceweb/img/priv.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="1199"/>
<sample t="268" lt="211" ts="1315464951976" s="false" lb="HOME" rc="" rm="Number of samples in transaction : 37, number of failing samples : 4" tn="Thread Group 1-1" dt="" by="1031843"/>
<httpSample t="26" lt="26" ts="1315464952245" s="false" lb="/iceweb/restful/Centro/findPagedByVentanaAndFilter" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" by="734"/>
<sample t="27" lt="26" ts="1315464952245" s="false" lb="PAGE" rc="" rm="Number of samples in transaction : 1, number of failing samples : 1" tn="Thread Group 1-1" dt="" by="734"/>
<httpSample t="4" lt="4" ts="1315464952272" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/hl.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" by="557"/>
<httpSample t="23" lt="23" ts="1315464952276" s="false" lb="/iceweb/centroDetalle" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" by="705"/>
<httpSample t="17" lt="17" ts="1315464952300" s="false" lb="/iceweb/restful/Centro/12003811" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" by="715"/>
<sample t="46" lt="44" ts="1315464952272" s="false" lb="DETAIL" rc="" rm="Number of samples in transaction : 3, number of failing samples : 2" tn="Thread Group 1-1" dt="" by="1977"/>

<httpSample t="59" it="0" lt="59" ts="1315465022157" s="false" lb="/iceweb/" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" de="iso-8859-1" by="696" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 500 Internal Server Error
Date: Thu, 08 Sep 2011 06:57:01 GMT
Server: Oracle Containers for J2EE
Content-Length: 304
Set-Cookie: JSESSIONID=257b5689cadee4b847d14418fa7cd2a863d12097aeef5a6a50cde2128907d433; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: text/html; charset=&quot;iso-8859-1&quot;
Content-Location: /app/mapa
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Keep-Alive: 115
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Connection: keep-alive
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;500 Internal Server Error&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;500 Internal Server Error&lt;/H1&gt;&lt;PRE&gt;Servlet error: An exception occurred. The current application deployment descriptors do not allow for including it in this response. Please consult the application log for details.&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/</java.net.URL>
</httpSample>
<httpSample t="2" it="0" lt="2" ts="1315465022219" s="true" lb="/iceweb/styles/style.css" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" de="" by="2962" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:01 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=40faecf588c73c1cbc20fb789ee5bcd9a68c83d9f0465c7a348a96a9cd7201d4; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: text/css
Last-Modified: Fri, 11 Mar 2011 09:31:21 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: text/css,*/*;q=0.1
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">/******** General &quot;Sin Formato&quot; ********/&#xd;
html,body{&#xd;
	margin:0;&#xd;
	padding:0&#xd;
	}&#xd;
	&#xd;
body, th, td {&#xd;
	font-family:arial,sans-serif;&#xd;
	font-size: 12px;&#xd;
	}&#xd;
	&#xd;
p{&#xd;
	margin:2px;&#xd;
	}&#xd;
	&#xd;
a{&#xd;
	color: #981793;&#xd;
	padding:10px;&#xd;
	}&#xd;
a:link {&#xd;
	color: #981793;&#xd;
	text-decoration: none;&#xd;
}&#xd;
a:visited {&#xd;
	color: #a91411;&#xd;
	text-decoration: none;&#xd;
}&#xd;
a:hover {&#xd;
	color: #981793;&#xd;
	text-decoration: underline;&#xd;
}&#xd;
&#xd;
img {&#xd;
	border:0;&#xd;
}&#xd;
hr.linea {&#xd;
	height: 1px;&#xd;
	border: 0;&#xd;
	color: #c1c1c1;&#xd;
	background-color: #ffffff;&#xd;
	width: 75%;&#xd;
} &#xd;
	&#xd;
/****** Estructura ******/&#xd;
#header{&#xd;
	margin:0;&#xd;
  	padding-left:0px;&#xd;
	background-image:url(../img/GvSig_FondoCabecera.gif);&#xd;
	background-repeat:repeat-x;	&#xd;
	color: #79B30B&#xd;
	}	&#xd;
&#xd;
#login {&#xd;
	background-color: #c5d8e8;&#xd;
	color:#000000;&#xd;
	padding:4px;&#xd;
}&#xd;
&#xd;
table.tableLayout {&#xd;
	width: 100%;&#xd;
}&#xd;
&#xd;
table.tableLayout td {&#xd;
	padding: 0px;&#xd;
	vertical-align: top;&#xd;
	text-align: left;&#xd;
}&#xd;
&#xd;
table.tableLayout td.bordeado {&#xd;
	border: 2px solid #c5d8e8;&#xd;
}&#xd;
	&#xd;
#footer{&#xd;
	clear:both;&#xd;
	width:100%;&#xd;
	background-color: #c5d8e8;&#xd;
	}&#xd;
	&#xd;
/******* Estilo *********/&#xd;
	&#xd;
.seccionMenu  {&#xd;
	background-color:#c5d8e8;&#xd;
    margin: 4px;&#xd;
    padding-left: 4px;&#xd;
    width: 97%;&#xd;
}&#xd;
&#xd;
.tituloMenu {&#xd;
     background: #007aaa url(img/south-mini.png) no-repeat;&#xd;
     width: 97%; &#xd;
     margin: 4px;&#xd;
     padding-left: 4px;&#xd;
     height:20px;&#xd;
     color: white;&#xd;
}&#xd;
&#xd;
.camposAlineados label {&#xd;
	float:left;&#xd;
	width:30%;&#xd;
	margin-right:0px;&#xd;
	padding-top:5px;&#xd;
	text-align:right;&#xd;
	font-weight:bold;&#xd;
}&#xd;
&#xd;
table.form tr th {&#xd;
	text-align: right;&#xd;
}&#xd;
&#xd;
table.list {&#xd;
	border-collapse: collapse;	&#xd;
}&#xd;
&#xd;
table.list tr th {&#xd;
	text-align: center;&#xd;
	cursor:pointer;&#xd;
}&#xd;
table.list tr th.sorted {&#xd;
	text-decoration: underline;&#xd;
}&#xd;
&#xd;
.tituloImpr {&#xd;
   	 margin: 4px;&#xd;
     width: 100%; &#xd;
     font-size: 20px;&#xd;
     font-weight: bold;&#xd;
     padding-left: 5px; &#xd;
     text-transform: uppercase;&#xd;
}&#xd;
&#xd;
.subtituloImpr {&#xd;
	border-bottom: 2px solid #007aaa;&#xd;
	margin-left: 4px;&#xd;
	margin-right: 4px;&#xd;
	margin-top: 20px;&#xd;
	margin-bottom: 15px;&#xd;
	width: 100%; &#xd;
	height: 20px; &#xd;
	font-size: 16px;&#xd;
	font-weight: bold;&#xd;
	padding-left: 5px; &#xd;
}&#xd;
&#xd;
.cabeceraImpr {&#xd;
	padding-left:10px;&#xd;
}&#xd;
&#xd;
.cabeceraImpr label {&#xd;
	font-weight: normal;&#xd;
}&#xd;
&#xd;
.cabeceraImpr .camposFiltro div {&#xd;
	padding: 5px 10px 20px 10px;&#xd;
}&#xd;
&#xd;
.listaImpr {&#xd;
	padding:10px;&#xd;
}&#xd;
&#xd;
.listaImpr table.list td {&#xd;
	border-top: 1px solid #d0d0d0;&#xd;
	padding-left: 10px;&#xd;
}&#xd;
&#xd;
.listaImpr table.list th {&#xd;
	padding-left: 10px;&#xd;
}&#xd;
&#xd;
table.printOption {&#xd;
	position: absolute; &#xd;
	top: 10px; &#xd;
	left: 570px;&#xd;
	cursor: pointer;&#xd;
}&#xd;
</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/styles/style.css</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022225" s="true" lb="/iceweb/js/json.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" de="" by="8178" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:01 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=b449fe38115001a357c977b4f71b78290e7446c2198d9d45ffaa5ac31a3ad9fa; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: application/x-javascript
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: */*
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">/**
 * @class JSON
 * VersiÃ³n modificada del json.js de Douglas Crockford
 * con soporte para referencias cÃ­clicas. 
 * http://www.json.org/js.html
 * @singleton
 */
exc = {};
exc.JSON = new (function(){
    // crashes Safari in some instances
    //var validRE = /^(&quot;(\\.|[^&quot;\\\n\r])*?&quot;|[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t])+?$/;
    
    var pad = function(n) {
        return n &lt; 10 ? &quot;0&quot; + n : n;
    };
    
    var m = {
        &quot;\b&quot;: &apos;\\b&apos;,
        &quot;\t&quot;: &apos;\\t&apos;,
        &quot;\n&quot;: &apos;\\n&apos;,
        &quot;\f&quot;: &apos;\\f&apos;,
        &quot;\r&quot;: &apos;\\r&apos;,
        &apos;&quot;&apos; : &apos;\\&quot;&apos;,
        &quot;\\&quot;: &apos;\\\\&apos;
    };

    
    /**
     * Debemos resetear los ids para no provocar errores en la proxima serializaciÃ³n
	 * Si no los reseteamos, podrÃ­a suceder varios objetos provenientes de distintas 
	 * deserializaciones tuvieran el mismo &apos;@id&apos; aun siendo objetos distintos.
     * Ello provocarÃ­a confusiones al serializarlos conjuntamente.
     * Nota: Use la funciÃ³n this.clearMetadata y no las auxiliares.
	 */
	function _clearClearCheck(obj) { 	// Funcion auxiliar
		if (obj &amp;&amp; typeof(obj)==&apos;object&apos;) {
			if (obj[&apos;@clear&apos;]) delete obj[&apos;@clear&apos;];
			else return;
			for (key in obj) _clearClearCheck(obj[key]);
		}
	}
	function _clearMetadata(obj) {  	// Funcion auxiliar
		if (obj &amp;&amp; typeof(obj)==&apos;object&apos;) {
			if (!obj[&apos;@clear&apos;]) {
				// No ha sido visitado
				delete obj[&apos;@id&apos;];
				obj[&apos;@clear&apos;] = true;  // Lo marcamos como visitado
			} else {
				// Ya ha sido visitado
				return;
			} 
			
			for (key in obj) _clearMetadata(obj[key]);
		}
	}
	// @public
    this.clearMetadata = function(obj) {
		_clearMetadata(obj);
		_clearClearCheck(obj);
	}
		
    /**
     * Encodes an Object, Array or other value
     * 
     * cfillol
     * Resolvemos las referencias cruzadas.
	 * El JSON devuelto por el servidor o generado en el cliente puede 
	 * tener referencias cruzadas codificadas por medio de identificadores para 
	 * los objetos. Esta manera de trabajar permite a la libreria serializar 
	 * objetos con referencias cÃ­clicas sin que se produzcan errores y cargar estos
	 * objetos desde Javascript con referencias cÃ­clicas incluidas, de forma
	 * transparente.
	 * 
     * @param {Mixed} o The variable to encode
     * @return {String} The JSON string
     */
    this.encode = function(o){
    	var uid = 1;				// Contador de identificadores unicos
    	var cache = new Object();	// Cache de objetos por id unico
    	
    	var encodeString = function(s){
	        if (/[&quot;\\\x00-\x1f]/.test(s)) {
	            return &apos;&quot;&apos; + s.replace(/([\x00-\x1f\\&quot;])/g, function(a, b) {
	                var c = m[b];
	                if(c){
	                    return c;
	                }
	                c = b.charCodeAt();
	                return &quot;\\u00&quot; +
	                    Math.floor(c / 16).toString(16) +
	                    (c % 16).toString(16);
	            }) + &apos;&quot;&apos;;
	        }
	        return &apos;&quot;&apos; + s + &apos;&quot;&apos;;
	    };
	    
	    var encodeArray = function(o){
	        var a = [&quot;[&quot;], b, i, l = o.length, v;
	            for (i = 0; i &lt; l; i += 1) {
	                v = o[i];
	                switch (typeof v) {
	                    case &quot;undefined&quot;:
	                    case &quot;function&quot;:
	                    case &quot;unknown&quot;:
	                        break;
	                    default:
	                        if (b) {
	                            a.push(&apos;,&apos;);
	                        }
	                        a.push(v === null ? &quot;null&quot; : encode(v));
	                        b = true;
	                }
	            }
	            a.push(&quot;]&quot;);
	            return a.join(&quot;&quot;);
	    };
	    
	    /**
	     * cfillol
		 * Codificamos las fechas con JSON como fechas de javascript
		 * Ej: {fechaIni: new Date(2007,2,1,15,0,0)}
		 */
	    var encodeDate = function(o){
	        return &apos;new Date(&apos; + o.getFullYear() + &quot;,&quot; +
		        (o.getMonth()) + &quot;,&quot; +
		        (o.getDate()) + &quot;,&quot; +
		        (o.getHours()) + &quot;,&quot; +
		        (o.getMinutes()) + &quot;,&quot; +
		        (o.getSeconds()) + &apos;)&apos;;
	    };
    
    	var encode = function(o) {
	        if(typeof o == &quot;undefined&quot; || o === null){
	            return &quot;null&quot;;
	        }else if(o instanceof Array){
	            return encodeArray(o);
	        }else if(o instanceof Date){
	            return encodeDate(o);
	        }else if(typeof o == &quot;string&quot;){
	            return encodeString(o);
	        }else if(typeof o == &quot;number&quot;){
	            return isFinite(o) ? String(o) : &quot;null&quot;;
	        }else if(typeof o == &quot;boolean&quot;){
	            return String(o);
	        }else {
	        	var luid = null;
	        	if (o[&apos;@id&apos;]) luid = parseInt(o[&apos;@id&apos;]);
	        	if (!luid || !cache[luid]) {
	        		if (!luid) luid = uid++;
					o[&apos;@id&apos;] = luid;
	        		cache[luid] = o;
					
	        		// IMPORTANT: @id has to be the first serialized property, otherwise 
					// jackson cyclic resolution wouldn&apos;t work
		            var a = [&apos;{&quot;@id&quot;:&apos;,luid], i, v;
		            for (i in o) {		               
						v = o[i];
						if (i.charAt(0)!=&apos;@&apos;) { // We have allready write @id property
							switch (typeof v) {
							case &quot;undefined&quot;:
							case &quot;function&quot;:
							case &quot;unknown&quot;:
								break;
							default:
								a.push(&apos;,&apos;);
								a.push(encode(i), &quot;:&quot;,
										v === null ? &quot;null&quot; : encode(v));
							}
						}
		            }
		            a.push(&quot;}&quot;);
		            return a.join(&quot;&quot;);
	        	} else return &apos;{&quot;@ref&quot;:&apos;+luid+&apos;}&apos;;
	        }  
    	}
        
        var str = encode(o);
        this.clearMetadata(o);
        return str;
    };
    
    
    /**
     * Decodes (parses) a JSON string to an object. If the JSON is invalid, this function throws a SyntaxError.
     * 
     * cfillol
     * Resolvemos las referencias cruzadas.
	 * El JSON devuelto por el servidor (SOJO) o generado en el cliente puede 
	 * tener referencias cruzadas codificadas por medio de identificadores para 
	 * los objetos. Esta manera de trabajar permite a la libreria serializar 
	 * objetos con referencias cÃ­clicas sin que se produzcan errores y cargar estos
	 * objetos desde Javascript con referencias cÃ­clicas incluidas, de forma
	 * transparente.
	 * 
     * @param {String} json The JSON string
     * @return {Object} The resulting object
     * 
     * 
     */
    this.decode = function(str){
    	var c = new Object();	// Cache
		function cache(obj) {
			if (obj &amp;&amp; typeof(obj)==&apos;object&apos;) {
				try {
					if (obj[&apos;@id&apos;]) c[obj[&apos;@id&apos;]] = obj;
				} catch(e) {
				    // TODO cfillol: Â¿Por que falla? Â¿Se paso un {}?
					// obj no tiene propiedades
					return;
				}
				for (key in obj) {
					var value = obj[key];
					if (typeof(value)==&apos;object&apos;) cache(value);
				}
			}
		}
		function resolve(obj) {
			if (!obj || typeof(obj)!=&apos;object&apos;) throw &quot;Se intentÃ³ resolver algo distinto de un objeto&quot;; 
			
			/*
			 Debemos resetearlo para no provocar errores en la prÃ³xima serializaciÃ³n
			 Si no lo reseteamos, podrÃ­a suceder varios objetos provenientes de distintas 
			 deserializaciones tuvieran el mismo &apos;@id&apos; aÃºn siendo objetos distintos.
			 Ello provocarÃ­a confusiones al serializarlos conjuntamente.
			*/
			delete obj[&apos;@id&apos;]; 
			
			for (key in obj) {
				var value = obj[key];
				if (value) {
					if (key==&apos;@ref&apos;) {
						return c[value];
					} else if (typeof(value)==&apos;object&apos;) {
						obj[key] = resolve(value);
					}
				}
			}
			
			return obj;
		}
	
		// Podemos pasarle una str o un objeto con referencias cruzadas no resueltas
	    var obj = null;
	    if (typeof(str)==&apos;string&apos;) obj = eval(&apos;(&apos; + str + &apos;)&apos;);
	    else obj = str;
	    
	    cache(obj);
		resolve(obj);
		
		return obj;
    }
    
    /**
     * Clona un obj json
     * TODO cfillol: Intentar optimizar
     */
    this.clone = function(obj){
    	return this.decode(this.encode(obj));
    }
    
})();

</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/json.js</java.net.URL>
</httpSample>
<httpSample t="7" it="0" lt="5" ts="1315465022235" s="true" lb="/iceweb/js/jquery-1.4.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" de="" by="158797" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:01 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=935fe703baddc7be869da5210a34216aceb05f7780b509be36fcdf96303e947b; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: application/x-javascript
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: */*
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">/*!
 * jQuery JavaScript Library v1.4
 * http://jquery.com/
 *
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://docs.jquery.com/License
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2010, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Wed Jan 13 15:23:05 2010 -0500
 */
(function( window, undefined ) {

// Define a local copy of jQuery
var jQuery = function( selector, context ) {
		// The jQuery object is actually just the init constructor &apos;enhanced&apos;
		return new jQuery.fn.init( selector, context );
	},

	// Map over jQuery in case of overwrite
	_jQuery = window.jQuery,

	// Map over the $ in case of overwrite
	_$ = window.$,

	// Use the correct document accordingly with window argument (sandbox)
	document = window.document,

	// A central reference to the root jQuery(document)
	rootjQuery,

	// A simple way to check for HTML strings or ID strings
	// (both of which we optimize for)
	quickExpr = /^[^&lt;]*(&lt;[\w\W]+&gt;)[^&gt;]*$|^#([\w-]+)$/,

	// Is it a simple selector
	isSimple = /^.[^:#\[\.,]*$/,

	// Check if a string has a non-whitespace character in it
	rnotwhite = /\S/,

	// Used for trimming whitespace
	rtrim = /^(\s|\u00A0)+|(\s|\u00A0)+$/g,

	// Match a standalone tag
	rsingleTag = /^&lt;(\w+)\s*\/?&gt;(?:&lt;\/\1&gt;)?$/,

	// Keep a UserAgent string for use with jQuery.browser
	userAgent = navigator.userAgent,

	// For matching the engine and version of the browser
	browserMatch,
	
	// Has the ready events already been bound?
	readyBound = false,
	
	// The functions to execute on DOM ready
	readyList = [],

	// The ready event handler
	DOMContentLoaded,

	// Save a reference to some core methods
	toString = Object.prototype.toString,
	hasOwnProperty = Object.prototype.hasOwnProperty,
	push = Array.prototype.push,
	slice = Array.prototype.slice,
	indexOf = Array.prototype.indexOf;

jQuery.fn = jQuery.prototype = {
	init: function( selector, context ) {
		var match, elem, ret, doc;

		// Handle $(&quot;&quot;), $(null), or $(undefined)
		if ( !selector ) {
			return this;
		}

		// Handle $(DOMElement)
		if ( selector.nodeType ) {
			this.context = this[0] = selector;
			this.length = 1;
			return this;
		}

		// Handle HTML strings
		if ( typeof selector === &quot;string&quot; ) {
			// Are we dealing with HTML string or an ID?
			match = quickExpr.exec( selector );

			// Verify a match, and that no context was specified for #id
			if ( match &amp;&amp; (match[1] || !context) ) {

				// HANDLE: $(html) -&gt; $(array)
				if ( match[1] ) {
					doc = (context ? context.ownerDocument || context : document);

					// If a single string is passed in and it&apos;s a single tag
					// just do a createElement and skip the rest
					ret = rsingleTag.exec( selector );

					if ( ret ) {
						if ( jQuery.isPlainObject( context ) ) {
							selector = [ document.createElement( ret[1] ) ];
							jQuery.fn.attr.call( selector, context, true );

						} else {
							selector = [ doc.createElement( ret[1] ) ];
						}

					} else {
						ret = buildFragment( [ match[1] ], [ doc ] );
						selector = (ret.cacheable ? ret.fragment.cloneNode(true) : ret.fragment).childNodes;
					}

				// HANDLE: $(&quot;#id&quot;)
				} else {
					elem = document.getElementById( match[2] );

					if ( elem ) {
						// Handle the case where IE and Opera return items
						// by name instead of ID
						if ( elem.id !== match[2] ) {
							return rootjQuery.find( selector );
						}

						// Otherwise, we inject the element directly into the jQuery object
						this.length = 1;
						this[0] = elem;
					}

					this.context = document;
					this.selector = selector;
					return this;
				}

			// HANDLE: $(&quot;TAG&quot;)
			} else if ( !context &amp;&amp; /^\w+$/.test( selector ) ) {
				this.selector = selector;
				this.context = document;
				selector = document.getElementsByTagName( selector );

			// HANDLE: $(expr, $(...))
			} else if ( !context || context.jquery ) {
				return (context || rootjQuery).find( selector );

			// HANDLE: $(expr, context)
			// (which is just equivalent to: $(context).find(expr)
			} else {
				return jQuery( context ).find( selector );
			}

		// HANDLE: $(function)
		// Shortcut for document ready
		} else if ( jQuery.isFunction( selector ) ) {
			return rootjQuery.ready( selector );
		}

		if (selector.selector !== undefined) {
			this.selector = selector.selector;
			this.context = selector.context;
		}

		return jQuery.isArray( selector ) ?
			this.setArray( selector ) :
			jQuery.makeArray( selector, this );
	},

	// Start with an empty selector
	selector: &quot;&quot;,

	// The current version of jQuery being used
	jquery: &quot;1.4&quot;,

	// The default length of a jQuery object is 0
	length: 0,

	// The number of elements contained in the matched element set
	size: function() {
		return this.length;
	},

	toArray: function() {
		return slice.call( this, 0 );
	},

	// Get the Nth element in the matched element set OR
	// Get the whole matched element set as a clean array
	get: function( num ) {
		return num == null ?

			// Return a &apos;clean&apos; array
			this.toArray() :

			// Return just the object
			( num &lt; 0 ? this.slice(num)[ 0 ] : this[ num ] );
	},

	// Take an array of elements and push it onto the stack
	// (returning the new matched element set)
	pushStack: function( elems, name, selector ) {
		// Build a new jQuery matched element set
		var ret = jQuery( elems || null );

		// Add the old object onto the stack (as a reference)
		ret.prevObject = this;

		ret.context = this.context;

		if ( name === &quot;find&quot; ) {
			ret.selector = this.selector + (this.selector ? &quot; &quot; : &quot;&quot;) + selector;
		} else if ( name ) {
			ret.selector = this.selector + &quot;.&quot; + name + &quot;(&quot; + selector + &quot;)&quot;;
		}

		// Return the newly-formed element set
		return ret;
	},

	// Force the current matched set of elements to become
	// the specified array of elements (destroying the stack in the process)
	// You should use pushStack() in order to do this, but maintain the stack
	setArray: function( elems ) {
		// Resetting the length to 0, then using the native Array push
		// is a super-fast way to populate an object with array-like properties
		this.length = 0;
		push.apply( this, elems );

		return this;
	},

	// Execute a callback for every element in the matched set.
	// (You can seed the arguments with an array of args, but this is
	// only used internally.)
	each: function( callback, args ) {
		return jQuery.each( this, callback, args );
	},
	
	ready: function( fn ) {
		// Attach the listeners
		jQuery.bindReady();

		// If the DOM is already ready
		if ( jQuery.isReady ) {
			// Execute the function immediately
			fn.call( document, jQuery );

		// Otherwise, remember the function for later
		} else if ( readyList ) {
			// Add the function to the wait list
			readyList.push( fn );
		}

		return this;
	},
	
	eq: function( i ) {
		return i === -1 ?
			this.slice( i ) :
			this.slice( i, +i + 1 );
	},

	first: function() {
		return this.eq( 0 );
	},

	last: function() {
		return this.eq( -1 );
	},

	slice: function() {
		return this.pushStack( slice.apply( this, arguments ),
			&quot;slice&quot;, slice.call(arguments).join(&quot;,&quot;) );
	},

	map: function( callback ) {
		return this.pushStack( jQuery.map(this, function( elem, i ) {
			return callback.call( elem, i, elem );
		}));
	},
	
	end: function() {
		return this.prevObject || jQuery(null);
	},

	// For internal use only.
	// Behaves like an Array&apos;s method, not like a jQuery method.
	push: push,
	sort: [].sort,
	splice: [].splice
};

// Give the init function the jQuery prototype for later instantiation
jQuery.fn.init.prototype = jQuery.fn;

jQuery.extend = jQuery.fn.extend = function() {
	// copy reference to target object
	var target = arguments[0] || {}, i = 1, length = arguments.length, deep = false, options, name, src, copy;

	// Handle a deep copy situation
	if ( typeof target === &quot;boolean&quot; ) {
		deep = target;
		target = arguments[1] || {};
		// skip the boolean and the target
		i = 2;
	}

	// Handle case when target is a string or something (possible in deep copy)
	if ( typeof target !== &quot;object&quot; &amp;&amp; !jQuery.isFunction(target) ) {
		target = {};
	}

	// extend jQuery itself if only one argument is passed
	if ( length === i ) {
		target = this;
		--i;
	}

	for ( ; i &lt; length; i++ ) {
		// Only deal with non-null/undefined values
		if ( (options = arguments[ i ]) != null ) {
			// Extend the base object
			for ( name in options ) {
				src = target[ name ];
				copy = options[ name ];

				// Prevent never-ending loop
				if ( target === copy ) {
					continue;
				}

				// Recurse if we&apos;re merging object literal values or arrays
				if ( deep &amp;&amp; copy &amp;&amp; ( jQuery.isPlainObject(copy) || jQuery.isArray(copy) ) ) {
					var clone = src &amp;&amp; ( jQuery.isPlainObject(src) || jQuery.isArray(src) ) ? src
						: jQuery.isArray(copy) ? [] : {};

					// Never move original objects, clone them
					target[ name ] = jQuery.extend( deep, clone, copy );

				// Don&apos;t bring in undefined values
				} else if ( copy !== undefined ) {
					target[ name ] = copy;
				}
			}
		}
	}

	// Return the modified object
	return target;
};

jQuery.extend({
	noConflict: function( deep ) {
		window.$ = _$;

		if ( deep ) {
			window.jQuery = _jQuery;
		}

		return jQuery;
	},
	
	// Is the DOM ready to be used? Set to true once it occurs.
	isReady: false,
	
	// Handle when the DOM is ready
	ready: function() {
		// Make sure that the DOM is not already loaded
		if ( !jQuery.isReady ) {
			// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).
			if ( !document.body ) {
				return setTimeout( jQuery.ready, 13 );
			}

			// Remember that the DOM is ready
			jQuery.isReady = true;

			// If there are functions bound, to execute
			if ( readyList ) {
				// Execute all of them
				var fn, i = 0;
				while ( (fn = readyList[ i++ ]) ) {
					fn.call( document, jQuery );
				}

				// Reset the list of functions
				readyList = null;
			}

			// Trigger any bound ready events
			if ( jQuery.fn.triggerHandler ) {
				jQuery( document ).triggerHandler( &quot;ready&quot; );
			}
		}
	},
	
	bindReady: function() {
		if ( readyBound ) {
			return;
		}

		readyBound = true;

		// Catch cases where $(document).ready() is called after the
		// browser event has already occurred.
		if ( document.readyState === &quot;complete&quot; ) {
			return jQuery.ready();
		}

		// Mozilla, Opera and webkit nightlies currently support this event
		if ( document.addEventListener ) {
			// Use the handy event callback
			document.addEventListener( &quot;DOMContentLoaded&quot;, DOMContentLoaded, false );
			
			// A fallback to window.onload, that will always work
			window.addEventListener( &quot;load&quot;, jQuery.ready, false );

		// If IE event model is used
		} else if ( document.attachEvent ) {
			// ensure firing before onload,
			// maybe late but safe also for iframes
			document.attachEvent(&quot;onreadystatechange&quot;, DOMContentLoaded);
			
			// A fallback to window.onload, that will always work
			window.attachEvent( &quot;onload&quot;, jQuery.ready );

			// If IE and not a frame
			// continually check to see if the document is ready
			var toplevel = false;

			try {
				toplevel = window.frameElement == null;
			} catch(e) {}

			if ( document.documentElement.doScroll &amp;&amp; toplevel ) {
				doScrollCheck();
			}
		}
	},

	// See test/unit/core.js for details concerning isFunction.
	// Since version 1.3, DOM methods and functions like alert
	// aren&apos;t supported. They return false on IE (#2968).
	isFunction: function( obj ) {
		return toString.call(obj) === &quot;[object Function]&quot;;
	},

	isArray: function( obj ) {
		return toString.call(obj) === &quot;[object Array]&quot;;
	},

	isPlainObject: function( obj ) {
		// Must be an Object.
		// Because of IE, we also have to check the presence of the constructor property.
		// Make sure that DOM nodes and window objects don&apos;t pass through, as well
		if ( !obj || toString.call(obj) !== &quot;[object Object]&quot; || obj.nodeType || obj.setInterval ) {
			return false;
		}
		
		// Not own constructor property must be Object
		if ( obj.constructor
			&amp;&amp; !hasOwnProperty.call(obj, &quot;constructor&quot;)
			&amp;&amp; !hasOwnProperty.call(obj.constructor.prototype, &quot;isPrototypeOf&quot;) ) {
			return false;
		}
		
		// Own properties are enumerated firstly, so to speed up,
		// if last one is own, then all properties are own.
	
		var key;
		for ( key in obj ) {}
		
		return key === undefined || hasOwnProperty.call( obj, key );
	},

	isEmptyObject: function( obj ) {
		for ( var name in obj ) {
			return false;
		}
		return true;
	},

	noop: function() {},

	// Evalulates a script in a global context
	globalEval: function( data ) {
		if ( data &amp;&amp; rnotwhite.test(data) ) {
			// Inspired by code by Andrea Giammarchi
			// http://webreflection.blogspot.com/2007/08/global-scope-evaluation-and-dom.html
			var head = document.getElementsByTagName(&quot;head&quot;)[0] || document.documentElement,
				script = document.createElement(&quot;script&quot;);

			script.type = &quot;text/javascript&quot;;

			if ( jQuery.support.scriptEval ) {
				script.appendChild( document.createTextNode( data ) );
			} else {
				script.text = data;
			}

			// Use insertBefore instead of appendChild to circumvent an IE6 bug.
			// This arises when a base node is used (#2709).
			head.insertBefore( script, head.firstChild );
			head.removeChild( script );
		}
	},

	nodeName: function( elem, name ) {
		return elem.nodeName &amp;&amp; elem.nodeName.toUpperCase() === name.toUpperCase();
	},

	// args is for internal usage only
	each: function( object, callback, args ) {
		var name, i = 0,
			length = object.length,
			isObj = length === undefined || jQuery.isFunction(object);

		if ( args ) {
			if ( isObj ) {
				for ( name in object ) {
					if ( callback.apply( object[ name ], args ) === false ) {
						break;
					}
				}
			} else {
				for ( ; i &lt; length; ) {
					if ( callback.apply( object[ i++ ], args ) === false ) {
						break;
					}
				}
			}

		// A special, fast, case for the most common use of each
		} else {
			if ( isObj ) {
				for ( name in object ) {
					if ( callback.call( object[ name ], name, object[ name ] ) === false ) {
						break;
					}
				}
			} else {
				for ( var value = object[0];
					i &lt; length &amp;&amp; callback.call( value, i, value ) !== false; value = object[++i] ) {}
			}
		}

		return object;
	},

	trim: function( text ) {
		return (text || &quot;&quot;).replace( rtrim, &quot;&quot; );
	},

	// results is for internal usage only
	makeArray: function( array, results ) {
		var ret = results || [];

		if ( array != null ) {
			// The window, strings (and functions) also have &apos;length&apos;
			// The extra typeof function check is to prevent crashes
			// in Safari 2 (See: #3039)
			if ( array.length == null || typeof array === &quot;string&quot; || jQuery.isFunction(array) || (typeof array !== &quot;function&quot; &amp;&amp; array.setInterval) ) {
				push.call( ret, array );
			} else {
				jQuery.merge( ret, array );
			}
		}

		return ret;
	},

	inArray: function( elem, array ) {
		if ( array.indexOf ) {
			return array.indexOf( elem );
		}

		for ( var i = 0, length = array.length; i &lt; length; i++ ) {
			if ( array[ i ] === elem ) {
				return i;
			}
		}

		return -1;
	},

	merge: function( first, second ) {
		var i = first.length, j = 0;

		if ( typeof second.length === &quot;number&quot; ) {
			for ( var l = second.length; j &lt; l; j++ ) {
				first[ i++ ] = second[ j ];
			}
		} else {
			while ( second[j] !== undefined ) {
				first[ i++ ] = second[ j++ ];
			}
		}

		first.length = i;

		return first;
	},

	grep: function( elems, callback, inv ) {
		var ret = [];

		// Go through the array, only saving the items
		// that pass the validator function
		for ( var i = 0, length = elems.length; i &lt; length; i++ ) {
			if ( !inv !== !callback( elems[ i ], i ) ) {
				ret.push( elems[ i ] );
			}
		}

		return ret;
	},

	// arg is for internal usage only
	map: function( elems, callback, arg ) {
		var ret = [], value;

		// Go through the array, translating each of the items to their
		// new value (or values).
		for ( var i = 0, length = elems.length; i &lt; length; i++ ) {
			value = callback( elems[ i ], i, arg );

			if ( value != null ) {
				ret[ ret.length ] = value;
			}
		}

		return ret.concat.apply( [], ret );
	},

	// A global GUID counter for objects
	guid: 1,

	proxy: function( fn, proxy, thisObject ) {
		if ( arguments.length === 2 ) {
			if ( typeof proxy === &quot;string&quot; ) {
				thisObject = fn;
				fn = thisObject[ proxy ];
				proxy = undefined;

			} else if ( proxy &amp;&amp; !jQuery.isFunction( proxy ) ) {
				thisObject = proxy;
				proxy = undefined;
			}
		}

		if ( !proxy &amp;&amp; fn ) {
			proxy = function() {
				return fn.apply( thisObject || this, arguments );
			};
		}

		// Set the guid of unique handler to the same of original handler, so it can be removed
		if ( fn ) {
			proxy.guid = fn.guid = fn.guid || proxy.guid || jQuery.guid++;
		}

		// So proxy can be declared as an argument
		return proxy;
	},

	// Use of jQuery.browser is frowned upon.
	// More details: http://docs.jquery.com/Utilities/jQuery.browser
	uaMatch: function( ua ) {
		var ret = { browser: &quot;&quot; };

		ua = ua.toLowerCase();

		if ( /webkit/.test( ua ) ) {
			ret = { browser: &quot;webkit&quot;, version: /webkit[\/ ]([\w.]+)/ };

		} else if ( /opera/.test( ua ) ) {
			ret = { browser: &quot;opera&quot;, version:  /version/.test( ua ) ? /version[\/ ]([\w.]+)/ : /opera[\/ ]([\w.]+)/ };
			
		} else if ( /msie/.test( ua ) ) {
			ret = { browser: &quot;msie&quot;, version: /msie ([\w.]+)/ };

		} else if ( /mozilla/.test( ua ) &amp;&amp; !/compatible/.test( ua ) ) {
			ret = { browser: &quot;mozilla&quot;, version: /rv:([\w.]+)/ };
		}

		ret.version = (ret.version &amp;&amp; ret.version.exec( ua ) || [0, &quot;0&quot;])[1];

		return ret;
	},

	browser: {}
});

browserMatch = jQuery.uaMatch( userAgent );
if ( browserMatch.browser ) {
	jQuery.browser[ browserMatch.browser ] = true;
	jQuery.browser.version = browserMatch.version;
}

// Deprecated, use jQuery.browser.webkit instead
if ( jQuery.browser.webkit ) {
	jQuery.browser.safari = true;
}

if ( indexOf ) {
	jQuery.inArray = function( elem, array ) {
		return indexOf.call( array, elem );
	};
}

// All jQuery objects should point back to these
rootjQuery = jQuery(document);

// Cleanup functions for the document ready method
if ( document.addEventListener ) {
	DOMContentLoaded = function() {
		document.removeEventListener( &quot;DOMContentLoaded&quot;, DOMContentLoaded, false );
		jQuery.ready();
	};

} else if ( document.attachEvent ) {
	DOMContentLoaded = function() {
		// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).
		if ( document.readyState === &quot;complete&quot; ) {
			document.detachEvent( &quot;onreadystatechange&quot;, DOMContentLoaded );
			jQuery.ready();
		}
	};
}

// The DOM ready check for Internet Explorer
function doScrollCheck() {
	if ( jQuery.isReady ) {
		return;
	}

	try {
		// If IE is used, use the trick by Diego Perini
		// http://javascript.nwbox.com/IEContentLoaded/
		document.documentElement.doScroll(&quot;left&quot;);
	} catch( error ) {
		setTimeout( doScrollCheck, 1 );
		return;
	}

	// and execute any waiting functions
	jQuery.ready();
}

if ( indexOf ) {
	jQuery.inArray = function( elem, array ) {
		return indexOf.call( array, elem );
	};
}

function evalScript( i, elem ) {
	if ( elem.src ) {
		jQuery.ajax({
			url: elem.src,
			async: false,
			dataType: &quot;script&quot;
		});
	} else {
		jQuery.globalEval( elem.text || elem.textContent || elem.innerHTML || &quot;&quot; );
	}

	if ( elem.parentNode ) {
		elem.parentNode.removeChild( elem );
	}
}

// Mutifunctional method to get and set values to a collection
// The value/s can be optionally by executed if its a function
function access( elems, key, value, exec, fn, pass ) {
	var length = elems.length;
	
	// Setting many attributes
	if ( typeof key === &quot;object&quot; ) {
		for ( var k in key ) {
			access( elems, k, key[k], exec, fn, value );
		}
		return elems;
	}
	
	// Setting one attribute
	if ( value !== undefined ) {
		// Optionally, function values get executed if exec is true
		exec = !pass &amp;&amp; exec &amp;&amp; jQuery.isFunction(value);
		
		for ( var i = 0; i &lt; length; i++ ) {
			fn( elems[i], key, exec ? value.call( elems[i], i, fn( elems[i], key ) ) : value, pass );
		}
		
		return elems;
	}
	
	// Getting an attribute
	return length ? fn( elems[0], key ) : null;
}

function now() {
	return (new Date).getTime();
}
(function() {

	jQuery.support = {};

	var root = document.documentElement,
		script = document.createElement(&quot;script&quot;),
		div = document.createElement(&quot;div&quot;),
		id = &quot;script&quot; + now();

	div.style.display = &quot;none&quot;;
	div.innerHTML = &quot;   &lt;link/&gt;&lt;table&gt;&lt;/table&gt;&lt;a href=&apos;/a&apos; style=&apos;color:red;float:left;opacity:.55;&apos;&gt;a&lt;/a&gt;&lt;input type=&apos;checkbox&apos;/&gt;&quot;;

	var all = div.getElementsByTagName(&quot;*&quot;),
		a = div.getElementsByTagName(&quot;a&quot;)[0];

	// Can&apos;t get basic test support
	if ( !all || !all.length || !a ) {
		return;
	}

	jQuery.support = {
		// IE strips leading whitespace when .innerHTML is used
		leadingWhitespace: div.firstChild.nodeType === 3,

		// Make sure that tbody elements aren&apos;t automatically inserted
		// IE will insert them into empty tables
		tbody: !div.getElementsByTagName(&quot;tbody&quot;).length,

		// Make sure that link elements get serialized correctly by innerHTML
		// This requires a wrapper element in IE
		htmlSerialize: !!div.getElementsByTagName(&quot;link&quot;).length,

		// Get the style information from getAttribute
		// (IE uses .cssText insted)
		style: /red/.test( a.getAttribute(&quot;style&quot;) ),

		// Make sure that URLs aren&apos;t manipulated
		// (IE normalizes it by default)
		hrefNormalized: a.getAttribute(&quot;href&quot;) === &quot;/a&quot;,

		// Make sure that element opacity exists
		// (IE uses filter instead)
		// Use a regex to work around a WebKit issue. See #5145
		opacity: /^0.55$/.test( a.style.opacity ),

		// Verify style float existence
		// (IE uses styleFloat instead of cssFloat)
		cssFloat: !!a.style.cssFloat,

		// Make sure that if no value is specified for a checkbox
		// that it defaults to &quot;on&quot;.
		// (WebKit defaults to &quot;&quot; instead)
		checkOn: div.getElementsByTagName(&quot;input&quot;)[0].value === &quot;on&quot;,

		// Make sure that a selected-by-default option has a working selected property.
		// (WebKit defaults to false instead of true, IE too, if it&apos;s in an optgroup)
		optSelected: document.createElement(&quot;select&quot;).appendChild( document.createElement(&quot;option&quot;) ).selected,

		// Will be defined later
		scriptEval: false,
		noCloneEvent: true,
		boxModel: null
	};

	script.type = &quot;text/javascript&quot;;
	try {
		script.appendChild( document.createTextNode( &quot;window.&quot; + id + &quot;=1;&quot; ) );
	} catch(e) {}

	root.insertBefore( script, root.firstChild );

	// Make sure that the execution of code works by injecting a script
	// tag with appendChild/createTextNode
	// (IE doesn&apos;t support this, fails, and uses .text instead)
	if ( window[ id ] ) {
		jQuery.support.scriptEval = true;
		delete window[ id ];
	}

	root.removeChild( script );

	if ( div.attachEvent &amp;&amp; div.fireEvent ) {
		div.attachEvent(&quot;onclick&quot;, function click() {
			// Cloning a node shouldn&apos;t copy over any
			// bound event handlers (IE does this)
			jQuery.support.noCloneEvent = false;
			div.detachEvent(&quot;onclick&quot;, click);
		});
		div.cloneNode(true).fireEvent(&quot;onclick&quot;);
	}

	// Figure out if the W3C box model works as expected
	// document.body must exist before we can do this
	// TODO: This timeout is temporary until I move ready into core.js.
	jQuery(function() {
		var div = document.createElement(&quot;div&quot;);
		div.style.width = div.style.paddingLeft = &quot;1px&quot;;

		document.body.appendChild( div );
		jQuery.boxModel = jQuery.support.boxModel = div.offsetWidth === 2;
		document.body.removeChild( div ).style.display = &apos;none&apos;;
		div = null;
	});

	// Technique from Juriy Zaytsev
	// http://thinkweb2.com/projects/prototype/detecting-event-support-without-browser-sniffing/
	var eventSupported = function( eventName ) { 
		var el = document.createElement(&quot;div&quot;); 
		eventName = &quot;on&quot; + eventName; 

		var isSupported = (eventName in el); 
		if ( !isSupported ) { 
			el.setAttribute(eventName, &quot;return;&quot;); 
			isSupported = typeof el[eventName] === &quot;function&quot;; 
		} 
		el = null; 

		return isSupported; 
	};
	
	jQuery.support.submitBubbles = eventSupported(&quot;submit&quot;);
	jQuery.support.changeBubbles = eventSupported(&quot;change&quot;);

	// release memory in IE
	root = script = div = all = a = null;
})();

jQuery.props = {
	&quot;for&quot;: &quot;htmlFor&quot;,
	&quot;class&quot;: &quot;className&quot;,
	readonly: &quot;readOnly&quot;,
	maxlength: &quot;maxLength&quot;,
	cellspacing: &quot;cellSpacing&quot;,
	rowspan: &quot;rowSpan&quot;,
	colspan: &quot;colSpan&quot;,
	tabindex: &quot;tabIndex&quot;,
	usemap: &quot;useMap&quot;,
	frameborder: &quot;frameBorder&quot;
};
var expando = &quot;jQuery&quot; + now(), uuid = 0, windowData = {};
var emptyObject = {};

jQuery.extend({
	cache: {},
	
	expando:expando,

	// The following elements throw uncatchable exceptions if you
	// attempt to add expando properties to them.
	noData: {
		&quot;embed&quot;: true,
		&quot;object&quot;: true,
		&quot;applet&quot;: true
	},

	data: function( elem, name, data ) {
		if ( elem.nodeName &amp;&amp; jQuery.noData[elem.nodeName.toLowerCase()] ) {
			return;
		}

		elem = elem == window ?
			windowData :
			elem;

		var id = elem[ expando ], cache = jQuery.cache, thisCache;

		// Handle the case where there&apos;s no name immediately
		if ( !name &amp;&amp; !id ) {
			return null;
		}

		// Compute a unique ID for the element
		if ( !id ) { 
			id = ++uuid;
		}

		// Avoid generating a new cache unless none exists and we
		// want to manipulate it.
		if ( typeof name === &quot;object&quot; ) {
			elem[ expando ] = id;
			thisCache = cache[ id ] = jQuery.extend(true, {}, name);
		} else if ( cache[ id ] ) {
			thisCache = cache[ id ];
		} else if ( typeof data === &quot;undefined&quot; ) {
			thisCache = emptyObject;
		} else {
			thisCache = cache[ id ] = {};
		}

		// Prevent overriding the named cache with undefined values
		if ( data !== undefined ) {
			elem[ expando ] = id;
			thisCache[ name ] = data;
		}

		return typeof name === &quot;string&quot; ? thisCache[ name ] : thisCache;
	},

	removeData: function( elem, name ) {
		if ( elem.nodeName &amp;&amp; jQuery.noData[elem.nodeName.toLowerCase()] ) {
			return;
		}

		elem = elem == window ?
			windowData :
			elem;

		var id = elem[ expando ], cache = jQuery.cache, thisCache = cache[ id ];

		// If we want to remove a specific section of the element&apos;s data
		if ( name ) {
			if ( thisCache ) {
				// Remove the section of cache data
				delete thisCache[ name ];

				// If we&apos;ve removed all the data, remove the element&apos;s cache
				if ( jQuery.isEmptyObject(thisCache) ) {
					jQuery.removeData( elem );
				}
			}

		// Otherwise, we want to remove all of the element&apos;s data
		} else {
			// Clean up the element expando
			try {
				delete elem[ expando ];
			} catch( e ) {
				// IE has trouble directly removing the expando
				// but it&apos;s ok with using removeAttribute
				if ( elem.removeAttribute ) {
					elem.removeAttribute( expando );
				}
			}

			// Completely remove the data cache
			delete cache[ id ];
		}
	}
});

jQuery.fn.extend({
	data: function( key, value ) {
		if ( typeof key === &quot;undefined&quot; &amp;&amp; this.length ) {
			return jQuery.data( this[0] );

		} else if ( typeof key === &quot;object&quot; ) {
			return this.each(function() {
				jQuery.data( this, key );
			});
		}

		var parts = key.split(&quot;.&quot;);
		parts[1] = parts[1] ? &quot;.&quot; + parts[1] : &quot;&quot;;

		if ( value === undefined ) {
			var data = this.triggerHandler(&quot;getData&quot; + parts[1] + &quot;!&quot;, [parts[0]]);

			if ( data === undefined &amp;&amp; this.length ) {
				data = jQuery.data( this[0], key );
			}
			return data === undefined &amp;&amp; parts[1] ?
				this.data( parts[0] ) :
				data;
		} else {
			return this.trigger(&quot;setData&quot; + parts[1] + &quot;!&quot;, [parts[0], value]).each(function() {
				jQuery.data( this, key, value );
			});
		}
	},

	removeData: function( key ) {
		return this.each(function() {
			jQuery.removeData( this, key );
		});
	}
});
jQuery.extend({
	queue: function( elem, type, data ) {
		if ( !elem ) {
			return;
		}

		type = (type || &quot;fx&quot;) + &quot;queue&quot;;
		var q = jQuery.data( elem, type );

		// Speed up dequeue by getting out quickly if this is just a lookup
		if ( !data ) {
			return q || [];
		}

		if ( !q || jQuery.isArray(data) ) {
			q = jQuery.data( elem, type, jQuery.makeArray(data) );

		} else {
			q.push( data );
		}

		return q;
	},

	dequeue: function( elem, type ) {
		type = type || &quot;fx&quot;;

		var queue = jQuery.queue( elem, type ), fn = queue.shift();

		// If the fx queue is dequeued, always remove the progress sentinel
		if ( fn === &quot;inprogress&quot; ) {
			fn = queue.shift();
		}

		if ( fn ) {
			// Add a progress sentinel to prevent the fx queue from being
			// automatically dequeued
			if ( type === &quot;fx&quot; ) {
				queue.unshift(&quot;inprogress&quot;);
			}

			fn.call(elem, function() {
				jQuery.dequeue(elem, type);
			});
		}
	}
});

jQuery.fn.extend({
	queue: function( type, data ) {
		if ( typeof type !== &quot;string&quot; ) {
			data = type;
			type = &quot;fx&quot;;
		}

		if ( data === undefined ) {
			return jQuery.queue( this[0], type );
		}
		return this.each(function( i, elem ) {
			var queue = jQuery.queue( this, type, data );

			if ( type === &quot;fx&quot; &amp;&amp; queue[0] !== &quot;inprogress&quot; ) {
				jQuery.dequeue( this, type );
			}
		});
	},
	dequeue: function( type ) {
		return this.each(function() {
			jQuery.dequeue( this, type );
		});
	},

	// Based off of the plugin by Clint Helfers, with permission.
	// http://blindsignals.com/index.php/2009/07/jquery-delay/
	delay: function( time, type ) {
		time = jQuery.fx ? jQuery.fx.speeds[time] || time : time;
		type = type || &quot;fx&quot;;

		return this.queue( type, function() {
			var elem = this;
			setTimeout(function() {
				jQuery.dequeue( elem, type );
			}, time );
		});
	},

	clearQueue: function( type ) {
		return this.queue( type || &quot;fx&quot;, [] );
	}
});
var rclass = /[\n\t]/g,
	rspace = /\s+/,
	rreturn = /\r/g,
	rspecialurl = /href|src|style/,
	rtype = /(button|input)/i,
	rfocusable = /(button|input|object|select|textarea)/i,
	rclickable = /^(a|area)$/i,
	rradiocheck = /radio|checkbox/;

jQuery.fn.extend({
	attr: function( name, value ) {
		return access( this, name, value, true, jQuery.attr );
	},

	removeAttr: function( name, fn ) {
		return this.each(function(){
			jQuery.attr( this, name, &quot;&quot; );
			if ( this.nodeType === 1 ) {
				this.removeAttribute( name );
			}
		});
	},

	addClass: function( value ) {
		if ( jQuery.isFunction(value) ) {
			return this.each(function(i) {
				var self = jQuery(this);
				self.addClass( value.call(this, i, self.attr(&quot;class&quot;)) );
			});
		}

		if ( value &amp;&amp; typeof value === &quot;string&quot; ) {
			var classNames = (value || &quot;&quot;).split( rspace );

			for ( var i = 0, l = this.length; i &lt; l; i++ ) {
				var elem = this[i];

				if ( elem.nodeType === 1 ) {
					if ( !elem.className ) {
						elem.className = value;

					} else {
						var className = &quot; &quot; + elem.className + &quot; &quot;;
						for ( var c = 0, cl = classNames.length; c &lt; cl; c++ ) {
							if ( className.indexOf( &quot; &quot; + classNames[c] + &quot; &quot; ) &lt; 0 ) {
								elem.className += &quot; &quot; + classNames[c];
							}
						}
					}
				}
			}
		}

		return this;
	},

	removeClass: function( value ) {
		if ( jQuery.isFunction(value) ) {
			return this.each(function(i) {
				var self = jQuery(this);
				self.removeClass( value.call(this, i, self.attr(&quot;class&quot;)) );
			});
		}

		if ( (value &amp;&amp; typeof value === &quot;string&quot;) || value === undefined ) {
			var classNames = (value || &quot;&quot;).split(rspace);

			for ( var i = 0, l = this.length; i &lt; l; i++ ) {
				var elem = this[i];

				if ( elem.nodeType === 1 &amp;&amp; elem.className ) {
					if ( value ) {
						var className = (&quot; &quot; + elem.className + &quot; &quot;).replace(rclass, &quot; &quot;);
						for ( var c = 0, cl = classNames.length; c &lt; cl; c++ ) {
							className = className.replace(&quot; &quot; + classNames[c] + &quot; &quot;, &quot; &quot;);
						}
						elem.className = className.substring(1, className.length - 1);

					} else {
						elem.className = &quot;&quot;;
					}
				}
			}
		}

		return this;
	},

	toggleClass: function( value, stateVal ) {
		var type = typeof value, isBool = typeof stateVal === &quot;boolean&quot;;

		if ( jQuery.isFunction( value ) ) {
			return this.each(function(i) {
				var self = jQuery(this);
				self.toggleClass( value.call(this, i, self.attr(&quot;class&quot;), stateVal), stateVal );
			});
		}

		return this.each(function() {
			if ( type === &quot;string&quot; ) {
				// toggle individual class names
				var className, i = 0, self = jQuery(this),
					state = stateVal,
					classNames = value.split( rspace );

				while ( (className = classNames[ i++ ]) ) {
					// check each className given, space seperated list
					state = isBool ? state : !self.hasClass( className );
					self[ state ? &quot;addClass&quot; : &quot;removeClass&quot; ]( className );
				}

			} else if ( type === &quot;undefined&quot; || type === &quot;boolean&quot; ) {
				if ( this.className ) {
					// store className if set
					jQuery.data( this, &quot;__className__&quot;, this.className );
				}

				// toggle whole className
				this.className = this.className || value === false ? &quot;&quot; : jQuery.data( this, &quot;__className__&quot; ) || &quot;&quot;;
			}
		});
	},

	hasClass: function( selector ) {
		var className = &quot; &quot; + selector + &quot; &quot;;
		for ( var i = 0, l = this.length; i &lt; l; i++ ) {
			if ( (&quot; &quot; + this[i].className + &quot; &quot;).replace(rclass, &quot; &quot;).indexOf( className ) &gt; -1 ) {
				return true;
			}
		}

		return false;
	},

	val: function( value ) {
		if ( value === undefined ) {
			var elem = this[0];

			if ( elem ) {
				if ( jQuery.nodeName( elem, &quot;option&quot; ) ) {
					return (elem.attributes.value || {}).specified ? elem.value : elem.text;
				}

				// We need to handle select boxes special
				if ( jQuery.nodeName( elem, &quot;select&quot; ) ) {
					var index = elem.selectedIndex,
						values = [],
						options = elem.options,
						one = elem.type === &quot;select-one&quot;;

					// Nothing was selected
					if ( index &lt; 0 ) {
						return null;
					}

					// Loop through all the selected options
					for ( var i = one ? index : 0, max = one ? index + 1 : options.length; i &lt; max; i++ ) {
						var option = options[ i ];

						if ( option.selected ) {
							// Get the specifc value for the option
							value = jQuery(option).val();

							// We don&apos;t need an array for one selects
							if ( one ) {
								return value;
							}

							// Multi-Selects return an array
							values.push( value );
						}
					}

					return values;
				}

				// Handle the case where in Webkit &quot;&quot; is returned instead of &quot;on&quot; if a value isn&apos;t specified
				if ( rradiocheck.test( elem.type ) &amp;&amp; !jQuery.support.checkOn ) {
					return elem.getAttribute(&quot;value&quot;) === null ? &quot;on&quot; : elem.value;
				}
				

				// Everything else, we just grab the value
				return (elem.value || &quot;&quot;).replace(rreturn, &quot;&quot;);

			}

			return undefined;
		}

		var isFunction = jQuery.isFunction(value);

		return this.each(function(i) {
			var self = jQuery(this), val = value;

			if ( this.nodeType !== 1 ) {
				return;
			}

			if ( isFunction ) {
				val = value.call(this, i, self.val());
			}

			// Typecast each time if the value is a Function and the appended
			// value is therefore different each time.
			if ( typeof val === &quot;number&quot; ) {
				val += &quot;&quot;;
			}

			if ( jQuery.isArray(val) &amp;&amp; rradiocheck.test( this.type ) ) {
				this.checked = jQuery.inArray( self.val(), val ) &gt;= 0;

			} else if ( jQuery.nodeName( this, &quot;select&quot; ) ) {
				var values = jQuery.makeArray(val);

				jQuery( &quot;option&quot;, this ).each(function() {
					this.selected = jQuery.inArray( jQuery(this).val(), values ) &gt;= 0;
				});

				if ( !values.length ) {
					this.selectedIndex = -1;
				}

			} else {
				this.value = val;
			}
		});
	}
});

jQuery.extend({
	attrFn: {
		val: true,
		css: true,
		html: true,
		text: true,
		data: true,
		width: true,
		height: true,
		offset: true
	},
		
	attr: function( elem, name, value, pass ) {
		// don&apos;t set attributes on text and comment nodes
		if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 ) {
			return undefined;
		}

		if ( pass &amp;&amp; name in jQuery.attrFn ) {
			return jQuery(elem)[name](value);
		}

		var notxml = elem.nodeType !== 1 || !jQuery.isXMLDoc( elem ),
			// Whether we are setting (or getting)
			set = value !== undefined;

		// Try to normalize/fix the name
		name = notxml &amp;&amp; jQuery.props[ name ] || name;

		// Only do all the following if this is a node (faster for style)
		if ( elem.nodeType === 1 ) {
			// These attributes require special treatment
			var special = rspecialurl.test( name );

			// Safari mis-reports the default selected property of an option
			// Accessing the parent&apos;s selectedIndex property fixes it
			if ( name === &quot;selected&quot; &amp;&amp; !jQuery.support.optSelected ) {
				var parent = elem.parentNode;
				if ( parent ) {
					parent.selectedIndex;
	
					// Make sure that it also works with optgroups, see #5701
					if ( parent.parentNode ) {
						parent.parentNode.selectedIndex;
					}
				}
			}

			// If applicable, access the attribute via the DOM 0 way
			if ( name in elem &amp;&amp; notxml &amp;&amp; !special ) {
				if ( set ) {
					// We can&apos;t allow the type property to be changed (since it causes problems in IE)
					if ( name === &quot;type&quot; &amp;&amp; rtype.test( elem.nodeName ) &amp;&amp; elem.parentNode ) {
						throw &quot;type property can&apos;t be changed&quot;;
					}

					elem[ name ] = value;
				}

				// browsers index elements by id/name on forms, give priority to attributes.
				if ( jQuery.nodeName( elem, &quot;form&quot; ) &amp;&amp; elem.getAttributeNode(name) ) {
					return elem.getAttributeNode( name ).nodeValue;
				}

				// elem.tabIndex doesn&apos;t always return the correct value when it hasn&apos;t been explicitly set
				// http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/
				if ( name === &quot;tabIndex&quot; ) {
					var attributeNode = elem.getAttributeNode( &quot;tabIndex&quot; );

					return attributeNode &amp;&amp; attributeNode.specified ?
						attributeNode.value :
						rfocusable.test( elem.nodeName ) || rclickable.test( elem.nodeName ) &amp;&amp; elem.href ?
							0 :
							undefined;
				}

				return elem[ name ];
			}

			if ( !jQuery.support.style &amp;&amp; notxml &amp;&amp; name === &quot;style&quot; ) {
				if ( set ) {
					elem.style.cssText = &quot;&quot; + value;
				}

				return elem.style.cssText;
			}

			if ( set ) {
				// convert the value to a string (all browsers do this but IE) see #1070
				elem.setAttribute( name, &quot;&quot; + value );
			}

			var attr = !jQuery.support.hrefNormalized &amp;&amp; notxml &amp;&amp; special ?
					// Some attributes require a special call on IE
					elem.getAttribute( name, 2 ) :
					elem.getAttribute( name );

			// Non-existent attributes return null, we normalize to undefined
			return attr === null ? undefined : attr;
		}

		// elem is actually elem.style ... set the style
		// Using attr for specific style information is now deprecated. Use style insead.
		return jQuery.style( elem, name, value );
	}
});
var fcleanup = function( nm ) {
	return nm.replace(/[^\w\s\.\|`]/g, function( ch ) {
		return &quot;\\&quot; + ch;
	});
};

/*
 * A number of helper functions used for managing events.
 * Many of the ideas behind this code originated from
 * Dean Edwards&apos; addEvent library.
 */
jQuery.event = {

	// Bind an event to an element
	// Original by Dean Edwards
	add: function( elem, types, handler, data ) {
		if ( elem.nodeType === 3 || elem.nodeType === 8 ) {
			return;
		}

		// For whatever reason, IE has trouble passing the window object
		// around, causing it to be cloned in the process
		if ( elem.setInterval &amp;&amp; ( elem !== window &amp;&amp; !elem.frameElement ) ) {
			elem = window;
		}

		// Make sure that the function being executed has a unique ID
		if ( !handler.guid ) {
			handler.guid = jQuery.guid++;
		}

		// if data is passed, bind to handler
		if ( data !== undefined ) {
			// Create temporary function pointer to original handler
			var fn = handler;

			// Create unique handler function, wrapped around original handler
			handler = jQuery.proxy( fn );

			// Store data in unique handler
			handler.data = data;
		}

		// Init the element&apos;s event structure
		var events = jQuery.data( elem, &quot;events&quot; ) || jQuery.data( elem, &quot;events&quot;, {} ),
			handle = jQuery.data( elem, &quot;handle&quot; ), eventHandle;

		if ( !handle ) {
			eventHandle = function() {
				// Handle the second event of a trigger and when
				// an event is called after a page has unloaded
				return typeof jQuery !== &quot;undefined&quot; &amp;&amp; !jQuery.event.triggered ?
					jQuery.event.handle.apply( eventHandle.elem, arguments ) :
					undefined;
			};

			handle = jQuery.data( elem, &quot;handle&quot;, eventHandle );
		}

		// If no handle is found then we must be trying to bind to one of the
		// banned noData elements
		if ( !handle ) {
			return;
		}

		// Add elem as a property of the handle function
		// This is to prevent a memory leak with non-native
		// event in IE.
		handle.elem = elem;

		// Handle multiple events separated by a space
		// jQuery(...).bind(&quot;mouseover mouseout&quot;, fn);
		types = types.split( /\s+/ );
		var type, i=0;
		while ( (type = types[ i++ ]) ) {
			// Namespaced event handlers
			var namespaces = type.split(&quot;.&quot;);
			type = namespaces.shift();
			handler.type = namespaces.slice(0).sort().join(&quot;.&quot;);

			// Get the current list of functions bound to this event
			var handlers = events[ type ],
				special = this.special[ type ] || {};

			

			// Init the event handler queue
			if ( !handlers ) {
				handlers = events[ type ] = {};

				// Check for a special event handler
				// Only use addEventListener/attachEvent if the special
				// events handler returns false
				if ( !special.setup || special.setup.call( elem, data, namespaces, handler) === false ) {
					// Bind the global event handler to the element
					if ( elem.addEventListener ) {
						elem.addEventListener( type, handle, false );
					} else if ( elem.attachEvent ) {
						elem.attachEvent( &quot;on&quot; + type, handle );
					}
				}
			}
			
			if ( special.add ) { 
				var modifiedHandler = special.add.call( elem, handler, data, namespaces, handlers ); 
				if ( modifiedHandler &amp;&amp; jQuery.isFunction( modifiedHandler ) ) { 
					modifiedHandler.guid = modifiedHandler.guid || handler.guid; 
					handler = modifiedHandler; 
				} 
			} 
			
			// Add the function to the element&apos;s handler list
			handlers[ handler.guid ] = handler;

			// Keep track of which events have been used, for global triggering
			this.global[ type ] = true;
		}

		// Nullify elem to prevent memory leaks in IE
		elem = null;
	},

	global: {},

	// Detach an event or set of events from an element
	remove: function( elem, types, handler ) {
		// don&apos;t do events on text and comment nodes
		if ( elem.nodeType === 3 || elem.nodeType === 8 ) {
			return;
		}

		var events = jQuery.data( elem, &quot;events&quot; ), ret, type, fn;

		if ( events ) {
			// Unbind all events for the element
			if ( types === undefined || (typeof types === &quot;string&quot; &amp;&amp; types.charAt(0) === &quot;.&quot;) ) {
				for ( type in events ) {
					this.remove( elem, type + (types || &quot;&quot;) );
				}
			} else {
				// types is actually an event object here
				if ( types.type ) {
					handler = types.handler;
					types = types.type;
				}

				// Handle multiple events separated by a space
				// jQuery(...).unbind(&quot;mouseover mouseout&quot;, fn);
				types = types.split(/\s+/);
				var i = 0;
				while ( (type = types[ i++ ]) ) {
					// Namespaced event handlers
					var namespaces = type.split(&quot;.&quot;);
					type = namespaces.shift();
					var all = !namespaces.length,
						cleaned = jQuery.map( namespaces.slice(0).sort(), fcleanup ),
						namespace = new RegExp(&quot;(^|\\.)&quot; + cleaned.join(&quot;\\.(?:.*\\.)?&quot;) + &quot;(\\.|$)&quot;),
						special = this.special[ type ] || {};

					if ( events[ type ] ) {
						// remove the given handler for the given type
						if ( handler ) {
							fn = events[ type ][ handler.guid ];
							delete events[ type ][ handler.guid ];

						// remove all handlers for the given type
						} else {
							for ( var handle in events[ type ] ) {
								// Handle the removal of namespaced events
								if ( all || namespace.test( events[ type ][ handle ].type ) ) {
									delete events[ type ][ handle ];
								}
							}
						}

						if ( special.remove ) {
							special.remove.call( elem, namespaces, fn);
						}

						// remove generic event handler if no more handlers exist
						for ( ret in events[ type ] ) {
							break;
						}
						if ( !ret ) {
							if ( !special.teardown || special.teardown.call( elem, namespaces ) === false ) {
								if ( elem.removeEventListener ) {
									elem.removeEventListener( type, jQuery.data( elem, &quot;handle&quot; ), false );
								} else if ( elem.detachEvent ) {
									elem.detachEvent( &quot;on&quot; + type, jQuery.data( elem, &quot;handle&quot; ) );
								}
							}
							ret = null;
							delete events[ type ];
						}
					}
				}
			}

			// Remove the expando if it&apos;s no longer used
			for ( ret in events ) {
				break;
			}
			if ( !ret ) {
				var handle = jQuery.data( elem, &quot;handle&quot; );
				if ( handle ) {
					handle.elem = null;
				}
				jQuery.removeData( elem, &quot;events&quot; );
				jQuery.removeData( elem, &quot;handle&quot; );
			}
		}
	},

	// bubbling is internal
	trigger: function( event, data, elem /*, bubbling */ ) {
		// Event object or event type
		var type = event.type || event,
			bubbling = arguments[3];

		if ( !bubbling ) {
			event = typeof event === &quot;object&quot; ?
				// jQuery.Event object
				event[expando] ? event :
				// Object literal
				jQuery.extend( jQuery.Event(type), event ) :
				// Just the event type (string)
				jQuery.Event(type);

			if ( type.indexOf(&quot;!&quot;) &gt;= 0 ) {
				event.type = type = type.slice(0, -1);
				event.exclusive = true;
			}

			// Handle a global trigger
			if ( !elem ) {
				// Don&apos;t bubble custom events when global (to avoid too much overhead)
				event.stopPropagation();

				// Only trigger if we&apos;ve ever bound an event for it
				if ( this.global[ type ] ) {
					jQuery.each( jQuery.cache, function() {
						if ( this.events &amp;&amp; this.events[type] ) {
							jQuery.event.trigger( event, data, this.handle.elem );
						}
					});
				}
			}

			// Handle triggering a single element

			// don&apos;t do events on text and comment nodes
			if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 ) {
				return undefined;
			}

			// Clean up in case it is reused
			event.result = undefined;
			event.target = elem;

			// Clone the incoming data, if any
			data = jQuery.makeArray( data );
			data.unshift( event );
		}

		event.currentTarget = elem;

		// Trigger the event, it is assumed that &quot;handle&quot; is a function
		var handle = jQuery.data( elem, &quot;handle&quot; );
		if ( handle ) {
			handle.apply( elem, data );
		}

		var nativeFn, nativeHandler;
		try {
			if ( !(elem &amp;&amp; elem.nodeName &amp;&amp; jQuery.noData[elem.nodeName.toLowerCase()]) ) {
				nativeFn = elem[ type ];
				nativeHandler = elem[ &quot;on&quot; + type ];
			}
		// prevent IE from throwing an error for some elements with some event types, see #3533
		} catch (e) {}

		var isClick = jQuery.nodeName(elem, &quot;a&quot;) &amp;&amp; type === &quot;click&quot;;

		// Trigger the native events (except for clicks on links)
		if ( !bubbling &amp;&amp; nativeFn &amp;&amp; !event.isDefaultPrevented() &amp;&amp; !isClick ) {
			this.triggered = true;
			try {
				elem[ type ]();
			// prevent IE from throwing an error for some hidden elements
			} catch (e) {}

		// Handle triggering native .onfoo handlers
		} else if ( nativeHandler &amp;&amp; elem[ &quot;on&quot; + type ].apply( elem, data ) === false ) {
			event.result = false;
		}

		this.triggered = false;

		if ( !event.isPropagationStopped() ) {
			var parent = elem.parentNode || elem.ownerDocument;
			if ( parent ) {
				jQuery.event.trigger( event, data, parent, true );
			}
		}
	},

	handle: function( event ) {
		// returned undefined or false
		var all, handlers;

		event = arguments[0] = jQuery.event.fix( event || window.event );
		event.currentTarget = this;

		// Namespaced event handlers
		var namespaces = event.type.split(&quot;.&quot;);
		event.type = namespaces.shift();

		// Cache this now, all = true means, any handler
		all = !namespaces.length &amp;&amp; !event.exclusive;

		var namespace = new RegExp(&quot;(^|\\.)&quot; + namespaces.slice(0).sort().join(&quot;\\.(?:.*\\.)?&quot;) + &quot;(\\.|$)&quot;);

		handlers = ( jQuery.data(this, &quot;events&quot;) || {} )[ event.type ];

		for ( var j in handlers ) {
			var handler = handlers[ j ];

			// Filter the functions by class
			if ( all || namespace.test(handler.type) ) {
				// Pass in a reference to the handler function itself
				// So that we can later remove it
				event.handler = handler;
				event.data = handler.data;

				var ret = handler.apply( this, arguments );

				if ( ret !== undefined ) {
					event.result = ret;
					if ( ret === false ) {
						event.preventDefault();
						event.stopPropagation();
					}
				}

				if ( event.isImmediatePropagationStopped() ) {
					break;
				}

			}
		}

		return event.result;
	},

	props: &quot;altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which&quot;.split(&quot; &quot;),

	fix: function( event ) {
		if ( event[ expando ] ) {
			return event;
		}

		// store a copy of the original event object
		// and &quot;clone&quot; to set read-only properties
		var originalEvent = event;
		event = jQuery.Event( originalEvent );

		for ( var i = this.props.length, prop; i; ) {
			prop = this.props[ --i ];
			event[ prop ] = originalEvent[ prop ];
		}

		// Fix target property, if necessary
		if ( !event.target ) {
			event.target = event.srcElement || document; // Fixes #1925 where srcElement might not be defined either
		}

		// check if target is a textnode (safari)
		if ( event.target.nodeType === 3 ) {
			event.target = event.target.parentNode;
		}

		// Add relatedTarget, if necessary
		if ( !event.relatedTarget &amp;&amp; event.fromElement ) {
			event.relatedTarget = event.fromElement === event.target ? event.toElement : event.fromElement;
		}

		// Calculate pageX/Y if missing and clientX/Y available
		if ( event.pageX == null &amp;&amp; event.clientX != null ) {
			var doc = document.documentElement, body = document.body;
			event.pageX = event.clientX + (doc &amp;&amp; doc.scrollLeft || body &amp;&amp; body.scrollLeft || 0) - (doc &amp;&amp; doc.clientLeft || body &amp;&amp; body.clientLeft || 0);
			event.pageY = event.clientY + (doc &amp;&amp; doc.scrollTop  || body &amp;&amp; body.scrollTop  || 0) - (doc &amp;&amp; doc.clientTop  || body &amp;&amp; body.clientTop  || 0);
		}

		// Add which for key events
		if ( !event.which &amp;&amp; ((event.charCode || event.charCode === 0) ? event.charCode : event.keyCode) ) {
			event.which = event.charCode || event.keyCode;
		}

		// Add metaKey to non-Mac browsers (use ctrl for PC&apos;s and Meta for Macs)
		if ( !event.metaKey &amp;&amp; event.ctrlKey ) {
			event.metaKey = event.ctrlKey;
		}

		// Add which for click: 1 === left; 2 === middle; 3 === right
		// Note: button is not normalized, so don&apos;t use it
		if ( !event.which &amp;&amp; event.button !== undefined ) {
			event.which = (event.button &amp; 1 ? 1 : ( event.button &amp; 2 ? 3 : ( event.button &amp; 4 ? 2 : 0 ) ));
		}

		return event;
	},

	// Deprecated, use jQuery.guid instead
	guid: 1E8,

	// Deprecated, use jQuery.proxy instead
	proxy: jQuery.proxy,

	special: {
		ready: {
			// Make sure the ready event is setup
			setup: jQuery.bindReady,
			teardown: jQuery.noop
		},

		live: {
			add: function( proxy, data, namespaces, live ) {
				jQuery.extend( proxy, data || {} );

				proxy.guid += data.selector + data.live; 
				jQuery.event.add( this, data.live, liveHandler, data ); 
				
			},

			remove: function( namespaces ) {
				if ( namespaces.length ) {
					var remove = 0, name = new RegExp(&quot;(^|\\.)&quot; + namespaces[0] + &quot;(\\.|$)&quot;);

					jQuery.each( (jQuery.data(this, &quot;events&quot;).live || {}), function() {
						if ( name.test(this.type) ) {
							remove++;
						}
					});

					if ( remove &lt; 1 ) {
						jQuery.event.remove( this, namespaces[0], liveHandler );
					}
				}
			},
			special: {}
		},
		beforeunload: {
			setup: function( data, namespaces, fn ) {
				// We only want to do this special case on windows
				if ( this.setInterval ) {
					this.onbeforeunload = fn;
				}

				return false;
			},
			teardown: function( namespaces, fn ) {
				if ( this.onbeforeunload === fn ) {
					this.onbeforeunload = null;
				}
			}
		}
	}
};

jQuery.Event = function( src ) {
	// Allow instantiation without the &apos;new&apos; keyword
	if ( !this.preventDefault ) {
		return new jQuery.Event( src );
	}

	// Event object
	if ( src &amp;&amp; src.type ) {
		this.originalEvent = src;
		this.type = src.type;
	// Event type
	} else {
		this.type = src;
	}

	// timeStamp is buggy for some events on Firefox(#3843)
	// So we won&apos;t rely on the native value
	this.timeStamp = now();

	// Mark it as fixed
	this[ expando ] = true;
};

function returnFalse() {
	return false;
}
function returnTrue() {
	return true;
}

// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding
// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html
jQuery.Event.prototype = {
	preventDefault: function() {
		this.isDefaultPrevented = returnTrue;

		var e = this.originalEvent;
		if ( !e ) {
			return;
		}
		
		// if preventDefault exists run it on the original event
		if ( e.preventDefault ) {
			e.preventDefault();
		}
		// otherwise set the returnValue property of the original event to false (IE)
		e.returnValue = false;
	},
	stopPropagation: function() {
		this.isPropagationStopped = returnTrue;

		var e = this.originalEvent;
		if ( !e ) {
			return;
		}
		// if stopPropagation exists run it on the original event
		if ( e.stopPropagation ) {
			e.stopPropagation();
		}
		// otherwise set the cancelBubble property of the original event to true (IE)
		e.cancelBubble = true;
	},
	stopImmediatePropagation: function() {
		this.isImmediatePropagationStopped = returnTrue;
		this.stopPropagation();
	},
	isDefaultPrevented: returnFalse,
	isPropagationStopped: returnFalse,
	isImmediatePropagationStopped: returnFalse
};

// Checks if an event happened on an element within another element
// Used in jQuery.event.special.mouseenter and mouseleave handlers
var withinElement = function( event ) {
	// Check if mouse(over|out) are still within the same parent element
	var parent = event.relatedTarget;

	// Traverse up the tree
	while ( parent &amp;&amp; parent !== this ) {
		// Firefox sometimes assigns relatedTarget a XUL element
		// which we cannot access the parentNode property of
		try {
			parent = parent.parentNode;

		// assuming we&apos;ve left the element since we most likely mousedover a xul element
		} catch(e) {
			break;
		}
	}

	if ( parent !== this ) {
		// set the correct event type
		event.type = event.data;

		// handle event if we actually just moused on to a non sub-element
		jQuery.event.handle.apply( this, arguments );
	}

},

// In case of event delegation, we only need to rename the event.type,
// liveHandler will take care of the rest.
delegate = function( event ) {
	event.type = event.data;
	jQuery.event.handle.apply( this, arguments );
};

// Create mouseenter and mouseleave events
jQuery.each({
	mouseenter: &quot;mouseover&quot;,
	mouseleave: &quot;mouseout&quot;
}, function( orig, fix ) {
	jQuery.event.special[ orig ] = {
		setup: function( data ) {
			jQuery.event.add( this, fix, data &amp;&amp; data.selector ? delegate : withinElement, orig );
		},
		teardown: function( data ) {
			jQuery.event.remove( this, fix, data &amp;&amp; data.selector ? delegate : withinElement );
		}
	};
});

// submit delegation
if ( !jQuery.support.submitBubbles ) {

jQuery.event.special.submit = {
	setup: function( data, namespaces, fn ) {
		if ( this.nodeName.toLowerCase() !== &quot;form&quot; ) {
			jQuery.event.add(this, &quot;click.specialSubmit.&quot; + fn.guid, function( e ) {
				var elem = e.target, type = elem.type;

				if ( (type === &quot;submit&quot; || type === &quot;image&quot;) &amp;&amp; jQuery( elem ).closest(&quot;form&quot;).length ) {
					return trigger( &quot;submit&quot;, this, arguments );
				}
			});
	 
			jQuery.event.add(this, &quot;keypress.specialSubmit.&quot; + fn.guid, function( e ) {
				var elem = e.target, type = elem.type;

				if ( (type === &quot;text&quot; || type === &quot;password&quot;) &amp;&amp; jQuery( elem ).closest(&quot;form&quot;).length &amp;&amp; e.keyCode === 13 ) {
					return trigger( &quot;submit&quot;, this, arguments );
				}
			});

		} else {
			return false;
		}
	},

	remove: function( namespaces, fn ) {
		jQuery.event.remove( this, &quot;click.specialSubmit&quot; + (fn ? &quot;.&quot;+fn.guid : &quot;&quot;) );
		jQuery.event.remove( this, &quot;keypress.specialSubmit&quot; + (fn ? &quot;.&quot;+fn.guid : &quot;&quot;) );
	}
};

}

// change delegation, happens here so we have bind.
if ( !jQuery.support.changeBubbles ) {

var formElems = /textarea|input|select/i;

function getVal( elem ) {
	var type = elem.type, val = elem.value;

	if ( type === &quot;radio&quot; || type === &quot;checkbox&quot; ) {
		val = elem.checked;

	} else if ( type === &quot;select-multiple&quot; ) {
		val = elem.selectedIndex &gt; -1 ?
			jQuery.map( elem.options, function( elem ) {
				return elem.selected;
			}).join(&quot;-&quot;) :
			&quot;&quot;;

	} else if ( elem.nodeName.toLowerCase() === &quot;select&quot; ) {
		val = elem.selectedIndex;
	}

	return val;
}

function testChange( e ) {
		var elem = e.target, data, val;

		if ( !formElems.test( elem.nodeName ) || elem.readOnly ) {
			return;
		}

		data = jQuery.data( elem, &quot;_change_data&quot; );
		val = getVal(elem);

		if ( val === data ) {
			return;
		}

		// the current data will be also retrieved by beforeactivate
		if ( e.type !== &quot;focusout&quot; || elem.type !== &quot;radio&quot; ) {
			jQuery.data( elem, &quot;_change_data&quot;, val );
		}

		if ( elem.type !== &quot;select&quot; &amp;&amp; (data != null || val) ) {
			e.type = &quot;change&quot;;
			return jQuery.event.trigger( e, arguments[1], this );
		}
}

jQuery.event.special.change = {
	filters: {
		focusout: testChange, 

		click: function( e ) {
			var elem = e.target, type = elem.type;

			if ( type === &quot;radio&quot; || type === &quot;checkbox&quot; || elem.nodeName.toLowerCase() === &quot;select&quot; ) {
				return testChange.call( this, e );
			}
		},

		// Change has to be called before submit
		// Keydown will be called before keypress, which is used in submit-event delegation
		keydown: function( e ) {
			var elem = e.target, type = elem.type;

			if ( (e.keyCode === 13 &amp;&amp; elem.nodeName.toLowerCase() !== &quot;textarea&quot;) ||
				(e.keyCode === 32 &amp;&amp; (type === &quot;checkbox&quot; || type === &quot;radio&quot;)) ||
				type === &quot;select-multiple&quot; ) {
				return testChange.call( this, e );
			}
		},

		// Beforeactivate happens also before the previous element is blurred
		// with this event you can&apos;t trigger a change event, but you can store
		// information/focus[in] is not needed anymore
		beforeactivate: function( e ) {
			var elem = e.target;

			if ( elem.nodeName.toLowerCase() === &quot;input&quot; &amp;&amp; elem.type === &quot;radio&quot; ) {
				jQuery.data( elem, &quot;_change_data&quot;, getVal(elem) );
			}
		}
	},
	setup: function( data, namespaces, fn ) {
		for ( var type in changeFilters ) {
			jQuery.event.add( this, type + &quot;.specialChange.&quot; + fn.guid, changeFilters[type] );
		}

		return formElems.test( this.nodeName );
	},
	remove: function( namespaces, fn ) {
		for ( var type in changeFilters ) {
			jQuery.event.remove( this, type + &quot;.specialChange&quot; + (fn ? &quot;.&quot;+fn.guid : &quot;&quot;), changeFilters[type] );
		}

		return formElems.test( this.nodeName );
	}
};

var changeFilters = jQuery.event.special.change.filters;

}

function trigger( type, elem, args ) {
	args[0].type = type;
	return jQuery.event.handle.apply( elem, args );
}

// Create &quot;bubbling&quot; focus and blur events
if ( document.addEventListener ) {
	jQuery.each({ focus: &quot;focusin&quot;, blur: &quot;focusout&quot; }, function( orig, fix ) {
		jQuery.event.special[ fix ] = {
			setup: function() {
				this.addEventListener( orig, handler, true );
			}, 
			teardown: function() { 
				this.removeEventListener( orig, handler, true );
			}
		};

		function handler( e ) { 
			e = jQuery.event.fix( e );
			e.type = fix;
			return jQuery.event.handle.call( this, e );
		}
	});
}

jQuery.each([&quot;bind&quot;, &quot;one&quot;], function( i, name ) {
	jQuery.fn[ name ] = function( type, data, fn ) {
		// Handle object literals
		if ( typeof type === &quot;object&quot; ) {
			for ( var key in type ) {
				this[ name ](key, data, type[key], fn);
			}
			return this;
		}
		
		if ( jQuery.isFunction( data ) ) {
			thisObject = fn;
			fn = data;
			data = undefined;
		}

		var handler = name === &quot;one&quot; ? jQuery.proxy( fn, function( event ) {
			jQuery( this ).unbind( event, handler );
			return fn.apply( this, arguments );
		}) : fn;

		return type === &quot;unload&quot; &amp;&amp; name !== &quot;one&quot; ?
			this.one( type, data, fn, thisObject ) :
			this.each(function() {
				jQuery.event.add( this, type, handler, data );
			});
	};
});

jQuery.fn.extend({
	unbind: function( type, fn ) {
		// Handle object literals
		if ( typeof type === &quot;object&quot; &amp;&amp; !type.preventDefault ) {
			for ( var key in type ) {
				this.unbind(key, type[key]);
			}
			return this;
		}

		return this.each(function() {
			jQuery.event.remove( this, type, fn );
		});
	},
	trigger: function( type, data ) {
		return this.each(function() {
			jQuery.event.trigger( type, data, this );
		});
	},

	triggerHandler: function( type, data ) {
		if ( this[0] ) {
			var event = jQuery.Event( type );
			event.preventDefault();
			event.stopPropagation();
			jQuery.event.trigger( event, data, this[0] );
			return event.result;
		}
	},

	toggle: function( fn ) {
		// Save reference to arguments for access in closure
		var args = arguments, i = 1;

		// link all the functions, so any of them can unbind this click handler
		while ( i &lt; args.length ) {
			jQuery.proxy( fn, args[ i++ ] );
		}

		return this.click( jQuery.proxy( fn, function( event ) {
			// Figure out which function to execute
			var lastToggle = ( jQuery.data( this, &quot;lastToggle&quot; + fn.guid ) || 0 ) % i;
			jQuery.data( this, &quot;lastToggle&quot; + fn.guid, lastToggle + 1 );

			// Make sure that clicks stop
			event.preventDefault();

			// and execute the function
			return args[ lastToggle ].apply( this, arguments ) || false;
		}));
	},

	hover: function( fnOver, fnOut ) {
		return this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );
	},

	live: function( type, data, fn ) {
		if ( jQuery.isFunction( data ) ) {
			fn = data;
			data = undefined;
		}

		jQuery( this.context ).bind( liveConvert( type, this.selector ), {
			data: data, selector: this.selector, live: type
		}, fn );

		return this;
	},

	die: function( type, fn ) {
		jQuery( this.context ).unbind( liveConvert( type, this.selector ), fn ? { guid: fn.guid + this.selector + type } : null );
		return this;
	}
});

function liveHandler( event ) {
	var stop = true, elems = [], selectors = [], args = arguments,
		related, match, fn, elem, j, i, data,
		live = jQuery.extend({}, jQuery.data( this, &quot;events&quot; ).live);

	for ( j in live ) {
		fn = live[j];
		if ( fn.live === event.type ||
				fn.altLive &amp;&amp; jQuery.inArray(event.type, fn.altLive) &gt; -1 ) {

			data = fn.data;
			if ( !(data.beforeFilter &amp;&amp; data.beforeFilter[event.type] &amp;&amp; 
					!data.beforeFilter[event.type](event)) ) {
				selectors.push( fn.selector );
			}
		} else {
			delete live[j];
		}
	}

	match = jQuery( event.target ).closest( selectors, event.currentTarget );

	for ( i = 0, l = match.length; i &lt; l; i++ ) {
		for ( j in live ) {
			fn = live[j];
			elem = match[i].elem;
			related = null;

			if ( match[i].selector === fn.selector ) {
				// Those two events require additional checking
				if ( fn.live === &quot;mouseenter&quot; || fn.live === &quot;mouseleave&quot; ) {
					related = jQuery( event.relatedTarget ).closest( fn.selector )[0];
				}

				if ( !related || related !== elem ) {
					elems.push({ elem: elem, fn: fn });
				}
			}
		}
	}

	for ( i = 0, l = elems.length; i &lt; l; i++ ) {
		match = elems[i];
		event.currentTarget = match.elem;
		event.data = match.fn.data;
		if ( match.fn.apply( match.elem, args ) === false ) {
			stop = false;
			break;
		}
	}

	return stop;
}

function liveConvert( type, selector ) {
	return [&quot;live&quot;, type, selector.replace(/\./g, &quot;`&quot;).replace(/ /g, &quot;&amp;&quot;)].join(&quot;.&quot;);
}

jQuery.each( (&quot;blur focus focusin focusout load resize scroll unload click dblclick &quot; +
	&quot;mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave &quot; +
	&quot;change select submit keydown keypress keyup error&quot;).split(&quot; &quot;), function( i, name ) {

	// Handle event binding
	jQuery.fn[ name ] = function( fn ) {
		return fn ? this.bind( name, fn ) : this.trigger( name );
	};

	if ( jQuery.attrFn ) {
		jQuery.attrFn[ name ] = true;
	}
});

// Prevent memory leaks in IE
// Window isn&apos;t included so as not to unbind existing unload events
// More info:
//  - http://isaacschlueter.com/2006/10/msie-memory-leaks/
if ( window.attachEvent &amp;&amp; !window.addEventListener ) {
	window.attachEvent(&quot;onunload&quot;, function() {
		for ( var id in jQuery.cache ) {
			if ( jQuery.cache[ id ].handle ) {
				// Try/Catch is to handle iframes being unloaded, see #4280
				try {
					jQuery.event.remove( jQuery.cache[ id ].handle.elem );
				} catch(e) {}
			}
		}
	});
}
/*!
 * Sizzle CSS Selector Engine - v1.0
 *  Copyright 2009, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){

var chunker = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|[&apos;&quot;][^&apos;&quot;]*[&apos;&quot;]|[^[\]&apos;&quot;]+)+\]|\\.|[^ &gt;+~,(\[\\]+)+|[&gt;+~])(\s*,\s*)?((?:.|\r|\n)*)/g,
	done = 0,
	toString = Object.prototype.toString,
	hasDuplicate = false,
	baseHasDuplicate = true;

// Here we check if the JavaScript engine is using some sort of
// optimization where it does not always call our comparision
// function. If that is the case, discard the hasDuplicate value.
//   Thus far that includes Google Chrome.
[0, 0].sort(function(){
	baseHasDuplicate = false;
	return 0;
});

var Sizzle = function(selector, context, results, seed) {
	results = results || [];
	var origContext = context = context || document;

	if ( context.nodeType !== 1 &amp;&amp; context.nodeType !== 9 ) {
		return [];
	}
	
	if ( !selector || typeof selector !== &quot;string&quot; ) {
		return results;
	}

	var parts = [], m, set, checkSet, extra, prune = true, contextXML = isXML(context),
		soFar = selector;
	
	// Reset the position of the chunker regexp (start from head)
	while ( (chunker.exec(&quot;&quot;), m = chunker.exec(soFar)) !== null ) {
		soFar = m[3];
		
		parts.push( m[1] );
		
		if ( m[2] ) {
			extra = m[3];
			break;
		}
	}

	if ( parts.length &gt; 1 &amp;&amp; origPOS.exec( selector ) ) {
		if ( parts.length === 2 &amp;&amp; Expr.relative[ parts[0] ] ) {
			set = posProcess( parts[0] + parts[1], context );
		} else {
			set = Expr.relative[ parts[0] ] ?
				[ context ] :
				Sizzle( parts.shift(), context );

			while ( parts.length ) {
				selector = parts.shift();

				if ( Expr.relative[ selector ] ) {
					selector += parts.shift();
				}
				
				set = posProcess( selector, set );
			}
		}
	} else {
		// Take a shortcut and set the context if the root selector is an ID
		// (but not if it&apos;ll be faster if the inner selector is an ID)
		if ( !seed &amp;&amp; parts.length &gt; 1 &amp;&amp; context.nodeType === 9 &amp;&amp; !contextXML &amp;&amp;
				Expr.match.ID.test(parts[0]) &amp;&amp; !Expr.match.ID.test(parts[parts.length - 1]) ) {
			var ret = Sizzle.find( parts.shift(), context, contextXML );
			context = ret.expr ? Sizzle.filter( ret.expr, ret.set )[0] : ret.set[0];
		}

		if ( context ) {
			var ret = seed ?
				{ expr: parts.pop(), set: makeArray(seed) } :
				Sizzle.find( parts.pop(), parts.length === 1 &amp;&amp; (parts[0] === &quot;~&quot; || parts[0] === &quot;+&quot;) &amp;&amp; context.parentNode ? context.parentNode : context, contextXML );
			set = ret.expr ? Sizzle.filter( ret.expr, ret.set ) : ret.set;

			if ( parts.length &gt; 0 ) {
				checkSet = makeArray(set);
			} else {
				prune = false;
			}

			while ( parts.length ) {
				var cur = parts.pop(), pop = cur;

				if ( !Expr.relative[ cur ] ) {
					cur = &quot;&quot;;
				} else {
					pop = parts.pop();
				}

				if ( pop == null ) {
					pop = context;
				}

				Expr.relative[ cur ]( checkSet, pop, contextXML );
			}
		} else {
			checkSet = parts = [];
		}
	}

	if ( !checkSet ) {
		checkSet = set;
	}

	if ( !checkSet ) {
		throw &quot;Syntax error, unrecognized expression: &quot; + (cur || selector);
	}

	if ( toString.call(checkSet) === &quot;[object Array]&quot; ) {
		if ( !prune ) {
			results.push.apply( results, checkSet );
		} else if ( context &amp;&amp; context.nodeType === 1 ) {
			for ( var i = 0; checkSet[i] != null; i++ ) {
				if ( checkSet[i] &amp;&amp; (checkSet[i] === true || checkSet[i].nodeType === 1 &amp;&amp; contains(context, checkSet[i])) ) {
					results.push( set[i] );
				}
			}
		} else {
			for ( var i = 0; checkSet[i] != null; i++ ) {
				if ( checkSet[i] &amp;&amp; checkSet[i].nodeType === 1 ) {
					results.push( set[i] );
				}
			}
		}
	} else {
		makeArray( checkSet, results );
	}

	if ( extra ) {
		Sizzle( extra, origContext, results, seed );
		Sizzle.uniqueSort( results );
	}

	return results;
};

Sizzle.uniqueSort = function(results){
	if ( sortOrder ) {
		hasDuplicate = baseHasDuplicate;
		results.sort(sortOrder);

		if ( hasDuplicate ) {
			for ( var i = 1; i &lt; results.length; i++ ) {
				if ( results[i] === results[i-1] ) {
					results.splice(i--, 1);
				}
			}
		}
	}

	return results;
};

Sizzle.matches = function(expr, set){
	return Sizzle(expr, null, null, set);
};

Sizzle.find = function(expr, context, isXML){
	var set, match;

	if ( !expr ) {
		return [];
	}

	for ( var i = 0, l = Expr.order.length; i &lt; l; i++ ) {
		var type = Expr.order[i], match;
		
		if ( (match = Expr.leftMatch[ type ].exec( expr )) ) {
			var left = match[1];
			match.splice(1,1);

			if ( left.substr( left.length - 1 ) !== &quot;\\&quot; ) {
				match[1] = (match[1] || &quot;&quot;).replace(/\\/g, &quot;&quot;);
				set = Expr.find[ type ]( match, context, isXML );
				if ( set != null ) {
					expr = expr.replace( Expr.match[ type ], &quot;&quot; );
					break;
				}
			}
		}
	}

	if ( !set ) {
		set = context.getElementsByTagName(&quot;*&quot;);
	}

	return {set: set, expr: expr};
};

Sizzle.filter = function(expr, set, inplace, not){
	var old = expr, result = [], curLoop = set, match, anyFound,
		isXMLFilter = set &amp;&amp; set[0] &amp;&amp; isXML(set[0]);

	while ( expr &amp;&amp; set.length ) {
		for ( var type in Expr.filter ) {
			if ( (match = Expr.leftMatch[ type ].exec( expr )) != null &amp;&amp; match[2] ) {
				var filter = Expr.filter[ type ], found, item, left = match[1];
				anyFound = false;

				match.splice(1,1);

				if ( left.substr( left.length - 1 ) === &quot;\\&quot; ) {
					continue;
				}

				if ( curLoop === result ) {
					result = [];
				}

				if ( Expr.preFilter[ type ] ) {
					match = Expr.preFilter[ type ]( match, curLoop, inplace, result, not, isXMLFilter );

					if ( !match ) {
						anyFound = found = true;
					} else if ( match === true ) {
						continue;
					}
				}

				if ( match ) {
					for ( var i = 0; (item = curLoop[i]) != null; i++ ) {
						if ( item ) {
							found = filter( item, match, i, curLoop );
							var pass = not ^ !!found;

							if ( inplace &amp;&amp; found != null ) {
								if ( pass ) {
									anyFound = true;
								} else {
									curLoop[i] = false;
								}
							} else if ( pass ) {
								result.push( item );
								anyFound = true;
							}
						}
					}
				}

				if ( found !== undefined ) {
					if ( !inplace ) {
						curLoop = result;
					}

					expr = expr.replace( Expr.match[ type ], &quot;&quot; );

					if ( !anyFound ) {
						return [];
					}

					break;
				}
			}
		}

		// Improper expression
		if ( expr === old ) {
			if ( anyFound == null ) {
				throw &quot;Syntax error, unrecognized expression: &quot; + expr;
			} else {
				break;
			}
		}

		old = expr;
	}

	return curLoop;
};

var Expr = Sizzle.selectors = {
	order: [ &quot;ID&quot;, &quot;NAME&quot;, &quot;TAG&quot; ],
	match: {
		ID: /#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,
		CLASS: /\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,
		NAME: /\[name=[&apos;&quot;]*((?:[\w\u00c0-\uFFFF-]|\\.)+)[&apos;&quot;]*\]/,
		ATTR: /\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*([&apos;&quot;]*)(.*?)\3|)\s*\]/,
		TAG: /^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,
		CHILD: /:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,
		POS: /:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,
		PSEUDO: /:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\(([&apos;&quot;]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/
	},
	leftMatch: {},
	attrMap: {
		&quot;class&quot;: &quot;className&quot;,
		&quot;for&quot;: &quot;htmlFor&quot;
	},
	attrHandle: {
		href: function(elem){
			return elem.getAttribute(&quot;href&quot;);
		}
	},
	relative: {
		&quot;+&quot;: function(checkSet, part){
			var isPartStr = typeof part === &quot;string&quot;,
				isTag = isPartStr &amp;&amp; !/\W/.test(part),
				isPartStrNotTag = isPartStr &amp;&amp; !isTag;

			if ( isTag ) {
				part = part.toLowerCase();
			}

			for ( var i = 0, l = checkSet.length, elem; i &lt; l; i++ ) {
				if ( (elem = checkSet[i]) ) {
					while ( (elem = elem.previousSibling) &amp;&amp; elem.nodeType !== 1 ) {}

					checkSet[i] = isPartStrNotTag || elem &amp;&amp; elem.nodeName.toLowerCase() === part ?
						elem || false :
						elem === part;
				}
			}

			if ( isPartStrNotTag ) {
				Sizzle.filter( part, checkSet, true );
			}
		},
		&quot;&gt;&quot;: function(checkSet, part){
			var isPartStr = typeof part === &quot;string&quot;;

			if ( isPartStr &amp;&amp; !/\W/.test(part) ) {
				part = part.toLowerCase();

				for ( var i = 0, l = checkSet.length; i &lt; l; i++ ) {
					var elem = checkSet[i];
					if ( elem ) {
						var parent = elem.parentNode;
						checkSet[i] = parent.nodeName.toLowerCase() === part ? parent : false;
					}
				}
			} else {
				for ( var i = 0, l = checkSet.length; i &lt; l; i++ ) {
					var elem = checkSet[i];
					if ( elem ) {
						checkSet[i] = isPartStr ?
							elem.parentNode :
							elem.parentNode === part;
					}
				}

				if ( isPartStr ) {
					Sizzle.filter( part, checkSet, true );
				}
			}
		},
		&quot;&quot;: function(checkSet, part, isXML){
			var doneName = done++, checkFn = dirCheck;

			if ( typeof part === &quot;string&quot; &amp;&amp; !/\W/.test(part) ) {
				var nodeCheck = part = part.toLowerCase();
				checkFn = dirNodeCheck;
			}

			checkFn(&quot;parentNode&quot;, part, doneName, checkSet, nodeCheck, isXML);
		},
		&quot;~&quot;: function(checkSet, part, isXML){
			var doneName = done++, checkFn = dirCheck;

			if ( typeof part === &quot;string&quot; &amp;&amp; !/\W/.test(part) ) {
				var nodeCheck = part = part.toLowerCase();
				checkFn = dirNodeCheck;
			}

			checkFn(&quot;previousSibling&quot;, part, doneName, checkSet, nodeCheck, isXML);
		}
	},
	find: {
		ID: function(match, context, isXML){
			if ( typeof context.getElementById !== &quot;undefined&quot; &amp;&amp; !isXML ) {
				var m = context.getElementById(match[1]);
				return m ? [m] : [];
			}
		},
		NAME: function(match, context){
			if ( typeof context.getElementsByName !== &quot;undefined&quot; ) {
				var ret = [], results = context.getElementsByName(match[1]);

				for ( var i = 0, l = results.length; i &lt; l; i++ ) {
					if ( results[i].getAttribute(&quot;name&quot;) === match[1] ) {
						ret.push( results[i] );
					}
				}

				return ret.length === 0 ? null : ret;
			}
		},
		TAG: function(match, context){
			return context.getElementsByTagName(match[1]);
		}
	},
	preFilter: {
		CLASS: function(match, curLoop, inplace, result, not, isXML){
			match = &quot; &quot; + match[1].replace(/\\/g, &quot;&quot;) + &quot; &quot;;

			if ( isXML ) {
				return match;
			}

			for ( var i = 0, elem; (elem = curLoop[i]) != null; i++ ) {
				if ( elem ) {
					if ( not ^ (elem.className &amp;&amp; (&quot; &quot; + elem.className + &quot; &quot;).replace(/[\t\n]/g, &quot; &quot;).indexOf(match) &gt;= 0) ) {
						if ( !inplace ) {
							result.push( elem );
						}
					} else if ( inplace ) {
						curLoop[i] = false;
					}
				}
			}

			return false;
		},
		ID: function(match){
			return match[1].replace(/\\/g, &quot;&quot;);
		},
		TAG: function(match, curLoop){
			return match[1].toLowerCase();
		},
		CHILD: function(match){
			if ( match[1] === &quot;nth&quot; ) {
				// parse equations like &apos;even&apos;, &apos;odd&apos;, &apos;5&apos;, &apos;2n&apos;, &apos;3n+2&apos;, &apos;4n-1&apos;, &apos;-n+6&apos;
				var test = /(-?)(\d*)n((?:\+|-)?\d*)/.exec(
					match[2] === &quot;even&quot; &amp;&amp; &quot;2n&quot; || match[2] === &quot;odd&quot; &amp;&amp; &quot;2n+1&quot; ||
					!/\D/.test( match[2] ) &amp;&amp; &quot;0n+&quot; + match[2] || match[2]);

				// calculate the numbers (first)n+(last) including if they are negative
				match[2] = (test[1] + (test[2] || 1)) - 0;
				match[3] = test[3] - 0;
			}

			// TODO: Move to normal caching system
			match[0] = done++;

			return match;
		},
		ATTR: function(match, curLoop, inplace, result, not, isXML){
			var name = match[1].replace(/\\/g, &quot;&quot;);
			
			if ( !isXML &amp;&amp; Expr.attrMap[name] ) {
				match[1] = Expr.attrMap[name];
			}

			if ( match[2] === &quot;~=&quot; ) {
				match[4] = &quot; &quot; + match[4] + &quot; &quot;;
			}

			return match;
		},
		PSEUDO: function(match, curLoop, inplace, result, not){
			if ( match[1] === &quot;not&quot; ) {
				// If we&apos;re dealing with a complex expression, or a simple one
				if ( ( chunker.exec(match[3]) || &quot;&quot; ).length &gt; 1 || /^\w/.test(match[3]) ) {
					match[3] = Sizzle(match[3], null, null, curLoop);
				} else {
					var ret = Sizzle.filter(match[3], curLoop, inplace, true ^ not);
					if ( !inplace ) {
						result.push.apply( result, ret );
					}
					return false;
				}
			} else if ( Expr.match.POS.test( match[0] ) || Expr.match.CHILD.test( match[0] ) ) {
				return true;
			}
			
			return match;
		},
		POS: function(match){
			match.unshift( true );
			return match;
		}
	},
	filters: {
		enabled: function(elem){
			return elem.disabled === false &amp;&amp; elem.type !== &quot;hidden&quot;;
		},
		disabled: function(elem){
			return elem.disabled === true;
		},
		checked: function(elem){
			return elem.checked === true;
		},
		selected: function(elem){
			// Accessing this property makes selected-by-default
			// options in Safari work properly
			elem.parentNode.selectedIndex;
			return elem.selected === true;
		},
		parent: function(elem){
			return !!elem.firstChild;
		},
		empty: function(elem){
			return !elem.firstChild;
		},
		has: function(elem, i, match){
			return !!Sizzle( match[3], elem ).length;
		},
		header: function(elem){
			return /h\d/i.test( elem.nodeName );
		},
		text: function(elem){
			return &quot;text&quot; === elem.type;
		},
		radio: function(elem){
			return &quot;radio&quot; === elem.type;
		},
		checkbox: function(elem){
			return &quot;checkbox&quot; === elem.type;
		},
		file: function(elem){
			return &quot;file&quot; === elem.type;
		},
		password: function(elem){
			return &quot;password&quot; === elem.type;
		},
		submit: function(elem){
			return &quot;submit&quot; === elem.type;
		},
		image: function(elem){
			return &quot;image&quot; === elem.type;
		},
		reset: function(elem){
			return &quot;reset&quot; === elem.type;
		},
		button: function(elem){
			return &quot;button&quot; === elem.type || elem.nodeName.toLowerCase() === &quot;button&quot;;
		},
		input: function(elem){
			return /input|select|textarea|button/i.test(elem.nodeName);
		}
	},
	setFilters: {
		first: function(elem, i){
			return i === 0;
		},
		last: function(elem, i, match, array){
			return i === array.length - 1;
		},
		even: function(elem, i){
			return i % 2 === 0;
		},
		odd: function(elem, i){
			return i % 2 === 1;
		},
		lt: function(elem, i, match){
			return i &lt; match[3] - 0;
		},
		gt: function(elem, i, match){
			return i &gt; match[3] - 0;
		},
		nth: function(elem, i, match){
			return match[3] - 0 === i;
		},
		eq: function(elem, i, match){
			return match[3] - 0 === i;
		}
	},
	filter: {
		PSEUDO: function(elem, match, i, array){
			var name = match[1], filter = Expr.filters[ name ];

			if ( filter ) {
				return filter( elem, i, match, array );
			} else if ( name === &quot;contains&quot; ) {
				return (elem.textContent || elem.innerText || getText([ elem ]) || &quot;&quot;).indexOf(match[3]) &gt;= 0;
			} else if ( name === &quot;not&quot; ) {
				var not = match[3];

				for ( var i = 0, l = not.length; i &lt; l; i++ ) {
					if ( not[i] === elem ) {
						return false;
					}
				}

				return true;
			} else {
				throw &quot;Syntax error, unrecognized expression: &quot; + name;
			}
		},
		CHILD: function(elem, match){
			var type = match[1], node = elem;
			switch (type) {
				case &apos;only&apos;:
				case &apos;first&apos;:
					while ( (node = node.previousSibling) )	 {
						if ( node.nodeType === 1 ) { 
							return false; 
						}
					}
					if ( type === &quot;first&quot; ) { 
						return true; 
					}
					node = elem;
				case &apos;last&apos;:
					while ( (node = node.nextSibling) )	 {
						if ( node.nodeType === 1 ) { 
							return false; 
						}
					}
					return true;
				case &apos;nth&apos;:
					var first = match[2], last = match[3];

					if ( first === 1 &amp;&amp; last === 0 ) {
						return true;
					}
					
					var doneName = match[0],
						parent = elem.parentNode;
	
					if ( parent &amp;&amp; (parent.sizcache !== doneName || !elem.nodeIndex) ) {
						var count = 0;
						for ( node = parent.firstChild; node; node = node.nextSibling ) {
							if ( node.nodeType === 1 ) {
								node.nodeIndex = ++count;
							}
						} 
						parent.sizcache = doneName;
					}
					
					var diff = elem.nodeIndex - last;
					if ( first === 0 ) {
						return diff === 0;
					} else {
						return ( diff % first === 0 &amp;&amp; diff / first &gt;= 0 );
					}
			}
		},
		ID: function(elem, match){
			return elem.nodeType === 1 &amp;&amp; elem.getAttribute(&quot;id&quot;) === match;
		},
		TAG: function(elem, match){
			return (match === &quot;*&quot; &amp;&amp; elem.nodeType === 1) || elem.nodeName.toLowerCase() === match;
		},
		CLASS: function(elem, match){
			return (&quot; &quot; + (elem.className || elem.getAttribute(&quot;class&quot;)) + &quot; &quot;)
				.indexOf( match ) &gt; -1;
		},
		ATTR: function(elem, match){
			var name = match[1],
				result = Expr.attrHandle[ name ] ?
					Expr.attrHandle[ name ]( elem ) :
					elem[ name ] != null ?
						elem[ name ] :
						elem.getAttribute( name ),
				value = result + &quot;&quot;,
				type = match[2],
				check = match[4];

			return result == null ?
				type === &quot;!=&quot; :
				type === &quot;=&quot; ?
				value === check :
				type === &quot;*=&quot; ?
				value.indexOf(check) &gt;= 0 :
				type === &quot;~=&quot; ?
				(&quot; &quot; + value + &quot; &quot;).indexOf(check) &gt;= 0 :
				!check ?
				value &amp;&amp; result !== false :
				type === &quot;!=&quot; ?
				value !== check :
				type === &quot;^=&quot; ?
				value.indexOf(check) === 0 :
				type === &quot;$=&quot; ?
				value.substr(value.length - check.length) === check :
				type === &quot;|=&quot; ?
				value === check || value.substr(0, check.length + 1) === check + &quot;-&quot; :
				false;
		},
		POS: function(elem, match, i, array){
			var name = match[2], filter = Expr.setFilters[ name ];

			if ( filter ) {
				return filter( elem, i, match, array );
			}
		}
	}
};

var origPOS = Expr.match.POS;

for ( var type in Expr.match ) {
	Expr.match[ type ] = new RegExp( Expr.match[ type ].source + /(?![^\[]*\])(?![^\(]*\))/.source );
	Expr.leftMatch[ type ] = new RegExp( /(^(?:.|\r|\n)*?)/.source + Expr.match[ type ].source.replace(/\\(\d+)/g, function(all, num){
		return &quot;\\&quot; + (num - 0 + 1);
	}));
}

var makeArray = function(array, results) {
	array = Array.prototype.slice.call( array, 0 );

	if ( results ) {
		results.push.apply( results, array );
		return results;
	}
	
	return array;
};

// Perform a simple check to determine if the browser is capable of
// converting a NodeList to an array using builtin methods.
try {
	Array.prototype.slice.call( document.documentElement.childNodes, 0 );

// Provide a fallback method if it does not work
} catch(e){
	makeArray = function(array, results) {
		var ret = results || [];

		if ( toString.call(array) === &quot;[object Array]&quot; ) {
			Array.prototype.push.apply( ret, array );
		} else {
			if ( typeof array.length === &quot;number&quot; ) {
				for ( var i = 0, l = array.length; i &lt; l; i++ ) {
					ret.push( array[i] );
				}
			} else {
				for ( var i = 0; array[i]; i++ ) {
					ret.push( array[i] );
				}
			}
		}

		return ret;
	};
}

var sortOrder;

if ( document.documentElement.compareDocumentPosition ) {
	sortOrder = function( a, b ) {
		if ( !a.compareDocumentPosition || !b.compareDocumentPosition ) {
			if ( a == b ) {
				hasDuplicate = true;
			}
			return a.compareDocumentPosition ? -1 : 1;
		}

		var ret = a.compareDocumentPosition(b) &amp; 4 ? -1 : a === b ? 0 : 1;
		if ( ret === 0 ) {
			hasDuplicate = true;
		}
		return ret;
	};
} else if ( &quot;sourceIndex&quot; in document.documentElement ) {
	sortOrder = function( a, b ) {
		if ( !a.sourceIndex || !b.sourceIndex ) {
			if ( a == b ) {
				hasDuplicate = true;
			}
			return a.sourceIndex ? -1 : 1;
		}

		var ret = a.sourceIndex - b.sourceIndex;
		if ( ret === 0 ) {
			hasDuplicate = true;
		}
		return ret;
	};
} else if ( document.createRange ) {
	sortOrder = function( a, b ) {
		if ( !a.ownerDocument || !b.ownerDocument ) {
			if ( a == b ) {
				hasDuplicate = true;
			}
			return a.ownerDocument ? -1 : 1;
		}

		var aRange = a.ownerDocument.createRange(), bRange = b.ownerDocument.createRange();
		aRange.setStart(a, 0);
		aRange.setEnd(a, 0);
		bRange.setStart(b, 0);
		bRange.setEnd(b, 0);
		var ret = aRange.compareBoundaryPoints(Range.START_TO_END, bRange);
		if ( ret === 0 ) {
			hasDuplicate = true;
		}
		return ret;
	};
}

// Utility function for retreiving the text value of an array of DOM nodes
function getText( elems ) {
	var ret = &quot;&quot;, elem;

	for ( var i = 0; elems[i]; i++ ) {
		elem = elems[i];

		// Get the text from text nodes and CDATA nodes
		if ( elem.nodeType === 3 || elem.nodeType === 4 ) {
			ret += elem.nodeValue;

		// Traverse everything else, except comment nodes
		} else if ( elem.nodeType !== 8 ) {
			ret += getText( elem.childNodes );
		}
	}

	return ret;
}

// Check to see if the browser returns elements by name when
// querying by getElementById (and provide a workaround)
(function(){
	// We&apos;re going to inject a fake input element with a specified name
	var form = document.createElement(&quot;div&quot;),
		id = &quot;script&quot; + (new Date).getTime();
	form.innerHTML = &quot;&lt;a name=&apos;&quot; + id + &quot;&apos;/&gt;&quot;;

	// Inject it into the root element, check its status, and remove it quickly
	var root = document.documentElement;
	root.insertBefore( form, root.firstChild );

	// The workaround has to do additional checks after a getElementById
	// Which slows things down for other browsers (hence the branching)
	if ( document.getElementById( id ) ) {
		Expr.find.ID = function(match, context, isXML){
			if ( typeof context.getElementById !== &quot;undefined&quot; &amp;&amp; !isXML ) {
				var m = context.getElementById(match[1]);
				return m ? m.id === match[1] || typeof m.getAttributeNode !== &quot;undefined&quot; &amp;&amp; m.getAttributeNode(&quot;id&quot;).nodeValue === match[1] ? [m] : undefined : [];
			}
		};

		Expr.filter.ID = function(elem, match){
			var node = typeof elem.getAttributeNode !== &quot;undefined&quot; &amp;&amp; elem.getAttributeNode(&quot;id&quot;);
			return elem.nodeType === 1 &amp;&amp; node &amp;&amp; node.nodeValue === match;
		};
	}

	root.removeChild( form );
	root = form = null; // release memory in IE
})();

(function(){
	// Check to see if the browser returns only elements
	// when doing getElementsByTagName(&quot;*&quot;)

	// Create a fake element
	var div = document.createElement(&quot;div&quot;);
	div.appendChild( document.createComment(&quot;&quot;) );

	// Make sure no comments are found
	if ( div.getElementsByTagName(&quot;*&quot;).length &gt; 0 ) {
		Expr.find.TAG = function(match, context){
			var results = context.getElementsByTagName(match[1]);

			// Filter out possible comments
			if ( match[1] === &quot;*&quot; ) {
				var tmp = [];

				for ( var i = 0; results[i]; i++ ) {
					if ( results[i].nodeType === 1 ) {
						tmp.push( results[i] );
					}
				}

				results = tmp;
			}

			return results;
		};
	}

	// Check to see if an attribute returns normalized href attributes
	div.innerHTML = &quot;&lt;a href=&apos;#&apos;&gt;&lt;/a&gt;&quot;;
	if ( div.firstChild &amp;&amp; typeof div.firstChild.getAttribute !== &quot;undefined&quot; &amp;&amp;
			div.firstChild.getAttribute(&quot;href&quot;) !== &quot;#&quot; ) {
		Expr.attrHandle.href = function(elem){
			return elem.getAttribute(&quot;href&quot;, 2);
		};
	}

	div = null; // release memory in IE
})();

if ( document.querySelectorAll ) {
	(function(){
		var oldSizzle = Sizzle, div = document.createElement(&quot;div&quot;);
		div.innerHTML = &quot;&lt;p class=&apos;TEST&apos;&gt;&lt;/p&gt;&quot;;

		// Safari can&apos;t handle uppercase or unicode characters when
		// in quirks mode.
		if ( div.querySelectorAll &amp;&amp; div.querySelectorAll(&quot;.TEST&quot;).length === 0 ) {
			return;
		}
	
		Sizzle = function(query, context, extra, seed){
			context = context || document;

			// Only use querySelectorAll on non-XML documents
			// (ID selectors don&apos;t work in non-HTML documents)
			if ( !seed &amp;&amp; context.nodeType === 9 &amp;&amp; !isXML(context) ) {
				try {
					return makeArray( context.querySelectorAll(query), extra );
				} catch(e){}
			}
		
			return oldSizzle(query, context, extra, seed);
		};

		for ( var prop in oldSizzle ) {
			Sizzle[ prop ] = oldSizzle[ prop ];
		}

		div = null; // release memory in IE
	})();
}

(function(){
	var div = document.createElement(&quot;div&quot;);

	div.innerHTML = &quot;&lt;div class=&apos;test e&apos;&gt;&lt;/div&gt;&lt;div class=&apos;test&apos;&gt;&lt;/div&gt;&quot;;

	// Opera can&apos;t find a second classname (in 9.6)
	// Also, make sure that getElementsByClassName actually exists
	if ( !div.getElementsByClassName || div.getElementsByClassName(&quot;e&quot;).length === 0 ) {
		return;
	}

	// Safari caches class attributes, doesn&apos;t catch changes (in 3.2)
	div.lastChild.className = &quot;e&quot;;

	if ( div.getElementsByClassName(&quot;e&quot;).length === 1 ) {
		return;
	}
	
	Expr.order.splice(1, 0, &quot;CLASS&quot;);
	Expr.find.CLASS = function(match, context, isXML) {
		if ( typeof context.getElementsByClassName !== &quot;undefined&quot; &amp;&amp; !isXML ) {
			return context.getElementsByClassName(match[1]);
		}
	};

	div = null; // release memory in IE
})();

function dirNodeCheck( dir, cur, doneName, checkSet, nodeCheck, isXML ) {
	for ( var i = 0, l = checkSet.length; i &lt; l; i++ ) {
		var elem = checkSet[i];
		if ( elem ) {
			elem = elem[dir];
			var match = false;

			while ( elem ) {
				if ( elem.sizcache === doneName ) {
					match = checkSet[elem.sizset];
					break;
				}

				if ( elem.nodeType === 1 &amp;&amp; !isXML ){
					elem.sizcache = doneName;
					elem.sizset = i;
				}

				if ( elem.nodeName.toLowerCase() === cur ) {
					match = elem;
					break;
				}

				elem = elem[dir];
			}

			checkSet[i] = match;
		}
	}
}

function dirCheck( dir, cur, doneName, checkSet, nodeCheck, isXML ) {
	for ( var i = 0, l = checkSet.length; i &lt; l; i++ ) {
		var elem = checkSet[i];
		if ( elem ) {
			elem = elem[dir];
			var match = false;

			while ( elem ) {
				if ( elem.sizcache === doneName ) {
					match = checkSet[elem.sizset];
					break;
				}

				if ( elem.nodeType === 1 ) {
					if ( !isXML ) {
						elem.sizcache = doneName;
						elem.sizset = i;
					}
					if ( typeof cur !== &quot;string&quot; ) {
						if ( elem === cur ) {
							match = true;
							break;
						}

					} else if ( Sizzle.filter( cur, [elem] ).length &gt; 0 ) {
						match = elem;
						break;
					}
				}

				elem = elem[dir];
			}

			checkSet[i] = match;
		}
	}
}

var contains = document.compareDocumentPosition ? function(a, b){
	return a.compareDocumentPosition(b) &amp; 16;
} : function(a, b){
	return a !== b &amp;&amp; (a.contains ? a.contains(b) : true);
};

var isXML = function(elem){
	// documentElement is verified for cases where it doesn&apos;t yet exist
	// (such as loading iframes in IE - #4833) 
	var documentElement = (elem ? elem.ownerDocument || elem : 0).documentElement;
	return documentElement ? documentElement.nodeName !== &quot;HTML&quot; : false;
};

var posProcess = function(selector, context){
	var tmpSet = [], later = &quot;&quot;, match,
		root = context.nodeType ? [context] : context;

	// Position selectors must be done after the filter
	// And so must :not(positional) so we move all PSEUDOs to the end
	while ( (match = Expr.match.PSEUDO.exec( selector )) ) {
		later += match[0];
		selector = selector.replace( Expr.match.PSEUDO, &quot;&quot; );
	}

	selector = Expr.relative[selector] ? selector + &quot;*&quot; : selector;

	for ( var i = 0, l = root.length; i &lt; l; i++ ) {
		Sizzle( selector, root[i], tmpSet );
	}

	return Sizzle.filter( later, tmpSet );
};

// EXPOSE
jQuery.find = Sizzle;
jQuery.expr = Sizzle.selectors;
jQuery.expr[&quot;:&quot;] = jQuery.expr.filters;
jQuery.unique = Sizzle.uniqueSort;
jQuery.getText = getText;
jQuery.isXMLDoc = isXML;
jQuery.contains = contains;

return;

window.Sizzle = Sizzle;

})();
var runtil = /Until$/,
	rparentsprev = /^(?:parents|prevUntil|prevAll)/,
	// Note: This RegExp should be improved, or likely pulled from Sizzle
	rmultiselector = /,/,
	slice = Array.prototype.slice;

// Implement the identical functionality for filter and not
var winnow = function( elements, qualifier, keep ) {
	if ( jQuery.isFunction( qualifier ) ) {
		return jQuery.grep(elements, function( elem, i ) {
			return !!qualifier.call( elem, i, elem ) === keep;
		});

	} else if ( qualifier.nodeType ) {
		return jQuery.grep(elements, function( elem, i ) {
			return (elem === qualifier) === keep;
		});

	} else if ( typeof qualifier === &quot;string&quot; ) {
		var filtered = jQuery.grep(elements, function( elem ) {
			return elem.nodeType === 1;
		});

		if ( isSimple.test( qualifier ) ) {
			return jQuery.filter(qualifier, filtered, !keep);
		} else {
			qualifier = jQuery.filter( qualifier, elements );
		}
	}

	return jQuery.grep(elements, function( elem, i ) {
		return (jQuery.inArray( elem, qualifier ) &gt;= 0) === keep;
	});
};

jQuery.fn.extend({
	find: function( selector ) {
		var ret = this.pushStack( &quot;&quot;, &quot;find&quot;, selector ), length = 0;

		for ( var i = 0, l = this.length; i &lt; l; i++ ) {
			length = ret.length;
			jQuery.find( selector, this[i], ret );

			if ( i &gt; 0 ) {
				// Make sure that the results are unique
				for ( var n = length; n &lt; ret.length; n++ ) {
					for ( var r = 0; r &lt; length; r++ ) {
						if ( ret[r] === ret[n] ) {
							ret.splice(n--, 1);
							break;
						}
					}
				}
			}
		}

		return ret;
	},

	has: function( target ) {
		var targets = jQuery( target );
		return this.filter(function() {
			for ( var i = 0, l = targets.length; i &lt; l; i++ ) {
				if ( jQuery.contains( this, targets[i] ) ) {
					return true;
				}
			}
		});
	},

	not: function( selector ) {
		return this.pushStack( winnow(this, selector, false), &quot;not&quot;, selector);
	},

	filter: function( selector ) {
		return this.pushStack( winnow(this, selector, true), &quot;filter&quot;, selector );
	},
	
	is: function( selector ) {
		return !!selector &amp;&amp; jQuery.filter( selector, this ).length &gt; 0;
	},

	closest: function( selectors, context ) {
		if ( jQuery.isArray( selectors ) ) {
			var ret = [], cur = this[0], match, matches = {}, selector;

			if ( cur &amp;&amp; selectors.length ) {
				for ( var i = 0, l = selectors.length; i &lt; l; i++ ) {
					selector = selectors[i];

					if ( !matches[selector] ) {
						matches[selector] = jQuery.expr.match.POS.test( selector ) ? 
							jQuery( selector, context || this.context ) :
							selector;
					}
				}

				while ( cur &amp;&amp; cur.ownerDocument &amp;&amp; cur !== context ) {
					for ( selector in matches ) {
						match = matches[selector];

						if ( match.jquery ? match.index(cur) &gt; -1 : jQuery(cur).is(match) ) {
							ret.push({ selector: selector, elem: cur });
							delete matches[selector];
						}
					}
					cur = cur.parentNode;
				}
			}

			return ret;
		}

		var pos = jQuery.expr.match.POS.test( selectors ) ? 
			jQuery( selectors, context || this.context ) : null;

		return this.map(function( i, cur ) {
			while ( cur &amp;&amp; cur.ownerDocument &amp;&amp; cur !== context ) {
				if ( pos ? pos.index(cur) &gt; -1 : jQuery(cur).is(selectors) ) {
					return cur;
				}
				cur = cur.parentNode;
			}
			return null;
		});
	},
	
	// Determine the position of an element within
	// the matched set of elements
	index: function( elem ) {
		if ( !elem || typeof elem === &quot;string&quot; ) {
			return jQuery.inArray( this[0],
				// If it receives a string, the selector is used
				// If it receives nothing, the siblings are used
				elem ? jQuery( elem ) : this.parent().children() );
		}
		// Locate the position of the desired element
		return jQuery.inArray(
			// If it receives a jQuery object, the first element is used
			elem.jquery ? elem[0] : elem, this );
	},

	add: function( selector, context ) {
		var set = typeof selector === &quot;string&quot; ?
				jQuery( selector, context || this.context ) :
				jQuery.makeArray( selector ),
			all = jQuery.merge( this.get(), set );

		return this.pushStack( isDisconnected( set[0] ) || isDisconnected( all[0] ) ?
			all :
			jQuery.unique( all ) );
	},

	andSelf: function() {
		return this.add( this.prevObject );
	}
});

// A painfully simple check to see if an element is disconnected
// from a document (should be improved, where feasible).
function isDisconnected( node ) {
	return !node || !node.parentNode || node.parentNode.nodeType === 11;
}

jQuery.each({
	parent: function( elem ) {
		var parent = elem.parentNode;
		return parent &amp;&amp; parent.nodeType !== 11 ? parent : null;
	},
	parents: function( elem ) {
		return jQuery.dir( elem, &quot;parentNode&quot; );
	},
	parentsUntil: function( elem, i, until ) {
		return jQuery.dir( elem, &quot;parentNode&quot;, until );
	},
	next: function( elem ) {
		return jQuery.nth( elem, 2, &quot;nextSibling&quot; );
	},
	prev: function( elem ) {
		return jQuery.nth( elem, 2, &quot;previousSibling&quot; );
	},
	nextAll: function( elem ) {
		return jQuery.dir( elem, &quot;nextSibling&quot; );
	},
	prevAll: function( elem ) {
		return jQuery.dir( elem, &quot;previousSibling&quot; );
	},
	nextUntil: function( elem, i, until ) {
		return jQuery.dir( elem, &quot;nextSibling&quot;, until );
	},
	prevUntil: function( elem, i, until ) {
		return jQuery.dir( elem, &quot;previousSibling&quot;, until );
	},
	siblings: function( elem ) {
		return jQuery.sibling( elem.parentNode.firstChild, elem );
	},
	children: function( elem ) {
		return jQuery.sibling( elem.firstChild );
	},
	contents: function( elem ) {
		return jQuery.nodeName( elem, &quot;iframe&quot; ) ?
			elem.contentDocument || elem.contentWindow.document :
			jQuery.makeArray( elem.childNodes );
	}
}, function( name, fn ) {
	jQuery.fn[ name ] = function( until, selector ) {
		var ret = jQuery.map( this, fn, until );
		
		if ( !runtil.test( name ) ) {
			selector = until;
		}

		if ( selector &amp;&amp; typeof selector === &quot;string&quot; ) {
			ret = jQuery.filter( selector, ret );
		}

		ret = this.length &gt; 1 ? jQuery.unique( ret ) : ret;

		if ( (this.length &gt; 1 || rmultiselector.test( selector )) &amp;&amp; rparentsprev.test( name ) ) {
			ret = ret.reverse();
		}

		return this.pushStack( ret, name, slice.call(arguments).join(&quot;,&quot;) );
	};
});

jQuery.extend({
	filter: function( expr, elems, not ) {
		if ( not ) {
			expr = &quot;:not(&quot; + expr + &quot;)&quot;;
		}

		return jQuery.find.matches(expr, elems);
	},
	
	dir: function( elem, dir, until ) {
		var matched = [], cur = elem[dir];
		while ( cur &amp;&amp; cur.nodeType !== 9 &amp;&amp; (until === undefined || !jQuery( cur ).is( until )) ) {
			if ( cur.nodeType === 1 ) {
				matched.push( cur );
			}
			cur = cur[dir];
		}
		return matched;
	},

	nth: function( cur, result, dir, elem ) {
		result = result || 1;
		var num = 0;

		for ( ; cur; cur = cur[dir] ) {
			if ( cur.nodeType === 1 &amp;&amp; ++num === result ) {
				break;
			}
		}

		return cur;
	},

	sibling: function( n, elem ) {
		var r = [];

		for ( ; n; n = n.nextSibling ) {
			if ( n.nodeType === 1 &amp;&amp; n !== elem ) {
				r.push( n );
			}
		}

		return r;
	}
});
var rinlinejQuery = / jQuery\d+=&quot;(?:\d+|null)&quot;/g,
	rleadingWhitespace = /^\s+/,
	rxhtmlTag = /(&lt;([\w:]+)[^&gt;]*?)\/&gt;/g,
	rselfClosing = /^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i,
	rtagName = /&lt;([\w:]+)/,
	rtbody = /&lt;tbody/i,
	rhtml = /&lt;|&amp;\w+;/,
	fcloseTag = function( all, front, tag ) {
		return rselfClosing.test( tag ) ?
			all :
			front + &quot;&gt;&lt;/&quot; + tag + &quot;&gt;&quot;;
	},
	wrapMap = {
		option: [ 1, &quot;&lt;select multiple=&apos;multiple&apos;&gt;&quot;, &quot;&lt;/select&gt;&quot; ],
		legend: [ 1, &quot;&lt;fieldset&gt;&quot;, &quot;&lt;/fieldset&gt;&quot; ],
		thead: [ 1, &quot;&lt;table&gt;&quot;, &quot;&lt;/table&gt;&quot; ],
		tr: [ 2, &quot;&lt;table&gt;&lt;tbody&gt;&quot;, &quot;&lt;/tbody&gt;&lt;/table&gt;&quot; ],
		td: [ 3, &quot;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&quot;, &quot;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&quot; ],
		col: [ 2, &quot;&lt;table&gt;&lt;tbody&gt;&lt;/tbody&gt;&lt;colgroup&gt;&quot;, &quot;&lt;/colgroup&gt;&lt;/table&gt;&quot; ],
		area: [ 1, &quot;&lt;map&gt;&quot;, &quot;&lt;/map&gt;&quot; ],
		_default: [ 0, &quot;&quot;, &quot;&quot; ]
	};

wrapMap.optgroup = wrapMap.option;
wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
wrapMap.th = wrapMap.td;

// IE can&apos;t serialize &lt;link&gt; and &lt;script&gt; tags normally
if ( !jQuery.support.htmlSerialize ) {
	wrapMap._default = [ 1, &quot;div&lt;div&gt;&quot;, &quot;&lt;/div&gt;&quot; ];
}

jQuery.fn.extend({
	text: function( text ) {
		if ( jQuery.isFunction(text) ) {
			return this.each(function(i) {
				var self = jQuery(this);
				return self.text( text.call(this, i, self.text()) );
			});
		}

		if ( typeof text !== &quot;object&quot; &amp;&amp; text !== undefined ) {
			return this.empty().append( (this[0] &amp;&amp; this[0].ownerDocument || document).createTextNode( text ) );
		}

		return jQuery.getText( this );
	},

	wrapAll: function( html ) {
		if ( jQuery.isFunction( html ) ) {
			return this.each(function(i) {
				jQuery(this).wrapAll( html.call(this, i) );
			});
		}

		if ( this[0] ) {
			// The elements to wrap the target around
			var wrap = jQuery( html, this[0].ownerDocument ).eq(0).clone(true);

			if ( this[0].parentNode ) {
				wrap.insertBefore( this[0] );
			}

			wrap.map(function() {
				var elem = this;

				while ( elem.firstChild &amp;&amp; elem.firstChild.nodeType === 1 ) {
					elem = elem.firstChild;
				}

				return elem;
			}).append(this);
		}

		return this;
	},

	wrapInner: function( html ) {
		return this.each(function() {
			var self = jQuery( this ), contents = self.contents();

			if ( contents.length ) {
				contents.wrapAll( html );

			} else {
				self.append( html );
			}
		});
	},

	wrap: function( html ) {
		return this.each(function() {
			jQuery( this ).wrapAll( html );
		});
	},

	unwrap: function() {
		return this.parent().each(function() {
			if ( !jQuery.nodeName( this, &quot;body&quot; ) ) {
				jQuery( this ).replaceWith( this.childNodes );
			}
		}).end();
	},

	append: function() {
		return this.domManip(arguments, true, function( elem ) {
			if ( this.nodeType === 1 ) {
				this.appendChild( elem );
			}
		});
	},

	prepend: function() {
		return this.domManip(arguments, true, function( elem ) {
			if ( this.nodeType === 1 ) {
				this.insertBefore( elem, this.firstChild );
			}
		});
	},

	before: function() {
		if ( this[0] &amp;&amp; this[0].parentNode ) {
			return this.domManip(arguments, false, function( elem ) {
				this.parentNode.insertBefore( elem, this );
			});
		} else if ( arguments.length ) {
			var set = jQuery(arguments[0]);
			set.push.apply( set, this.toArray() );
			return this.pushStack( set, &quot;before&quot;, arguments );
		}
	},

	after: function() {
		if ( this[0] &amp;&amp; this[0].parentNode ) {
			return this.domManip(arguments, false, function( elem ) {
				this.parentNode.insertBefore( elem, this.nextSibling );
			});
		} else if ( arguments.length ) {
			var set = this.pushStack( this, &quot;after&quot;, arguments );
			set.push.apply( set, jQuery(arguments[0]).toArray() );
			return set;
		}
	},

	clone: function( events ) {
		// Do the clone
		var ret = this.map(function() {
			if ( !jQuery.support.noCloneEvent &amp;&amp; !jQuery.isXMLDoc(this) ) {
				// IE copies events bound via attachEvent when
				// using cloneNode. Calling detachEvent on the
				// clone will also remove the events from the orignal
				// In order to get around this, we use innerHTML.
				// Unfortunately, this means some modifications to
				// attributes in IE that are actually only stored
				// as properties will not be copied (such as the
				// the name attribute on an input).
				var html = this.outerHTML, ownerDocument = this.ownerDocument;
				if ( !html ) {
					var div = ownerDocument.createElement(&quot;div&quot;);
					div.appendChild( this.cloneNode(true) );
					html = div.innerHTML;
				}

				return jQuery.clean([html.replace(rinlinejQuery, &quot;&quot;)
					.replace(rleadingWhitespace, &quot;&quot;)], ownerDocument)[0];
			} else {
				return this.cloneNode(true);
			}
		});

		// Copy the events from the original to the clone
		if ( events === true ) {
			cloneCopyEvent( this, ret );
			cloneCopyEvent( this.find(&quot;*&quot;), ret.find(&quot;*&quot;) );
		}

		// Return the cloned set
		return ret;
	},

	html: function( value ) {
		if ( value === undefined ) {
			return this[0] &amp;&amp; this[0].nodeType === 1 ?
				this[0].innerHTML.replace(rinlinejQuery, &quot;&quot;) :
				null;

		// See if we can take a shortcut and just use innerHTML
		} else if ( typeof value === &quot;string&quot; &amp;&amp; !/&lt;script/i.test( value ) &amp;&amp;
			(jQuery.support.leadingWhitespace || !rleadingWhitespace.test( value )) &amp;&amp;
			!wrapMap[ (rtagName.exec( value ) || [&quot;&quot;, &quot;&quot;])[1].toLowerCase() ] ) {

			try {
				for ( var i = 0, l = this.length; i &lt; l; i++ ) {
					// Remove element nodes and prevent memory leaks
					if ( this[i].nodeType === 1 ) {
						cleanData( this[i].getElementsByTagName(&quot;*&quot;) );
						this[i].innerHTML = value;
					}
				}

			// If using innerHTML throws an exception, use the fallback method
			} catch(e) {
				this.empty().append( value );
			}

		} else if ( jQuery.isFunction( value ) ) {
			this.each(function(i){
				var self = jQuery(this), old = self.html();
				self.empty().append(function(){
					return value.call( this, i, old );
				});
			});

		} else {
			this.empty().append( value );
		}

		return this;
	},

	replaceWith: function( value ) {
		if ( this[0] &amp;&amp; this[0].parentNode ) {
			// Make sure that the elements are removed from the DOM before they are inserted
			// this can help fix replacing a parent with child elements
			if ( !jQuery.isFunction( value ) ) {
				value = jQuery( value ).detach();
			}

			return this.each(function() {
				var next = this.nextSibling, parent = this.parentNode;

				jQuery(this).remove();

				if ( next ) {
					jQuery(next).before( value );
				} else {
					jQuery(parent).append( value );
				}
			});
		} else {
			return this.pushStack( jQuery(jQuery.isFunction(value) ? value() : value), &quot;replaceWith&quot;, value );
		}
	},

	detach: function( selector ) {
		return this.remove( selector, true );
	},

	domManip: function( args, table, callback ) {
		var results, first, value = args[0], scripts = [];

		if ( jQuery.isFunction(value) ) {
			return this.each(function(i) {
				var self = jQuery(this);
				args[0] = value.call(this, i, table ? self.html() : undefined);
				return self.domManip( args, table, callback );
			});
		}

		if ( this[0] ) {
			// If we&apos;re in a fragment, just use that instead of building a new one
			if ( args[0] &amp;&amp; args[0].parentNode &amp;&amp; args[0].parentNode.nodeType === 11 ) {
				results = { fragment: args[0].parentNode };
			} else {
				results = buildFragment( args, this, scripts );
			}

			first = results.fragment.firstChild;

			if ( first ) {
				table = table &amp;&amp; jQuery.nodeName( first, &quot;tr&quot; );

				for ( var i = 0, l = this.length; i &lt; l; i++ ) {
					callback.call(
						table ?
							root(this[i], first) :
							this[i],
						results.cacheable || this.length &gt; 1 || i &gt; 0 ?
							results.fragment.cloneNode(true) :
							results.fragment
					);
				}
			}

			if ( scripts ) {
				jQuery.each( scripts, evalScript );
			}
		}

		return this;

		function root( elem, cur ) {
			return jQuery.nodeName(elem, &quot;table&quot;) ?
				(elem.getElementsByTagName(&quot;tbody&quot;)[0] ||
				elem.appendChild(elem.ownerDocument.createElement(&quot;tbody&quot;))) :
				elem;
		}
	}
});

function cloneCopyEvent(orig, ret) {
	var i = 0;

	ret.each(function() {
		if ( this.nodeName !== (orig[i] &amp;&amp; orig[i].nodeName) ) {
			return;
		}

		var oldData = jQuery.data( orig[i++] ), curData = jQuery.data( this, oldData ), events = oldData &amp;&amp; oldData.events;

		if ( events ) {
			delete curData.handle;
			curData.events = {};

			for ( var type in events ) {
				for ( var handler in events[ type ] ) {
					jQuery.event.add( this, type, events[ type ][ handler ], events[ type ][ handler ].data );
				}
			}
		}
	});
}

function buildFragment( args, nodes, scripts ) {
	var fragment, cacheable, cached, cacheresults, doc;

	if ( args.length === 1 &amp;&amp; typeof args[0] === &quot;string&quot; &amp;&amp; args[0].length &lt; 512 &amp;&amp; args[0].indexOf(&quot;&lt;option&quot;) &lt; 0 ) {
		cacheable = true;
		cacheresults = jQuery.fragments[ args[0] ];
		if ( cacheresults ) {
			if ( cacheresults !== 1 ) {
				fragment = cacheresults;
			}
			cached = true;
		}
	}

	if ( !fragment ) {
		doc = (nodes &amp;&amp; nodes[0] ? nodes[0].ownerDocument || nodes[0] : document);
		fragment = doc.createDocumentFragment();
		jQuery.clean( args, doc, fragment, scripts );
	}

	if ( cacheable ) {
		jQuery.fragments[ args[0] ] = cacheresults ? fragment : 1;
	}

	return { fragment: fragment, cacheable: cacheable };
}

jQuery.fragments = {};

jQuery.each({
	appendTo: &quot;append&quot;,
	prependTo: &quot;prepend&quot;,
	insertBefore: &quot;before&quot;,
	insertAfter: &quot;after&quot;,
	replaceAll: &quot;replaceWith&quot;
}, function( name, original ) {
	jQuery.fn[ name ] = function( selector ) {
		var ret = [], insert = jQuery( selector );

		for ( var i = 0, l = insert.length; i &lt; l; i++ ) {
			var elems = (i &gt; 0 ? this.clone(true) : this).get();
			jQuery.fn[ original ].apply( jQuery(insert[i]), elems );
			ret = ret.concat( elems );
		}
		return this.pushStack( ret, name, insert.selector );
	};
});

jQuery.each({
	// keepData is for internal use only--do not document
	remove: function( selector, keepData ) {
		if ( !selector || jQuery.filter( selector, [ this ] ).length ) {
			if ( !keepData &amp;&amp; this.nodeType === 1 ) {
				cleanData( this.getElementsByTagName(&quot;*&quot;) );
				cleanData( [ this ] );
			}

			if ( this.parentNode ) {
				 this.parentNode.removeChild( this );
			}
		}
	},

	empty: function() {
		// Remove element nodes and prevent memory leaks
		if ( this.nodeType === 1 ) {
			cleanData( this.getElementsByTagName(&quot;*&quot;) );
		}

		// Remove any remaining nodes
		while ( this.firstChild ) {
			this.removeChild( this.firstChild );
		}
	}
}, function( name, fn ) {
	jQuery.fn[ name ] = function() {
		return this.each( fn, arguments );
	};
});

jQuery.extend({
	clean: function( elems, context, fragment, scripts ) {
		context = context || document;

		// !context.createElement fails in IE with an error but returns typeof &apos;object&apos;
		if ( typeof context.createElement === &quot;undefined&quot; ) {
			context = context.ownerDocument || context[0] &amp;&amp; context[0].ownerDocument || document;
		}

		var ret = [];

		jQuery.each(elems, function( i, elem ) {
			if ( typeof elem === &quot;number&quot; ) {
				elem += &quot;&quot;;
			}

			if ( !elem ) {
				return;
			}

			// Convert html string into DOM nodes
			if ( typeof elem === &quot;string&quot; &amp;&amp; !rhtml.test( elem ) ) {
				elem = context.createTextNode( elem );

			} else if ( typeof elem === &quot;string&quot; ) {
				// Fix &quot;XHTML&quot;-style tags in all browsers
				elem = elem.replace(rxhtmlTag, fcloseTag);

				// Trim whitespace, otherwise indexOf won&apos;t work as expected
				var tag = (rtagName.exec( elem ) || [&quot;&quot;, &quot;&quot;])[1].toLowerCase(),
					wrap = wrapMap[ tag ] || wrapMap._default,
					depth = wrap[0],
					div = context.createElement(&quot;div&quot;);

				// Go to html and back, then peel off extra wrappers
				div.innerHTML = wrap[1] + elem + wrap[2];

				// Move to the right depth
				while ( depth-- ) {
					div = div.lastChild;
				}

				// Remove IE&apos;s autoinserted &lt;tbody&gt; from table fragments
				if ( !jQuery.support.tbody ) {

					// String was a &lt;table&gt;, *may* have spurious &lt;tbody&gt;
					var hasBody = rtbody.test(elem),
						tbody = tag === &quot;table&quot; &amp;&amp; !hasBody ?
							div.firstChild &amp;&amp; div.firstChild.childNodes :

							// String was a bare &lt;thead&gt; or &lt;tfoot&gt;
							wrap[1] === &quot;&lt;table&gt;&quot; &amp;&amp; !hasBody ?
								div.childNodes :
								[];

					for ( var j = tbody.length - 1; j &gt;= 0 ; --j ) {
						if ( jQuery.nodeName( tbody[ j ], &quot;tbody&quot; ) &amp;&amp; !tbody[ j ].childNodes.length ) {
							tbody[ j ].parentNode.removeChild( tbody[ j ] );
						}
					}

				}

				// IE completely kills leading whitespace when innerHTML is used
				if ( !jQuery.support.leadingWhitespace &amp;&amp; rleadingWhitespace.test( elem ) ) {
					div.insertBefore( context.createTextNode( rleadingWhitespace.exec(elem)[0] ), div.firstChild );
				}

				elem = jQuery.makeArray( div.childNodes );
			}

			if ( elem.nodeType ) {
				ret.push( elem );
			} else {
				ret = jQuery.merge( ret, elem );
			}

		});

		if ( fragment ) {
			for ( var i = 0; ret[i]; i++ ) {
				if ( scripts &amp;&amp; jQuery.nodeName( ret[i], &quot;script&quot; ) &amp;&amp; (!ret[i].type || ret[i].type.toLowerCase() === &quot;text/javascript&quot;) ) {
					scripts.push( ret[i].parentNode ? ret[i].parentNode.removeChild( ret[i] ) : ret[i] );
				} else {
					if ( ret[i].nodeType === 1 ) {
						ret.splice.apply( ret, [i + 1, 0].concat(jQuery.makeArray(ret[i].getElementsByTagName(&quot;script&quot;))) );
					}
					fragment.appendChild( ret[i] );
				}
			}
		}

		return ret;
	}
});

function cleanData( elems ) {
	for ( var i = 0, elem, id; (elem = elems[i]) != null; i++ ) {
		if ( !jQuery.noData[elem.nodeName.toLowerCase()] &amp;&amp; (id = elem[expando]) ) {
			delete jQuery.cache[ id ];
		}
	}
}
// exclude the following css properties to add px
var rexclude = /z-?index|font-?weight|opacity|zoom|line-?height/i,
	ralpha = /alpha\([^)]*\)/,
	ropacity = /opacity=([^)]*)/,
	rfloat = /float/i,
	rdashAlpha = /-([a-z])/ig,
	rupper = /([A-Z])/g,
	rnumpx = /^-?\d+(?:px)?$/i,
	rnum = /^-?\d/,

	cssShow = { position: &quot;absolute&quot;, visibility: &quot;hidden&quot;, display:&quot;block&quot; },
	cssWidth = [ &quot;Left&quot;, &quot;Right&quot; ],
	cssHeight = [ &quot;Top&quot;, &quot;Bottom&quot; ],

	// cache check for defaultView.getComputedStyle
	getComputedStyle = document.defaultView &amp;&amp; document.defaultView.getComputedStyle,
	// normalize float css property
	styleFloat = jQuery.support.cssFloat ? &quot;cssFloat&quot; : &quot;styleFloat&quot;,
	fcamelCase = function( all, letter ) {
		return letter.toUpperCase();
	};

jQuery.fn.css = function( name, value ) {
	return access( this, name, value, true, function( elem, name, value ) {
		if ( value === undefined ) {
			return jQuery.curCSS( elem, name );
		}
		
		if ( typeof value === &quot;number&quot; &amp;&amp; !rexclude.test(name) ) {
			value += &quot;px&quot;;
		}

		jQuery.style( elem, name, value );
	});
};

jQuery.extend({
	style: function( elem, name, value ) {
		// don&apos;t set styles on text and comment nodes
		if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 ) {
			return undefined;
		}

		// ignore negative width and height values #1599
		if ( (name === &quot;width&quot; || name === &quot;height&quot;) &amp;&amp; parseFloat(value) &lt; 0 ) {
			value = undefined;
		}

		var style = elem.style || elem, set = value !== undefined;

		// IE uses filters for opacity
		if ( !jQuery.support.opacity &amp;&amp; name === &quot;opacity&quot; ) {
			if ( set ) {
				// IE has trouble with opacity if it does not have layout
				// Force it by setting the zoom level
				style.zoom = 1;

				// Set the alpha filter to set the opacity
				var opacity = parseInt( value, 10 ) + &quot;&quot; === &quot;NaN&quot; ? &quot;&quot; : &quot;alpha(opacity=&quot; + value * 100 + &quot;)&quot;;
				var filter = style.filter || jQuery.curCSS( elem, &quot;filter&quot; ) || &quot;&quot;;
				style.filter = ralpha.test(filter) ? filter.replace(ralpha, opacity) : opacity;
			}

			return style.filter &amp;&amp; style.filter.indexOf(&quot;opacity=&quot;) &gt;= 0 ?
				(parseFloat( ropacity.exec(style.filter)[1] ) / 100) + &quot;&quot;:
				&quot;&quot;;
		}

		// Make sure we&apos;re using the right name for getting the float value
		if ( rfloat.test( name ) ) {
			name = styleFloat;
		}

		name = name.replace(rdashAlpha, fcamelCase);

		if ( set ) {
			style[ name ] = value;
		}

		return style[ name ];
	},

	css: function( elem, name, force, extra ) {
		if ( name === &quot;width&quot; || name === &quot;height&quot; ) {
			var val, props = cssShow, which = name === &quot;width&quot; ? cssWidth : cssHeight;

			function getWH() {
				val = name === &quot;width&quot; ? elem.offsetWidth : elem.offsetHeight;

				if ( extra === &quot;border&quot; ) {
					return;
				}

				jQuery.each( which, function() {
					if ( !extra ) {
						val -= parseFloat(jQuery.curCSS( elem, &quot;padding&quot; + this, true)) || 0;
					}

					if ( extra === &quot;margin&quot; ) {
						val += parseFloat(jQuery.curCSS( elem, &quot;margin&quot; + this, true)) || 0;
					} else {
						val -= parseFloat(jQuery.curCSS( elem, &quot;border&quot; + this + &quot;Width&quot;, true)) || 0;
					}
				});
			}

			if ( elem.offsetWidth !== 0 ) {
				getWH();
			} else {
				jQuery.swap( elem, props, getWH );
			}

			return Math.max(0, Math.round(val));
		}

		return jQuery.curCSS( elem, name, force );
	},

	curCSS: function( elem, name, force ) {
		var ret, style = elem.style, filter;

		// IE uses filters for opacity
		if ( !jQuery.support.opacity &amp;&amp; name === &quot;opacity&quot; &amp;&amp; elem.currentStyle ) {
			ret = ropacity.test(elem.currentStyle.filter || &quot;&quot;) ?
				(parseFloat(RegExp.$1) / 100) + &quot;&quot; :
				&quot;&quot;;

			return ret === &quot;&quot; ?
				&quot;1&quot; :
				ret;
		}

		// Make sure we&apos;re using the right name for getting the float value
		if ( rfloat.test( name ) ) {
			name = styleFloat;
		}

		if ( !force &amp;&amp; style &amp;&amp; style[ name ] ) {
			ret = style[ name ];

		} else if ( getComputedStyle ) {

			// Only &quot;float&quot; is needed here
			if ( rfloat.test( name ) ) {
				name = &quot;float&quot;;
			}

			name = name.replace( rupper, &quot;-$1&quot; ).toLowerCase();

			var defaultView = elem.ownerDocument.defaultView;

			if ( !defaultView ) {
				return null;
			}

			var computedStyle = defaultView.getComputedStyle( elem, null );

			if ( computedStyle ) {
				ret = computedStyle.getPropertyValue( name );
			}

			// We should always get a number back from opacity
			if ( name === &quot;opacity&quot; &amp;&amp; ret === &quot;&quot; ) {
				ret = &quot;1&quot;;
			}

		} else if ( elem.currentStyle ) {
			var camelCase = name.replace(rdashAlpha, fcamelCase);

			ret = elem.currentStyle[ name ] || elem.currentStyle[ camelCase ];

			// From the awesome hack by Dean Edwards
			// http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291

			// If we&apos;re not dealing with a regular pixel number
			// but a number that has a weird ending, we need to convert it to pixels
			if ( !rnumpx.test( ret ) &amp;&amp; rnum.test( ret ) ) {
				// Remember the original values
				var left = style.left, rsLeft = elem.runtimeStyle.left;

				// Put in the new values to get a computed value out
				elem.runtimeStyle.left = elem.currentStyle.left;
				style.left = camelCase === &quot;fontSize&quot; ? &quot;1em&quot; : (ret || 0);
				ret = style.pixelLeft + &quot;px&quot;;

				// Revert the changed values
				style.left = left;
				elem.runtimeStyle.left = rsLeft;
			}
		}

		return ret;
	},

	// A method for quickly swapping in/out CSS properties to get correct calculations
	swap: function( elem, options, callback ) {
		var old = {};

		// Remember the old values, and insert the new ones
		for ( var name in options ) {
			old[ name ] = elem.style[ name ];
			elem.style[ name ] = options[ name ];
		}

		callback.call( elem );

		// Revert the old values
		for ( var name in options ) {
			elem.style[ name ] = old[ name ];
		}
	}
});

if ( jQuery.expr &amp;&amp; jQuery.expr.filters ) {
	jQuery.expr.filters.hidden = function( elem ) {
		var width = elem.offsetWidth, height = elem.offsetHeight,
			skip = elem.nodeName.toLowerCase() === &quot;tr&quot;;

		return width === 0 &amp;&amp; height === 0 &amp;&amp; !skip ?
			true :
			width &gt; 0 &amp;&amp; height &gt; 0 &amp;&amp; !skip ?
				false :
				jQuery.curCSS(elem, &quot;display&quot;) === &quot;none&quot;;
	};

	jQuery.expr.filters.visible = function( elem ) {
		return !jQuery.expr.filters.hidden( elem );
	};
}
var jsc = now(),
	rscript = /&lt;script(.|\s)*?\/script&gt;/gi,
	rselectTextarea = /select|textarea/i,
	rinput = /color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,
	jsre = /=\?(&amp;|$)/,
	rquery = /\?/,
	rts = /(\?|&amp;)_=.*?(&amp;|$)/,
	rurl = /^(\w+:)?\/\/([^\/?#]+)/,
	r20 = /%20/g;

jQuery.fn.extend({
	// Keep a copy of the old load
	_load: jQuery.fn.load,

	load: function( url, params, callback ) {
		if ( typeof url !== &quot;string&quot; ) {
			return this._load( url );

		// Don&apos;t do a request if no elements are being requested
		} else if ( !this.length ) {
			return this;
		}

		var off = url.indexOf(&quot; &quot;);
		if ( off &gt;= 0 ) {
			var selector = url.slice(off, url.length);
			url = url.slice(0, off);
		}

		// Default to a GET request
		var type = &quot;GET&quot;;

		// If the second parameter was provided
		if ( params ) {
			// If it&apos;s a function
			if ( jQuery.isFunction( params ) ) {
				// We assume that it&apos;s the callback
				callback = params;
				params = null;

			// Otherwise, build a param string
			} else if ( typeof params === &quot;object&quot; ) {
				params = jQuery.param( params, jQuery.ajaxSettings.traditional );
				type = &quot;POST&quot;;
			}
		}

		// Request the remote document
		jQuery.ajax({
			url: url,
			type: type,
			dataType: &quot;html&quot;,
			data: params,
			context:this,
			complete: function( res, status ) {
				// If successful, inject the HTML into all the matched elements
				if ( status === &quot;success&quot; || status === &quot;notmodified&quot; ) {
					// See if a selector was specified
					this.html( selector ?
						// Create a dummy div to hold the results
						jQuery(&quot;&lt;div /&gt;&quot;)
							// inject the contents of the document in, removing the scripts
							// to avoid any &apos;Permission Denied&apos; errors in IE
							.append(res.responseText.replace(rscript, &quot;&quot;))

							// Locate the specified elements
							.find(selector) :

						// If not, just inject the full result
						res.responseText );
				}

				if ( callback ) {
					this.each( callback, [res.responseText, status, res] );
				}
			}
		});

		return this;
	},

	serialize: function() {
		return jQuery.param(this.serializeArray());
	},
	serializeArray: function() {
		return this.map(function() {
			return this.elements ? jQuery.makeArray(this.elements) : this;
		})
		.filter(function() {
			return this.name &amp;&amp; !this.disabled &amp;&amp;
				(this.checked || rselectTextarea.test(this.nodeName) ||
					rinput.test(this.type));
		})
		.map(function( i, elem ) {
			var val = jQuery(this).val();

			return val == null ?
				null :
				jQuery.isArray(val) ?
					jQuery.map( val, function( val, i ) {
						return { name: elem.name, value: val };
					}) :
					{ name: elem.name, value: val };
		}).get();
	}
});

// Attach a bunch of functions for handling common AJAX events
jQuery.each( &quot;ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend&quot;.split(&quot; &quot;), function( i, o ) {
	jQuery.fn[o] = function( f ) {
		return this.bind(o, f);
	};
});

jQuery.extend({

	get: function( url, data, callback, type ) {
		// shift arguments if data argument was omited
		if ( jQuery.isFunction( data ) ) {
			type = type || callback;
			callback = data;
			data = null;
		}

		return jQuery.ajax({
			type: &quot;GET&quot;,
			url: url,
			data: data,
			success: callback,
			dataType: type
		});
	},

	getScript: function( url, callback ) {
		return jQuery.get(url, null, callback, &quot;script&quot;);
	},

	getJSON: function( url, data, callback ) {
		return jQuery.get(url, data, callback, &quot;json&quot;);
	},

	post: function( url, data, callback, type ) {
		// shift arguments if data argument was omited
		if ( jQuery.isFunction( data ) ) {
			type = type || callback;
			callback = data;
			data = {};
		}

		return jQuery.ajax({
			type: &quot;POST&quot;,
			url: url,
			data: data,
			success: callback,
			dataType: type
		});
	},

	ajaxSetup: function( settings ) {
		jQuery.extend( jQuery.ajaxSettings, settings );
	},

	ajaxSettings: {
		url: location.href,
		global: true,
		type: &quot;GET&quot;,
		contentType: &quot;application/x-www-form-urlencoded&quot;,
		processData: true,
		async: true,
		/*
		timeout: 0,
		data: null,
		username: null,
		password: null,
		traditional: false,
		*/
		// Create the request object; Microsoft failed to properly
		// implement the XMLHttpRequest in IE7 (can&apos;t request local files),
		// so we use the ActiveXObject when it is available
		// This function can be overriden by calling jQuery.ajaxSetup
		xhr: window.XMLHttpRequest &amp;&amp; (window.location.protocol !== &quot;file:&quot; || !window.ActiveXObject) ?
			function() {
				return new window.XMLHttpRequest();
			} :
			function() {
				try {
					return new window.ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
				} catch(e) {}
			},
		accepts: {
			xml: &quot;application/xml, text/xml&quot;,
			html: &quot;text/html&quot;,
			script: &quot;text/javascript, application/javascript&quot;,
			json: &quot;application/json, text/javascript&quot;,
			text: &quot;text/plain&quot;,
			_default: &quot;*/*&quot;
		}
	},

	// Last-Modified header cache for next request
	lastModified: {},
	etag: {},

	ajax: function( origSettings ) {
		var s = jQuery.extend(true, {}, jQuery.ajaxSettings, origSettings);
		
		var jsonp, status, data,
			callbackContext = s.context || s,
			type = s.type.toUpperCase();

		// convert data if not already a string
		if ( s.data &amp;&amp; s.processData &amp;&amp; typeof s.data !== &quot;string&quot; ) {
			s.data = jQuery.param( s.data, s.traditional );
		}

		// Handle JSONP Parameter Callbacks
		if ( s.dataType === &quot;jsonp&quot; ) {
			if ( type === &quot;GET&quot; ) {
				if ( !jsre.test( s.url ) ) {
					s.url += (rquery.test( s.url ) ? &quot;&amp;&quot; : &quot;?&quot;) + (s.jsonp || &quot;callback&quot;) + &quot;=?&quot;;
				}
			} else if ( !s.data || !jsre.test(s.data) ) {
				s.data = (s.data ? s.data + &quot;&amp;&quot; : &quot;&quot;) + (s.jsonp || &quot;callback&quot;) + &quot;=?&quot;;
			}
			s.dataType = &quot;json&quot;;
		}

		// Build temporary JSONP function
		if ( s.dataType === &quot;json&quot; &amp;&amp; (s.data &amp;&amp; jsre.test(s.data) || jsre.test(s.url)) ) {
			jsonp = s.jsonpCallback || (&quot;jsonp&quot; + jsc++);

			// Replace the =? sequence both in the query string and the data
			if ( s.data ) {
				s.data = (s.data + &quot;&quot;).replace(jsre, &quot;=&quot; + jsonp + &quot;$1&quot;);
			}

			s.url = s.url.replace(jsre, &quot;=&quot; + jsonp + &quot;$1&quot;);

			// We need to make sure
			// that a JSONP style response is executed properly
			s.dataType = &quot;script&quot;;

			// Handle JSONP-style loading
			window[ jsonp ] = window[ jsonp ] || function( tmp ) {
				data = tmp;
				success();
				complete();
				// Garbage collect
				window[ jsonp ] = undefined;

				try {
					delete window[ jsonp ];
				} catch(e) {}

				if ( head ) {
					head.removeChild( script );
				}
			};
		}

		if ( s.dataType === &quot;script&quot; &amp;&amp; s.cache === null ) {
			s.cache = false;
		}

		if ( s.cache === false &amp;&amp; type === &quot;GET&quot; ) {
			var ts = now();

			// try replacing _= if it is there
			var ret = s.url.replace(rts, &quot;$1_=&quot; + ts + &quot;$2&quot;);

			// if nothing was replaced, add timestamp to the end
			s.url = ret + ((ret === s.url) ? (rquery.test(s.url) ? &quot;&amp;&quot; : &quot;?&quot;) + &quot;_=&quot; + ts : &quot;&quot;);
		}

		// If data is available, append data to url for get requests
		if ( s.data &amp;&amp; type === &quot;GET&quot; ) {
			s.url += (rquery.test(s.url) ? &quot;&amp;&quot; : &quot;?&quot;) + s.data;
		}

		// Watch for a new set of requests
		if ( s.global &amp;&amp; ! jQuery.active++ ) {
			jQuery.event.trigger( &quot;ajaxStart&quot; );
		}

		// Matches an absolute URL, and saves the domain
		var parts = rurl.exec( s.url ),
			remote = parts &amp;&amp; (parts[1] &amp;&amp; parts[1] !== location.protocol || parts[2] !== location.host);

		// If we&apos;re requesting a remote document
		// and trying to load JSON or Script with a GET
		if ( s.dataType === &quot;script&quot; &amp;&amp; type === &quot;GET&quot; &amp;&amp; remote ) {
			var head = document.getElementsByTagName(&quot;head&quot;)[0] || document.documentElement;
			var script = document.createElement(&quot;script&quot;);
			script.src = s.url;
			if ( s.scriptCharset ) {
				script.charset = s.scriptCharset;
			}

			// Handle Script loading
			if ( !jsonp ) {
				var done = false;

				// Attach handlers for all browsers
				script.onload = script.onreadystatechange = function() {
					if ( !done &amp;&amp; (!this.readyState ||
							this.readyState === &quot;loaded&quot; || this.readyState === &quot;complete&quot;) ) {
						done = true;
						success();
						complete();

						// Handle memory leak in IE
						script.onload = script.onreadystatechange = null;
						if ( head &amp;&amp; script.parentNode ) {
							head.removeChild( script );
						}
					}
				};
			}

			// Use insertBefore instead of appendChild  to circumvent an IE6 bug.
			// This arises when a base node is used (#2709 and #4378).
			head.insertBefore( script, head.firstChild );

			// We handle everything using the script element injection
			return undefined;
		}

		var requestDone = false;

		// Create the request object
		var xhr = s.xhr();

		if ( !xhr ) {
			return;
		}

		// Open the socket
		// Passing null username, generates a login popup on Opera (#2865)
		if ( s.username ) {
			xhr.open(type, s.url, s.async, s.username, s.password);
		} else {
			xhr.open(type, s.url, s.async);
		}

		// Need an extra try/catch for cross domain requests in Firefox 3
		try {
			// Set the correct header, if data is being sent
			if ( s.data || origSettings &amp;&amp; origSettings.contentType ) {
				xhr.setRequestHeader(&quot;Content-Type&quot;, s.contentType);
			}

			// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
			if ( s.ifModified ) {
				if ( jQuery.lastModified[s.url] ) {
					xhr.setRequestHeader(&quot;If-Modified-Since&quot;, jQuery.lastModified[s.url]);
				}

				if ( jQuery.etag[s.url] ) {
					xhr.setRequestHeader(&quot;If-None-Match&quot;, jQuery.etag[s.url]);
				}
			}

			// Set header so the called script knows that it&apos;s an XMLHttpRequest
			// Only send the header if it&apos;s not a remote XHR
			if ( !remote ) {
				xhr.setRequestHeader(&quot;X-Requested-With&quot;, &quot;XMLHttpRequest&quot;);
			}

			// Set the Accepts header for the server, depending on the dataType
			xhr.setRequestHeader(&quot;Accept&quot;, s.dataType &amp;&amp; s.accepts[ s.dataType ] ?
				s.accepts[ s.dataType ] + &quot;, */*&quot; :
				s.accepts._default );
		} catch(e) {}

		// Allow custom headers/mimetypes and early abort
		if ( s.beforeSend &amp;&amp; s.beforeSend.call(callbackContext, xhr, s) === false ) {
			// Handle the global AJAX counter
			if ( s.global &amp;&amp; ! --jQuery.active ) {
				jQuery.event.trigger( &quot;ajaxStop&quot; );
			}

			// close opended socket
			xhr.abort();
			return false;
		}

		if ( s.global ) {
			trigger(&quot;ajaxSend&quot;, [xhr, s]);
		}

		// Wait for a response to come back
		var onreadystatechange = xhr.onreadystatechange = function( isTimeout ) {
			// The request was aborted
			if ( !xhr || xhr.readyState === 0 ) {
				// Opera doesn&apos;t call onreadystatechange before this point
				// so we simulate the call
				if ( !requestDone ) {
					complete();
				}

				requestDone = true;
				if ( xhr ) {
					xhr.onreadystatechange = jQuery.noop;
				}

			// The transfer is complete and the data is available, or the request timed out
			} else if ( !requestDone &amp;&amp; xhr &amp;&amp; (xhr.readyState === 4 || isTimeout === &quot;timeout&quot;) ) {
				requestDone = true;
				xhr.onreadystatechange = jQuery.noop;

				status = isTimeout === &quot;timeout&quot; ?
					&quot;timeout&quot; :
					!jQuery.httpSuccess( xhr ) ?
						&quot;error&quot; :
						s.ifModified &amp;&amp; jQuery.httpNotModified( xhr, s.url ) ?
							&quot;notmodified&quot; :
							&quot;success&quot;;

				if ( status === &quot;success&quot; ) {
					// Watch for, and catch, XML document parse errors
					try {
						// process the data (runs the xml through httpData regardless of callback)
						data = jQuery.httpData( xhr, s.dataType, s );
					} catch(e) {
						status = &quot;parsererror&quot;;
					}
				}

				// Make sure that the request was successful or notmodified
				if ( status === &quot;success&quot; || status === &quot;notmodified&quot; ) {
					// JSONP handles its own success callback
					if ( !jsonp ) {
						success();
					}
				} else {
					jQuery.handleError(s, xhr, status);
				}

				// Fire the complete handlers
				complete();

				if ( isTimeout === &quot;timeout&quot; ) {
					xhr.abort();
				}

				// Stop memory leaks
				if ( s.async ) {
					xhr = null;
				}
			}
		};

		// Override the abort handler, if we can (IE doesn&apos;t allow it, but that&apos;s OK)
		// Opera doesn&apos;t fire onreadystatechange at all on abort
		try {
			var oldAbort = xhr.abort;
			xhr.abort = function() {
				if ( xhr ) {
					oldAbort.call( xhr );
					if ( xhr ) {
						xhr.readyState = 0;
					}
				}

				onreadystatechange();
			};
		} catch(e) { }

		// Timeout checker
		if ( s.async &amp;&amp; s.timeout &gt; 0 ) {
			setTimeout(function() {
				// Check to see if the request is still happening
				if ( xhr &amp;&amp; !requestDone ) {
					onreadystatechange( &quot;timeout&quot; );
				}
			}, s.timeout);
		}

		// Send the data
		try {
			xhr.send( type === &quot;POST&quot; || type === &quot;PUT&quot; || type === &quot;DELETE&quot; ? s.data : null );
		} catch(e) {
			jQuery.handleError(s, xhr, null, e);
			// Fire the complete handlers
			complete();
		}

		// firefox 1.5 doesn&apos;t fire statechange for sync requests
		if ( !s.async ) {
			onreadystatechange();
		}

		function success() {
			// If a local callback was specified, fire it and pass it the data
			if ( s.success ) {
				s.success.call( callbackContext, data, status, xhr );
			}

			// Fire the global callback
			if ( s.global ) {
				trigger( &quot;ajaxSuccess&quot;, [xhr, s] );
			}
		}

		function complete() {
			// Process result
			if ( s.complete ) {
				s.complete.call( callbackContext, xhr, status);
			}

			// The request was completed
			if ( s.global ) {
				trigger( &quot;ajaxComplete&quot;, [xhr, s] );
			}

			// Handle the global AJAX counter
			if ( s.global &amp;&amp; ! --jQuery.active ) {
				jQuery.event.trigger( &quot;ajaxStop&quot; );
			}
		}
		
		function trigger(type, args) {
			(s.context ? jQuery(s.context) : jQuery.event).trigger(type, args);
		}

		// return XMLHttpRequest to allow aborting the request etc.
		return xhr;
	},

	handleError: function( s, xhr, status, e ) {
		// If a local callback was specified, fire it
		if ( s.error ) {
			s.error.call( s.context || window, xhr, status, e );
		}

		// Fire the global callback
		if ( s.global ) {
			(s.context ? jQuery(s.context) : jQuery.event).trigger( &quot;ajaxError&quot;, [xhr, s, e] );
		}
	},

	// Counter for holding the number of active queries
	active: 0,

	// Determines if an XMLHttpRequest was successful or not
	httpSuccess: function( xhr ) {
		try {
			// IE error sometimes returns 1223 when it should be 204 so treat it as success, see #1450
			return !xhr.status &amp;&amp; location.protocol === &quot;file:&quot; ||
				// Opera returns 0 when status is 304
				( xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300 ) ||
				xhr.status === 304 || xhr.status === 1223 || xhr.status === 0;
		} catch(e) {}

		return false;
	},

	// Determines if an XMLHttpRequest returns NotModified
	httpNotModified: function( xhr, url ) {
		var lastModified = xhr.getResponseHeader(&quot;Last-Modified&quot;),
			etag = xhr.getResponseHeader(&quot;Etag&quot;);

		if ( lastModified ) {
			jQuery.lastModified[url] = lastModified;
		}

		if ( etag ) {
			jQuery.etag[url] = etag;
		}

		// Opera returns 0 when status is 304
		return xhr.status === 304 || xhr.status === 0;
	},

	httpData: function( xhr, type, s ) {
		var ct = xhr.getResponseHeader(&quot;content-type&quot;) || &quot;&quot;,
			xml = type === &quot;xml&quot; || !type &amp;&amp; ct.indexOf(&quot;xml&quot;) &gt;= 0,
			data = xml ? xhr.responseXML : xhr.responseText;

		if ( xml &amp;&amp; data.documentElement.nodeName === &quot;parsererror&quot; ) {
			throw &quot;parsererror&quot;;
		}

		// Allow a pre-filtering function to sanitize the response
		// s is checked to keep backwards compatibility
		if ( s &amp;&amp; s.dataFilter ) {
			data = s.dataFilter( data, type );
		}

		// The filter can actually parse the response
		if ( typeof data === &quot;string&quot; ) {
			// Get the JavaScript object, if JSON is used.
			if ( type === &quot;json&quot; || !type &amp;&amp; ct.indexOf(&quot;json&quot;) &gt;= 0 ) {
				// Make sure the incoming data is actual JSON
				// Logic borrowed from http://json.org/json2.js
				if (/^[\],:{}\s]*$/.test(data.replace(/\\(?:[&quot;\\\/bfnrt]|u[0-9a-fA-F]{4})/g, &quot;@&quot;)
					.replace(/&quot;[^&quot;\\\n\r]*&quot;|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, &quot;]&quot;)
					.replace(/(?:^|:|,)(?:\s*\[)+/g, &quot;&quot;))) {

					// Try to use the native JSON parser first
					if ( window.JSON &amp;&amp; window.JSON.parse ) {
						data = window.JSON.parse( data );

					} else {
						data = (new Function(&quot;return &quot; + data))();
					}

				} else {
					throw &quot;Invalid JSON: &quot; + data;
				}

			// If the type is &quot;script&quot;, eval it in global context
			} else if ( type === &quot;script&quot; || !type &amp;&amp; ct.indexOf(&quot;javascript&quot;) &gt;= 0 ) {
				jQuery.globalEval( data );
			}
		}

		return data;
	},

	// Serialize an array of form elements or a set of
	// key/values into a query string
	param: function( a, traditional ) {
		
		var s = [];
		
		// Set traditional to true for jQuery &lt;= 1.3.2 behavior.
		if ( traditional === undefined ) {
			traditional = jQuery.ajaxSettings.traditional;
		}
		
		function add( key, value ) {
			// If value is a function, invoke it and return its value
			value = jQuery.isFunction(value) ? value() : value;
			s[ s.length ] = encodeURIComponent(key) + &quot;=&quot; + encodeURIComponent(value);
		}
		
		// If an array was passed in, assume that it is an array of form elements.
		if ( jQuery.isArray(a) || a.jquery ) {
			// Serialize the form elements
			jQuery.each( a, function() {
				add( this.name, this.value );
			});
			
		} else {
			// If traditional, encode the &quot;old&quot; way (the way 1.3.2 or older
			// did it), otherwise encode params recursively.
			jQuery.each( a, function buildParams( prefix, obj ) {
				
				if ( jQuery.isArray(obj) ) {
					// Serialize array item.
					jQuery.each( obj, function( i, v ) {
						if ( traditional ) {
							// Treat each array item as a scalar.
							add( prefix, v );
						} else {
							// If array item is non-scalar (array or object), encode its
							// numeric index to resolve deserialization ambiguity issues.
							// Note that rack (as of 1.0.0) can&apos;t currently deserialize
							// nested arrays properly, and attempting to do so may cause
							// a server error. Possible fixes are to modify rack&apos;s
							// deserialization algorithm or to provide an option or flag
							// to force array serialization to be shallow.
							buildParams( prefix + &quot;[&quot; + ( typeof v === &quot;object&quot; || jQuery.isArray(v) ? i : &quot;&quot; ) + &quot;]&quot;, v );
						}
					});
					
				} else if ( !traditional &amp;&amp; obj != null &amp;&amp; typeof obj === &quot;object&quot; ) {
					// Serialize object item.
					jQuery.each( obj, function( k, v ) {
						buildParams( prefix + &quot;[&quot; + k + &quot;]&quot;, v );
					});
					
				} else {
					// Serialize scalar item.
					add( prefix, obj );
				}
			});
		}
		
		// Return the resulting serialization
		return s.join(&quot;&amp;&quot;).replace(r20, &quot;+&quot;);
	}

});
var elemdisplay = {},
	rfxtypes = /toggle|show|hide/,
	rfxnum = /^([+-]=)?([\d+-.]+)(.*)$/,
	timerId,
	fxAttrs = [
		// height animations
		[ &quot;height&quot;, &quot;marginTop&quot;, &quot;marginBottom&quot;, &quot;paddingTop&quot;, &quot;paddingBottom&quot; ],
		// width animations
		[ &quot;width&quot;, &quot;marginLeft&quot;, &quot;marginRight&quot;, &quot;paddingLeft&quot;, &quot;paddingRight&quot; ],
		// opacity animations
		[ &quot;opacity&quot; ]
	];

jQuery.fn.extend({
	show: function( speed, callback ) {
		if ( speed != null ) {
			return this.animate( genFx(&quot;show&quot;, 3), speed, callback);

		} else {
			for ( var i = 0, l = this.length; i &lt; l; i++ ) {
				var old = jQuery.data(this[i], &quot;olddisplay&quot;);

				this[i].style.display = old || &quot;&quot;;

				if ( jQuery.css(this[i], &quot;display&quot;) === &quot;none&quot; ) {
					var nodeName = this[i].nodeName, display;

					if ( elemdisplay[ nodeName ] ) {
						display = elemdisplay[ nodeName ];

					} else {
						var elem = jQuery(&quot;&lt;&quot; + nodeName + &quot; /&gt;&quot;).appendTo(&quot;body&quot;);

						display = elem.css(&quot;display&quot;);

						if ( display === &quot;none&quot; ) {
							display = &quot;block&quot;;
						}

						elem.remove();

						elemdisplay[ nodeName ] = display;
					}

					jQuery.data(this[i], &quot;olddisplay&quot;, display);
				}
			}

			// Set the display of the elements in a second loop
			// to avoid the constant reflow
			for ( var j = 0, k = this.length; j &lt; k; j++ ) {
				this[j].style.display = jQuery.data(this[j], &quot;olddisplay&quot;) || &quot;&quot;;
			}

			return this;
		}
	},

	hide: function( speed, callback ) {
		if ( speed != null ) {
			return this.animate( genFx(&quot;hide&quot;, 3), speed, callback);

		} else {
			for ( var i = 0, l = this.length; i &lt; l; i++ ) {
				var old = jQuery.data(this[i], &quot;olddisplay&quot;);
				if ( !old &amp;&amp; old !== &quot;none&quot; ) {
					jQuery.data(this[i], &quot;olddisplay&quot;, jQuery.css(this[i], &quot;display&quot;));
				}
			}

			// Set the display of the elements in a second loop
			// to avoid the constant reflow
			for ( var j = 0, k = this.length; j &lt; k; j++ ) {
				this[j].style.display = &quot;none&quot;;
			}

			return this;
		}
	},

	// Save the old toggle function
	_toggle: jQuery.fn.toggle,

	toggle: function( fn, fn2 ) {
		var bool = typeof fn === &quot;boolean&quot;;

		if ( jQuery.isFunction(fn) &amp;&amp; jQuery.isFunction(fn2) ) {
			this._toggle.apply( this, arguments );

		} else if ( fn == null || bool ) {
			this.each(function() {
				var state = bool ? fn : jQuery(this).is(&quot;:hidden&quot;);
				jQuery(this)[ state ? &quot;show&quot; : &quot;hide&quot; ]();
			});

		} else {
			this.animate(genFx(&quot;toggle&quot;, 3), fn, fn2);
		}

		return this;
	},

	fadeTo: function( speed, to, callback ) {
		return this.filter(&quot;:hidden&quot;).css(&quot;opacity&quot;, 0).show().end()
					.animate({opacity: to}, speed, callback);
	},

	animate: function( prop, speed, easing, callback ) {
		var optall = jQuery.speed(speed, easing, callback);

		if ( jQuery.isEmptyObject( prop ) ) {
			return this.each( optall.complete );
		}

		return this[ optall.queue === false ? &quot;each&quot; : &quot;queue&quot; ](function() {
			var opt = jQuery.extend({}, optall), p,
				hidden = this.nodeType === 1 &amp;&amp; jQuery(this).is(&quot;:hidden&quot;),
				self = this;

			for ( p in prop ) {
				var name = p.replace(rdashAlpha, fcamelCase);

				if ( p !== name ) {
					prop[ name ] = prop[ p ];
					delete prop[ p ];
					p = name;
				}

				if ( prop[p] === &quot;hide&quot; &amp;&amp; hidden || prop[p] === &quot;show&quot; &amp;&amp; !hidden ) {
					return opt.complete.call(this);
				}

				if ( ( p === &quot;height&quot; || p === &quot;width&quot; ) &amp;&amp; this.style ) {
					// Store display property
					opt.display = jQuery.css(this, &quot;display&quot;);

					// Make sure that nothing sneaks out
					opt.overflow = this.style.overflow;
				}

				if ( jQuery.isArray( prop[p] ) ) {
					// Create (if needed) and add to specialEasing
					(opt.specialEasing = opt.specialEasing || {})[p] = prop[p][1];
					prop[p] = prop[p][0];
				}
			}

			if ( opt.overflow != null ) {
				this.style.overflow = &quot;hidden&quot;;
			}

			opt.curAnim = jQuery.extend({}, prop);

			jQuery.each( prop, function( name, val ) {
				var e = new jQuery.fx( self, opt, name );

				if ( rfxtypes.test(val) ) {
					e[ val === &quot;toggle&quot; ? hidden ? &quot;show&quot; : &quot;hide&quot; : val ]( prop );

				} else {
					var parts = rfxnum.exec(val),
						start = e.cur(true) || 0;

					if ( parts ) {
						var end = parseFloat( parts[2] ),
							unit = parts[3] || &quot;px&quot;;

						// We need to compute starting value
						if ( unit !== &quot;px&quot; ) {
							self.style[ name ] = (end || 1) + unit;
							start = ((end || 1) / e.cur(true)) * start;
							self.style[ name ] = start + unit;
						}

						// If a +=/-= token was provided, we&apos;re doing a relative animation
						if ( parts[1] ) {
							end = ((parts[1] === &quot;-=&quot; ? -1 : 1) * end) + start;
						}

						e.custom( start, end, unit );

					} else {
						e.custom( start, val, &quot;&quot; );
					}
				}
			});

			// For JS strict compliance
			return true;
		});
	},

	stop: function( clearQueue, gotoEnd ) {
		var timers = jQuery.timers;

		if ( clearQueue ) {
			this.queue([]);
		}

		this.each(function() {
			// go in reverse order so anything added to the queue during the loop is ignored
			for ( var i = timers.length - 1; i &gt;= 0; i-- ) {
				if ( timers[i].elem === this ) {
					if (gotoEnd) {
						// force the next step to be the last
						timers[i](true);
					}

					timers.splice(i, 1);
				}
			}
		});

		// start the next in the queue if the last step wasn&apos;t forced
		if ( !gotoEnd ) {
			this.dequeue();
		}

		return this;
	}

});

// Generate shortcuts for custom animations
jQuery.each({
	slideDown: genFx(&quot;show&quot;, 1),
	slideUp: genFx(&quot;hide&quot;, 1),
	slideToggle: genFx(&quot;toggle&quot;, 1),
	fadeIn: { opacity: &quot;show&quot; },
	fadeOut: { opacity: &quot;hide&quot; }
}, function( name, props ) {
	jQuery.fn[ name ] = function( speed, callback ) {
		return this.animate( props, speed, callback );
	};
});

jQuery.extend({
	speed: function( speed, easing, fn ) {
		var opt = speed &amp;&amp; typeof speed === &quot;object&quot; ? speed : {
			complete: fn || !fn &amp;&amp; easing ||
				jQuery.isFunction( speed ) &amp;&amp; speed,
			duration: speed,
			easing: fn &amp;&amp; easing || easing &amp;&amp; !jQuery.isFunction(easing) &amp;&amp; easing
		};

		opt.duration = jQuery.fx.off ? 0 : typeof opt.duration === &quot;number&quot; ? opt.duration :
			jQuery.fx.speeds[opt.duration] || jQuery.fx.speeds._default;

		// Queueing
		opt.old = opt.complete;
		opt.complete = function() {
			if ( opt.queue !== false ) {
				jQuery(this).dequeue();
			}
			if ( jQuery.isFunction( opt.old ) ) {
				opt.old.call( this );
			}
		};

		return opt;
	},

	easing: {
		linear: function( p, n, firstNum, diff ) {
			return firstNum + diff * p;
		},
		swing: function( p, n, firstNum, diff ) {
			return ((-Math.cos(p*Math.PI)/2) + 0.5) * diff + firstNum;
		}
	},

	timers: [],

	fx: function( elem, options, prop ) {
		this.options = options;
		this.elem = elem;
		this.prop = prop;

		if ( !options.orig ) {
			options.orig = {};
		}
	}

});

jQuery.fx.prototype = {
	// Simple function for setting a style value
	update: function() {
		if ( this.options.step ) {
			this.options.step.call( this.elem, this.now, this );
		}

		(jQuery.fx.step[this.prop] || jQuery.fx.step._default)( this );

		// Set display property to block for height/width animations
		if ( ( this.prop === &quot;height&quot; || this.prop === &quot;width&quot; ) &amp;&amp; this.elem.style ) {
			this.elem.style.display = &quot;block&quot;;
		}
	},

	// Get the current size
	cur: function( force ) {
		if ( this.elem[this.prop] != null &amp;&amp; (!this.elem.style || this.elem.style[this.prop] == null) ) {
			return this.elem[ this.prop ];
		}

		var r = parseFloat(jQuery.css(this.elem, this.prop, force));
		return r &amp;&amp; r &gt; -10000 ? r : parseFloat(jQuery.curCSS(this.elem, this.prop)) || 0;
	},

	// Start an animation from one number to another
	custom: function( from, to, unit ) {
		this.startTime = now();
		this.start = from;
		this.end = to;
		this.unit = unit || this.unit || &quot;px&quot;;
		this.now = this.start;
		this.pos = this.state = 0;

		var self = this;
		function t( gotoEnd ) {
			return self.step(gotoEnd);
		}

		t.elem = this.elem;

		if ( t() &amp;&amp; jQuery.timers.push(t) &amp;&amp; !timerId ) {
			timerId = setInterval(jQuery.fx.tick, 13);
		}
	},

	// Simple &apos;show&apos; function
	show: function() {
		// Remember where we started, so that we can go back to it later
		this.options.orig[this.prop] = jQuery.style( this.elem, this.prop );
		this.options.show = true;

		// Begin the animation
		// Make sure that we start at a small width/height to avoid any
		// flash of content
		this.custom(this.prop === &quot;width&quot; || this.prop === &quot;height&quot; ? 1 : 0, this.cur());

		// Start by showing the element
		jQuery( this.elem ).show();
	},

	// Simple &apos;hide&apos; function
	hide: function() {
		// Remember where we started, so that we can go back to it later
		this.options.orig[this.prop] = jQuery.style( this.elem, this.prop );
		this.options.hide = true;

		// Begin the animation
		this.custom(this.cur(), 0);
	},

	// Each step of an animation
	step: function( gotoEnd ) {
		var t = now(), done = true;

		if ( gotoEnd || t &gt;= this.options.duration + this.startTime ) {
			this.now = this.end;
			this.pos = this.state = 1;
			this.update();

			this.options.curAnim[ this.prop ] = true;

			for ( var i in this.options.curAnim ) {
				if ( this.options.curAnim[i] !== true ) {
					done = false;
				}
			}

			if ( done ) {
				if ( this.options.display != null ) {
					// Reset the overflow
					this.elem.style.overflow = this.options.overflow;

					// Reset the display
					var old = jQuery.data(this.elem, &quot;olddisplay&quot;);
					this.elem.style.display = old ? old : this.options.display;

					if ( jQuery.css(this.elem, &quot;display&quot;) === &quot;none&quot; ) {
						this.elem.style.display = &quot;block&quot;;
					}
				}

				// Hide the element if the &quot;hide&quot; operation was done
				if ( this.options.hide ) {
					jQuery(this.elem).hide();
				}

				// Reset the properties, if the item has been hidden or shown
				if ( this.options.hide || this.options.show ) {
					for ( var p in this.options.curAnim ) {
						jQuery.style(this.elem, p, this.options.orig[p]);
					}
				}

				// Execute the complete function
				this.options.complete.call( this.elem );
			}

			return false;

		} else {
			var n = t - this.startTime;
			this.state = n / this.options.duration;

			// Perform the easing function, defaults to swing
			var specialEasing = this.options.specialEasing &amp;&amp; this.options.specialEasing[this.prop];
			var defaultEasing = this.options.easing || (jQuery.easing.swing ? &quot;swing&quot; : &quot;linear&quot;);
			this.pos = jQuery.easing[specialEasing || defaultEasing](this.state, n, 0, 1, this.options.duration);
			this.now = this.start + ((this.end - this.start) * this.pos);

			// Perform the next step of the animation
			this.update();
		}

		return true;
	}
};

jQuery.extend( jQuery.fx, {
	tick: function() {
		var timers = jQuery.timers;

		for ( var i = 0; i &lt; timers.length; i++ ) {
			if ( !timers[i]() ) {
				timers.splice(i--, 1);
			}
		}

		if ( !timers.length ) {
			jQuery.fx.stop();
		}
	},
		
	stop: function() {
		clearInterval( timerId );
		timerId = null;
	},
	
	speeds: {
		slow: 600,
 		fast: 200,
 		// Default speed
 		_default: 400
	},

	step: {
		opacity: function( fx ) {
			jQuery.style(fx.elem, &quot;opacity&quot;, fx.now);
		},

		_default: function( fx ) {
			if ( fx.elem.style &amp;&amp; fx.elem.style[ fx.prop ] != null ) {
				fx.elem.style[ fx.prop ] = (fx.prop === &quot;width&quot; || fx.prop === &quot;height&quot; ? Math.max(0, fx.now) : fx.now) + fx.unit;
			} else {
				fx.elem[ fx.prop ] = fx.now;
			}
		}
	}
});

if ( jQuery.expr &amp;&amp; jQuery.expr.filters ) {
	jQuery.expr.filters.animated = function( elem ) {
		return jQuery.grep(jQuery.timers, function( fn ) {
			return elem === fn.elem;
		}).length;
	};
}

function genFx( type, num ) {
	var obj = {};

	jQuery.each( fxAttrs.concat.apply([], fxAttrs.slice(0,num)), function() {
		obj[ this ] = type;
	});

	return obj;
}
if ( &quot;getBoundingClientRect&quot; in document.documentElement ) {
	jQuery.fn.offset = function( options ) {
		var elem = this[0];

		if ( !elem || !elem.ownerDocument ) {
			return null;
		}

		if ( options ) { 
			return this.each(function( i ) {
				jQuery.offset.setOffset( this, options, i );
			});
		}

		if ( elem === elem.ownerDocument.body ) {
			return jQuery.offset.bodyOffset( elem );
		}

		var box = elem.getBoundingClientRect(), doc = elem.ownerDocument, body = doc.body, docElem = doc.documentElement,
			clientTop = docElem.clientTop || body.clientTop || 0, clientLeft = docElem.clientLeft || body.clientLeft || 0,
			top  = box.top  + (self.pageYOffset || jQuery.support.boxModel &amp;&amp; docElem.scrollTop  || body.scrollTop ) - clientTop,
			left = box.left + (self.pageXOffset || jQuery.support.boxModel &amp;&amp; docElem.scrollLeft || body.scrollLeft) - clientLeft;

		return { top: top, left: left };
	};

} else {
	jQuery.fn.offset = function( options ) {
		var elem = this[0];

		if ( !elem || !elem.ownerDocument ) {
			return null;
		}

		if ( options ) { 
			return this.each(function( i ) {
				jQuery.offset.setOffset( this, options, i );
			});
		}

		if ( elem === elem.ownerDocument.body ) {
			return jQuery.offset.bodyOffset( elem );
		}

		jQuery.offset.initialize();

		var offsetParent = elem.offsetParent, prevOffsetParent = elem,
			doc = elem.ownerDocument, computedStyle, docElem = doc.documentElement,
			body = doc.body, defaultView = doc.defaultView,
			prevComputedStyle = defaultView ? defaultView.getComputedStyle( elem, null ) : elem.currentStyle,
			top = elem.offsetTop, left = elem.offsetLeft;

		while ( (elem = elem.parentNode) &amp;&amp; elem !== body &amp;&amp; elem !== docElem ) {
			if ( jQuery.offset.supportsFixedPosition &amp;&amp; prevComputedStyle.position === &quot;fixed&quot; ) {
				break;
			}

			computedStyle = defaultView ? defaultView.getComputedStyle(elem, null) : elem.currentStyle;
			top  -= elem.scrollTop;
			left -= elem.scrollLeft;

			if ( elem === offsetParent ) {
				top  += elem.offsetTop;
				left += elem.offsetLeft;

				if ( jQuery.offset.doesNotAddBorder &amp;&amp; !(jQuery.offset.doesAddBorderForTableAndCells &amp;&amp; /^t(able|d|h)$/i.test(elem.nodeName)) ) {
					top  += parseFloat( computedStyle.borderTopWidth  ) || 0;
					left += parseFloat( computedStyle.borderLeftWidth ) || 0;
				}

				prevOffsetParent = offsetParent, offsetParent = elem.offsetParent;
			}

			if ( jQuery.offset.subtractsBorderForOverflowNotVisible &amp;&amp; computedStyle.overflow !== &quot;visible&quot; ) {
				top  += parseFloat( computedStyle.borderTopWidth  ) || 0;
				left += parseFloat( computedStyle.borderLeftWidth ) || 0;
			}

			prevComputedStyle = computedStyle;
		}

		if ( prevComputedStyle.position === &quot;relative&quot; || prevComputedStyle.position === &quot;static&quot; ) {
			top  += body.offsetTop;
			left += body.offsetLeft;
		}

		if ( jQuery.offset.supportsFixedPosition &amp;&amp; prevComputedStyle.position === &quot;fixed&quot; ) {
			top  += Math.max( docElem.scrollTop, body.scrollTop );
			left += Math.max( docElem.scrollLeft, body.scrollLeft );
		}

		return { top: top, left: left };
	};
}

jQuery.offset = {
	initialize: function() {
		var body = document.body, container = document.createElement(&quot;div&quot;), innerDiv, checkDiv, table, td, bodyMarginTop = parseFloat( jQuery.curCSS(body, &quot;marginTop&quot;, true) ) || 0,
			html = &quot;&lt;div style=&apos;position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;&apos;&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;table style=&apos;position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;&apos; cellpadding=&apos;0&apos; cellspacing=&apos;0&apos;&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;;

		jQuery.extend( container.style, { position: &quot;absolute&quot;, top: 0, left: 0, margin: 0, border: 0, width: &quot;1px&quot;, height: &quot;1px&quot;, visibility: &quot;hidden&quot; } );

		container.innerHTML = html;
		body.insertBefore( container, body.firstChild );
		innerDiv = container.firstChild;
		checkDiv = innerDiv.firstChild;
		td = innerDiv.nextSibling.firstChild.firstChild;

		this.doesNotAddBorder = (checkDiv.offsetTop !== 5);
		this.doesAddBorderForTableAndCells = (td.offsetTop === 5);

		checkDiv.style.position = &quot;fixed&quot;, checkDiv.style.top = &quot;20px&quot;;
		// safari subtracts parent border width here which is 5px
		this.supportsFixedPosition = (checkDiv.offsetTop === 20 || checkDiv.offsetTop === 15);
		checkDiv.style.position = checkDiv.style.top = &quot;&quot;;

		innerDiv.style.overflow = &quot;hidden&quot;, innerDiv.style.position = &quot;relative&quot;;
		this.subtractsBorderForOverflowNotVisible = (checkDiv.offsetTop === -5);

		this.doesNotIncludeMarginInBodyOffset = (body.offsetTop !== bodyMarginTop);

		body.removeChild( container );
		body = container = innerDiv = checkDiv = table = td = null;
		jQuery.offset.initialize = jQuery.noop;
	},

	bodyOffset: function( body ) {
		var top = body.offsetTop, left = body.offsetLeft;

		jQuery.offset.initialize();

		if ( jQuery.offset.doesNotIncludeMarginInBodyOffset ) {
			top  += parseFloat( jQuery.curCSS(body, &quot;marginTop&quot;,  true) ) || 0;
			left += parseFloat( jQuery.curCSS(body, &quot;marginLeft&quot;, true) ) || 0;
		}

		return { top: top, left: left };
	},
	
	setOffset: function( elem, options, i ) {
		// set position first, in-case top/left are set even on static elem
		if ( /static/.test( jQuery.curCSS( elem, &quot;position&quot; ) ) ) {
			elem.style.position = &quot;relative&quot;;
		}
		var curElem   = jQuery( elem ),
			curOffset = curElem.offset(),
			curTop    = parseInt( jQuery.curCSS( elem, &quot;top&quot;,  true ), 10 ) || 0,
			curLeft   = parseInt( jQuery.curCSS( elem, &quot;left&quot;, true ), 10 ) || 0;

		if ( jQuery.isFunction( options ) ) {
			options = options.call( elem, i, curOffset );
		}

		var props = {
			top:  (options.top  - curOffset.top)  + curTop,
			left: (options.left - curOffset.left) + curLeft
		};
		
		if ( &quot;using&quot; in options ) {
			options.using.call( elem, props );
		} else {
			curElem.css( props );
		}
	}
};


jQuery.fn.extend({
	position: function() {
		if ( !this[0] ) {
			return null;
		}

		var elem = this[0],

		// Get *real* offsetParent
		offsetParent = this.offsetParent(),

		// Get correct offsets
		offset       = this.offset(),
		parentOffset = /^body|html$/i.test(offsetParent[0].nodeName) ? { top: 0, left: 0 } : offsetParent.offset();

		// Subtract element margins
		// note: when an element has margin: auto the offsetLeft and marginLeft
		// are the same in Safari causing offset.left to incorrectly be 0
		offset.top  -= parseFloat( jQuery.curCSS(elem, &quot;marginTop&quot;,  true) ) || 0;
		offset.left -= parseFloat( jQuery.curCSS(elem, &quot;marginLeft&quot;, true) ) || 0;

		// Add offsetParent borders
		parentOffset.top  += parseFloat( jQuery.curCSS(offsetParent[0], &quot;borderTopWidth&quot;,  true) ) || 0;
		parentOffset.left += parseFloat( jQuery.curCSS(offsetParent[0], &quot;borderLeftWidth&quot;, true) ) || 0;

		// Subtract the two offsets
		return {
			top:  offset.top  - parentOffset.top,
			left: offset.left - parentOffset.left
		};
	},

	offsetParent: function() {
		return this.map(function() {
			var offsetParent = this.offsetParent || document.body;
			while ( offsetParent &amp;&amp; (!/^body|html$/i.test(offsetParent.nodeName) &amp;&amp; jQuery.css(offsetParent, &quot;position&quot;) === &quot;static&quot;) ) {
				offsetParent = offsetParent.offsetParent;
			}
			return offsetParent;
		});
	}
});


// Create scrollLeft and scrollTop methods
jQuery.each( [&quot;Left&quot;, &quot;Top&quot;], function( i, name ) {
	var method = &quot;scroll&quot; + name;

	jQuery.fn[ method ] = function(val) {
		var elem = this[0], win;
		
		if ( !elem ) {
			return null;
		}

		if ( val !== undefined ) {
			// Set the scroll offset
			return this.each(function() {
				win = getWindow( this );

				if ( win ) {
					win.scrollTo(
						!i ? val : jQuery(win).scrollLeft(),
						 i ? val : jQuery(win).scrollTop()
					);

				} else {
					this[ method ] = val;
				}
			});
		} else {
			win = getWindow( elem );

			// Return the scroll offset
			return win ? (&quot;pageXOffset&quot; in win) ? win[ i ? &quot;pageYOffset&quot; : &quot;pageXOffset&quot; ] :
				jQuery.support.boxModel &amp;&amp; win.document.documentElement[ method ] ||
					win.document.body[ method ] :
				elem[ method ];
		}
	};
});

function getWindow( elem ) {
	return (&quot;scrollTo&quot; in elem &amp;&amp; elem.document) ?
		elem :
		elem.nodeType === 9 ?
			elem.defaultView || elem.parentWindow :
			false;
}
// Create innerHeight, innerWidth, outerHeight and outerWidth methods
jQuery.each([ &quot;Height&quot;, &quot;Width&quot; ], function( i, name ) {

	var type = name.toLowerCase();

	// innerHeight and innerWidth
	jQuery.fn[&quot;inner&quot; + name] = function() {
		return this[0] ?
			jQuery.css( this[0], type, false, &quot;padding&quot; ) :
			null;
	};

	// outerHeight and outerWidth
	jQuery.fn[&quot;outer&quot; + name] = function( margin ) {
		return this[0] ?
			jQuery.css( this[0], type, false, margin ? &quot;margin&quot; : &quot;border&quot; ) :
			null;
	};

	jQuery.fn[ type ] = function( size ) {
		// Get window width or height
		var elem = this[0];
		if ( !elem ) {
			return size == null ? null : this;
		}

		return (&quot;scrollTo&quot; in elem &amp;&amp; elem.document) ? // does it walk and quack like a window?
			// Everyone else use document.documentElement or document.body depending on Quirks vs Standards mode
			elem.document.compatMode === &quot;CSS1Compat&quot; &amp;&amp; elem.document.documentElement[ &quot;client&quot; + name ] ||
			elem.document.body[ &quot;client&quot; + name ] :

			// Get document width or height
			(elem.nodeType === 9) ? // is it a document
				// Either scroll[Width/Height] or offset[Width/Height], whichever is greater
				Math.max(
					elem.documentElement[&quot;client&quot; + name],
					elem.body[&quot;scroll&quot; + name], elem.documentElement[&quot;scroll&quot; + name],
					elem.body[&quot;offset&quot; + name], elem.documentElement[&quot;offset&quot; + name]
				) :

				// Get or set width or height on the element
				size === undefined ?
					// Get width or height on the element
					jQuery.css( elem, type ) :

					// Set the width or height on the element (default to pixels if value is unitless)
					this.css( type, typeof size === &quot;string&quot; ? size : size + &quot;px&quot; );
	};

});
// Expose jQuery to the global object
window.jQuery = window.$ = jQuery;

})(window);
</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/jquery-1.4.js</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022287" s="true" lb="/iceweb/js/common.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" de="" by="1545" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 1161
Set-Cookie: JSESSIONID=7d99a7acb92729a95aad388f9cca9ecfac41422dc040fb47315ee7b64ccd8db9; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: application/x-javascript
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: */*
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">&#xd;
function getById(id) { &#xd;
	return document.getElementById(id); &#xd;
}&#xd;
&#xd;
function desplegarContraer(cual,desde) {&#xd;
	var elElemento=document.getElementById(cual);&#xd;
	if(elElemento.className == &apos;elementoVisible&apos;) {&#xd;
	     elElemento.className = &apos;elementoOculto&apos;;&#xd;
	     desde.className = &apos;linkContraido&apos;;&#xd;
	} else {&#xd;
	     elElemento.className = &apos;elementoVisible&apos;;&#xd;
	     desde.className = &apos;linkExpandido&apos;;&#xd;
	}&#xd;
}&#xd;
&#xd;
/**&#xd;
 * Obtiene un parÃ¡metro de la url&#xd;
 * @param name Nombre del parÃ¡metro&#xd;
 * @return Valor del parÃ¡metro&#xd;
 */&#xd;
function getUrlParam(name) {&#xd;
  name = name.replace(/[\[]/,&quot;\\\[&quot;).replace(/[\]]/,&quot;\\\]&quot;);&#xd;
  var regexS = &quot;[\\?&amp;]&quot;+name+&quot;=([^&amp;#]*)&quot;;&#xd;
  var regex = new RegExp( regexS );&#xd;
  var results = regex.exec( window.location.href );&#xd;
  if( results == null )&#xd;
    return null;&#xd;
  else&#xd;
    return decodeURIComponent(results[1]);&#xd;
}&#xd;
&#xd;
/**&#xd;
 * Obtiene la ruta raÃ­z de la aplicaciÃ³n web (ej: /iceweb)&#xd;
 */&#xd;
function getAppRootPath() {&#xd;
	var pathname = window.location.pathname;  // window.location.pathname;&#xd;
    var posSegBarra = pathname.indexOf(&apos;/&apos;, 1);&#xd;
    if (posSegBarra==-1) return &apos;/&apos;;&#xd;
    return pathname.substr(0, posSegBarra);&#xd;
}</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/common.js</java.net.URL>
</httpSample>
<httpSample t="3" it="0" lt="2" ts="1315465022292" s="true" lb="/iceweb/js/flexigrid/CentroPagedGrid.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" de="" by="42752" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=8ddf102337780839c416af3593333eda70bf95c526863ad0122b40fce58bb6b7; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: application/x-javascript
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: */*
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">/*&#xd;
 * VersiÃ³n modificada del Flexigrid for jQuery de Paulo P. Marinas:&#xd;
 *&#xd;
 * Copyright (c) 2008 Paulo P. Marinas (webplicity.net/flexigrid)&#xd;
 * Dual licensed under the MIT (MIT-LICENSE.txt)&#xd;
 * and GPL (GPL-LICENSE.txt) licenses.&#xd;
 *&#xd;
 * $Date: 2008-07-14 00:09:43 +0800 (Tue, 14 Jul 2008) $&#xd;
 */ &#xd;
(function($){&#xd;
		  &#xd;
	var docloaded = false;&#xd;
&#xd;
	$(document).ready(function () {docloaded = true} );&#xd;
&#xd;
	$.fn.flexigrid = function(p) {&#xd;
&#xd;
		return this.each( function() {&#xd;
				if (!docloaded)&#xd;
				{&#xd;
					$(this).hide();&#xd;
					var t = this;&#xd;
					$(document).ready&#xd;
					(&#xd;
						function ()&#xd;
						{&#xd;
						$.addFlex(t,p);&#xd;
						}&#xd;
					);&#xd;
				} else {&#xd;
					$.addFlex(this,p);&#xd;
				}&#xd;
			});&#xd;
&#xd;
	}; //end flexigrid&#xd;
&#xd;
	$.fn.flexReload = function(p) { // function to reload grid&#xd;
&#xd;
		return this.each( function() {&#xd;
				if (this.grid&amp;&amp;this.p.url) this.grid.populate();&#xd;
			});&#xd;
&#xd;
	}; //end flexReload&#xd;
&#xd;
	$.fn.flexOptions = function(p) { //function to update general options&#xd;
&#xd;
		return this.each( function() {&#xd;
				if (this.grid) $.extend(this.p,p);&#xd;
			});&#xd;
&#xd;
	}; //end flexOptions&#xd;
&#xd;
	$.fn.flexToggleCol = function(cid,visible) { // function to reload grid&#xd;
&#xd;
		return this.each( function() {&#xd;
				if (this.grid) this.grid.toggleCol(cid,visible);&#xd;
			});&#xd;
&#xd;
	}; //end flexToggleCol&#xd;
&#xd;
	$.fn.flexAddData = function(data) { // function to add data to grid&#xd;
&#xd;
		return this.each( function() {&#xd;
				if (this.grid) this.grid.addData(data);&#xd;
			});&#xd;
&#xd;
	};&#xd;
&#xd;
	$.fn.noSelect = function(p) { //no select plugin by me :-)&#xd;
&#xd;
		if (p == null) &#xd;
			prevent = true;&#xd;
		else&#xd;
			prevent = p;&#xd;
&#xd;
		if (prevent) {&#xd;
		&#xd;
		return this.each(function ()&#xd;
			{&#xd;
				if ($.browser.msie||$.browser.safari) $(this).bind(&apos;selectstart&apos;,function(){return false;});&#xd;
				else if ($.browser.mozilla) &#xd;
					{&#xd;
						$(this).css(&apos;MozUserSelect&apos;,&apos;none&apos;);&#xd;
						$(&apos;body&apos;).trigger(&apos;focus&apos;);&#xd;
					}&#xd;
				else if ($.browser.opera) $(this).bind(&apos;mousedown&apos;,function(){return false;});&#xd;
				else $(this).attr(&apos;unselectable&apos;,&apos;on&apos;);&#xd;
			});&#xd;
			&#xd;
		} else {&#xd;
&#xd;
		&#xd;
		return this.each(function ()&#xd;
			{&#xd;
				if ($.browser.msie||$.browser.safari) $(this).unbind(&apos;selectstart&apos;);&#xd;
				else if ($.browser.mozilla) $(this).css(&apos;MozUserSelect&apos;,&apos;inherit&apos;);&#xd;
				else if ($.browser.opera) $(this).unbind(&apos;mousedown&apos;);&#xd;
				else $(this).removeAttr(&apos;unselectable&apos;,&apos;on&apos;);&#xd;
			});&#xd;
		&#xd;
		}&#xd;
&#xd;
	}; //end noSelect&#xd;
		&#xd;
})(jQuery);&#xd;
&#xd;
&#xd;
var CentroPagedGrid = function(t,p) {&#xd;
		t = $(&quot;#&quot;+t);&#xd;
&#xd;
		if (t.grid) return false; //return if already exist	&#xd;
&#xd;
		// apply default properties&#xd;
		p = $.extend({&#xd;
			singleSelect: true,&#xd;
			colModel : [&#xd;
				{display: &apos;CÃ³digo&apos;, name : &apos;codigo&apos;, width : 60, sortable : true, align: &apos;center&apos;},&#xd;
				{display: &apos;Nombre&apos;, name : &apos;despecifica&apos;, width : 150, sortable : true, align: &apos;left&apos;},&#xd;
				{display: &apos;Provincia&apos;, name : &apos;provincia&apos;, width : 50, sortable : true, align: &apos;left&apos;, hide: true},&#xd;
				{display: &apos;RÃ©gimen&apos;, name : &apos;regimen&apos;, width : 30, sortable : true, align: &apos;center&apos;, hide: true},&#xd;
				{display: &apos;Tickets&apos;, name : &apos;numTicketsAbiertos&apos;, width : 30, sortable : true, align: &apos;right&apos;, hide: true},&#xd;
				{display: &apos;Items&apos;, name : &apos;numItemsFamilia&apos;, width : 25, sortable : true, align: &apos;right&apos;, hide: true}&#xd;
			],&#xd;
			sortname: &apos;despecifica&apos;,&#xd;
			sortorder: true,&#xd;
			 height: 200, //default height&#xd;
			 width: &apos;auto&apos;, //auto width&#xd;
			 striped: true, //apply odd even stripes&#xd;
			 novstripe: false,&#xd;
			 minwidth: 30, //min width of columns&#xd;
			 minheight: 80, //min height of columns&#xd;
			 resizable: true, //resizable table&#xd;
			 url: &apos;restful/Centro/findPagedByVentanaAndFilter&apos;,&#xd;
			 method: &apos;GET&apos;,&#xd;
			 dataType: &apos;json&apos;,&#xd;
			 errormsg: &apos;Connection Error&apos;,&#xd;
			 usepager: true, //&#xd;
			 nowrap: true, //&#xd;
			 page: 1, //current page&#xd;
			 total: 1, //total pages&#xd;
			 useRp: false, //use the results per page select box&#xd;
			 rp: 20, // results per page&#xd;
			 rpOptions: [10,15,20,25,40],&#xd;
			 title: false,&#xd;
			 pagestat: &apos;Displaying {from} to {to} of {total} items&apos;,&#xd;
			 pagetext: &apos;Page&apos;,&#xd;
			 outof: &apos;of&apos;,&#xd;
			 findtext: &apos;Find&apos;,&#xd;
			 procmsg: &apos;Processing, please wait ...&apos;,&#xd;
			 query: &apos;&apos;,&#xd;
			 qtype: &apos;&apos;,&#xd;
			 nomsg: &apos;No items&apos;,&#xd;
			 minColToggle: 1, //minimum allowed column to be hidden&#xd;
			 showToggleBtn: true, //show or hide column toggle popup&#xd;
			 hideOnSubmit: true,&#xd;
			 autoload: false,&#xd;
			 blockOpacity: 0.5,&#xd;
			 onDragCol: false,&#xd;
			 onToggleCol: false,&#xd;
			 onChangeSort: false,&#xd;
			 onSuccess: false,&#xd;
			 onError: false,&#xd;
			 onSubmit: false // using a custom populate function&#xd;
		  }, p);&#xd;
		  		&#xd;
&#xd;
		$(t)&#xd;
		.show() //show if hidden&#xd;
		.attr({cellPadding: 0, cellSpacing: 0, border: 0})  //remove padding and spacing&#xd;
		.removeAttr(&apos;width&apos;) //remove width properties	&#xd;
		;&#xd;
		&#xd;
		//create grid class&#xd;
		var g = {&#xd;
			hset : {},&#xd;
			rePosDrag: function () {&#xd;
&#xd;
			var cdleft = 0 - this.hDiv.scrollLeft;&#xd;
			if (this.hDiv.scrollLeft&gt;0) cdleft -= Math.floor(p.cgwidth/2);&#xd;
			$(g.cDrag).css({top:g.hDiv.offsetTop+1});&#xd;
			var cdpad = this.cdpad;&#xd;
			&#xd;
			$(&apos;div&apos;,g.cDrag).hide();&#xd;
			&#xd;
			$(&apos;thead tr:first th:visible&apos;,this.hDiv).each&#xd;
				(&#xd;
			 	function ()&#xd;
					{&#xd;
					var n = $(&apos;thead tr:first th:visible&apos;,g.hDiv).index(this);&#xd;
&#xd;
					var cdpos = parseInt($(&apos;div&apos;,this).width());&#xd;
					var ppos = cdpos;&#xd;
					if (cdleft==0) &#xd;
							cdleft -= Math.floor(p.cgwidth/2); &#xd;
&#xd;
					cdpos = cdpos + cdleft + cdpad;&#xd;
					&#xd;
					$(&apos;div:eq(&apos;+n+&apos;)&apos;,g.cDrag).css({&apos;left&apos;:cdpos+&apos;px&apos;}).show();&#xd;
&#xd;
					cdleft = cdpos;&#xd;
					}&#xd;
				);&#xd;
				&#xd;
			},&#xd;
			fixHeight: function (newH) {&#xd;
					newH = false;&#xd;
					if (!newH) newH = $(g.bDiv).height();&#xd;
					var hdHeight = $(this.hDiv).height();&#xd;
					$(&apos;div&apos;,this.cDrag).each(&#xd;
						function ()&#xd;
							{&#xd;
								$(this).height(newH+hdHeight);&#xd;
							}&#xd;
					);&#xd;
					&#xd;
					var nd = parseInt($(g.nDiv).height());&#xd;
					&#xd;
					if (nd&gt;newH)&#xd;
						$(g.nDiv).height(newH).width(200);&#xd;
					else&#xd;
						$(g.nDiv).height(&apos;auto&apos;).width(&apos;auto&apos;);&#xd;
					&#xd;
					$(g.block).css({height:newH,marginBottom:(newH * -1)});&#xd;
					&#xd;
					var hrH = g.bDiv.offsetTop + newH;&#xd;
					if (p.height != &apos;auto&apos; &amp;&amp; p.resizable) hrH = g.vDiv.offsetTop;&#xd;
					$(g.rDiv).css({height: hrH});&#xd;
				&#xd;
			},&#xd;
			dragStart: function (dragtype,e,obj) { //default drag function start&#xd;
				&#xd;
				if (dragtype==&apos;colresize&apos;) //column resize&#xd;
					{&#xd;
						$(g.nDiv).hide();$(g.nBtn).hide();&#xd;
						var n = $(&apos;div&apos;,this.cDrag).index(obj);&#xd;
						var ow = $(&apos;th:visible div:eq(&apos;+n+&apos;)&apos;,this.hDiv).width();&#xd;
						$(obj).addClass(&apos;dragging&apos;).siblings().hide();&#xd;
						$(obj).prev().addClass(&apos;dragging&apos;).show();&#xd;
						&#xd;
						this.colresize = {startX: e.pageX, ol: parseInt(obj.style.left), ow: ow, n : n };&#xd;
						$(&apos;body&apos;).css(&apos;cursor&apos;,&apos;col-resize&apos;);&#xd;
					}&#xd;
				else if (dragtype==&apos;vresize&apos;) //table resize&#xd;
					{&#xd;
						var hgo = false;&#xd;
						$(&apos;body&apos;).css(&apos;cursor&apos;,&apos;row-resize&apos;);&#xd;
						if (obj) &#xd;
							{&#xd;
							hgo = true;&#xd;
							$(&apos;body&apos;).css(&apos;cursor&apos;,&apos;col-resize&apos;);&#xd;
							}&#xd;
						this.vresize = {h: p.height, sy: e.pageY, w: p.width, sx: e.pageX, hgo: hgo};&#xd;
						&#xd;
					}&#xd;
&#xd;
				else if (dragtype==&apos;colMove&apos;) //column header drag&#xd;
					{&#xd;
						$(g.nDiv).hide();$(g.nBtn).hide();&#xd;
						this.hset = $(this.hDiv).offset();&#xd;
						this.hset.right = this.hset.left + $(&apos;table&apos;,this.hDiv).width();&#xd;
						this.hset.bottom = this.hset.top + $(&apos;table&apos;,this.hDiv).height();&#xd;
						this.dcol = obj;&#xd;
						this.dcoln = $(&apos;th&apos;,this.hDiv).index(obj);&#xd;
						&#xd;
						this.colCopy = document.createElement(&quot;div&quot;);&#xd;
						this.colCopy.className = &quot;colCopy&quot;;&#xd;
						this.colCopy.innerHTML = obj.innerHTML;&#xd;
						if ($.browser.msie)&#xd;
						{&#xd;
						this.colCopy.className = &quot;colCopy ie&quot;;&#xd;
						}&#xd;
						&#xd;
						&#xd;
						$(this.colCopy).css({position:&apos;absolute&apos;,float:&apos;left&apos;,display:&apos;none&apos;, textAlign: obj.align});&#xd;
						$(&apos;body&apos;).append(this.colCopy);&#xd;
						$(this.cDrag).hide();&#xd;
						&#xd;
					}&#xd;
														&#xd;
				$(&apos;body&apos;).noSelect();&#xd;
			&#xd;
			},&#xd;
			dragMove: function (e) {&#xd;
			&#xd;
				if (this.colresize) //column resize&#xd;
					{&#xd;
						var n = this.colresize.n;&#xd;
						var diff = e.pageX-this.colresize.startX;&#xd;
						var nleft = this.colresize.ol + diff;&#xd;
						var nw = this.colresize.ow + diff;&#xd;
						if (nw &gt; p.minwidth)&#xd;
							{&#xd;
								$(&apos;div:eq(&apos;+n+&apos;)&apos;,this.cDrag).css(&apos;left&apos;,nleft);&#xd;
								this.colresize.nw = nw;&#xd;
							}&#xd;
					}&#xd;
				else if (this.vresize) //table resize&#xd;
					{&#xd;
						var v = this.vresize;&#xd;
						var y = e.pageY;&#xd;
						var diff = y-v.sy;&#xd;
						&#xd;
						if (!p.defwidth) p.defwidth = p.width;&#xd;
						&#xd;
						if (p.width != &apos;auto&apos; &amp;&amp; !p.nohresize &amp;&amp; v.hgo)&#xd;
						{&#xd;
							var x = e.pageX;&#xd;
							var xdiff = x - v.sx;&#xd;
							var newW = v.w + xdiff;&#xd;
							if (newW &gt; p.defwidth)&#xd;
								{&#xd;
									this.gDiv.style.width = newW + &apos;px&apos;;&#xd;
									p.width = newW;&#xd;
								}&#xd;
						}&#xd;
						&#xd;
						var newH = v.h + diff;&#xd;
						if ((newH &gt; p.minheight || p.height &lt; p.minheight) &amp;&amp; !v.hgo)&#xd;
							{&#xd;
								this.bDiv.style.height = newH + &apos;px&apos;;&#xd;
								p.height = newH;&#xd;
								this.fixHeight(newH);&#xd;
							}&#xd;
						v = null;&#xd;
					}&#xd;
				else if (this.colCopy) {&#xd;
					$(this.dcol).addClass(&apos;thMove&apos;).removeClass(&apos;thOver&apos;); &#xd;
					if (e.pageX &gt; this.hset.right || e.pageX &lt; this.hset.left || e.pageY &gt; this.hset.bottom || e.pageY &lt; this.hset.top)&#xd;
					{&#xd;
						//this.dragEnd();&#xd;
						$(&apos;body&apos;).css(&apos;cursor&apos;,&apos;move&apos;);&#xd;
					}&#xd;
					else &#xd;
					$(&apos;body&apos;).css(&apos;cursor&apos;,&apos;pointer&apos;);&#xd;
					$(this.colCopy).css({top:e.pageY + 10,left:e.pageX + 20, display: &apos;block&apos;});&#xd;
				}													&#xd;
			&#xd;
			},&#xd;
			dragEnd: function () {&#xd;
&#xd;
				if (this.colresize)&#xd;
					{&#xd;
						var n = this.colresize.n;&#xd;
						var nw = this.colresize.nw;&#xd;
&#xd;
								$(&apos;th:visible div:eq(&apos;+n+&apos;)&apos;,this.hDiv).css(&apos;width&apos;,nw);&#xd;
								$(&apos;tr&apos;,this.bDiv).each (&#xd;
									function ()&#xd;
										{&#xd;
										$(&apos;td:visible div:eq(&apos;+n+&apos;)&apos;,this).css(&apos;width&apos;,nw);&#xd;
										}&#xd;
								);&#xd;
								this.hDiv.scrollLeft = this.bDiv.scrollLeft;&#xd;
&#xd;
&#xd;
						$(&apos;div:eq(&apos;+n+&apos;)&apos;,this.cDrag).siblings().show();&#xd;
						$(&apos;.dragging&apos;,this.cDrag).removeClass(&apos;dragging&apos;);&#xd;
						this.rePosDrag();&#xd;
						this.fixHeight();&#xd;
						this.colresize = false;&#xd;
					}&#xd;
				else if (this.vresize)&#xd;
					{&#xd;
						this.vresize = false;&#xd;
					}&#xd;
				else if (this.colCopy)&#xd;
					{&#xd;
						$(this.colCopy).remove();&#xd;
						if (this.dcolt != null)&#xd;
							{&#xd;
							&#xd;
							&#xd;
							if (this.dcoln&gt;this.dcolt)&#xd;
								$(&apos;th:eq(&apos;+this.dcolt+&apos;)&apos;,this.hDiv).before(this.dcol);&#xd;
							else&#xd;
								$(&apos;th:eq(&apos;+this.dcolt+&apos;)&apos;,this.hDiv).after(this.dcol);&#xd;
							&#xd;
							&#xd;
							&#xd;
							this.switchCol(this.dcoln,this.dcolt);&#xd;
							$(this.cdropleft).remove();&#xd;
							$(this.cdropright).remove();&#xd;
							this.rePosDrag();&#xd;
							&#xd;
							if (p.onDragCol) p.onDragCol(this.dcoln, this.dcolt);&#xd;
																			&#xd;
							}&#xd;
						&#xd;
						this.dcol = null;&#xd;
						this.hset = null;&#xd;
						this.dcoln = null;&#xd;
						this.dcolt = null;&#xd;
						this.colCopy = null;&#xd;
						&#xd;
						$(&apos;.thMove&apos;,this.hDiv).removeClass(&apos;thMove&apos;);&#xd;
						$(this.cDrag).show();&#xd;
					}										&#xd;
				$(&apos;body&apos;).css(&apos;cursor&apos;,&apos;default&apos;);&#xd;
				$(&apos;body&apos;).noSelect(false);&#xd;
			},&#xd;
			toggleCol: function(cid,visible) {&#xd;
				&#xd;
				var ncol = $(&quot;th[axis=&apos;col&quot;+cid+&quot;&apos;]&quot;,this.hDiv)[0];&#xd;
				var n = $(&apos;thead th&apos;,g.hDiv).index(ncol);&#xd;
				var cb = $(&apos;input[value=&apos;+cid+&apos;]&apos;,g.nDiv)[0];&#xd;
				&#xd;
				&#xd;
				if (visible==null)&#xd;
					{&#xd;
						visible = ncol.hide;&#xd;
					}&#xd;
				&#xd;
				&#xd;
				&#xd;
				if ($(&apos;input:checked&apos;,g.nDiv).length&lt;p.minColToggle&amp;&amp;!visible) return false;&#xd;
				&#xd;
				if (visible)&#xd;
					{&#xd;
						ncol.hide = false;&#xd;
						$(ncol).show();&#xd;
						cb.checked = true;&#xd;
					}&#xd;
				else&#xd;
					{&#xd;
						ncol.hide = true;&#xd;
						$(ncol).hide();&#xd;
						cb.checked = false;&#xd;
					}&#xd;
					&#xd;
						$(&apos;tbody tr&apos;,t).each&#xd;
							(&#xd;
								function ()&#xd;
									{&#xd;
										if (visible)&#xd;
											$(&apos;td:eq(&apos;+n+&apos;)&apos;,this).show();&#xd;
										else&#xd;
											$(&apos;td:eq(&apos;+n+&apos;)&apos;,this).hide();&#xd;
									}&#xd;
							);							&#xd;
				&#xd;
				this.rePosDrag();&#xd;
				&#xd;
				if (p.onToggleCol) p.onToggleCol(cid,visible);&#xd;
				&#xd;
				return visible;&#xd;
			},&#xd;
			switchCol: function(cdrag,cdrop) { //switch columns&#xd;
				&#xd;
				$(&apos;tbody tr&apos;,t).each&#xd;
					(&#xd;
						function ()&#xd;
							{&#xd;
								if (cdrag&gt;cdrop)&#xd;
									$(&apos;td:eq(&apos;+cdrop+&apos;)&apos;,this).before($(&apos;td:eq(&apos;+cdrag+&apos;)&apos;,this));&#xd;
								else&#xd;
									$(&apos;td:eq(&apos;+cdrop+&apos;)&apos;,this).after($(&apos;td:eq(&apos;+cdrag+&apos;)&apos;,this));&#xd;
							}&#xd;
					);&#xd;
					&#xd;
					//switch order in nDiv&#xd;
					if (cdrag&gt;cdrop)&#xd;
						$(&apos;tr:eq(&apos;+cdrop+&apos;)&apos;,this.nDiv).before($(&apos;tr:eq(&apos;+cdrag+&apos;)&apos;,this.nDiv));&#xd;
					else&#xd;
						$(&apos;tr:eq(&apos;+cdrop+&apos;)&apos;,this.nDiv).after($(&apos;tr:eq(&apos;+cdrag+&apos;)&apos;,this.nDiv));&#xd;
						&#xd;
					if ($.browser.msie&amp;&amp;$.browser.version&lt;7.0) $(&apos;tr:eq(&apos;+cdrop+&apos;) input&apos;,this.nDiv)[0].checked = true;	&#xd;
					&#xd;
					this.hDiv.scrollLeft = this.bDiv.scrollLeft;&#xd;
			},			&#xd;
			scroll: function() {&#xd;
					this.hDiv.scrollLeft = this.bDiv.scrollLeft;&#xd;
					this.rePosDrag();&#xd;
			},&#xd;
			addData: function (_data) { //parse data&#xd;
				&#xd;
				var data = _data.pageData;&#xd;
				&#xd;
				// Preproceso: CAlculamos el nÃºmero de items de la&#xd;
				// familia seleccionada o el total, si no se seleccionÃ³&#xd;
				// una familia de items&#xd;
				var codFamilia = this.params!=null &amp;&amp; this.params.filter!=null? this.params.filter.codFamiliaItem : null;&#xd;
				if (codFamilia) {&#xd;
					for (var i=0; i&lt;data.length; i++) {&#xd;
						var centro = data[i];&#xd;
						var inventario = centro.inventario;&#xd;
						centro.numItemsFamilia = 0;&#xd;
					    if (inventario!=null) {&#xd;
					    	for (var j=0; j&lt;inventario.length; j++) {&#xd;
					    		var regInv = inventario[j];&#xd;
					    		var familia = regInv.familia;&#xd;
					    		if (familia!=null &amp;&amp; codFamilia==familia.codigo) {&#xd;
					    			centro.numItemsFamilia = regInv.cantidad;&#xd;
					    		} &#xd;
					    	}&#xd;
					    }&#xd;
					}&#xd;
				} else {&#xd;
					for (var i=0; i&lt;data.length; i++) {&#xd;
						var centro = data[i];&#xd;
						var inventario = centro.inventario;&#xd;
						centro.numItemsFamilia = 0;&#xd;
					    if (inventario!=null) {&#xd;
					    	for (var j=0; j&lt;inventario.length; j++) {&#xd;
					    		var regInv = inventario[j];&#xd;
					    		var familia = regInv.familia;&#xd;
					    		if (familia!=null) {&#xd;
					    			centro.numItemsFamilia += regInv.cantidad;&#xd;
					    		} &#xd;
					    	}&#xd;
					    }&#xd;
					}&#xd;
				}&#xd;
				&#xd;
				// MÃ¡s preproceso opcional&#xd;
				if (p.preProcess) data = p.preProcess(data);&#xd;
				&#xd;
				$(&apos;.pReload&apos;,this.pDiv).removeClass(&apos;loading&apos;);&#xd;
				this.loading = false;&#xd;
&#xd;
				if (!data) &#xd;
					{&#xd;
					$(&apos;.pPageStat&apos;,this.pDiv).html(p.errormsg);	&#xd;
					return false;&#xd;
					}&#xd;
&#xd;
&#xd;
					p.total = _data.totalCount;&#xd;
					&#xd;
				if (p.total==0)&#xd;
					{&#xd;
					$(&apos;tr, a, td, div&apos;,t).unbind();&#xd;
					$(t).empty();&#xd;
					p.pages = 1;&#xd;
					p.page = 1;&#xd;
					this.buildpager();&#xd;
					$(&apos;.pPageStat&apos;,this.pDiv).html(p.nomsg);&#xd;
					return false;&#xd;
					}&#xd;
				&#xd;
				p.pages = Math.ceil(p.total/p.rp);&#xd;
&#xd;
					p.page = _data.pageNumber;&#xd;
				&#xd;
				this.buildpager();&#xd;
&#xd;
				//build new body&#xd;
				var tbody = document.createElement(&apos;tbody&apos;);&#xd;
				&#xd;
				if (p.dataType==&apos;json&apos;)&#xd;
				{&#xd;
					$.each&#xd;
					(&#xd;
					 (data.rows? data.rows : data),&#xd;
					 function(i,row) &#xd;
					 	{&#xd;
							var tr = document.createElement(&apos;tr&apos;);&#xd;
							if (i % 2 &amp;&amp; p.striped) tr.className = &apos;erow&apos;;&#xd;
							&#xd;
							if (row.id) tr.id = &apos;row&apos; + row.id;&#xd;
							tr.data = row;&#xd;
							&#xd;
							//add cell&#xd;
							&#xd;
							$(&apos;thead tr:first th&apos;,g.hDiv).each&#xd;
							(&#xd;
							 	function ()&#xd;
									{&#xd;
										&#xd;
										var td = document.createElement(&apos;td&apos;);&#xd;
										var idx = $(this).attr(&apos;idx&apos;);&#xd;
										td.align = this.align;&#xd;
										td.innerHTML = row[idx];&#xd;
										$(tr).append(td);&#xd;
										td = null;&#xd;
									}&#xd;
							); &#xd;
							&#xd;
							/*&#xd;
							if ($(&apos;thead&apos;,this.gDiv).length&lt;1) //handle if grid has no headers&#xd;
							{&#xd;
							&#xd;
									for (idx in row)&#xd;
										{&#xd;
										var td = document.createElement(&apos;td&apos;);&#xd;
										td.innerHTML = row[idx];&#xd;
										$(tr).append(td);&#xd;
										td = null;&#xd;
										}&#xd;
							}							&#xd;
							*/&#xd;
							$(tbody).append(tr);&#xd;
							tr = null;&#xd;
						}&#xd;
					);				&#xd;
					&#xd;
				} else if (p.dataType==&apos;xml&apos;) {&#xd;
&#xd;
				i = 1;&#xd;
&#xd;
				$(&quot;rows row&quot;,data).each&#xd;
				(&#xd;
				 &#xd;
				 	function ()&#xd;
						{&#xd;
							&#xd;
							i++;&#xd;
							&#xd;
							var tr = document.createElement(&apos;tr&apos;);&#xd;
							if (i % 2 &amp;&amp; p.striped) tr.className = &apos;erow&apos;;&#xd;
&#xd;
							var nid =$(this).attr(&apos;id&apos;);&#xd;
							if (nid) tr.id = &apos;row&apos; + nid;&#xd;
							&#xd;
							nid = null;&#xd;
							&#xd;
							var robj = this;&#xd;
&#xd;
							&#xd;
							&#xd;
							$(&apos;thead tr:first th&apos;,g.hDiv).each&#xd;
							(&#xd;
							 	function ()&#xd;
									{&#xd;
										&#xd;
										var td = document.createElement(&apos;td&apos;);&#xd;
										var idx = $(this).attr(&apos;axis&apos;).substr(3);&#xd;
										td.align = this.align;&#xd;
										td.innerHTML = $(&quot;cell:eq(&quot;+ idx +&quot;)&quot;,robj).text();&#xd;
										$(tr).append(td);&#xd;
										td = null;&#xd;
									}&#xd;
							);&#xd;
							&#xd;
							&#xd;
							if ($(&apos;thead&apos;,this.gDiv).length&lt;1) //handle if grid has no headers&#xd;
							{&#xd;
								$(&apos;cell&apos;,this).each&#xd;
								(&#xd;
								 	function ()&#xd;
										{&#xd;
										var td = document.createElement(&apos;td&apos;);&#xd;
										td.innerHTML = $(this).text();&#xd;
										$(tr).append(td);&#xd;
										td = null;&#xd;
										}&#xd;
								);&#xd;
							}&#xd;
							&#xd;
							tr.data&#xd;
							$(tbody).append(tr);&#xd;
							tr = null;&#xd;
							robj = null;&#xd;
						}&#xd;
				);&#xd;
				&#xd;
				}&#xd;
&#xd;
				$(&apos;tr&apos;,t).unbind();&#xd;
				$(t).empty();&#xd;
				&#xd;
				$(t).append(tbody);&#xd;
				this.addCellProp();&#xd;
				this.addRowProp();&#xd;
				&#xd;
				//this.fixHeight($(this.bDiv).height());&#xd;
				&#xd;
				this.rePosDrag();&#xd;
				&#xd;
				tbody = null; data = null; i = null; &#xd;
				&#xd;
				if (p.onSuccess) p.onSuccess();&#xd;
				if (p.hideOnSubmit) $(g.block).remove();//$(t).show();&#xd;
				&#xd;
				this.hDiv.scrollLeft = this.bDiv.scrollLeft;&#xd;
				if ($.browser.opera) $(t).css(&apos;visibility&apos;,&apos;visible&apos;);&#xd;
				&#xd;
			},&#xd;
			changeSort: function(th) { //change sortorder&#xd;
			&#xd;
				if (this.loading) return true;&#xd;
				&#xd;
				$(g.nDiv).hide();$(g.nBtn).hide();&#xd;
				&#xd;
				if (p.sortname == $(th).attr(&apos;abbr&apos;))&#xd;
					{&#xd;
						if (p.sortorder== true) p.sortorder = false; &#xd;
						else p.sortorder = true;						&#xd;
					}&#xd;
				&#xd;
				$(th).addClass(&apos;sorted&apos;).siblings().removeClass(&apos;sorted&apos;);&#xd;
				$(&apos;.sdesc&apos;,this.hDiv).removeClass(&apos;sdesc&apos;);&#xd;
				$(&apos;.sasc&apos;,this.hDiv).removeClass(&apos;sasc&apos;);&#xd;
				$(&apos;div&apos;,th).addClass(&apos;s&apos;+p.sortorder);&#xd;
				p.sortname= $(th).attr(&apos;abbr&apos;);&#xd;
				&#xd;
				if (p.onChangeSort)&#xd;
					p.onChangeSort(p.sortname,p.sortorder);&#xd;
				else&#xd;
					this.populate();				&#xd;
			&#xd;
			},&#xd;
			buildpager: function(){ //rebuild pager based on new properties&#xd;
			&#xd;
			$(&apos;.pcontrol input&apos;,this.pDiv).val(p.page);&#xd;
			$(&apos;.pcontrol span&apos;,this.pDiv).html(p.pages);&#xd;
			&#xd;
			var r1 = (p.page-1) * p.rp + 1; &#xd;
			var r2 = r1 + p.rp - 1; &#xd;
			&#xd;
			if (p.total&lt;r2) r2 = p.total;&#xd;
			&#xd;
			var stat = p.pagestat;&#xd;
			&#xd;
			stat = stat.replace(/{from}/,r1);&#xd;
			stat = stat.replace(/{to}/,r2);&#xd;
			stat = stat.replace(/{total}/,p.total);&#xd;
			&#xd;
			$(&apos;.pPageStat&apos;,this.pDiv).html(stat);&#xd;
			&#xd;
			},&#xd;
			populate: function (params) { //get latest data&#xd;
&#xd;
				if (this.loading) return true;&#xd;
&#xd;
				if (p.onSubmit)&#xd;
					{&#xd;
						var gh = p.onSubmit();&#xd;
						if (!gh) return false;&#xd;
					}&#xd;
&#xd;
				this.loading = true;&#xd;
				if (!p.url) return false;&#xd;
				&#xd;
				$(&apos;.pPageStat&apos;,this.pDiv).html(p.procmsg);&#xd;
				&#xd;
				$(&apos;.pReload&apos;,this.pDiv).addClass(&apos;loading&apos;);&#xd;
				&#xd;
				$(g.block).css({top:g.bDiv.offsetTop});&#xd;
				&#xd;
				if (p.hideOnSubmit) $(this.gDiv).prepend(g.block); //$(t).hide();&#xd;
				&#xd;
				if ($.browser.opera) $(t).css(&apos;visibility&apos;,&apos;hidden&apos;);&#xd;
				&#xd;
				if (!p.newp) p.newp = 1;&#xd;
				&#xd;
				if (p.page&gt;p.pages) p.page = p.pages;&#xd;
				&#xd;
				if (!params) params = this.params;&#xd;
				else this.params = params;&#xd;
				&#xd;
				var param = $.extend({&#xd;
					pageNumber: p.newp, &#xd;
					pageSize: p.rp, &#xd;
					sortProp: p.sortname, &#xd;
					asc: p.sortorder&#xd;
				}, params);&#xd;
&#xd;
				p.newp = params.pageNumber;&#xd;
				&#xd;
				// Procuramos que se pueda cambiar la pÃ¡gina seleccionada&#xd;
				// a travÃ©s del componente&#xd;
				delete params.pageNumber;&#xd;
				&#xd;
				exc.RESTFUL.call({&#xd;
				   type: p.method,&#xd;
				   url: p.url,&#xd;
				   data: param,&#xd;
				   dataType: p.dataType,&#xd;
				   success: function(data){ g.addData(data); },&#xd;
				   error: function(XMLHttpRequest, textStatus, errorThrown) { try { if (p.onError) p.onError(XMLHttpRequest, textStatus, errorThrown); } catch (e) {} }&#xd;
				 });&#xd;
			},&#xd;
			doSearch: function () {&#xd;
				p.query = $(&apos;input[name=q]&apos;,g.sDiv).val();&#xd;
				p.qtype = $(&apos;select[name=qtype]&apos;,g.sDiv).val();&#xd;
				p.newp = 1;&#xd;
&#xd;
				this.populate();				&#xd;
			},&#xd;
			changePage: function (ctype){ //change page&#xd;
			&#xd;
				if (this.loading) return true;&#xd;
			&#xd;
				switch(ctype)&#xd;
				{&#xd;
					case &apos;first&apos;: p.newp = 1; break;&#xd;
					case &apos;prev&apos;: if (p.page&gt;1) p.newp = parseInt(p.page) - 1; break;&#xd;
					case &apos;next&apos;: if (p.page&lt;p.pages) p.newp = parseInt(p.page) + 1; break;&#xd;
					case &apos;last&apos;: p.newp = p.pages; break;&#xd;
					case &apos;input&apos;: &#xd;
							var nv = parseInt($(&apos;.pcontrol input&apos;,this.pDiv).val());&#xd;
							if (isNaN(nv)) nv = 1;&#xd;
							if (nv&lt;1) nv = 1;&#xd;
							else if (nv &gt; p.pages) nv = p.pages;&#xd;
							$(&apos;.pcontrol input&apos;,this.pDiv).val(nv);&#xd;
							p.newp =nv;&#xd;
							break;&#xd;
				}&#xd;
			&#xd;
				if (p.newp==p.page) return false;&#xd;
				&#xd;
				if (p.onChangePage) &#xd;
					p.onChangePage(p.newp);&#xd;
				else				&#xd;
					this.populate();&#xd;
			&#xd;
			},&#xd;
			addCellProp: function ()&#xd;
			{&#xd;
				&#xd;
					$(&apos;tbody tr td&apos;,g.bDiv).each&#xd;
					(&#xd;
						function ()&#xd;
							{&#xd;
									var tdDiv = document.createElement(&apos;div&apos;);&#xd;
									var n = $(&apos;td&apos;,$(this).parent()).index(this);&#xd;
									var pth = $(&apos;th:eq(&apos;+n+&apos;)&apos;,g.hDiv).get(0);&#xd;
			&#xd;
									if (pth!=null)&#xd;
									{&#xd;
									if (p.sortname==$(pth).attr(&apos;abbr&apos;)&amp;&amp;p.sortname) &#xd;
										{&#xd;
										this.className = &apos;sorted&apos;;&#xd;
										}&#xd;
									 $(tdDiv).css({textAlign:pth.align,width: $(&apos;div:first&apos;,pth)[0].style.width});&#xd;
									 &#xd;
									 if (pth.hide) $(this).css(&apos;display&apos;,&apos;none&apos;);&#xd;
									 &#xd;
									 }&#xd;
									 &#xd;
									 if (p.nowrap==false) $(tdDiv).css(&apos;white-space&apos;,&apos;normal&apos;);&#xd;
									 &#xd;
									 if (this.innerHTML==&apos;&apos;) this.innerHTML = &apos;&amp;nbsp;&apos;;&#xd;
									 &#xd;
									 //tdDiv.value = this.innerHTML; //store preprocess value&#xd;
									 tdDiv.innerHTML = this.innerHTML;&#xd;
									 &#xd;
									 var prnt = $(this).parent()[0];&#xd;
									 var pid = false;&#xd;
									 if (prnt.id) pid = prnt.id.substr(3);&#xd;
									 &#xd;
									 if (pth!=null)&#xd;
									 {&#xd;
									 if (pth.process) pth.process(tdDiv,pid);&#xd;
									 }&#xd;
									 &#xd;
									$(this).empty().append(tdDiv).removeAttr(&apos;width&apos;); //wrap content&#xd;
&#xd;
									//add editable event here &apos;dblclick&apos;&#xd;
&#xd;
							}&#xd;
					);&#xd;
					&#xd;
			},&#xd;
			getCellDim: function (obj) // get cell prop for editable event&#xd;
			{&#xd;
				var ht = parseInt($(obj).height());&#xd;
				var pht = parseInt($(obj).parent().height());&#xd;
				var wt = parseInt(obj.style.width);&#xd;
				var pwt = parseInt($(obj).parent().width());&#xd;
				var top = obj.offsetParent.offsetTop;&#xd;
				var left = obj.offsetParent.offsetLeft;&#xd;
				var pdl = parseInt($(obj).css(&apos;paddingLeft&apos;));&#xd;
				var pdt = parseInt($(obj).css(&apos;paddingTop&apos;));&#xd;
				return {ht:ht,wt:wt,top:top,left:left,pdl:pdl, pdt:pdt, pht:pht, pwt: pwt};&#xd;
			},&#xd;
			addRowProp: function()&#xd;
			{&#xd;
					$(&apos;tbody tr&apos;,g.bDiv).each&#xd;
					(&#xd;
						function ()&#xd;
							{&#xd;
							$(this)&#xd;
							.click(&#xd;
								function (e) &#xd;
									{ &#xd;
										var obj = (e.target || e.srcElement); if (obj.href || obj.type) return true;&#xd;
										$(this).toggleClass(&apos;trSelected&apos;);&#xd;
										if (p.singleSelect) $(this).siblings().removeClass(&apos;trSelected&apos;);&#xd;
										if (g.rowSelected) g.rowSelected(this);&#xd;
									}&#xd;
							)&#xd;
							.mousedown(&#xd;
								function (e)&#xd;
									{&#xd;
										if (e.shiftKey)&#xd;
										{&#xd;
										$(this).toggleClass(&apos;trSelected&apos;); &#xd;
										g.multisel = true; &#xd;
										this.focus();&#xd;
										$(g.gDiv).noSelect();&#xd;
										}&#xd;
									}&#xd;
							)&#xd;
							.mouseup(&#xd;
								function ()&#xd;
									{&#xd;
										if (g.multisel)&#xd;
										{&#xd;
										g.multisel = false;&#xd;
										$(g.gDiv).noSelect(false);&#xd;
										}&#xd;
									}&#xd;
							)&#xd;
							.hover(&#xd;
								function (e) &#xd;
									{ &#xd;
									if (g.multisel) &#xd;
										{&#xd;
										$(this).toggleClass(&apos;trSelected&apos;); &#xd;
										}&#xd;
									},&#xd;
								function () {}						&#xd;
							)&#xd;
							;&#xd;
							&#xd;
							if ($.browser.msie&amp;&amp;$.browser.version&lt;7.0)&#xd;
								{&#xd;
									$(this)&#xd;
									.hover(&#xd;
										function () { $(this).addClass(&apos;trOver&apos;); },&#xd;
										function () { $(this).removeClass(&apos;trOver&apos;); }&#xd;
									)&#xd;
									;&#xd;
								}&#xd;
							}&#xd;
					);&#xd;
					&#xd;
					&#xd;
			},&#xd;
			pager: 0&#xd;
			};		&#xd;
		&#xd;
		//create model if any&#xd;
		if (p.colModel)&#xd;
		{&#xd;
			thead = document.createElement(&apos;thead&apos;);&#xd;
			tr = document.createElement(&apos;tr&apos;);&#xd;
			&#xd;
			for (i=0;i&lt;p.colModel.length;i++)&#xd;
				{&#xd;
					var cm = p.colModel[i];&#xd;
					var th = document.createElement(&apos;th&apos;);&#xd;
&#xd;
					th.innerHTML = cm.display;&#xd;
					&#xd;
					if (cm.name&amp;&amp;cm.sortable)&#xd;
						$(th).attr(&apos;abbr&apos;,cm.name);&#xd;
					&#xd;
					//th.idx = i;&#xd;
					$(th).attr(&apos;idx&apos;,cm.name);&#xd;
					$(th).attr(&apos;axis&apos;,&apos;col&apos;+i);&#xd;
					&#xd;
					if (cm.align)&#xd;
						th.align = cm.align;&#xd;
						&#xd;
					if (cm.width) &#xd;
						$(th).attr(&apos;width&apos;,cm.width);&#xd;
&#xd;
					if (cm.hide)&#xd;
						{&#xd;
						th.hide = true;&#xd;
						}&#xd;
						&#xd;
					if (cm.process)&#xd;
						{&#xd;
							th.process = cm.process;&#xd;
						}&#xd;
&#xd;
					$(tr).append(th);&#xd;
				}&#xd;
			$(thead).append(tr);&#xd;
			$(t).prepend(thead);&#xd;
		} // end if p.colmodel	&#xd;
&#xd;
		//init divs&#xd;
		g.gDiv = document.createElement(&apos;div&apos;); //create global container&#xd;
		g.mDiv = document.createElement(&apos;div&apos;); //create title container&#xd;
		g.hDiv = document.createElement(&apos;div&apos;); //create header container&#xd;
		g.bDiv = document.createElement(&apos;div&apos;); //create body container&#xd;
		g.vDiv = document.createElement(&apos;div&apos;); //create grip&#xd;
		g.rDiv = document.createElement(&apos;div&apos;); //create horizontal resizer&#xd;
		g.cDrag = document.createElement(&apos;div&apos;); //create column drag&#xd;
		g.block = document.createElement(&apos;div&apos;); //creat blocker&#xd;
		g.nDiv = document.createElement(&apos;div&apos;); //create column show/hide popup&#xd;
		g.nBtn = document.createElement(&apos;div&apos;); //create column show/hide button&#xd;
		g.iDiv = document.createElement(&apos;div&apos;); //create editable layer&#xd;
		g.tDiv = document.createElement(&apos;div&apos;); //create toolbar&#xd;
		g.sDiv = document.createElement(&apos;div&apos;);&#xd;
		&#xd;
		if (p.usepager) g.pDiv = document.createElement(&apos;div&apos;); //create pager container&#xd;
		g.hTable = document.createElement(&apos;table&apos;);&#xd;
&#xd;
		//set gDiv&#xd;
		g.gDiv.className = &apos;flexigrid&apos;;&#xd;
		if (p.width!=&apos;auto&apos;) g.gDiv.style.width = p.width + &apos;px&apos;;&#xd;
&#xd;
		//add conditional classes&#xd;
		if ($.browser.msie)&#xd;
			$(g.gDiv).addClass(&apos;ie&apos;);&#xd;
		&#xd;
		if (p.novstripe)&#xd;
			$(g.gDiv).addClass(&apos;novstripe&apos;);&#xd;
&#xd;
		$(t).before(g.gDiv);&#xd;
		$(g.gDiv)&#xd;
		.append(t)&#xd;
		;&#xd;
&#xd;
		//set toolbar&#xd;
		if (p.buttons) &#xd;
		{&#xd;
			g.tDiv.className = &apos;tDiv&apos;;&#xd;
			var tDiv2 = document.createElement(&apos;div&apos;);&#xd;
			tDiv2.className = &apos;tDiv2&apos;;&#xd;
			&#xd;
			for (i=0;i&lt;p.buttons.length;i++)&#xd;
				{&#xd;
					var btn = p.buttons[i];&#xd;
					if (!btn.separator)&#xd;
					{&#xd;
						var btnDiv = document.createElement(&apos;div&apos;);&#xd;
						btnDiv.className = &apos;fbutton&apos;;&#xd;
						btnDiv.innerHTML = &quot;&lt;div&gt;&lt;span&gt;&quot;+btn.name+&quot;&lt;/span&gt;&lt;/div&gt;&quot;;&#xd;
						if (btn.bclass) &#xd;
							$(&apos;span&apos;,btnDiv)&#xd;
							.addClass(btn.bclass)&#xd;
							.css({paddingLeft:20})&#xd;
							;&#xd;
						btnDiv.onpress = btn.onpress;&#xd;
						btnDiv.name = btn.name;&#xd;
						if (btn.onpress)&#xd;
						{&#xd;
							$(btnDiv).click&#xd;
							(	&#xd;
								function () &#xd;
								{&#xd;
								this.onpress(this.name,g.gDiv);&#xd;
								}&#xd;
							);&#xd;
						}&#xd;
						$(tDiv2).append(btnDiv);&#xd;
						if ($.browser.msie&amp;&amp;$.browser.version&lt;7.0)&#xd;
						{&#xd;
							$(btnDiv).hover(function(){$(this).addClass(&apos;fbOver&apos;);},function(){$(this).removeClass(&apos;fbOver&apos;);});&#xd;
						}&#xd;
						&#xd;
					} else {&#xd;
						$(tDiv2).append(&quot;&lt;div class=&apos;btnseparator&apos;&gt;&lt;/div&gt;&quot;);&#xd;
					}&#xd;
				}&#xd;
				$(g.tDiv).append(tDiv2);&#xd;
				$(g.tDiv).append(&quot;&lt;div style=&apos;clear:both&apos;&gt;&lt;/div&gt;&quot;);&#xd;
				$(g.gDiv).prepend(g.tDiv);&#xd;
		}&#xd;
		&#xd;
		//set hDiv&#xd;
		g.hDiv.className = &apos;hDiv&apos;;&#xd;
&#xd;
		$(t).before(g.hDiv);&#xd;
&#xd;
		//set hTable&#xd;
			g.hTable.cellPadding = 0;&#xd;
			g.hTable.cellSpacing = 0;&#xd;
			$(g.hDiv).append(&apos;&lt;div class=&quot;hDivBox&quot;&gt;&lt;/div&gt;&apos;);&#xd;
			$(&apos;div&apos;,g.hDiv).append(g.hTable);&#xd;
			var thead = $(&quot;thead:first&quot;,t).get(0);&#xd;
			if (thead) $(g.hTable).append(thead);&#xd;
			thead = null;&#xd;
		&#xd;
		if (!p.colmodel) var ci = 0;&#xd;
&#xd;
		//setup thead			&#xd;
			$(&apos;thead tr:first th&apos;,g.hDiv).each&#xd;
			(&#xd;
			 	function ()&#xd;
					{&#xd;
						var thdiv = document.createElement(&apos;div&apos;);&#xd;
						&#xd;
						&#xd;
					&#xd;
						if ($(this).attr(&apos;abbr&apos;))&#xd;
							{&#xd;
							$(this).click(&#xd;
								function (e) &#xd;
									{&#xd;
										&#xd;
										if (!$(this).hasClass(&apos;thOver&apos;)) return false;&#xd;
										var obj = (e.target || e.srcElement);&#xd;
										if (obj.href || obj.type) return true; &#xd;
										g.changeSort(this);&#xd;
									}&#xd;
							)&#xd;
							;&#xd;
							&#xd;
							if ($(this).attr(&apos;abbr&apos;)==p.sortname)&#xd;
								{&#xd;
								this.className = &apos;sorted&apos;;&#xd;
								thdiv.className = &apos;s&apos;+p.sortorder;&#xd;
								}&#xd;
							}&#xd;
							&#xd;
							if (this.hide) $(this).hide();&#xd;
							&#xd;
							if (!p.colmodel)&#xd;
							{&#xd;
								$(this).attr(&apos;axis&apos;,&apos;col&apos; + ci++);&#xd;
							}&#xd;
							&#xd;
							&#xd;
						 $(thdiv).css({textAlign:this.align, width: this.width + &apos;px&apos;});&#xd;
						 thdiv.innerHTML = this.innerHTML;&#xd;
						 &#xd;
						$(this).empty().append(thdiv).removeAttr(&apos;width&apos;)&#xd;
						.mousedown(function (e) &#xd;
							{&#xd;
								g.dragStart(&apos;colMove&apos;,e,this);&#xd;
							})&#xd;
						.hover(&#xd;
							function(){&#xd;
								if (!g.colresize&amp;&amp;!$(this).hasClass(&apos;thMove&apos;)&amp;&amp;!g.colCopy) $(this).addClass(&apos;thOver&apos;);&#xd;
								&#xd;
								if ($(this).attr(&apos;abbr&apos;)!=p.sortname&amp;&amp;!g.colCopy&amp;&amp;!g.colresize&amp;&amp;$(this).attr(&apos;abbr&apos;)) $(&apos;div&apos;,this).addClass(&apos;s&apos;+p.sortorder);&#xd;
								else if ($(this).attr(&apos;abbr&apos;)==p.sortname&amp;&amp;!g.colCopy&amp;&amp;!g.colresize&amp;&amp;$(this).attr(&apos;abbr&apos;))&#xd;
									{&#xd;
										var no = &apos;&apos;;&#xd;
										if (p.sortorder==&apos;asc&apos;) no = &apos;desc&apos;;&#xd;
										else no = &apos;asc&apos;;&#xd;
										$(&apos;div&apos;,this).removeClass(&apos;s&apos;+p.sortorder).addClass(&apos;s&apos;+no);&#xd;
									}&#xd;
								&#xd;
								if (g.colCopy) &#xd;
									{&#xd;
									var n = $(&apos;th&apos;,g.hDiv).index(this);&#xd;
									&#xd;
									if (n==g.dcoln) return false;&#xd;
									&#xd;
									&#xd;
									&#xd;
									if (n&lt;g.dcoln) $(this).append(g.cdropleft);&#xd;
									else $(this).append(g.cdropright);&#xd;
									&#xd;
									g.dcolt = n;&#xd;
									&#xd;
									} else if (!g.colresize) {&#xd;
										&#xd;
									var nv = $(&apos;th:visible&apos;,g.hDiv).index(this);&#xd;
									var onl = parseInt($(&apos;div:eq(&apos;+nv+&apos;)&apos;,g.cDrag).css(&apos;left&apos;));&#xd;
									var nw = jQuery(g.nBtn).outerWidth();&#xd;
									nl = onl - nw + Math.floor(p.cgwidth/2);&#xd;
									&#xd;
									$(g.nDiv).hide();$(g.nBtn).hide();&#xd;
									&#xd;
									$(g.nBtn).css({&apos;left&apos;:nl,top:g.hDiv.offsetTop}).show();&#xd;
									&#xd;
									var ndw = parseInt($(g.nDiv).width());&#xd;
									&#xd;
									$(g.nDiv).css({top:g.bDiv.offsetTop});&#xd;
									&#xd;
									if ((nl+ndw)&gt;$(g.gDiv).width())&#xd;
										$(g.nDiv).css(&apos;left&apos;,onl-ndw+1);&#xd;
									else&#xd;
										$(g.nDiv).css(&apos;left&apos;,nl);&#xd;
										&#xd;
									if ($(this).hasClass(&apos;sorted&apos;)) &#xd;
										$(g.nBtn).addClass(&apos;srtd&apos;);&#xd;
									else&#xd;
										$(g.nBtn).removeClass(&apos;srtd&apos;);&#xd;
										&#xd;
									}&#xd;
									&#xd;
							},&#xd;
							function(){&#xd;
								$(this).removeClass(&apos;thOver&apos;);&#xd;
								if ($(this).attr(&apos;abbr&apos;)!=p.sortname) $(&apos;div&apos;,this).removeClass(&apos;s&apos;+p.sortorder);&#xd;
								else if ($(this).attr(&apos;abbr&apos;)==p.sortname)&#xd;
									{&#xd;
										var no = &apos;&apos;;&#xd;
										if (p.sortorder==&apos;asc&apos;) no = &apos;desc&apos;;&#xd;
										else no = &apos;asc&apos;;&#xd;
										&#xd;
										$(&apos;div&apos;,this).addClass(&apos;s&apos;+p.sortorder).removeClass(&apos;s&apos;+no);&#xd;
									}&#xd;
								if (g.colCopy) &#xd;
									{								&#xd;
									$(g.cdropleft).remove();&#xd;
									$(g.cdropright).remove();&#xd;
									g.dcolt = null;&#xd;
									}&#xd;
							})&#xd;
						; //wrap content&#xd;
					}&#xd;
			);&#xd;
&#xd;
		//set bDiv&#xd;
		g.bDiv.className = &apos;bDiv&apos;;&#xd;
		$(t).before(g.bDiv);&#xd;
		$(g.bDiv)&#xd;
		.css({ height: (p.height==&apos;auto&apos;) ? &apos;auto&apos; : p.height+&quot;px&quot;})&#xd;
		.scroll(function (e) {g.scroll()})&#xd;
		.append(t)&#xd;
		;&#xd;
		&#xd;
		if (p.height == &apos;auto&apos;) &#xd;
			{&#xd;
			$(&apos;table&apos;,g.bDiv).addClass(&apos;autoht&apos;);&#xd;
			}&#xd;
&#xd;
&#xd;
		//add td properties&#xd;
		g.addCellProp();&#xd;
		&#xd;
		//add row properties&#xd;
		g.addRowProp();&#xd;
		&#xd;
		//set cDrag&#xd;
		&#xd;
		var cdcol = $(&apos;thead tr:first th:first&apos;,g.hDiv).get(0);&#xd;
		&#xd;
		if (cdcol != null)&#xd;
		{		&#xd;
		g.cDrag.className = &apos;cDrag&apos;;&#xd;
		g.cdpad = 0;&#xd;
		&#xd;
		g.cdpad += (isNaN(parseInt($(&apos;div&apos;,cdcol).css(&apos;borderLeftWidth&apos;))) ? 0 : parseInt($(&apos;div&apos;,cdcol).css(&apos;borderLeftWidth&apos;))); &#xd;
		g.cdpad += (isNaN(parseInt($(&apos;div&apos;,cdcol).css(&apos;borderRightWidth&apos;))) ? 0 : parseInt($(&apos;div&apos;,cdcol).css(&apos;borderRightWidth&apos;))); &#xd;
		g.cdpad += (isNaN(parseInt($(&apos;div&apos;,cdcol).css(&apos;paddingLeft&apos;))) ? 0 : parseInt($(&apos;div&apos;,cdcol).css(&apos;paddingLeft&apos;))); &#xd;
		g.cdpad += (isNaN(parseInt($(&apos;div&apos;,cdcol).css(&apos;paddingRight&apos;))) ? 0 : parseInt($(&apos;div&apos;,cdcol).css(&apos;paddingRight&apos;))); &#xd;
		g.cdpad += (isNaN(parseInt($(cdcol).css(&apos;borderLeftWidth&apos;))) ? 0 : parseInt($(cdcol).css(&apos;borderLeftWidth&apos;))); &#xd;
		g.cdpad += (isNaN(parseInt($(cdcol).css(&apos;borderRightWidth&apos;))) ? 0 : parseInt($(cdcol).css(&apos;borderRightWidth&apos;))); &#xd;
		g.cdpad += (isNaN(parseInt($(cdcol).css(&apos;paddingLeft&apos;))) ? 0 : parseInt($(cdcol).css(&apos;paddingLeft&apos;))); &#xd;
		g.cdpad += (isNaN(parseInt($(cdcol).css(&apos;paddingRight&apos;))) ? 0 : parseInt($(cdcol).css(&apos;paddingRight&apos;))); &#xd;
&#xd;
		$(g.bDiv).before(g.cDrag);&#xd;
		&#xd;
		var cdheight = $(g.bDiv).height();&#xd;
		var hdheight = $(g.hDiv).height();&#xd;
		&#xd;
		$(g.cDrag).css({top: -hdheight + &apos;px&apos;});&#xd;
		&#xd;
		$(&apos;thead tr:first th&apos;,g.hDiv).each&#xd;
			(&#xd;
			 	function ()&#xd;
					{&#xd;
						var cgDiv = document.createElement(&apos;div&apos;);&#xd;
						$(g.cDrag).append(cgDiv);&#xd;
						if (!p.cgwidth) p.cgwidth = $(cgDiv).width();&#xd;
						$(cgDiv).css({height: cdheight + hdheight})&#xd;
						.mousedown(function(e){g.dragStart(&apos;colresize&apos;,e,this);})&#xd;
						;&#xd;
						if ($.browser.msie&amp;&amp;$.browser.version&lt;7.0)&#xd;
						{&#xd;
							g.fixHeight($(g.gDiv).height());&#xd;
							$(cgDiv).hover(&#xd;
								function () &#xd;
								{&#xd;
								g.fixHeight();&#xd;
								$(this).addClass(&apos;dragging&apos;) &#xd;
								},&#xd;
								function () { if (!g.colresize) $(this).removeClass(&apos;dragging&apos;) }&#xd;
							);&#xd;
						}&#xd;
					}&#xd;
			);&#xd;
		&#xd;
		//g.rePosDrag();&#xd;
							&#xd;
		}&#xd;
		&#xd;
&#xd;
		//add strip		&#xd;
		if (p.striped) &#xd;
			$(&apos;tbody tr:odd&apos;,g.bDiv).addClass(&apos;erow&apos;);&#xd;
			&#xd;
			&#xd;
		if (p.resizable &amp;&amp; p.height !=&apos;auto&apos;) &#xd;
		{&#xd;
		g.vDiv.className = &apos;vGrip&apos;;&#xd;
		$(g.vDiv)&#xd;
		.mousedown(function (e) { g.dragStart(&apos;vresize&apos;,e)})&#xd;
		.html(&apos;&lt;span&gt;&lt;/span&gt;&apos;);&#xd;
		$(g.bDiv).after(g.vDiv);&#xd;
		}&#xd;
		&#xd;
		if (p.resizable &amp;&amp; p.width !=&apos;auto&apos; &amp;&amp; !p.nohresize) &#xd;
		{&#xd;
		g.rDiv.className = &apos;hGrip&apos;;&#xd;
		$(g.rDiv)&#xd;
		.mousedown(function (e) {g.dragStart(&apos;vresize&apos;,e,true);})&#xd;
		.html(&apos;&lt;span&gt;&lt;/span&gt;&apos;)&#xd;
		.css(&apos;height&apos;,$(g.gDiv).height())&#xd;
		;&#xd;
		if ($.browser.msie&amp;&amp;$.browser.version&lt;7.0)&#xd;
		{&#xd;
			$(g.rDiv).hover(function(){$(this).addClass(&apos;hgOver&apos;);},function(){$(this).removeClass(&apos;hgOver&apos;);});&#xd;
		}&#xd;
		$(g.gDiv).append(g.rDiv);&#xd;
		}&#xd;
		&#xd;
		// add pager&#xd;
		if (p.usepager)&#xd;
		{&#xd;
		g.pDiv.className = &apos;pDiv&apos;;&#xd;
		g.pDiv.innerHTML = &apos;&lt;div class=&quot;pDiv2&quot;&gt;&lt;/div&gt;&apos;;&#xd;
		$(g.bDiv).after(g.pDiv);&#xd;
		var html = &apos; &lt;div class=&quot;pGroup&quot;&gt; &lt;div class=&quot;pFirst pButton&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;pPrev pButton&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;btnseparator&quot;&gt;&lt;/div&gt; &lt;div class=&quot;pGroup&quot;&gt;&lt;span class=&quot;pcontrol&quot;&gt;&apos;+p.pagetext+&apos; &lt;input type=&quot;text&quot; size=&quot;4&quot; value=&quot;1&quot; /&gt; &apos;+p.outof+&apos; &lt;span&gt; 1 &lt;/span&gt;&lt;/span&gt;&lt;/div&gt; &lt;div class=&quot;btnseparator&quot;&gt;&lt;/div&gt; &lt;div class=&quot;pGroup&quot;&gt; &lt;div class=&quot;pNext pButton&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;pLast pButton&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;btnseparator&quot;&gt;&lt;/div&gt; &lt;div class=&quot;pGroup&quot;&gt; &lt;div class=&quot;pReload pButton&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;btnseparator&quot;&gt;&lt;/div&gt; &lt;div class=&quot;pGroup&quot;&gt;&lt;span class=&quot;pPageStat&quot;&gt;&lt;/span&gt;&lt;/div&gt;&apos;;&#xd;
		$(&apos;div&apos;,g.pDiv).html(html);&#xd;
		&#xd;
		$(&apos;.pReload&apos;,g.pDiv).click(function(){g.populate()});&#xd;
		$(&apos;.pFirst&apos;,g.pDiv).click(function(){g.changePage(&apos;first&apos;)});&#xd;
		$(&apos;.pPrev&apos;,g.pDiv).click(function(){g.changePage(&apos;prev&apos;)});&#xd;
		$(&apos;.pNext&apos;,g.pDiv).click(function(){g.changePage(&apos;next&apos;)});&#xd;
		$(&apos;.pLast&apos;,g.pDiv).click(function(){g.changePage(&apos;last&apos;)});&#xd;
		$(&apos;.pcontrol input&apos;,g.pDiv).keydown(function(e){if(e.keyCode==13) g.changePage(&apos;input&apos;)});&#xd;
		if ($.browser.msie&amp;&amp;$.browser.version&lt;7) $(&apos;.pButton&apos;,g.pDiv).hover(function(){$(this).addClass(&apos;pBtnOver&apos;);},function(){$(this).removeClass(&apos;pBtnOver&apos;);});&#xd;
			&#xd;
			if (p.useRp)&#xd;
			{&#xd;
			var opt = &quot;&quot;;&#xd;
			for (var nx=0;nx&lt;p.rpOptions.length;nx++)&#xd;
			{&#xd;
				if (p.rp == p.rpOptions[nx]) sel = &apos;selected=&quot;selected&quot;&apos;; else sel = &apos;&apos;;&#xd;
				 opt += &quot;&lt;option value=&apos;&quot; + p.rpOptions[nx] + &quot;&apos; &quot; + sel + &quot; &gt;&quot; + p.rpOptions[nx] + &quot;&amp;nbsp;&amp;nbsp;&lt;/option&gt;&quot;;&#xd;
			};&#xd;
			$(&apos;.pDiv2&apos;,g.pDiv).prepend(&quot;&lt;div class=&apos;pGroup&apos;&gt;&lt;select name=&apos;rp&apos;&gt;&quot;+opt+&quot;&lt;/select&gt;&lt;/div&gt; &lt;div class=&apos;btnseparator&apos;&gt;&lt;/div&gt;&quot;);&#xd;
			$(&apos;select&apos;,g.pDiv).change(&#xd;
					function ()&#xd;
					{&#xd;
						if (p.onRpChange) &#xd;
							p.onRpChange(+this.value);&#xd;
						else&#xd;
							{&#xd;
							p.newp = 1;&#xd;
							p.rp = +this.value;&#xd;
							g.populate();&#xd;
							}&#xd;
					}&#xd;
				);&#xd;
			}&#xd;
		&#xd;
		//add search button&#xd;
		if (p.searchitems)&#xd;
			{&#xd;
				$(&apos;.pDiv2&apos;,g.pDiv).prepend(&quot;&lt;div class=&apos;pGroup&apos;&gt; &lt;div class=&apos;pSearch pButton&apos;&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt; &lt;/div&gt;  &lt;div class=&apos;btnseparator&apos;&gt;&lt;/div&gt;&quot;);&#xd;
				$(&apos;.pSearch&apos;,g.pDiv).click(function(){$(g.sDiv).slideToggle(&apos;fast&apos;,function(){$(&apos;.sDiv:visible input:first&apos;,g.gDiv).trigger(&apos;focus&apos;);});});				&#xd;
				//add search box&#xd;
				g.sDiv.className = &apos;sDiv&apos;;&#xd;
				&#xd;
				sitems = p.searchitems;&#xd;
				&#xd;
				var sopt = &quot;&quot;;&#xd;
				for (var s = 0; s &lt; sitems.length; s++)&#xd;
				{&#xd;
					if (p.qtype==&apos;&apos; &amp;&amp; sitems[s].isdefault==true)&#xd;
					{&#xd;
					p.qtype = sitems[s].name;&#xd;
					sel = &apos;selected=&quot;selected&quot;&apos;;&#xd;
					} else sel = &apos;&apos;;&#xd;
					sopt += &quot;&lt;option value=&apos;&quot; + sitems[s].name + &quot;&apos; &quot; + sel + &quot; &gt;&quot; + sitems[s].display + &quot;&amp;nbsp;&amp;nbsp;&lt;/option&gt;&quot;;						&#xd;
				}&#xd;
				&#xd;
				if (p.qtype==&apos;&apos;) p.qtype = sitems[0].name;&#xd;
				&#xd;
				$(g.sDiv).append(&quot;&lt;div class=&apos;sDiv2&apos;&gt;&quot;+p.findtext+&quot; &lt;input type=&apos;text&apos; size=&apos;30&apos; name=&apos;q&apos; class=&apos;qsbox&apos; /&gt; &lt;select name=&apos;qtype&apos;&gt;&quot;+sopt+&quot;&lt;/select&gt; &lt;!--input type=&apos;button&apos; value=&apos;Clear&apos; /--&gt;&lt;/div&gt;&quot;);&#xd;
&#xd;
				$(&apos;input[name=q],select[name=qtype]&apos;,g.sDiv).keydown(function(e){if(e.keyCode==13) g.doSearch()});&#xd;
				$(&apos;input[value=Clear]&apos;,g.sDiv).click(function(){$(&apos;input[name=q]&apos;,g.sDiv).val(&apos;&apos;); p.query = &apos;&apos;; g.doSearch(); });&#xd;
				$(g.bDiv).after(g.sDiv);				&#xd;
				&#xd;
			}&#xd;
		&#xd;
		}&#xd;
		$(g.pDiv,g.sDiv).append(&quot;&lt;div style=&apos;clear:both&apos;&gt;&lt;/div&gt;&quot;);&#xd;
	&#xd;
		// add title&#xd;
		if (p.title)&#xd;
		{&#xd;
			g.mDiv.className = &apos;mDiv&apos;;&#xd;
			g.mDiv.innerHTML = &apos;&lt;div class=&quot;ftitle&quot;&gt;&apos;+p.title+&apos;&lt;/div&gt;&apos;;&#xd;
			$(g.gDiv).prepend(g.mDiv);&#xd;
			if (p.showTableToggleBtn)&#xd;
				{&#xd;
					$(g.mDiv).append(&apos;&lt;div class=&quot;ptogtitle&quot; title=&quot;Minimize/Maximize Table&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt;&apos;);&#xd;
					$(&apos;div.ptogtitle&apos;,g.mDiv).click&#xd;
					(&#xd;
					 	function ()&#xd;
							{&#xd;
								$(g.gDiv).toggleClass(&apos;hideBody&apos;);&#xd;
								$(this).toggleClass(&apos;vsble&apos;);&#xd;
							}&#xd;
					);&#xd;
				}&#xd;
			//g.rePosDrag();&#xd;
		}&#xd;
&#xd;
		//setup cdrops&#xd;
		g.cdropleft = document.createElement(&apos;span&apos;);&#xd;
		g.cdropleft.className = &apos;cdropleft&apos;;&#xd;
		g.cdropright = document.createElement(&apos;span&apos;);&#xd;
		g.cdropright.className = &apos;cdropright&apos;;&#xd;
&#xd;
		//add block&#xd;
		g.block.className = &apos;gBlock&apos;;&#xd;
		var gh = $(g.bDiv).height();&#xd;
		var gtop = g.bDiv.offsetTop;&#xd;
		$(g.block).css(&#xd;
		{&#xd;
			width: g.bDiv.style.width,&#xd;
			height: gh,&#xd;
			background: &apos;white&apos;,&#xd;
			position: &apos;relative&apos;,&#xd;
			marginBottom: (gh * -1),&#xd;
			zIndex: 1,&#xd;
			top: gtop,&#xd;
			left: &apos;0px&apos;&#xd;
		}&#xd;
		);&#xd;
		$(g.block).fadeTo(0,p.blockOpacity);				&#xd;
		&#xd;
		// add column control&#xd;
		if ($(&apos;th&apos;,g.hDiv).length)&#xd;
		{&#xd;
			&#xd;
			g.nDiv.className = &apos;nDiv&apos;;&#xd;
			g.nDiv.innerHTML = &quot;&lt;table cellpadding=&apos;0&apos; cellspacing=&apos;0&apos;&gt;&lt;tbody&gt;&lt;/tbody&gt;&lt;/table&gt;&quot;;&#xd;
			$(g.nDiv).css(&#xd;
			{&#xd;
				marginBottom: (gh * -1),&#xd;
				display: &apos;none&apos;,&#xd;
				top: gtop&#xd;
			}&#xd;
			).noSelect()&#xd;
			;&#xd;
			&#xd;
			var cn = 0;&#xd;
			&#xd;
			&#xd;
			$(&apos;th div&apos;,g.hDiv).each&#xd;
			(&#xd;
			 	function ()&#xd;
					{&#xd;
						var kcol = $(&quot;th[axis=&apos;col&quot; + cn + &quot;&apos;]&quot;,g.hDiv)[0];&#xd;
						var chk = &apos;checked=&quot;checked&quot;&apos;;&#xd;
						if (kcol.style.display==&apos;none&apos;) chk = &apos;&apos;;&#xd;
						&#xd;
						$(&apos;tbody&apos;,g.nDiv).append(&apos;&lt;tr&gt;&lt;td class=&quot;ndcol1&quot;&gt;&lt;input type=&quot;checkbox&quot; &apos;+ chk +&apos; class=&quot;togCol&quot; value=&quot;&apos;+ cn +&apos;&quot; /&gt;&lt;/td&gt;&lt;td class=&quot;ndcol2&quot;&gt;&apos;+this.innerHTML+&apos;&lt;/td&gt;&lt;/tr&gt;&apos;);&#xd;
						cn++;&#xd;
					}&#xd;
			);&#xd;
			&#xd;
			if ($.browser.msie&amp;&amp;$.browser.version&lt;7.0)&#xd;
				$(&apos;tr&apos;,g.nDiv).hover&#xd;
				(&#xd;
				 	function () {$(this).addClass(&apos;ndcolover&apos;);},&#xd;
					function () {$(this).removeClass(&apos;ndcolover&apos;);}&#xd;
				);&#xd;
			&#xd;
			$(&apos;td.ndcol2&apos;,g.nDiv).click&#xd;
			(&#xd;
			 	function ()&#xd;
					{&#xd;
						if ($(&apos;input:checked&apos;,g.nDiv).length&lt;=p.minColToggle&amp;&amp;$(this).prev().find(&apos;input&apos;)[0].checked) return false;&#xd;
						return g.toggleCol($(this).prev().find(&apos;input&apos;).val());&#xd;
					}&#xd;
			);&#xd;
			&#xd;
			$(&apos;input.togCol&apos;,g.nDiv).click&#xd;
			(&#xd;
			 	function ()&#xd;
					{&#xd;
						&#xd;
						if ($(&apos;input:checked&apos;,g.nDiv).length&lt;p.minColToggle&amp;&amp;this.checked==false) return false;&#xd;
						$(this).parent().next().trigger(&apos;click&apos;);&#xd;
						//return false;&#xd;
					}&#xd;
			);&#xd;
&#xd;
&#xd;
			$(g.gDiv).prepend(g.nDiv);&#xd;
			&#xd;
			$(g.nBtn).addClass(&apos;nBtn&apos;)&#xd;
			.html(&apos;&lt;div&gt;&lt;/div&gt;&apos;)&#xd;
			.attr(&apos;title&apos;,&apos;Hide/Show Columns&apos;)&#xd;
			.click&#xd;
			(&#xd;
			 	function ()&#xd;
				{&#xd;
			 	$(g.nDiv).toggle(); return true;&#xd;
				}&#xd;
			);&#xd;
			&#xd;
			if (p.showToggleBtn) $(g.gDiv).prepend(g.nBtn);&#xd;
			&#xd;
		}&#xd;
		&#xd;
		// add date edit layer&#xd;
		$(g.iDiv)&#xd;
		.addClass(&apos;iDiv&apos;)&#xd;
		.css({display:&apos;none&apos;})&#xd;
		;&#xd;
		$(g.bDiv).append(g.iDiv);&#xd;
		&#xd;
		// add flexigrid events&#xd;
		$(g.bDiv)&#xd;
		.hover(function(){$(g.nDiv).hide();$(g.nBtn).hide();},function(){if (g.multisel) g.multisel = false;})&#xd;
		;&#xd;
		$(g.gDiv)&#xd;
		.hover(function(){},function(){$(g.nDiv).hide();$(g.nBtn).hide();})&#xd;
		;&#xd;
		&#xd;
		//add document events&#xd;
		$(document)&#xd;
		.mousemove(function(e){g.dragMove(e)})&#xd;
		.mouseup(function(e){g.dragEnd()})&#xd;
		.hover(function(){},function (){g.dragEnd()})&#xd;
		;&#xd;
		&#xd;
		//browser adjustments&#xd;
		if ($.browser.msie&amp;&amp;$.browser.version&lt;7.0)&#xd;
		{&#xd;
			$(&apos;.hDiv,.bDiv,.mDiv,.pDiv,.vGrip,.tDiv, .sDiv&apos;,g.gDiv)&#xd;
			.css({width: &apos;100%&apos;});&#xd;
			$(g.gDiv).addClass(&apos;ie6&apos;);&#xd;
			if (p.width!=&apos;auto&apos;) $(g.gDiv).addClass(&apos;ie6fullwidthbug&apos;);			&#xd;
		} &#xd;
		&#xd;
		g.rePosDrag();&#xd;
		g.fixHeight();&#xd;
		&#xd;
		//make grid functions accessible&#xd;
		t.p = p;&#xd;
		t.grid = g;&#xd;
		&#xd;
		// load data&#xd;
		if (p.url&amp;&amp;p.autoload) &#xd;
			{&#xd;
			g.populate();&#xd;
			}&#xd;
		&#xd;
		//return t;&#xd;
		&#xd;
		return g;&#xd;
	};&#xd;
	&#xd;
	&#xd;
</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/CentroPagedGrid.js</java.net.URL>
</httpSample>
<httpSample t="3" it="0" lt="3" ts="1315465022298" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/flexigrid.css" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" de="" by="14353" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=90a744b1125c2262cb6fe86b8524b9b3e7c5b915d8e726fcebca0c1dfafec0df; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: text/css
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: text/css,*/*;q=0.1
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">@charset &quot;UTF-8&quot;;&#xd;
/* CSS Document */&#xd;
&#xd;
.flexigrid&#xd;
	{&#xd;
	font-family: Arial, Helvetica, sans-serif;&#xd;
	font-size: 11px;&#xd;
	position: relative;&#xd;
	border: 0px solid #eee;&#xd;
	overflow: hidden;&#xd;
	color: #000;&#xd;
	}&#xd;
&#xd;
	.flexigrid.hideBody&#xd;
		{&#xd;
		height: 26px !important;&#xd;
		border-bottom: 1px solid #ccc;&#xd;
		}&#xd;
&#xd;
	.ie6fullwidthbug&#xd;
		{&#xd;
		border-right: 0px solid #ccc;&#xd;
		padding-right: 2px;	&#xd;
		}&#xd;
&#xd;
.flexigrid div.nDiv&#xd;
	{&#xd;
	background: #eee url(images/line.gif) repeat-y -1px top;&#xd;
	border: 1px solid #ccc;&#xd;
	border-top: 0px;&#xd;
	overflow: auto;&#xd;
	left: 0px;&#xd;
	position: absolute;&#xd;
	z-index: 999;&#xd;
	float: left;&#xd;
	}&#xd;
&#xd;
	.flexigrid div.nDiv table&#xd;
		{&#xd;
		margin: 2px;&#xd;
		}&#xd;
&#xd;
.flexigrid div.hDivBox&#xd;
	{&#xd;
	float: left; &#xd;
	padding-right: 40px;&#xd;
	}&#xd;
&#xd;
.flexigrid div.bDiv table&#xd;
	{&#xd;
	margin-bottom: 10px;&#xd;
	}&#xd;
	&#xd;
	.flexigrid div.bDiv table.autoht&#xd;
		{&#xd;
		border-bottom: 0px;&#xd;
		margin-bottom: 0px;&#xd;
		}&#xd;
	&#xd;
.flexigrid div.nDiv td&#xd;
	{&#xd;
	padding: 2px 3px;&#xd;
	border: 1px solid #eee;&#xd;
	cursor: default;&#xd;
	}&#xd;
&#xd;
.flexigrid div.nDiv tr:hover td, .flexigrid div.nDiv tr.ndcolover td&#xd;
	{&#xd;
	background: #d5effc url(images/hl.png) repeat-x top;&#xd;
	border: 1px solid #a8d8eb;&#xd;
	}&#xd;
	&#xd;
	.flexigrid div.nDiv td.ndcol1&#xd;
		{&#xd;
		border-right: 1px solid #ccc;&#xd;
		}&#xd;
		&#xd;
	.flexigrid div.nDiv td.ndcol2&#xd;
		{&#xd;
		border-left: 1px solid #fff;&#xd;
		padding-right: 10px;&#xd;
		}&#xd;
&#xd;
	.flexigrid div.nDiv tr:hover td.ndcol1, .flexigrid div.nDiv tr.ndcolover td.ndcol1&#xd;
		{&#xd;
		border-right: 1px solid #d2e3ec;&#xd;
		}&#xd;
		&#xd;
	.flexigrid div.nDiv tr:hover td.ndcol2, .flexigrid div.nDiv tr.ndcolover td.ndcol2&#xd;
		{&#xd;
		border-left: 1px solid #eef8ff;&#xd;
		}&#xd;
	&#xd;
	.flexigrid div.nBtn&#xd;
		{&#xd;
		position: absolute;&#xd;
		height: 24px;&#xd;
		width: 14px;&#xd;
		z-index: 900;&#xd;
		background: #fafafa url(images/fhbg.gif) repeat-x bottom;&#xd;
		border: 0px solid #ccc;&#xd;
		border-left: 1px solid #ccc;&#xd;
		top: 0px;&#xd;
		left: 0px;&#xd;
		margin-top: 1px;&#xd;
		cursor: pointer;&#xd;
		display: none;&#xd;
		}&#xd;
		&#xd;
		.flexigrid div.nBtn div&#xd;
			{&#xd;
			height: 24px;&#xd;
			width: 12px;&#xd;
			border-left: 1px solid #fff;&#xd;
			float: left;&#xd;
			background: url(images/ddn.png) no-repeat center;&#xd;
			}		&#xd;
		&#xd;
		.flexigrid div.nBtn.srtd&#xd;
			{&#xd;
			background: url(images/wbg.gif) repeat-x 0px -1px;&#xd;
			}&#xd;
		&#xd;
&#xd;
.flexigrid div.mDiv&#xd;
	{&#xd;
	background: url(images/wbg.gif) repeat-x top;&#xd;
	border: 1px solid #ccc;&#xd;
	border-bottom: 0px;&#xd;
	border-top: 0px;&#xd;
	font-weight: bold;&#xd;
	display: block;&#xd;
	overflow: hidden;&#xd;
	white-space: nowrap;&#xd;
	position: relative;&#xd;
	}&#xd;
&#xd;
.flexigrid div.mDiv div&#xd;
	{&#xd;
	padding: 6px;&#xd;
	white-space: nowrap;&#xd;
	}&#xd;
	&#xd;
		.flexigrid div.mDiv div.ptogtitle&#xd;
			{&#xd;
			position: absolute;&#xd;
			top: 4px;&#xd;
			right: 3px;&#xd;
			padding: 0px;&#xd;
			height: 16px;&#xd;
			width: 16px;&#xd;
			overflow: hidden;&#xd;
			border: 1px solid #ccc;&#xd;
			cursor: pointer;&#xd;
			}&#xd;
&#xd;
			.flexigrid div.mDiv div.ptogtitle:hover&#xd;
			{&#xd;
			background-position: left -2px;&#xd;
			border-color: #bbb;&#xd;
			}&#xd;
			&#xd;
			.flexigrid div.mDiv div.ptogtitle span&#xd;
			{&#xd;
			display: block;&#xd;
			border-left: 1px solid #eee;&#xd;
			border-top: 1px solid #fff;&#xd;
			border-bottom: 1px solid #ddd;&#xd;
			width: 14px;&#xd;
			height: 14px;&#xd;
			background: url(images/uup.png) no-repeat center;&#xd;
			}&#xd;
			&#xd;
			.flexigrid div.mDiv div.ptogtitle.vsble span&#xd;
			{&#xd;
			background: url(images/ddn.png) no-repeat center;			&#xd;
			}			&#xd;
&#xd;
.flexigrid div.tDiv /*toolbar*/&#xd;
	{&#xd;
	background: #fafafa url(images/bg.gif) repeat-x top;&#xd;
	position: relative;			&#xd;
	border: 1px solid #ccc;&#xd;
	border-bottom: 0px;&#xd;
	overflow: hidden;&#xd;
	}&#xd;
&#xd;
	.flexigrid div.tDiv2&#xd;
		{&#xd;
		float: left;&#xd;
		clear: both;&#xd;
		padding: 1px;&#xd;
		}&#xd;
&#xd;
.flexigrid div.sDiv /*toolbar*/&#xd;
	{&#xd;
	background: #fafafa url(images/bg.gif) repeat-x top;&#xd;
	position: relative;&#xd;
	border: 1px solid #ccc;&#xd;
	border-top: 0px;&#xd;
	overflow: hidden;&#xd;
	display: none;&#xd;
	}&#xd;
&#xd;
	.flexigrid div.sDiv2&#xd;
		{&#xd;
		float: left;&#xd;
		clear: both;&#xd;
		padding: 5px;&#xd;
		padding-left: 5px;&#xd;
		width: 1024px;&#xd;
		}&#xd;
&#xd;
		.flexigrid div.sDiv2 input, .flexigrid div.sDiv2 select&#xd;
		{&#xd;
		vertical-align: middle;&#xd;
		}&#xd;
			&#xd;
	.flexigrid div.btnseparator&#xd;
		{&#xd;
		float: left;&#xd;
		height: 22px;&#xd;
		border-left: 1px solid #ccc;&#xd;
		border-right: 1px solid #fff;&#xd;
		margin: 1px;&#xd;
		}&#xd;
	&#xd;
	.flexigrid div.fbutton&#xd;
		{&#xd;
			float: left;&#xd;
			display: block;&#xd;
			cursor: pointer;&#xd;
			padding: 1px;&#xd;
		}&#xd;
&#xd;
	.flexigrid div.fbutton div&#xd;
		{&#xd;
			float: left;&#xd;
			padding: 1px 3px;&#xd;
		}		&#xd;
		&#xd;
	.flexigrid div.fbutton span&#xd;
		{&#xd;
		float: left;&#xd;
		display: block;&#xd;
		padding: 3px;&#xd;
		}&#xd;
&#xd;
	.flexigrid div.fbutton:hover, .flexigrid div.fbutton.fbOver&#xd;
		{&#xd;
			padding: 0px;&#xd;
			border: 1px solid #ccc;&#xd;
		}&#xd;
&#xd;
	.flexigrid div.fbutton:hover div, .flexigrid div.fbutton.fbOver div&#xd;
		{&#xd;
			padding: 0px 2px;&#xd;
			border-left: 1px solid #fff;&#xd;
			border-top: 1px solid #fff;&#xd;
			border-right: 1px solid #eee;&#xd;
			border-bottom: 1px solid #eee;&#xd;
		}		&#xd;
		&#xd;
	&#xd;
/* end toolbar*/&#xd;
&#xd;
.flexigrid div.hDiv&#xd;
	{&#xd;
	background: #fafafa url(images/fhbg.gif) repeat-x bottom;&#xd;
	position: relative;&#xd;
	border: 1px solid #ccc;&#xd;
	border-bottom: 0px;&#xd;
	overflow: hidden;&#xd;
	}	&#xd;
&#xd;
.flexigrid div.hDiv table&#xd;
	{&#xd;
	border-right: 1px solid #fff;&#xd;
	}&#xd;
&#xd;
	.flexigrid div.cDrag&#xd;
		{&#xd;
		float: left;&#xd;
		position: absolute;&#xd;
		z-index: 2;&#xd;
		overflow: visible;&#xd;
		}&#xd;
&#xd;
		.flexigrid div.cDrag div&#xd;
			{&#xd;
			float: left;&#xd;
			background: none;&#xd;
			display: block;&#xd;
			position: absolute;&#xd;
			height: 24px;&#xd;
			width: 5px;&#xd;
			cursor: col-resize;&#xd;
			}&#xd;
			&#xd;
		.flexigrid div.cDrag div:hover, .flexigrid div.cDrag div.dragging&#xd;
			{&#xd;
			background: url(images/line.gif) repeat-y 2px center;&#xd;
			}&#xd;
&#xd;
.flexigrid div.iDiv&#xd;
	{&#xd;
		border: 1px solid #316ac5;&#xd;
		position: absolute;&#xd;
		overflow: visible;&#xd;
		background: none;&#xd;
	}&#xd;
	&#xd;
	.flexigrid div.iDiv input, .flexigrid div.iDiv select, .flexigrid div.iDiv textarea&#xd;
		{&#xd;
		font-family: Arial, Helvetica, sans-serif;&#xd;
		font-size: 11px;&#xd;
		}&#xd;
		&#xd;
	.flexigrid div.iDiv input.tb&#xd;
		{&#xd;
		border: 0px;&#xd;
		padding: 0px;&#xd;
		width: 100%;&#xd;
		height: 100%;&#xd;
		padding: 0px;&#xd;
		background: none;&#xd;
		}			&#xd;
					&#xd;
.flexigrid div.bDiv&#xd;
	{&#xd;
	border: 1px solid #ccc;&#xd;
	border-top: 0px;&#xd;
	background: #fff;&#xd;
	overflow: auto;&#xd;
	position: relative;&#xd;
	}&#xd;
	&#xd;
.flexigrid div.bDiv table&#xd;
	{&#xd;
	border-bottom: 1px solid #ccc;&#xd;
	}&#xd;
	&#xd;
	.flexigrid div.hGrip&#xd;
	{&#xd;
	position: absolute;&#xd;
	top: 0px;&#xd;
	right: 0px;&#xd;
	height: 5px;&#xd;
	width: 5px;&#xd;
	background: url(images/line.gif) repeat-x center;&#xd;
	margin-right: 1px;&#xd;
	cursor: col-resize;&#xd;
	}&#xd;
	&#xd;
		.flexigrid div.hGrip:hover, .flexigrid div.hGrip.hgOver&#xd;
			{&#xd;
				border-right: 1px solid #999;				&#xd;
				margin-right: 0px;&#xd;
			}&#xd;
	&#xd;
	.flexigrid div.vGrip&#xd;
		{&#xd;
		height: 5px;&#xd;
		overflow: hidden;&#xd;
		position: relative;&#xd;
		background: #fafafa url(images/wbg.gif) repeat-x 0px -1px;&#xd;
		border: 1px solid #ccc;&#xd;
		border-top: 0px;&#xd;
		text-align: center;&#xd;
		cursor: row-resize;&#xd;
		}&#xd;
			&#xd;
			.flexigrid div.vGrip span&#xd;
					{&#xd;
					display: block;&#xd;
					margin: 1px auto;&#xd;
					width: 20px;&#xd;
					height: 1px;&#xd;
					overflow: hidden;&#xd;
					border-top: 1px solid #aaa;&#xd;
					border-bottom: 1px solid #aaa;	&#xd;
					background: none;&#xd;
					}&#xd;
&#xd;
.flexigrid div.hDiv th, .flexigrid  div.bDiv td  /* common cell properties*/&#xd;
	{&#xd;
	text-align: left;&#xd;
	border-right: 1px solid #ddd;&#xd;
	border-left: 1px solid #fff;&#xd;
	overflow: hidden;&#xd;
	vertical-align: top !important;&#xd;
	}&#xd;
&#xd;
		.flexigrid div.hDiv th div, .flexigrid  div.bDiv td  div, div.colCopy div/* common inner cell properties*/&#xd;
			{&#xd;
			padding: 5px;&#xd;
			border-left: 0px solid #fff;&#xd;
			}&#xd;
&#xd;
.flexigrid div.hDiv th, div.colCopy&#xd;
	{&#xd;
	font-weight: normal;&#xd;
	height: 24px;&#xd;
	cursor: default;&#xd;
	white-space: nowrap;&#xd;
	overflow: hidden;&#xd;
	}	&#xd;
&#xd;
div.colCopy {&#xd;
	font-family: Arial, Helvetica, sans-serif;&#xd;
	font-size: 11px;&#xd;
	background: #fafafa url(images/fhbg.gif) repeat-x bottom;&#xd;
	border: 1px solid #ccc;&#xd;
	border-bottom: 0px;&#xd;
	overflow: hidden;&#xd;
	}&#xd;
&#xd;
.flexigrid div.hDiv th.sorted&#xd;
	{&#xd;
	background: url(images/wbg.gif) repeat-x 0px -1px;&#xd;
	border-bottom: 0px solid #ccc;&#xd;
	}&#xd;
	&#xd;
	.flexigrid div.hDiv th.thOver&#xd;
	{&#xd;
	}&#xd;
&#xd;
	.flexigrid div.hDiv th.thOver div, .flexigrid div.hDiv th.sorted.thOver div&#xd;
	{&#xd;
	border-bottom: 1px solid orange;&#xd;
	padding-bottom: 4px;&#xd;
	}&#xd;
	&#xd;
	.flexigrid div.hDiv th.sorted div&#xd;
	{&#xd;
	border-bottom: 0px solid #ccc;&#xd;
	padding-bottom: 5px;&#xd;
	}&#xd;
&#xd;
	.flexigrid div.hDiv th.thMove&#xd;
	{&#xd;
	background: #fff;&#xd;
	color: #fff;&#xd;
	}&#xd;
	&#xd;
	.flexigrid div.hDiv th.sorted.thMove div&#xd;
		{&#xd;
		border-bottom: 1px solid #fff;&#xd;
		padding-bottom: 4px&#xd;
		}&#xd;
	&#xd;
	.flexigrid div.hDiv th.thMove div&#xd;
	{&#xd;
		background: #fff !important;&#xd;
	}	&#xd;
	&#xd;
	.flexigrid div.hDiv th div.sdesc&#xd;
		{&#xd;
		background: url(images/dn.png) no-repeat center top;&#xd;
		}	&#xd;
&#xd;
	.flexigrid div.hDiv th div.sasc&#xd;
		{&#xd;
		background: url(images/up.png) no-repeat center top;&#xd;
		}	&#xd;
		&#xd;
.flexigrid div.bDiv td&#xd;
	{&#xd;
	border-bottom: 1px solid #fff;&#xd;
	vertical-align: top;&#xd;
	white-space: nowrap;&#xd;
	}&#xd;
&#xd;
		.flexigrid div.hDiv th div&#xd;
			{&#xd;
			}&#xd;
			&#xd;
			.flexigrid span.cdropleft&#xd;
			{&#xd;
			display: block;&#xd;
			background: url(images/prev.gif) no-repeat -4px center;&#xd;
			width: 24px;&#xd;
			height: 24px;&#xd;
			position: relative;&#xd;
			top: -24px;&#xd;
			margin-bottom: -24px;&#xd;
			z-index: 3;&#xd;
			}&#xd;
&#xd;
			.flexigrid div.hDiv span.cdropright&#xd;
			{&#xd;
			display: block;&#xd;
			background: url(images/next.gif) no-repeat 12px center;&#xd;
			width: 24px;&#xd;
			height: 24px;&#xd;
			float: right;&#xd;
			position: relative;&#xd;
			top: -24px;&#xd;
			margin-bottom: -24px;&#xd;
			}&#xd;
&#xd;
&#xd;
		.flexigrid div.bDiv td div&#xd;
			{&#xd;
			border-top: 0px solid #fff;&#xd;
			padding-bottom: 4px;&#xd;
			}&#xd;
	&#xd;
				&#xd;
		.flexigrid tr td.sorted&#xd;
				{&#xd;
				background: #f3f3f3;&#xd;
				border-right: 1px solid #ddd;&#xd;
				border-bottom: 1px solid #f3f3f3;&#xd;
				}		&#xd;
&#xd;
				.flexigrid tr td.sorted div&#xd;
					{&#xd;
					}&#xd;
&#xd;
&#xd;
		.flexigrid tr.erow td&#xd;
				{&#xd;
				background: #f7f7f7;&#xd;
				border-bottom: 1px solid #f7f7f7;&#xd;
				}&#xd;
				&#xd;
		.flexigrid tr.erow td.sorted&#xd;
				{&#xd;
				background: #e3e3e3;&#xd;
				border-bottom: 1px solid #e3e3e3;&#xd;
				}						&#xd;
&#xd;
				.flexigrid tr.erow td.sorted div&#xd;
					{&#xd;
					}&#xd;
&#xd;
		.flexigrid div.bDiv tr:hover td, &#xd;
		.flexigrid div.bDiv tr:hover td.sorted,&#xd;
		.flexigrid div.bDiv tr.trOver td.sorted, &#xd;
		.flexigrid div.bDiv tr.trOver td&#xd;
			{&#xd;
			background: #d9ebf5;&#xd;
			border-left: 1px solid #eef8ff;&#xd;
			border-bottom: 1px dotted #a8d8eb;&#xd;
			}&#xd;
					&#xd;
		.flexigrid div.bDiv tr.trSelected:hover td, &#xd;
		.flexigrid div.bDiv tr.trSelected:hover td.sorted,&#xd;
		.flexigrid div.bDiv tr.trOver.trSelected td.sorted, &#xd;
		.flexigrid div.bDiv tr.trOver.trSelected td,&#xd;
		.flexigrid tr.trSelected td.sorted, &#xd;
		.flexigrid tr.trSelected td&#xd;
			{&#xd;
			background: #d5effc url(images/hl.png) repeat-x top;&#xd;
			border-right: 1px solid #d2e3ec;&#xd;
			border-left: 1px solid #eef8ff;&#xd;
			border-bottom: 1px solid #a8d8eb;&#xd;
			}&#xd;
&#xd;
	/* novstripe adjustments */&#xd;
&#xd;
	.flexigrid.novstripe .bDiv table&#xd;
	{&#xd;
		border-bottom: 1px solid #ccc;&#xd;
		border-right: 1px solid #ccc;&#xd;
	}&#xd;
&#xd;
	.flexigrid.novstripe  div.bDiv td  &#xd;
		{&#xd;
		border-right-color: #fff;&#xd;
		}&#xd;
		&#xd;
	.flexigrid.novstripe div.bDiv tr.erow td.sorted&#xd;
		{&#xd;
		border-right-color: #e3e3e3;&#xd;
		}&#xd;
&#xd;
	.flexigrid.novstripe div.bDiv tr td.sorted&#xd;
		{&#xd;
		border-right-color: #f3f3f3;&#xd;
		}&#xd;
&#xd;
	.flexigrid.novstripe  div.bDiv tr.erow td  &#xd;
		{&#xd;
		border-right-color: #f7f7f7;&#xd;
		border-left-color: #f7f7f7;&#xd;
		}&#xd;
		&#xd;
		.flexigrid.novstripe div.bDiv tr.trSelected:hover td, &#xd;
		.flexigrid.novstripe div.bDiv tr.trSelected:hover td.sorted,&#xd;
		.flexigrid.novstripe div.bDiv tr.trOver.trSelected td.sorted, &#xd;
		.flexigrid.novstripe div.bDiv tr.trOver.trSelected td,&#xd;
		.flexigrid.novstripe tr.trSelected td.sorted, &#xd;
		.flexigrid.novstripe tr.trSelected td&#xd;
			{&#xd;
			border-right: 1px solid #0066FF;&#xd;
			border-left: 1px solid #0066FF;&#xd;
			}		&#xd;
&#xd;
	.flexigrid.novstripe div.bDiv tr.trOver td, .flexigrid.novstripe div.bDiv tr:hover td&#xd;
		{&#xd;
		border-left-color: #d9ebf5;&#xd;
		border-right-color: #d9ebf5;&#xd;
		}&#xd;
&#xd;
	/* end novstripe */&#xd;
&#xd;
.flexigrid div.pDiv&#xd;
	{&#xd;
	background: url(images/wbg.gif) repeat-x 0 -1px;&#xd;
	border: 1px solid #ccc;&#xd;
	border-top: 0px;&#xd;
	overflow: hidden;&#xd;
	white-space: nowrap;&#xd;
	position: relative;&#xd;
	}&#xd;
&#xd;
.flexigrid div.pDiv div.pDiv2&#xd;
	{&#xd;
	margin: 3px;&#xd;
	margin-left: -2px;&#xd;
	float: left;&#xd;
	width: 1024px;&#xd;
	}	&#xd;
	&#xd;
	div.pGroup&#xd;
		{&#xd;
		float: left;&#xd;
		background: none;&#xd;
		height: 24px;&#xd;
		margin: 0px 5px;&#xd;
		}&#xd;
	&#xd;
	.flexigrid div.pDiv .pPageStat, .flexigrid div.pDiv .pcontrol&#xd;
		{&#xd;
		position: relative;&#xd;
&#xd;
		top: 5px;&#xd;
		overflow: visible;&#xd;
		}&#xd;
		&#xd;
	.flexigrid div.pDiv input&#xd;
		{&#xd;
		vertical-align: text-top;&#xd;
		position: relative;&#xd;
		top: -5px;&#xd;
		}&#xd;
	&#xd;
	.flexigrid div.pDiv  div.pButton&#xd;
		{&#xd;
		float: left;&#xd;
		width: 22px;&#xd;
		height: 22px;&#xd;
		border: 0px;&#xd;
		cursor: pointer;&#xd;
		overflow: hidden;&#xd;
		}&#xd;
&#xd;
		.flexigrid div.pDiv  div.pButton:hover, .flexigrid div.pDiv  div.pButton.pBtnOver&#xd;
			{&#xd;
			width: 20px;&#xd;
			height: 20px;&#xd;
			border: 1px solid #ccc;&#xd;
			cursor: pointer;&#xd;
			}&#xd;
		&#xd;
	.flexigrid div.pDiv  div.pButton span&#xd;
		{&#xd;
		width: 20px;&#xd;
		height: 20px;&#xd;
		display: block;&#xd;
		float: left;&#xd;
		}		&#xd;
	&#xd;
		.flexigrid div.pDiv  div.pButton:hover span, .flexigrid div.pDiv  div.pButton.pBtnOver span&#xd;
			{&#xd;
			width: 19px;&#xd;
			height: 19px;&#xd;
			border-top: 1px solid #fff;&#xd;
			border-left: 1px solid #fff;&#xd;
			}		&#xd;
		&#xd;
&#xd;
		.flexigrid .pSearch&#xd;
			{&#xd;
			background: url(images/magnifier.png) no-repeat center;&#xd;
			}&#xd;
	&#xd;
		.flexigrid .pFirst&#xd;
			{&#xd;
			background: url(images/first.gif) no-repeat center;&#xd;
			}&#xd;
			&#xd;
		.flexigrid .pPrev&#xd;
			{&#xd;
			background: url(images/prev.gif) no-repeat center;&#xd;
			}&#xd;
&#xd;
		.flexigrid .pNext&#xd;
			{&#xd;
			background: url(images/next.gif) no-repeat center;&#xd;
			}&#xd;
&#xd;
		.flexigrid .pLast&#xd;
			{&#xd;
			background: url(images/last.gif) no-repeat center;&#xd;
			}&#xd;
			&#xd;
		.flexigrid .pReload&#xd;
			{&#xd;
			background: url(images/load.png) no-repeat center;&#xd;
			}&#xd;
			&#xd;
		.flexigrid .pReload.loading&#xd;
			{&#xd;
			background: url(images/load.gif) no-repeat center;&#xd;
			}															&#xd;
&#xd;
/* ie adjustments */&#xd;
			&#xd;
		.flexigrid.ie div.hDiv th div, .flexigrid.ie  div.bDiv td  div, div.colCopy.ie div/* common inner cell properties*/&#xd;
			{&#xd;
			overflow: hidden;&#xd;
			}			&#xd;
		</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/flexigrid.css</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="3" ts="1315465022302" s="true" lb="/iceweb/js/ajax.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" de="" by="12255" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=fb368a8fa2da474381dc60305eda18e4cfc604237aef9400a4f29916e1c8f3bc; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: application/x-javascript
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: */*
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">exc.AJAX = (function() {
		
	var rscript = /&lt;script(.|\s)*?\/script&gt;/gi,
	rselectTextarea = /select|textarea/i,
	rinput = /color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,
	jsre = /=\?(&amp;|$)/,
	rquery = /\?/,
	rts = /(\?|&amp;)_=.*?(&amp;|$)/,
	rurl = /^(\w+:)?\/\/([^\/?#]+)/,
	r20 = /%20/g;

	return {
		ajaxSettings: {
			url: location.href,
			global: true,
			type: &quot;GET&quot;,
			contentType: &quot;application/x-www-form-urlencoded&quot;,
			processData: true,
			async: true,
			/*
			timeout: 0,
			data: null,
			username: null,
			password: null,
			traditional: false,
			*/
			// Create the request object; Microsoft failed to properly
			// implement the XMLHttpRequest in IE7 (can&apos;t request local files),
			// so we use the ActiveXObject when it is available
			// This function can be overriden by calling exc.AJAX.ajaxSetup
			xhr: window.XMLHttpRequest &amp;&amp; (window.location.protocol !== &quot;file:&quot; || !window.ActiveXObject) ?
				function() {
					return new window.XMLHttpRequest();
				} :
				function() {
					try {
						return new window.ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
					} catch(e) {}
				},
			accepts: {
				xml: &quot;application/xml, text/xml&quot;,
				html: &quot;text/html&quot;,
				script: &quot;text/javascript, application/javascript&quot;,
				json: &quot;application/json&quot;,
				text: &quot;text/plain&quot;,
				_default: &quot;*/*&quot;
			}
		},
	
		// Last-Modified header cache for next request
		lastModified: {},
		etag: {},
	
		call: function( origSettings ) {
			var s = jQuery.extend(true, {}, exc.AJAX.ajaxSettings, origSettings);
	
			var status, data,
				callbackContext = s.context || s,
				type = s.type.toUpperCase();
			
			// If data is available, append data to url for get requests
			if ( s.data &amp;&amp; type === &quot;GET&quot; ) {
				s.url += (rquery.test(s.url) ? &quot;&amp;&quot; : &quot;?&quot;) + s.data;
			}
	
			// Watch for a new set of requests
			if ( s.global &amp;&amp; ! exc.AJAX.active++ ) {
				jQuery.event.trigger( &quot;ajaxStart&quot; );
			}
	
			// Matches an absolute URL, and saves the domain
			var parts = rurl.exec( s.url ),
				remote = parts &amp;&amp; (parts[1] &amp;&amp; parts[1] !== location.protocol || parts[2] !== location.host);
	
			
			var requestDone = false;
	
			// Create the request object
			var xhr = s.xhr();
			if ( !xhr ) return;
	
	
			// Open the socket
			// Passing null username, generates a login popup on Opera (#2865)
			if ( s.username ) {
				xhr.open(type, s.url, s.async, s.username, s.password);
			} else {
				xhr.open(type, s.url, s.async);
			}
	
			// Need an extra try/catch for cross domain requests in Firefox 3
			try {
				// Set the correct header, if data is being sent
				if ( s.data || origSettings &amp;&amp; origSettings.contentType ) {
					xhr.setRequestHeader(&quot;Content-Type&quot;, s.contentType);
				}
	
				// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
				if ( s.ifModified ) {
					if ( exc.AJAX.lastModified[s.url] ) {
						xhr.setRequestHeader(&quot;If-Modified-Since&quot;, exc.AJAX.lastModified[s.url]);
					}
	
					if ( exc.AJAX.etag[s.url] ) {
						xhr.setRequestHeader(&quot;If-None-Match&quot;, exc.AJAX.etag[s.url]);
					}
				}
	
				// Set header so the called script knows that it&apos;s an XMLHttpRequest
				// Only send the header if it&apos;s not a remote XHR
				if ( !remote ) {
					xhr.setRequestHeader(&quot;X-Requested-With&quot;, &quot;XMLHttpRequest&quot;);
				}
	
				// Set the Accepts header for the server, depending on the dataType
				xhr.setRequestHeader(&quot;Accept&quot;, s.dataType &amp;&amp; s.accepts[ s.dataType ] ?
					s.accepts[ s.dataType ] + &quot;, */*&quot; :
					s.accepts._default );
			} catch(e) {}
	
			// Allow custom headers/mimetypes and early abort
			if ( s.beforeSend &amp;&amp; s.beforeSend.call(callbackContext, xhr, s) === false ) {
				// Handle the global AJAX counter
				if ( s.global &amp;&amp; ! --exc.AJAX.active ) {
					jQuery.event.trigger( &quot;ajaxStop&quot; );
				}
	
				// close opended socket
				xhr.abort();
				return false;
			}
	
			if ( s.global ) {
				trigger(&quot;ajaxSend&quot;, [xhr, s]);
			}
	
			// Wait for a response to come back
			var onreadystatechange = xhr.onreadystatechange = function( isTimeout ) {
				// The request was aborted
				if ( !xhr || xhr.readyState === 0 ) {
					// Opera doesn&apos;t call onreadystatechange before this point
					// so we simulate the call
					if ( !requestDone ) {
						complete();
					}
	
					requestDone = true;
					if ( xhr ) {
						xhr.onreadystatechange = jQuery.noop;
					}
	
				// The transfer is complete and the data is available, or the request timed out
				} else if ( !requestDone &amp;&amp; xhr &amp;&amp; (xhr.readyState === 4 || isTimeout === &quot;timeout&quot;) ) {
					requestDone = true;
					xhr.onreadystatechange = jQuery.noop;
	
					status = isTimeout === &quot;timeout&quot; ?
						&quot;timeout&quot; :
						!exc.AJAX.httpSuccess( xhr ) ?
							&quot;error&quot; :
							s.ifModified &amp;&amp; exc.AJAX.httpNotModified( xhr, s.url ) ?
								&quot;notmodified&quot; :
								&quot;success&quot;;
	
					if ( status === &quot;success&quot; ) data = xhr.responseText;
					
					// Make sure that the request was successful or notmodified
					if ( status === &quot;success&quot; || status === &quot;notmodified&quot; ) {
						success();
					} else {
						exc.AJAX.handleError(s, xhr, status);
					}
	
					// Fire the complete handlers
					complete();
	
					if ( isTimeout === &quot;timeout&quot; ) {
						xhr.abort();
					}
	
					// Stop memory leaks
					if ( s.async ) {
						xhr = null;
					}
				}
			};
	
			// Override the abort handler, if we can (IE doesn&apos;t allow it, but that&apos;s OK)
			// Opera doesn&apos;t fire onreadystatechange at all on abort
			try {
				var oldAbort = xhr.abort;
				xhr.abort = function() {
					if ( xhr ) {
						oldAbort.call( xhr );
						if ( xhr ) {
							xhr.readyState = 0;
						}
					}
	
					onreadystatechange();
				};
			} catch(e) { }
	
			// Timeout checker
			if ( s.async &amp;&amp; s.timeout &gt; 0 ) {
				setTimeout(function() {
					// Check to see if the request is still happening
					if ( xhr &amp;&amp; !requestDone ) {
						onreadystatechange( &quot;timeout&quot; );
					}
				}, s.timeout);
			}
	
			// Send the data
			try {
				xhr.send( type === &quot;POST&quot; || type === &quot;PUT&quot; || type === &quot;DELETE&quot; ? s.data : null );
			} catch(e) {
				exc.AJAX.handleError(s, xhr, null, e);
				// Fire the complete handlers
				complete();
			}
	
			// firefox 1.5 doesn&apos;t fire statechange for sync requests
			if ( !s.async ) {
				onreadystatechange();
			}
	
			function success() {
				// If a local callback was specified, fire it and pass it the data
				if ( s.success ) {
					s.success.call( callbackContext, data, status, xhr );
				}
	
				// Fire the global callback
				if ( s.global ) {
					trigger( &quot;ajaxSuccess&quot;, [xhr, s] );
				}
			}
	
			function complete() {
				// Process result
				if ( s.complete ) {
					s.complete.call( callbackContext, xhr, status);
				}
	
				// The request was completed
				if ( s.global ) {
					trigger( &quot;ajaxComplete&quot;, [xhr, s] );
				}
	
				// Handle the global AJAX counter
				if ( s.global &amp;&amp; ! --exc.AJAX.active ) {
					jQuery.event.trigger( &quot;ajaxStop&quot; );
				}
			}
			
			function trigger(type, args) {
				(s.context ? jQuery(s.context) : jQuery.event).trigger(type, args);
			}
	
			// return XMLHttpRequest to allow aborting the request etc.
			return xhr;
		},
	
		handleError: function( s, xhr, status, e ) {
			// If a local callback was specified, fire it
			if ( s.error ) {
				s.error.call( s.context || window, xhr, status, e );
			}
	
			// Fire the global callback
			if ( s.global ) {
				(s.context ? jQuery(s.context) : jQuery.event).trigger( &quot;ajaxError&quot;, [xhr, s, e] );
			}
		},
	
		// Counter for holding the number of active queries
		active: 0,
	
		// Determines if an XMLHttpRequest was successful or not
		httpSuccess: function( xhr ) {
			try {
				// IE error sometimes returns 1223 when it should be 204 so treat it as success, see #1450
				return !xhr.status &amp;&amp; location.protocol === &quot;file:&quot; ||
					// Opera returns 0 when status is 304
					( xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300 ) ||
					xhr.status === 304 || xhr.status === 1223 || xhr.status === 0;
			} catch(e) {}
	
			return false;
		},
	
		// Determines if an XMLHttpRequest returns NotModified
		httpNotModified: function( xhr, url ) {
			var lastModified = xhr.getResponseHeader(&quot;Last-Modified&quot;),
				etag = xhr.getResponseHeader(&quot;Etag&quot;);
	
			if ( lastModified ) {
				exc.AJAX.lastModified[url] = lastModified;
			}
	
			if ( etag ) {
				exc.AJAX.etag[url] = etag;
			}
	
			// Opera returns 0 when status is 304
			return xhr.status === 304 || xhr.status === 0;
		},
	
		// Serialize an array of form elements or a set of
		// key/values into a query string
		param: function( a, traditional ) {
			
			var s = [];
			
			// Set traditional to true for jQuery &lt;= 1.3.2 behavior.
			if ( traditional === undefined ) {
				traditional = exc.AJAX.ajaxSettings.traditional;
			}
			
			function add( key, value ) {
				// If value is a function, invoke it and return its value
				value = jQuery.isFunction(value) ? value() : value;
				s[ s.length ] = encodeURIComponent(key) + &quot;=&quot; + encodeURIComponent(value);
			}
			
			// If an array was passed in, assume that it is an array of form elements.
			if ( jQuery.isArray(a) || a.jquery ) {
				// Serialize the form elements
				jQuery.each( a, function() {
					add( this.name, this.value );
				});
				
			} else {
				// If traditional, encode the &quot;old&quot; way (the way 1.3.2 or older
				// did it), otherwise encode params recursively.
				jQuery.each( a, function buildParams( prefix, obj ) {
					
					if ( jQuery.isArray(obj) ) {
						// Serialize array item.
						jQuery.each( obj, function( i, v ) {
							if ( traditional ) {
								// Treat each array item as a scalar.
								add( prefix, v );
							} else {
								// If array item is non-scalar (array or object), encode its
								// numeric index to resolve deserialization ambiguity issues.
								// Note that rack (as of 1.0.0) can&apos;t currently deserialize
								// nested arrays properly, and attempting to do so may cause
								// a server error. Possible fixes are to modify rack&apos;s
								// deserialization algorithm or to provide an option or flag
								// to force array serialization to be shallow.
								buildParams( prefix + &quot;[&quot; + ( typeof v === &quot;object&quot; || jQuery.isArray(v) ? i : &quot;&quot; ) + &quot;]&quot;, v );
							}
						});
						
					} else if ( !traditional &amp;&amp; obj != null &amp;&amp; typeof obj === &quot;object&quot; ) {
						// Serialize object item.
						jQuery.each( obj, function( k, v ) {
							buildParams( prefix + &quot;[&quot; + k + &quot;]&quot;, v );
						});
						
					} else {
						// Serialize scalar item.
						add( prefix, obj );
					}
				});
			}
			
			// Return the resulting serialization
			return s.join(&quot;&amp;&quot;).replace(r20, &quot;+&quot;);
		}
	}
})();


/**
 * MÃ©todo para abstraernos de las librerÃ­as de AJAX de terceros
 */
exc.RESTFUL = (function() {
	return {
		call : function(settings) {
			var type = settings.type? settings.type : &quot;GET&quot;; 
			
			var data = null;
			if (settings.data) {
				if (type === &quot;GET&quot; &amp;&amp; typeof(data)==&quot;object&quot;) {
					var params = settings.data;
					var paramsQuery = [];
					var amp = false;
					for (var key in params) {
						var value = params[key];
						if (value!=undefined) {
							if (amp) paramsQuery.push(&apos;&amp;&apos;);
							else amp = true;
							
							var str = value;
							if (typeof(value)==&apos;object&apos;) {
								str = exc.JSON.encode(value);
							}
							
							paramsQuery.push(encodeURIComponent(key),&apos;=&apos;,encodeURIComponent(str));
						}
					}
					data = paramsQuery.join(&apos;&apos;);
				} else {
					data = exc.JSON.encode(settings.data);
				}
			}
	
			var newSettings = {
				type: type,
				url: settings.url,
				data: data,
				success: function(text) { settings.success(exc.JSON.decode(text)); },
				error: settings.error,
				dataType: &quot;json&quot;,
				//contentType:&quot;application/x-www-form-urlencoded&quot;
				contentType:&quot;application/json&quot;
			}
			exc.AJAX.call(newSettings);
		}
	}
})();
</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/ajax.js</java.net.URL>
</httpSample>
<httpSample t="3" it="0" lt="3" ts="1315465022307" s="true" lb="/iceweb/js/OpenLayersExt.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" de="" by="12804" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=64451ad520e8870aca07fbbe93b5098b3082013714385045a7edc8aa352eccc9; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: application/x-javascript
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: */*
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">
/**
 * Capa generica de OpenLayers para dibujar marcas en el mapa
 * a partir de una fuente de datos JSON
 */
exc.OpenLayers = exc.OpenLayers || {};
exc.OpenLayers.Layer = exc.OpenLayers.Layer || {};
exc.OpenLayers.Layer.JsonMarker = OpenLayers.Class(OpenLayers.Layer.Markers, {
    location:null,
    params: null,
    features: null,
    formatOptions: null, 
    selectedFeature: null,
    defaultStyle: null,
    
    jsonFeaturesRoot: function(json) { return json; },
    jsonTitle: null,
    jsonDescription: null,
    jsonLat: null,
    jsonLon: null,
    loading: false,
    
    initialize: function(name, options) {
        OpenLayers.Layer.Markers.prototype.initialize.apply(this, arguments);
        this.features = new Array();
        
        if(!this.defaultStyle) {
            this.defaultStyle = {
                &apos;externalGraphic&apos;: OpenLayers.Util.getImagesLocation() + &quot;marker.png&quot;,
                &apos;graphicWidth&apos;: 21,
                &apos;graphicHeight&apos;: 25,
                &apos;graphicXOffset&apos;: -10.5,
                &apos;graphicYOffset&apos;: -12.5
            };
        }
    },

    destroy: function() {
        // Warning: Layer.Markers.destroy() must be called prior to calling
        // clearFeatures() here, otherwise we leak memory. Indeed, if
        // Layer.Markers.destroy() is called after clearFeatures(), it won&apos;t be
        // able to remove the marker image elements from the layer&apos;s div since
        // the markers will have been destroyed by clearFeatures().
        OpenLayers.Layer.Markers.prototype.destroy.apply(this, arguments);
        this.clearFeatures();
        this.features = null;
    },

    load: function(params) {
    	if (this.loading) return false;
    	
        if (this.location != null) {
        	this.loading = true;
        	this.params = params;
        	
        	var _this = this;
        	
            this.events.triggerEvent(&quot;loadstart&quot;);
            this.clearFeatures();
            exc.RESTFUL.call({
            	type: &quot;GET&quot;,
            	data: this.params,
                url: this.location,
                success: function(o) { _this.onLoaded(o); },
                failure: function(o) { _this.onLoadFail(o); }
            });
        }    
    },
    
    onLoaded: function(json) {
    	this.loading = false;
        this.loaded = true;
    	this.drawMarkers(json);
        this.events.triggerEvent(&quot;loadend&quot;);
    },
    
    onLoadFail: function(e) {
    	this.loading = false;
        this.events.triggerEvent(&quot;loadend&quot;);
    },
    
    moveTo:function(bounds, zoomChanged, minor) {
		// Evitamos llamar al moveTo del padre para evitar SIG-30
		//OpenLayers.Layer.Markers.prototype.moveTo.apply(this, arguments);
    	
        if(this.visibility &amp;&amp; (!this.loaded || zoomChanged || !minor)) {
        	// Cargamos los datos de la nueva ventana visualizada
            this.load(this.params);
        }
    },

    jsonToFeature: function(jsonFeature, style) {
    	if (!(this.jsonLon &amp;&amp; this.jsonLat)) return null; 
    	
        var geometry = new OpenLayers.Geometry.Point(
        	this.jsonLon(jsonFeature),
        	this.jsonLat(jsonFeature)
    	);
        
        if (this.internalProjection &amp;&amp; this.externalProjection) {
            geometry.transform(this.externalProjection, this.internalProjection); 
        }
        
        return new OpenLayers.Feature.Vector(geometry, {}, style);
    },  
    
    read: function(text) {

    	var features = [];
        var json = exc.JSON.decode(text);
        
    },   
    
    drawMarkers: function(json) {
        var options = {};
        OpenLayers.Util.extend(options, this.formatOptions);
        
        if (this.map &amp;&amp; !this.projection.equals(this.map.getProjectionObject())) {
            options.externalProjection = this.projection;
            options.internalProjection = this.map.getProjectionObject();
        }    
                
        var style = !this.defaultStyle ? null :
        	OpenLayers.Util.applyDefaults({}, this.defaultStyle);
        
        var features = [];
        var jsonFeatures = this.jsonFeaturesRoot(json);
        var nfeatures = jsonFeatures.length;
        for (var i = 0; i &lt; nfeatures; i++) {
        	var jsonFeature = jsonFeatures[i];
        	var feature = this.jsonToFeature(jsonFeature, style);
        	if (feature) {
        		feature.data = {json: jsonFeature};
        		features.push(feature);
        	}
        }
        
        for (var i=0, len=features.length; i&lt;len; i++) {
            var feature = features[i];
            var data = feature.data;
            var location;
            var iconSize, iconOffset;
            
            location = new OpenLayers.LonLat(feature.geometry.x, 
                                             feature.geometry.y);
            
            if (feature.style.graphicWidth 
                &amp;&amp; feature.style.graphicHeight) {
                iconSize = new OpenLayers.Size(
                    feature.style.graphicWidth,
                    feature.style.graphicHeight);
            }        
            
            // FIXME: At the moment, we only use this if we have an 
            // externalGraphic, because icon has no setOffset API Method.
            if (feature.style.graphicXOffset !== undefined
                &amp;&amp; feature.style.graphicYOffset !== undefined) {
                iconOffset = new OpenLayers.Pixel(
                    feature.style.graphicXOffset, 
                    feature.style.graphicYOffset);
            }
            
            if (feature.style.externalGraphic != null) {
                data.icon = new OpenLayers.Icon(feature.style.externalGraphic, 
                                                iconSize, 
                                                iconOffset);
            } else {
                data.icon = OpenLayers.Marker.defaultIcon();

                //allows for the case where the image url is not 
                // specified but the size is. use a default icon
                // but change the size
                if (iconSize != null) {
                    data.icon.setSize(iconSize);
                }
            }
            
            data[&apos;overflow&apos;] = feature.attributes.overflow || &quot;auto&quot;; 
            
            var markerFeature = new OpenLayers.Feature(this, location, data);
            this.features.push(markerFeature);
            var marker = markerFeature.createMarker();
            if (this.jsonToHtml) {
              marker.events.register(&apos;click&apos;, markerFeature, this.markerClick);
            }
            this.addMarker(marker);
        }
    },
    
    jsonToHtml: function(json) {
    	var html = [];
    	html.push(&apos;&lt;table&gt;&apos;);
    	for (key in json) {
    		html.push(&apos;&lt;tr&gt;&apos;);
    		html.push(&apos;&lt;td&gt;&apos;,&apos;&lt;b&gt;&apos;,key,&apos;&lt;/b&gt;&apos;,&apos;&lt;/td&gt;&apos;);
	    	html.push(&apos;&lt;td&gt;&apos;,json[key],&apos;&lt;/td&gt;&apos;);
	    	html.push(&apos;&lt;/tr&gt;&apos;);
    	}
    	html.push(&apos;&lt;/table&gt;&apos;);
    	return html.join(&apos;&apos;);
    },
    markerClick: function(evt) {
        var sameMarkerClicked = (this == this.layer.selectedFeature);
        this.layer.selectedFeature = (!sameMarkerClicked) ? this : null;
        for(var i=0, len=this.layer.map.popups.length; i&lt;len; i++) {
            this.layer.map.removePopup(this.layer.map.popups[i]);
        }
        if (!sameMarkerClicked) {
        	this.data.popupContentHTML = this.layer.jsonToHtml(this.data.json);
            this.layer.map.addPopup(this.createPopup(true)); 
        } else {
        	this.data.popupContentHTML = null;
        }
        OpenLayers.Event.stop(evt);
    },
    clearFeatures: function() {
        if (this.features != null) {
            while(this.features.length &gt; 0) {
                var feature = this.features[0];
                OpenLayers.Util.removeItem(this.features, feature);
                feature.destroy();
            }
        }        
    },
    
    CLASS_NAME: &quot;exc.OpenLayers.Layer.JsonMarker&quot;
});

/**
 * Mapa especÃ­fico para centros educativos
 */
var CentrosMap = function(divId) {
	var appRoot = getAppRootPath();
	
	var map = new OpenLayers.Map(divId);
	map.markSelectedChanged = function() {};
	
	var ol_wms = new OpenLayers.Layer.WMS(
		&quot;OpenLayers WMS&quot;,
		&quot;http://labs.metacarta.com/wms/vmap0&quot;,
		{layers: &apos;basic&apos;}
	);
	map.addLayer(ol_wms);

	
	/* cfillol: Deshabilitamos los mapas de Google hasta que se resuelva SIG-69
	try {
		var gphy = new OpenLayers.Layer.Google(
			&quot;Google Physical&quot;,
			{type: G_PHYSICAL_MAP}
		);
	
		var gmap = new OpenLayers.Layer.Google(
			&quot;Google Streets&quot;, // the default
			{numZoomLevels: 20}
		);
		
		var ghyb = new OpenLayers.Layer.Google(
			&quot;Google Hybrid&quot;,
			{type: G_HYBRID_MAP, numZoomLevels: 20}
		);
		
		var gsat = new OpenLayers.Layer.Google(
			&quot;Google Satellite&quot;,
			{type: G_SATELLITE_MAP, numZoomLevels: 22}
		);
	
		map.addLayers([gphy, gmap, ghyb, gsat]);
	} catch (e) {
		// Si no estamos conectados a internet la carga
		// de los mapas de Google puede fallar y la de 
		// OpenLayers puede funcionar si estÃ¡ cacheada
	}
	*/
	
	var stylePrivate = {
		&apos;externalGraphic&apos;: appRoot+&apos;/img/priv.png&apos;,
		&apos;graphicWidth&apos;: 21,
		&apos;graphicHeight&apos;: 25,
		&apos;graphicXOffset&apos;: -10.5,
		&apos;graphicYOffset&apos;: -12.5
	};
	
	var stylePublic = {
		&apos;externalGraphic&apos;: appRoot+&apos;/img/pub.png&apos;,
		&apos;graphicWidth&apos;: 21,
		&apos;graphicHeight&apos;: 25,
		&apos;graphicXOffset&apos;: -10.5,
		&apos;graphicYOffset&apos;: -12.5
	};
	
	var styleMix = {
		&apos;externalGraphic&apos;: appRoot+&apos;/img/mix.png&apos;,
		&apos;graphicWidth&apos;: 21,
		&apos;graphicHeight&apos;: 25,
		&apos;graphicXOffset&apos;: -10.5,
		&apos;graphicYOffset&apos;: -12.5
	};

	jsonLayer = new exc.OpenLayers.Layer.JsonMarker(&quot;Centros&quot;, {
		jsonToFeature: function(o, defStyle) {
			var geometry = new OpenLayers.Geometry.Point(o.lon, o.lat);
			var regimen = o.info.regimen;
			var style = &apos;Pub.&apos;==regimen? stylePublic : &apos;Priv.&apos;==regimen? stylePrivate : styleMix;
			return new OpenLayers.Feature.Vector(geometry, {}, style);
		},
		load: function(params) {
	    	// Precondiciones
	    	if (this.loading) return false;
	    	if (params==null) return false;
	    	var map = this.map;
	    	if (!map.getExtent()) return false;
	  		
	    	this.loading = true;
	    	if (!params) params = {};
	    	this.params = params;
	    	var _this = this;
	    	
	    	this.events.triggerEvent(&quot;loadstart&quot;);
	        this.clearFeatures();
	            
	    	if (params.codigo) {
	        	// Consultamos el centro por codigo
	    		exc.RESTFUL.call({
	            	type: &quot;GET&quot;,
	            	data: this.params,
	                url: appRoot+&apos;/restful/Centro/&apos;+params.codigo,
	                success: function(o) { 
	    				// Convertimos de Centro a lista de CentroResumen
	    				_this.onLoaded([{
	    					info: {codigo: o.codigo, regimen: o.regimen, cantidad: 1},
	    					lon: o.longitud, 
	    					lat: o.latitud
	    				}]); 
	    			},
	                error: function(o) { _this.onLoadFail(o); }
	            });	
	    	} else {
	    		// Consultamos los centros por cuadrÃ­cula
	        	var viewPortCoords = map.getExtent().toArray();
	       		params.cuadricula = {
	    			infIzq: { lon: viewPortCoords[0], lat: viewPortCoords[1] },
	    			supDer: { lon: viewPortCoords[2], lat: viewPortCoords[3] },
	    			// ResoluciÃ³n de 15px
	    			resLon: Math.floor(map.size.w/15), resLat: Math.floor(map.size.h/15)
	       		};
	      		
	            exc.RESTFUL.call({
	            	type: &quot;GET&quot;,
	            	data: params,
	                url: appRoot+&apos;/restful/Centro/findMarcasCuadriculaByFilter&apos;,
	                success: function(o) { _this.onLoaded(o); },
	                error: function(o) { _this.onLoadFail(o); }
	            });
	    	}     
	    },
		markerClick: function(evt) {
			var sameMarkerClicked = (this == this.layer.selectedFeature);
			if (!sameMarkerClicked) {
				var other = this.layer.selectedFeature;
				this.layer.selectedFeature = this;
				if (other &amp;&amp; other.marker) {
					var otherImg = document.getElementById(other.marker.icon.imageDiv.id+&apos;_innerImage&apos;);
					otherImg.src = otherImg.src.replace(&apos;_sel.png&apos;, &apos;.png&apos;);
				}
				var img = document.getElementById(this.marker.icon.imageDiv.id+&apos;_innerImage&apos;);
				img.src = img.src.replace(&apos;.png&apos;, &apos;_sel.png&apos;);
	
				map.markSelectedChanged(this);
			} 
			
			OpenLayers.Event.stop(evt);
		}
	});
	map.addLayer(jsonLayer);

	map.addControl(new OpenLayers.Control.LayerSwitcher());	
	map.setCenter(new OpenLayers.LonLat(-0.55, 39.331), 8);
		
	map.load = function(params) {
		jsonLayer.load(params);
	};

	return map;
};</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayersExt.js</java.net.URL>
</httpSample>
<httpSample t="14" it="0" lt="3" ts="1315465022311" s="true" lb="/iceweb/js/OpenLayers/OpenLayers.js" rc="200" rm="OK" tn="Thread Group 1-1" dt="text" de="" by="712189" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=80330a397790a8a11f67ccbfaae87bde0d87192962ea155ce5fd392dd08c6f14; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: application/x-javascript
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: */*
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String">/*

  OpenLayers.js -- OpenLayers Map Viewer Library

  Copyright 2005-2008 MetaCarta, Inc., released under the Clear BSD license.
  Please see http://svn.openlayers.org/trunk/openlayers/license.txt
  for the full text of the license.

  Includes compressed code under the following licenses:

  (For uncompressed versions of the code used please see the
  OpenLayers SVN repository: &lt;http://openlayers.org/&gt;)

*/

/* Contains portions of Prototype.js:
 *
 * Prototype JavaScript framework, version 1.4.0
 *  (c) 2005 Sam Stephenson &lt;sam@conio.net&gt;
 *
 *  Prototype is freely distributable under the terms of an MIT-style license.
 *  For details, see the Prototype web site: http://prototype.conio.net/
 *
 *--------------------------------------------------------------------------*/

/**  
*  
*  Contains portions of Rico &lt;http://openrico.org/&gt;
* 
*  Copyright 2005 Sabre Airline Solutions  
*  
*  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you
*  may not use this file except in compliance with the License. You
*  may obtain a copy of the License at
*  
*         http://www.apache.org/licenses/LICENSE-2.0  
*  
*  Unless required by applicable law or agreed to in writing, software
*  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
*  implied. See the License for the specific language governing
*  permissions and limitations under the License. 
*
**/

/**
 * Contains XMLHttpRequest.js &lt;http://code.google.com/p/xmlhttprequest/&gt;
 * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 */

/**
 * Contains portions of Gears &lt;http://code.google.com/apis/gears/&gt;
 *
 * Copyright 2007, Google Inc.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 *  1. Redistributions of source code must retain the above copyright notice,
 *     this list of conditions and the following disclaimer.
 *  2. Redistributions in binary form must reproduce the above copyright notice,
 *     this list of conditions and the following disclaimer in the documentation
 *     and/or other materials provided with the distribution.
 *  3. Neither the name of Google Inc. nor the names of its contributors may be
 *     used to endorse or promote products derived from this software without
 *     specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS&apos;&apos; AND ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
 * EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
 * OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
 * OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
 * ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Sets up google.gears.*, which is *the only* supported way to access Gears.
 *
 * Circumvent this file at your own risk!
 *
 * In the future, Gears may automatically define google.gears.* without this
 * file. Gears may use these objects to transparently fix bugs and compatibility
 * issues. Applications that use the code below will continue to work seamlessly
 * when that happens.
 */
var OpenLayers={singleFile:true};(function(){var singleFile=(typeof OpenLayers==&quot;object&quot;&amp;&amp;OpenLayers.singleFile);window.OpenLayers={_scriptName:(!singleFile)?&quot;lib/OpenLayers.js&quot;:&quot;OpenLayers.js&quot;,_getScriptLocation:function(){var scriptLocation=&quot;&quot;;var isOL=new RegExp(&quot;(^|(.*?\\/))(&quot;+OpenLayers._scriptName+&quot;)(\\?|$)&quot;);var scripts=document.getElementsByTagName(&apos;script&apos;);for(var i=0,len=scripts.length;i&lt;len;i++){var src=scripts[i].getAttribute(&apos;src&apos;);if(src){var match=src.match(isOL);if(match){scriptLocation=match[1];break;}}}
return scriptLocation;}};if(!singleFile){var jsfiles=new Array(&quot;OpenLayers/Util.js&quot;,&quot;OpenLayers/BaseTypes.js&quot;,&quot;OpenLayers/BaseTypes/Class.js&quot;,&quot;OpenLayers/BaseTypes/Bounds.js&quot;,&quot;OpenLayers/BaseTypes/Element.js&quot;,&quot;OpenLayers/BaseTypes/LonLat.js&quot;,&quot;OpenLayers/BaseTypes/Pixel.js&quot;,&quot;OpenLayers/BaseTypes/Size.js&quot;,&quot;OpenLayers/Console.js&quot;,&quot;OpenLayers/Tween.js&quot;,&quot;Rico/Corner.js&quot;,&quot;Rico/Color.js&quot;,&quot;OpenLayers/Ajax.js&quot;,&quot;OpenLayers/Events.js&quot;,&quot;OpenLayers/Request.js&quot;,&quot;OpenLayers/Request/XMLHttpRequest.js&quot;,&quot;OpenLayers/Projection.js&quot;,&quot;OpenLayers/Map.js&quot;,&quot;OpenLayers/Layer.js&quot;,&quot;OpenLayers/Icon.js&quot;,&quot;OpenLayers/Marker.js&quot;,&quot;OpenLayers/Marker/Box.js&quot;,&quot;OpenLayers/Popup.js&quot;,&quot;OpenLayers/Tile.js&quot;,&quot;OpenLayers/Tile/Image.js&quot;,&quot;OpenLayers/Tile/WFS.js&quot;,&quot;OpenLayers/Layer/Image.js&quot;,&quot;OpenLayers/Layer/SphericalMercator.js&quot;,&quot;OpenLayers/Layer/EventPane.js&quot;,&quot;OpenLayers/Layer/FixedZoomLevels.js&quot;,&quot;OpenLayers/Layer/Google.js&quot;,&quot;OpenLayers/Layer/VirtualEarth.js&quot;,&quot;OpenLayers/Layer/Yahoo.js&quot;,&quot;OpenLayers/Layer/HTTPRequest.js&quot;,&quot;OpenLayers/Layer/Grid.js&quot;,&quot;OpenLayers/Layer/MapGuide.js&quot;,&quot;OpenLayers/Layer/MapServer.js&quot;,&quot;OpenLayers/Layer/MapServer/Untiled.js&quot;,&quot;OpenLayers/Layer/KaMap.js&quot;,&quot;OpenLayers/Layer/KaMapCache.js&quot;,&quot;OpenLayers/Layer/MultiMap.js&quot;,&quot;OpenLayers/Layer/Markers.js&quot;,&quot;OpenLayers/Layer/Text.js&quot;,&quot;OpenLayers/Layer/WorldWind.js&quot;,&quot;OpenLayers/Layer/ArcGIS93Rest.js&quot;,&quot;OpenLayers/Layer/WMS.js&quot;,&quot;OpenLayers/Layer/WMS/Untiled.js&quot;,&quot;OpenLayers/Layer/ArcIMS.js&quot;,&quot;OpenLayers/Layer/GeoRSS.js&quot;,&quot;OpenLayers/Layer/Boxes.js&quot;,&quot;OpenLayers/Layer/XYZ.js&quot;,&quot;OpenLayers/Layer/TMS.js&quot;,&quot;OpenLayers/Layer/TileCache.js&quot;,&quot;OpenLayers/Popup/Anchored.js&quot;,&quot;OpenLayers/Popup/AnchoredBubble.js&quot;,&quot;OpenLayers/Popup/Framed.js&quot;,&quot;OpenLayers/Popup/FramedCloud.js&quot;,&quot;OpenLayers/Feature.js&quot;,&quot;OpenLayers/Feature/Vector.js&quot;,&quot;OpenLayers/Feature/WFS.js&quot;,&quot;OpenLayers/Handler.js&quot;,&quot;OpenLayers/Handler/Click.js&quot;,&quot;OpenLayers/Handler/Hover.js&quot;,&quot;OpenLayers/Handler/Point.js&quot;,&quot;OpenLayers/Handler/Path.js&quot;,&quot;OpenLayers/Handler/Polygon.js&quot;,&quot;OpenLayers/Handler/Feature.js&quot;,&quot;OpenLayers/Handler/Drag.js&quot;,&quot;OpenLayers/Handler/RegularPolygon.js&quot;,&quot;OpenLayers/Handler/Box.js&quot;,&quot;OpenLayers/Handler/MouseWheel.js&quot;,&quot;OpenLayers/Handler/Keyboard.js&quot;,&quot;OpenLayers/Control.js&quot;,&quot;OpenLayers/Control/Attribution.js&quot;,&quot;OpenLayers/Control/Button.js&quot;,&quot;OpenLayers/Control/ZoomBox.js&quot;,&quot;OpenLayers/Control/ZoomToMaxExtent.js&quot;,&quot;OpenLayers/Control/DragPan.js&quot;,&quot;OpenLayers/Control/Navigation.js&quot;,&quot;OpenLayers/Control/MouseDefaults.js&quot;,&quot;OpenLayers/Control/MousePosition.js&quot;,&quot;OpenLayers/Control/OverviewMap.js&quot;,&quot;OpenLayers/Control/KeyboardDefaults.js&quot;,&quot;OpenLayers/Control/PanZoom.js&quot;,&quot;OpenLayers/Control/PanZoomBar.js&quot;,&quot;OpenLayers/Control/ArgParser.js&quot;,&quot;OpenLayers/Control/Permalink.js&quot;,&quot;OpenLayers/Control/Scale.js&quot;,&quot;OpenLayers/Control/ScaleLine.js&quot;,&quot;OpenLayers/Control/Snapping.js&quot;,&quot;OpenLayers/Control/Split.js&quot;,&quot;OpenLayers/Control/LayerSwitcher.js&quot;,&quot;OpenLayers/Control/DrawFeature.js&quot;,&quot;OpenLayers/Control/DragFeature.js&quot;,&quot;OpenLayers/Control/ModifyFeature.js&quot;,&quot;OpenLayers/Control/Panel.js&quot;,&quot;OpenLayers/Control/SelectFeature.js&quot;,&quot;OpenLayers/Control/NavigationHistory.js&quot;,&quot;OpenLayers/Control/Measure.js&quot;,&quot;OpenLayers/Control/WMSGetFeatureInfo.js&quot;,&quot;OpenLayers/Geometry.js&quot;,&quot;OpenLayers/Geometry/Rectangle.js&quot;,&quot;OpenLayers/Geometry/Collection.js&quot;,&quot;OpenLayers/Geometry/Point.js&quot;,&quot;OpenLayers/Geometry/MultiPoint.js&quot;,&quot;OpenLayers/Geometry/Curve.js&quot;,&quot;OpenLayers/Geometry/LineString.js&quot;,&quot;OpenLayers/Geometry/LinearRing.js&quot;,&quot;OpenLayers/Geometry/Polygon.js&quot;,&quot;OpenLayers/Geometry/MultiLineString.js&quot;,&quot;OpenLayers/Geometry/MultiPolygon.js&quot;,&quot;OpenLayers/Geometry/Surface.js&quot;,&quot;OpenLayers/Renderer.js&quot;,&quot;OpenLayers/Renderer/Elements.js&quot;,&quot;OpenLayers/Renderer/SVG.js&quot;,&quot;OpenLayers/Renderer/Canvas.js&quot;,&quot;OpenLayers/Renderer/VML.js&quot;,&quot;OpenLayers/Layer/Vector.js&quot;,&quot;OpenLayers/Layer/Vector/RootContainer.js&quot;,&quot;OpenLayers/Strategy.js&quot;,&quot;OpenLayers/Strategy/Fixed.js&quot;,&quot;OpenLayers/Strategy/Cluster.js&quot;,&quot;OpenLayers/Strategy/Paging.js&quot;,&quot;OpenLayers/Strategy/BBOX.js&quot;,&quot;OpenLayers/Strategy/Save.js&quot;,&quot;OpenLayers/Protocol.js&quot;,&quot;OpenLayers/Protocol/HTTP.js&quot;,&quot;OpenLayers/Protocol/SQL.js&quot;,&quot;OpenLayers/Protocol/SQL/Gears.js&quot;,&quot;OpenLayers/Protocol/WFS.js&quot;,&quot;OpenLayers/Protocol/WFS/v1.js&quot;,&quot;OpenLayers/Protocol/WFS/v1_0_0.js&quot;,&quot;OpenLayers/Protocol/WFS/v1_1_0.js&quot;,&quot;OpenLayers/Layer/PointTrack.js&quot;,&quot;OpenLayers/Layer/GML.js&quot;,&quot;OpenLayers/Style.js&quot;,&quot;OpenLayers/StyleMap.js&quot;,&quot;OpenLayers/Rule.js&quot;,&quot;OpenLayers/Filter.js&quot;,&quot;OpenLayers/Filter/FeatureId.js&quot;,&quot;OpenLayers/Filter/Logical.js&quot;,&quot;OpenLayers/Filter/Comparison.js&quot;,&quot;OpenLayers/Filter/Spatial.js&quot;,&quot;OpenLayers/Format.js&quot;,&quot;OpenLayers/Format/XML.js&quot;,&quot;OpenLayers/Format/ArcXML.js&quot;,&quot;OpenLayers/Format/ArcXML/Features.js&quot;,&quot;OpenLayers/Format/GML.js&quot;,&quot;OpenLayers/Format/GML/Base.js&quot;,&quot;OpenLayers/Format/GML/v2.js&quot;,&quot;OpenLayers/Format/GML/v3.js&quot;,&quot;OpenLayers/Format/KML.js&quot;,&quot;OpenLayers/Format/GeoRSS.js&quot;,&quot;OpenLayers/Format/WFS.js&quot;,&quot;OpenLayers/Format/WFSCapabilities.js&quot;,&quot;OpenLayers/Format/WFSCapabilities/v1.js&quot;,&quot;OpenLayers/Format/WFSCapabilities/v1_0_0.js&quot;,&quot;OpenLayers/Format/WFSCapabilities/v1_1_0.js&quot;,&quot;OpenLayers/Format/WFSDescribeFeatureType.js&quot;,&quot;OpenLayers/Format/WMSDescribeLayer.js&quot;,&quot;OpenLayers/Format/WMSDescribeLayer/v1_1.js&quot;,&quot;OpenLayers/Format/WKT.js&quot;,&quot;OpenLayers/Format/OSM.js&quot;,&quot;OpenLayers/Format/GPX.js&quot;,&quot;OpenLayers/Format/Filter.js&quot;,&quot;OpenLayers/Format/Filter/v1.js&quot;,&quot;OpenLayers/Format/Filter/v1_0_0.js&quot;,&quot;OpenLayers/Format/Filter/v1_1_0.js&quot;,&quot;OpenLayers/Format/SLD.js&quot;,&quot;OpenLayers/Format/SLD/v1.js&quot;,&quot;OpenLayers/Format/SLD/v1_0_0.js&quot;,&quot;OpenLayers/Format/SLD/v1.js&quot;,&quot;OpenLayers/Format/WFST.js&quot;,&quot;OpenLayers/Format/WFST/v1.js&quot;,&quot;OpenLayers/Format/WFST/v1_0_0.js&quot;,&quot;OpenLayers/Format/WFST/v1_1_0.js&quot;,&quot;OpenLayers/Format/Text.js&quot;,&quot;OpenLayers/Format/JSON.js&quot;,&quot;OpenLayers/Format/GeoJSON.js&quot;,&quot;OpenLayers/Format/WMC.js&quot;,&quot;OpenLayers/Format/WMC/v1.js&quot;,&quot;OpenLayers/Format/WMC/v1_0_0.js&quot;,&quot;OpenLayers/Format/WMC/v1_1_0.js&quot;,&quot;OpenLayers/Format/WMSCapabilities.js&quot;,&quot;OpenLayers/Format/WMSCapabilities/v1_1.js&quot;,&quot;OpenLayers/Format/WMSCapabilities/v1_1_0.js&quot;,&quot;OpenLayers/Format/WMSCapabilities/v1_1_1.js&quot;,&quot;OpenLayers/Format/WMSGetFeatureInfo.js&quot;,&quot;OpenLayers/Layer/WFS.js&quot;,&quot;OpenLayers/Control/GetFeature.js&quot;,&quot;OpenLayers/Control/MouseToolbar.js&quot;,&quot;OpenLayers/Control/NavToolbar.js&quot;,&quot;OpenLayers/Control/PanPanel.js&quot;,&quot;OpenLayers/Control/Pan.js&quot;,&quot;OpenLayers/Control/ZoomIn.js&quot;,&quot;OpenLayers/Control/ZoomOut.js&quot;,&quot;OpenLayers/Control/ZoomPanel.js&quot;,&quot;OpenLayers/Control/EditingToolbar.js&quot;,&quot;OpenLayers/Lang.js&quot;,&quot;OpenLayers/Lang/en.js&quot;);var agent=navigator.userAgent;var docWrite=(agent.match(&quot;MSIE&quot;)||agent.match(&quot;Safari&quot;));if(docWrite){var allScriptTags=new Array(jsfiles.length);}
var host=OpenLayers._getScriptLocation()+&quot;lib/&quot;;for(var i=0,len=jsfiles.length;i&lt;len;i++){if(docWrite){allScriptTags[i]=&quot;&lt;script src=&apos;&quot;+host+jsfiles[i]+&quot;&apos;&gt;&lt;/script&gt;&quot;;}else{var s=document.createElement(&quot;script&quot;);s.src=host+jsfiles[i];var h=document.getElementsByTagName(&quot;head&quot;).length?document.getElementsByTagName(&quot;head&quot;)[0]:document.body;h.appendChild(s);}}
if(docWrite){document.write(allScriptTags.join(&quot;&quot;));}}})();OpenLayers.VERSION_NUMBER=&quot;OpenLayers 2.8 -- $Revision: 9492 $&quot;;OpenLayers.String={startsWith:function(str,sub){return(str.indexOf(sub)==0);},contains:function(str,sub){return(str.indexOf(sub)!=-1);},trim:function(str){return str.replace(/^\s\s*/,&apos;&apos;).replace(/\s\s*$/,&apos;&apos;);},camelize:function(str){var oStringList=str.split(&apos;-&apos;);var camelizedString=oStringList[0];for(var i=1,len=oStringList.length;i&lt;len;i++){var s=oStringList[i];camelizedString+=s.charAt(0).toUpperCase()+s.substring(1);}
return camelizedString;},format:function(template,context,args){if(!context){context=window;}
var replacer=function(str,match){var replacement;var subs=match.split(/\.+/);for(var i=0;i&lt;subs.length;i++){if(i==0){replacement=context;}
replacement=replacement[subs[i]];}
if(typeof replacement==&quot;function&quot;){replacement=args?replacement.apply(null,args):replacement();}
if(typeof replacement==&apos;undefined&apos;){return&apos;undefined&apos;;}else{return replacement;}};return template.replace(OpenLayers.String.tokenRegEx,replacer);},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(value){return OpenLayers.String.numberRegEx.test(value);},numericIf:function(value){return OpenLayers.String.isNumeric(value)?parseFloat(value):value;}};if(!String.prototype.startsWith){String.prototype.startsWith=function(sStart){OpenLayers.Console.warn(OpenLayers.i18n(&quot;methodDeprecated&quot;,{&apos;newMethod&apos;:&apos;OpenLayers.String.startsWith&apos;}));return OpenLayers.String.startsWith(this,sStart);};}
if(!String.prototype.contains){String.prototype.contains=function(str){OpenLayers.Console.warn(OpenLayers.i18n(&quot;methodDeprecated&quot;,{&apos;newMethod&apos;:&apos;OpenLayers.String.contains&apos;}));return OpenLayers.String.contains(this,str);};}
if(!String.prototype.trim){String.prototype.trim=function(){OpenLayers.Console.warn(OpenLayers.i18n(&quot;methodDeprecated&quot;,{&apos;newMethod&apos;:&apos;OpenLayers.String.trim&apos;}));return OpenLayers.String.trim(this);};}
if(!String.prototype.camelize){String.prototype.camelize=function(){OpenLayers.Console.warn(OpenLayers.i18n(&quot;methodDeprecated&quot;,{&apos;newMethod&apos;:&apos;OpenLayers.String.camelize&apos;}));return OpenLayers.String.camelize(this);};}
OpenLayers.Number={decimalSeparator:&quot;.&quot;,thousandsSeparator:&quot;,&quot;,limitSigDigs:function(num,sig){var fig=0;if(sig&gt;0){fig=parseFloat(num.toPrecision(sig));}
return fig;},format:function(num,dec,tsep,dsep){dec=(typeof dec!=&quot;undefined&quot;)?dec:0;tsep=(typeof tsep!=&quot;undefined&quot;)?tsep:OpenLayers.Number.thousandsSeparator;dsep=(typeof dsep!=&quot;undefined&quot;)?dsep:OpenLayers.Number.decimalSeparator;if(dec!=null){num=parseFloat(num.toFixed(dec));}
var parts=num.toString().split(&quot;.&quot;);if(parts.length==1&amp;&amp;dec==null){dec=0;}
var integer=parts[0];if(tsep){var thousands=/(-?[0-9]+)([0-9]{3})/;while(thousands.test(integer)){integer=integer.replace(thousands,&quot;$1&quot;+tsep+&quot;$2&quot;);}}
var str;if(dec==0){str=integer;}else{var rem=parts.length&gt;1?parts[1]:&quot;0&quot;;if(dec!=null){rem=rem+new Array(dec-rem.length+1).join(&quot;0&quot;);}
str=integer+dsep+rem;}
return str;}};if(!Number.prototype.limitSigDigs){Number.prototype.limitSigDigs=function(sig){OpenLayers.Console.warn(OpenLayers.i18n(&quot;methodDeprecated&quot;,{&apos;newMethod&apos;:&apos;OpenLayers.Number.limitSigDigs&apos;}));return OpenLayers.Number.limitSigDigs(this,sig);};}
OpenLayers.Function={bind:function(func,object){var args=Array.prototype.slice.apply(arguments,[2]);return function(){var newArgs=args.concat(Array.prototype.slice.apply(arguments,[0]));return func.apply(object,newArgs);};},bindAsEventListener:function(func,object){return function(event){return func.call(object,event||window.event);};}};if(!Function.prototype.bind){Function.prototype.bind=function(){OpenLayers.Console.warn(OpenLayers.i18n(&quot;methodDeprecated&quot;,{&apos;newMethod&apos;:&apos;OpenLayers.Function.bind&apos;}));Array.prototype.unshift.apply(arguments,[this]);return OpenLayers.Function.bind.apply(null,arguments);};}
if(!Function.prototype.bindAsEventListener){Function.prototype.bindAsEventListener=function(object){OpenLayers.Console.warn(OpenLayers.i18n(&quot;methodDeprecated&quot;,{&apos;newMethod&apos;:&apos;OpenLayers.Function.bindAsEventListener&apos;}));return OpenLayers.Function.bindAsEventListener(this,object);};}
OpenLayers.Array={filter:function(array,callback,caller){var selected=[];if(Array.prototype.filter){selected=array.filter(callback,caller);}else{var len=array.length;if(typeof callback!=&quot;function&quot;){throw new TypeError();}
for(var i=0;i&lt;len;i++){if(i in array){var val=array[i];if(callback.call(caller,val,i,array)){selected.push(val);}}}}
return selected;}};OpenLayers.Class=function(){var Class=function(){if(arguments&amp;&amp;arguments[0]!=OpenLayers.Class.isPrototype){this.initialize.apply(this,arguments);}};var extended={};var parent,initialize;for(var i=0,len=arguments.length;i&lt;len;++i){if(typeof arguments[i]==&quot;function&quot;){if(i==0&amp;&amp;len&gt;1){initialize=arguments[i].prototype.initialize;arguments[i].prototype.initialize=function(){};extended=new arguments[i];if(initialize===undefined){delete arguments[i].prototype.initialize;}else{arguments[i].prototype.initialize=initialize;}}
parent=arguments[i].prototype;}else{parent=arguments[i];}
OpenLayers.Util.extend(extended,parent);}
Class.prototype=extended;return Class;};OpenLayers.Class.isPrototype=function(){};OpenLayers.Class.create=function(){return function(){if(arguments&amp;&amp;arguments[0]!=OpenLayers.Class.isPrototype){this.initialize.apply(this,arguments);}};};OpenLayers.Class.inherit=function(){var superClass=arguments[0];var proto=new superClass(OpenLayers.Class.isPrototype);for(var i=1,len=arguments.length;i&lt;len;i++){if(typeof arguments[i]==&quot;function&quot;){var mixin=arguments[i];arguments[i]=new mixin(OpenLayers.Class.isPrototype);}
OpenLayers.Util.extend(proto,arguments[i]);}
return proto;};OpenLayers.Util={};OpenLayers.Util.getElement=function(){var elements=[];for(var i=0,len=arguments.length;i&lt;len;i++){var element=arguments[i];if(typeof element==&apos;string&apos;){element=document.getElementById(element);}
if(arguments.length==1){return element;}
elements.push(element);}
return elements;};if(typeof window.$===&quot;undefined&quot;){window.$=OpenLayers.Util.getElement;}
OpenLayers.Util.extend=function(destination,source){destination=destination||{};if(source){for(var property in source){var value=source[property];if(value!==undefined){destination[property]=value;}}
var sourceIsEvt=typeof window.Event==&quot;function&quot;&amp;&amp;source instanceof window.Event;if(!sourceIsEvt&amp;&amp;source.hasOwnProperty&amp;&amp;source.hasOwnProperty(&apos;toString&apos;)){destination.toString=source.toString;}}
return destination;};OpenLayers.Util.removeItem=function(array,item){for(var i=array.length-1;i&gt;=0;i--){if(array[i]==item){array.splice(i,1);}}
return array;};OpenLayers.Util.clearArray=function(array){OpenLayers.Console.warn(OpenLayers.i18n(&quot;methodDeprecated&quot;,{&apos;newMethod&apos;:&apos;array = []&apos;}));array.length=0;};OpenLayers.Util.indexOf=function(array,obj){for(var i=0,len=array.length;i&lt;len;i++){if(array[i]==obj){return i;}}
return-1;};OpenLayers.Util.modifyDOMElement=function(element,id,px,sz,position,border,overflow,opacity){if(id){element.id=id;}
if(px){element.style.left=px.x+&quot;px&quot;;element.style.top=px.y+&quot;px&quot;;}
if(sz){element.style.width=sz.w+&quot;px&quot;;element.style.height=sz.h+&quot;px&quot;;}
if(position){element.style.position=position;}
if(border){element.style.border=border;}
if(overflow){element.style.overflow=overflow;}
if(parseFloat(opacity)&gt;=0.0&amp;&amp;parseFloat(opacity)&lt;1.0){element.style.filter=&apos;alpha(opacity=&apos;+(opacity*100)+&apos;)&apos;;element.style.opacity=opacity;}else if(parseFloat(opacity)==1.0){element.style.filter=&apos;&apos;;element.style.opacity=&apos;&apos;;}};OpenLayers.Util.createDiv=function(id,px,sz,imgURL,position,border,overflow,opacity){var dom=document.createElement(&apos;div&apos;);if(imgURL){dom.style.backgroundImage=&apos;url(&apos;+imgURL+&apos;)&apos;;}
if(!id){id=OpenLayers.Util.createUniqueID(&quot;OpenLayersDiv&quot;);}
if(!position){position=&quot;absolute&quot;;}
OpenLayers.Util.modifyDOMElement(dom,id,px,sz,position,border,overflow,opacity);return dom;};OpenLayers.Util.createImage=function(id,px,sz,imgURL,position,border,opacity,delayDisplay){var image=document.createElement(&quot;img&quot;);if(!id){id=OpenLayers.Util.createUniqueID(&quot;OpenLayersDiv&quot;);}
if(!position){position=&quot;relative&quot;;}
OpenLayers.Util.modifyDOMElement(image,id,px,sz,position,border,null,opacity);if(delayDisplay){image.style.display=&quot;none&quot;;OpenLayers.Event.observe(image,&quot;load&quot;,OpenLayers.Function.bind(OpenLayers.Util.onImageLoad,image));OpenLayers.Event.observe(image,&quot;error&quot;,OpenLayers.Function.bind(OpenLayers.Util.onImageLoadError,image));}
image.style.alt=id;image.galleryImg=&quot;no&quot;;if(imgURL){image.src=imgURL;}
return image;};OpenLayers.Util.setOpacity=function(element,opacity){OpenLayers.Util.modifyDOMElement(element,null,null,null,null,null,null,opacity);};OpenLayers.Util.onImageLoad=function(){if(!this.viewRequestID||(this.map&amp;&amp;this.viewRequestID==this.map.viewRequestID)){this.style.backgroundColor=&quot;transparent&quot;;this.style.display=&quot;&quot;;}};OpenLayers.Util.onImageLoadErrorColor=&quot;pink&quot;;OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;OpenLayers.Util.onImageLoadError=function(){this._attempts=(this._attempts)?(this._attempts+1):1;if(this._attempts&lt;=OpenLayers.IMAGE_RELOAD_ATTEMPTS){var urls=this.urls;if(urls&amp;&amp;urls instanceof Array&amp;&amp;urls.length&gt;1){var src=this.src.toString();var current_url,k;for(k=0;current_url=urls[k];k++){if(src.indexOf(current_url)!=-1){break;}}
var guess=Math.floor(urls.length*Math.random());var new_url=urls[guess];k=0;while(new_url==current_url&amp;&amp;k++&lt;4){guess=Math.floor(urls.length*Math.random());new_url=urls[guess];}
this.src=src.replace(current_url,new_url);}else{this.src=this.src;}}else{this.style.backgroundColor=OpenLayers.Util.onImageLoadErrorColor;}
this.style.display=&quot;&quot;;};OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var arVersion=navigator.appVersion.split(&quot;MSIE&quot;);var version=parseFloat(arVersion[1]);var filter=false;try{filter=!!(document.body.filters);}catch(e){}
OpenLayers.Util.alphaHackNeeded=(filter&amp;&amp;(version&gt;=5.5)&amp;&amp;(version&lt;7));}
return OpenLayers.Util.alphaHackNeeded;};OpenLayers.Util.modifyAlphaImageDiv=function(div,id,px,sz,imgURL,position,border,sizing,opacity){OpenLayers.Util.modifyDOMElement(div,id,px,sz,position,null,null,opacity);var img=div.childNodes[0];if(imgURL){img.src=imgURL;}
OpenLayers.Util.modifyDOMElement(img,div.id+&quot;_innerImage&quot;,null,sz,&quot;relative&quot;,border);if(OpenLayers.Util.alphaHack()){if(div.style.display!=&quot;none&quot;){div.style.display=&quot;inline-block&quot;;}
if(sizing==null){sizing=&quot;scale&quot;;}
div.style.filter=&quot;progid:DXImageTransform.Microsoft&quot;+&quot;.AlphaImageLoader(src=&apos;&quot;+img.src+&quot;&apos;, &quot;+&quot;sizingMethod=&apos;&quot;+sizing+&quot;&apos;)&quot;;if(parseFloat(div.style.opacity)&gt;=0.0&amp;&amp;parseFloat(div.style.opacity)&lt;1.0){div.style.filter+=&quot; alpha(opacity=&quot;+div.style.opacity*100+&quot;)&quot;;}
img.style.filter=&quot;alpha(opacity=0)&quot;;}};OpenLayers.Util.createAlphaImageDiv=function(id,px,sz,imgURL,position,border,sizing,opacity,delayDisplay){var div=OpenLayers.Util.createDiv();var img=OpenLayers.Util.createImage(null,null,null,null,null,null,null,false);div.appendChild(img);if(delayDisplay){img.style.display=&quot;none&quot;;OpenLayers.Event.observe(img,&quot;load&quot;,OpenLayers.Function.bind(OpenLayers.Util.onImageLoad,div));OpenLayers.Event.observe(img,&quot;error&quot;,OpenLayers.Function.bind(OpenLayers.Util.onImageLoadError,div));}
OpenLayers.Util.modifyAlphaImageDiv(div,id,px,sz,imgURL,position,border,sizing,opacity);return div;};OpenLayers.Util.upperCaseObject=function(object){var uObject={};for(var key in object){uObject[key.toUpperCase()]=object[key];}
return uObject;};OpenLayers.Util.applyDefaults=function(to,from){to=to||{};var fromIsEvt=typeof window.Event==&quot;function&quot;&amp;&amp;from instanceof window.Event;for(var key in from){if(to[key]===undefined||(!fromIsEvt&amp;&amp;from.hasOwnProperty&amp;&amp;from.hasOwnProperty(key)&amp;&amp;!to.hasOwnProperty(key))){to[key]=from[key];}}
if(!fromIsEvt&amp;&amp;from&amp;&amp;from.hasOwnProperty&amp;&amp;from.hasOwnProperty(&apos;toString&apos;)&amp;&amp;!to.hasOwnProperty(&apos;toString&apos;)){to.toString=from.toString;}
return to;};OpenLayers.Util.getParameterString=function(params){var paramsArray=[];for(var key in params){var value=params[key];if((value!=null)&amp;&amp;(typeof value!=&apos;function&apos;)){var encodedValue;if(typeof value==&apos;object&apos;&amp;&amp;value.constructor==Array){var encodedItemArray=[];for(var itemIndex=0,len=value.length;itemIndex&lt;len;itemIndex++){encodedItemArray.push(encodeURIComponent(value[itemIndex]));}
encodedValue=encodedItemArray.join(&quot;,&quot;);}
else{encodedValue=encodeURIComponent(value);}
paramsArray.push(encodeURIComponent(key)+&quot;=&quot;+encodedValue);}}
return paramsArray.join(&quot;&amp;&quot;);};OpenLayers.ImgPath=&apos;&apos;;OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||(OpenLayers._getScriptLocation()+&quot;img/&quot;);};OpenLayers.Util.Try=function(){var returnValue=null;for(var i=0,len=arguments.length;i&lt;len;i++){var lambda=arguments[i];try{returnValue=lambda();break;}catch(e){}}
return returnValue;};OpenLayers.Util.getNodes=function(p,tagName){var nodes=OpenLayers.Util.Try(function(){return OpenLayers.Util._getNodes(p.documentElement.childNodes,tagName);},function(){return OpenLayers.Util._getNodes(p.childNodes,tagName);});return nodes;};OpenLayers.Util._getNodes=function(nodes,tagName){var retArray=[];for(var i=0,len=nodes.length;i&lt;len;i++){if(nodes[i].nodeName==tagName){retArray.push(nodes[i]);}}
return retArray;};OpenLayers.Util.getTagText=function(parent,item,index){var result=OpenLayers.Util.getNodes(parent,item);if(result&amp;&amp;(result.length&gt;0))
{if(!index){index=0;}
if(result[index].childNodes.length&gt;1){return result.childNodes[1].nodeValue;}
else if(result[index].childNodes.length==1){return result[index].firstChild.nodeValue;}}else{return&quot;&quot;;}};OpenLayers.Util.getXmlNodeValue=function(node){var val=null;OpenLayers.Util.Try(function(){val=node.text;if(!val){val=node.textContent;}
if(!val){val=node.firstChild.nodeValue;}},function(){val=node.textContent;});return val;};OpenLayers.Util.mouseLeft=function(evt,div){var target=(evt.relatedTarget)?evt.relatedTarget:evt.toElement;while(target!=div&amp;&amp;target!=null){target=target.parentNode;}
return(target!=div);};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(number,precision){if(precision==null){precision=OpenLayers.Util.DEFAULT_PRECISION;}
var number;if(precision==0){number=parseFloat(number);}else{number=parseFloat(parseFloat(number).toPrecision(precision));}
return number;};OpenLayers.Util.rad=function(x){return x*Math.PI/180;};OpenLayers.Util.distVincenty=function(p1,p2){var a=6378137,b=6356752.3142,f=1/298.257223563;var L=OpenLayers.Util.rad(p2.lon-p1.lon);var U1=Math.atan((1-f)*Math.tan(OpenLayers.Util.rad(p1.lat)));var U2=Math.atan((1-f)*Math.tan(OpenLayers.Util.rad(p2.lat)));var sinU1=Math.sin(U1),cosU1=Math.cos(U1);var sinU2=Math.sin(U2),cosU2=Math.cos(U2);var lambda=L,lambdaP=2*Math.PI;var iterLimit=20;while(Math.abs(lambda-lambdaP)&gt;1e-12&amp;&amp;--iterLimit&gt;0){var sinLambda=Math.sin(lambda),cosLambda=Math.cos(lambda);var sinSigma=Math.sqrt((cosU2*sinLambda)*(cosU2*sinLambda)+
(cosU1*sinU2-sinU1*cosU2*cosLambda)*(cosU1*sinU2-sinU1*cosU2*cosLambda));if(sinSigma==0){return 0;}
var cosSigma=sinU1*sinU2+cosU1*cosU2*cosLambda;var sigma=Math.atan2(sinSigma,cosSigma);var alpha=Math.asin(cosU1*cosU2*sinLambda/sinSigma);var cosSqAlpha=Math.cos(alpha)*Math.cos(alpha);var cos2SigmaM=cosSigma-2*sinU1*sinU2/cosSqAlpha;var C=f/16*cosSqAlpha*(4+f*(4-3*cosSqAlpha));lambdaP=lambda;lambda=L+(1-C)*f*Math.sin(alpha)*(sigma+C*sinSigma*(cos2SigmaM+C*cosSigma*(-1+2*cos2SigmaM*cos2SigmaM)));}
if(iterLimit==0){return NaN;}
var uSq=cosSqAlpha*(a*a-b*b)/(b*b);var A=1+uSq/16384*(4096+uSq*(-768+uSq*(320-175*uSq)));var B=uSq/1024*(256+uSq*(-128+uSq*(74-47*uSq)));var deltaSigma=B*sinSigma*(cos2SigmaM+B/4*(cosSigma*(-1+2*cos2SigmaM*cos2SigmaM)-
B/6*cos2SigmaM*(-3+4*sinSigma*sinSigma)*(-3+4*cos2SigmaM*cos2SigmaM)));var s=b*A*(sigma-deltaSigma);var d=s.toFixed(3)/1000;return d;};OpenLayers.Util.getParameters=function(url){url=url||window.location.href;var paramsString=&quot;&quot;;if(OpenLayers.String.contains(url,&apos;?&apos;)){var start=url.indexOf(&apos;?&apos;)+1;var end=OpenLayers.String.contains(url,&quot;#&quot;)?url.indexOf(&apos;#&apos;):url.length;paramsString=url.substring(start,end);}
var parameters={};var pairs=paramsString.split(/[&amp;;]/);for(var i=0,len=pairs.length;i&lt;len;++i){var keyValue=pairs[i].split(&apos;=&apos;);if(keyValue[0]){var key=decodeURIComponent(keyValue[0]);var value=keyValue[1]||&apos;&apos;;value=value.split(&quot;,&quot;);for(var j=0,jlen=value.length;j&lt;jlen;j++){value[j]=decodeURIComponent(value[j]);}
if(value.length==1){value=value[0];}
parameters[key]=value;}}
return parameters;};OpenLayers.Util.getArgs=function(url){OpenLayers.Console.warn(OpenLayers.i18n(&quot;methodDeprecated&quot;,{&apos;newMethod&apos;:&apos;OpenLayers.Util.getParameters&apos;}));return OpenLayers.Util.getParameters(url);};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(prefix){if(prefix==null){prefix=&quot;id_&quot;;}
OpenLayers.Util.lastSeqID+=1;return prefix+OpenLayers.Util.lastSeqID;};OpenLayers.INCHES_PER_UNIT={&apos;inches&apos;:1.0,&apos;ft&apos;:12.0,&apos;mi&apos;:63360.0,&apos;m&apos;:39.3701,&apos;km&apos;:39370.1,&apos;dd&apos;:4374754,&apos;yd&apos;:36};OpenLayers.INCHES_PER_UNIT[&quot;in&quot;]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT[&quot;degrees&quot;]=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT[&quot;nmi&quot;]=1852*OpenLayers.INCHES_PER_UNIT.m;OpenLayers.METERS_PER_INCH=0.02540005080010160020;OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{&quot;Inch&quot;:OpenLayers.INCHES_PER_UNIT.inches,&quot;Meter&quot;:1.0/OpenLayers.METERS_PER_INCH,&quot;Foot&quot;:0.30480060960121920243/OpenLayers.METERS_PER_INCH,&quot;IFoot&quot;:0.30480000000000000000/OpenLayers.METERS_PER_INCH,&quot;ClarkeFoot&quot;:0.3047972651151/OpenLayers.METERS_PER_INCH,&quot;SearsFoot&quot;:0.30479947153867624624/OpenLayers.METERS_PER_INCH,&quot;GoldCoastFoot&quot;:0.30479971018150881758/OpenLayers.METERS_PER_INCH,&quot;IInch&quot;:0.02540000000000000000/OpenLayers.METERS_PER_INCH,&quot;MicroInch&quot;:0.00002540000000000000/OpenLayers.METERS_PER_INCH,&quot;Mil&quot;:0.00000002540000000000/OpenLayers.METERS_PER_INCH,&quot;Centimeter&quot;:0.01000000000000000000/OpenLayers.METERS_PER_INCH,&quot;Kilometer&quot;:1000.00000000000000000000/OpenLayers.METERS_PER_INCH,&quot;Yard&quot;:0.91440182880365760731/OpenLayers.METERS_PER_INCH,&quot;SearsYard&quot;:0.914398414616029/OpenLayers.METERS_PER_INCH,&quot;IndianYard&quot;:0.91439853074444079983/OpenLayers.METERS_PER_INCH,&quot;IndianYd37&quot;:0.91439523/OpenLayers.METERS_PER_INCH,&quot;IndianYd62&quot;:0.9143988/OpenLayers.METERS_PER_INCH,&quot;IndianYd75&quot;:0.9143985/OpenLayers.METERS_PER_INCH,&quot;IndianFoot&quot;:0.30479951/OpenLayers.METERS_PER_INCH,&quot;IndianFt37&quot;:0.30479841/OpenLayers.METERS_PER_INCH,&quot;IndianFt62&quot;:0.3047996/OpenLayers.METERS_PER_INCH,&quot;IndianFt75&quot;:0.3047995/OpenLayers.METERS_PER_INCH,&quot;Mile&quot;:1609.34721869443738887477/OpenLayers.METERS_PER_INCH,&quot;IYard&quot;:0.91440000000000000000/OpenLayers.METERS_PER_INCH,&quot;IMile&quot;:1609.34400000000000000000/OpenLayers.METERS_PER_INCH,&quot;NautM&quot;:1852.00000000000000000000/OpenLayers.METERS_PER_INCH,&quot;Lat-66&quot;:110943.316488932731/OpenLayers.METERS_PER_INCH,&quot;Lat-83&quot;:110946.25736872234125/OpenLayers.METERS_PER_INCH,&quot;Decimeter&quot;:0.10000000000000000000/OpenLayers.METERS_PER_INCH,&quot;Millimeter&quot;:0.00100000000000000000/OpenLayers.METERS_PER_INCH,&quot;Dekameter&quot;:10.00000000000000000000/OpenLayers.METERS_PER_INCH,&quot;Decameter&quot;:10.00000000000000000000/OpenLayers.METERS_PER_INCH,&quot;Hectometer&quot;:100.00000000000000000000/OpenLayers.METERS_PER_INCH,&quot;GermanMeter&quot;:1.0000135965/OpenLayers.METERS_PER_INCH,&quot;CaGrid&quot;:0.999738/OpenLayers.METERS_PER_INCH,&quot;ClarkeChain&quot;:20.1166194976/OpenLayers.METERS_PER_INCH,&quot;GunterChain&quot;:20.11684023368047/OpenLayers.METERS_PER_INCH,&quot;BenoitChain&quot;:20.116782494375872/OpenLayers.METERS_PER_INCH,&quot;SearsChain&quot;:20.11676512155/OpenLayers.METERS_PER_INCH,&quot;ClarkeLink&quot;:0.201166194976/OpenLayers.METERS_PER_INCH,&quot;GunterLink&quot;:0.2011684023368047/OpenLayers.METERS_PER_INCH,&quot;BenoitLink&quot;:0.20116782494375872/OpenLayers.METERS_PER_INCH,&quot;SearsLink&quot;:0.2011676512155/OpenLayers.METERS_PER_INCH,&quot;Rod&quot;:5.02921005842012/OpenLayers.METERS_PER_INCH,&quot;IntnlChain&quot;:20.1168/OpenLayers.METERS_PER_INCH,&quot;IntnlLink&quot;:0.201168/OpenLayers.METERS_PER_INCH,&quot;Perch&quot;:5.02921005842012/OpenLayers.METERS_PER_INCH,&quot;Pole&quot;:5.02921005842012/OpenLayers.METERS_PER_INCH,&quot;Furlong&quot;:201.1684023368046/OpenLayers.METERS_PER_INCH,&quot;Rood&quot;:3.778266898/OpenLayers.METERS_PER_INCH,&quot;CapeFoot&quot;:0.3047972615/OpenLayers.METERS_PER_INCH,&quot;Brealey&quot;:375.00000000000000000000/OpenLayers.METERS_PER_INCH,&quot;ModAmFt&quot;:0.304812252984505969011938/OpenLayers.METERS_PER_INCH,&quot;Fathom&quot;:1.8288/OpenLayers.METERS_PER_INCH,&quot;NautM-UK&quot;:1853.184/OpenLayers.METERS_PER_INCH,&quot;50kilometers&quot;:50000.0/OpenLayers.METERS_PER_INCH,&quot;150kilometers&quot;:150000.0/OpenLayers.METERS_PER_INCH});OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{&quot;mm&quot;:OpenLayers.INCHES_PER_UNIT[&quot;Meter&quot;]/1000.0,&quot;cm&quot;:OpenLayers.INCHES_PER_UNIT[&quot;Meter&quot;]/100.0,&quot;dm&quot;:OpenLayers.INCHES_PER_UNIT[&quot;Meter&quot;]*100.0,&quot;km&quot;:OpenLayers.INCHES_PER_UNIT[&quot;Meter&quot;]*1000.0,&quot;kmi&quot;:OpenLayers.INCHES_PER_UNIT[&quot;nmi&quot;],&quot;fath&quot;:OpenLayers.INCHES_PER_UNIT[&quot;Fathom&quot;],&quot;ch&quot;:OpenLayers.INCHES_PER_UNIT[&quot;IntnlChain&quot;],&quot;link&quot;:OpenLayers.INCHES_PER_UNIT[&quot;IntnlLink&quot;],&quot;us-in&quot;:OpenLayers.INCHES_PER_UNIT[&quot;inches&quot;],&quot;us-ft&quot;:OpenLayers.INCHES_PER_UNIT[&quot;Foot&quot;],&quot;us-yd&quot;:OpenLayers.INCHES_PER_UNIT[&quot;Yard&quot;],&quot;us-ch&quot;:OpenLayers.INCHES_PER_UNIT[&quot;GunterChain&quot;],&quot;us-mi&quot;:OpenLayers.INCHES_PER_UNIT[&quot;Mile&quot;],&quot;ind-yd&quot;:OpenLayers.INCHES_PER_UNIT[&quot;IndianYd37&quot;],&quot;ind-ft&quot;:OpenLayers.INCHES_PER_UNIT[&quot;IndianFt37&quot;],&quot;ind-ch&quot;:20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(scale){var normScale=(scale&gt;1.0)?(1.0/scale):scale;return normScale;};OpenLayers.Util.getResolutionFromScale=function(scale,units){if(units==null){units=&quot;degrees&quot;;}
var normScale=OpenLayers.Util.normalizeScale(scale);var resolution=1/(normScale*OpenLayers.INCHES_PER_UNIT[units]*OpenLayers.DOTS_PER_INCH);return resolution;};OpenLayers.Util.getScaleFromResolution=function(resolution,units){if(units==null){units=&quot;degrees&quot;;}
var scale=resolution*OpenLayers.INCHES_PER_UNIT[units]*OpenLayers.DOTS_PER_INCH;return scale;};OpenLayers.Util.safeStopPropagation=function(evt){OpenLayers.Event.stop(evt,true);};OpenLayers.Util.pagePosition=function(forElement){var valueT=0,valueL=0;var element=forElement;var child=forElement;while(element){if(element==document.body){if(OpenLayers.Element.getStyle(child,&apos;position&apos;)==&apos;absolute&apos;){break;}}
valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;child=element;try{element=element.offsetParent;}catch(e){OpenLayers.Console.error(OpenLayers.i18n(&quot;pagePositionFailed&quot;,{&apos;elemId&apos;:element.id}));break;}}
element=forElement;while(element){valueT-=element.scrollTop||0;valueL-=element.scrollLeft||0;element=element.parentNode;}
return[valueL,valueT];};OpenLayers.Util.isEquivalentUrl=function(url1,url2,options){options=options||{};OpenLayers.Util.applyDefaults(options,{ignoreCase:true,ignorePort80:true,ignoreHash:true});var urlObj1=OpenLayers.Util.createUrlObject(url1,options);var urlObj2=OpenLayers.Util.createUrlObject(url2,options);for(var key in urlObj1){if(key!==&quot;args&quot;){if(urlObj1[key]!=urlObj2[key]){return false;}}}
for(var key in urlObj1.args){if(urlObj1.args[key]!=urlObj2.args[key]){return false;}
delete urlObj2.args[key];}
for(var key in urlObj2.args){return false;}
return true;};OpenLayers.Util.createUrlObject=function(url,options){options=options||{};if(!(/^\w+:\/\//).test(url)){var loc=window.location;var port=loc.port?&quot;:&quot;+loc.port:&quot;&quot;;var fullUrl=loc.protocol+&quot;//&quot;+loc.host.split(&quot;:&quot;).shift()+port;if(url.indexOf(&quot;/&quot;)===0){url=fullUrl+url;}else{var parts=loc.pathname.split(&quot;/&quot;);parts.pop();url=fullUrl+parts.join(&quot;/&quot;)+&quot;/&quot;+url;}}
if(options.ignoreCase){url=url.toLowerCase();}
var a=document.createElement(&apos;a&apos;);a.href=url;var urlObject={};urlObject.host=a.host.split(&quot;:&quot;).shift();urlObject.protocol=a.protocol;if(options.ignorePort80){urlObject.port=(a.port==&quot;80&quot;||a.port==&quot;0&quot;)?&quot;&quot;:a.port;}else{urlObject.port=(a.port==&quot;&quot;||a.port==&quot;0&quot;)?&quot;80&quot;:a.port;}
urlObject.hash=(options.ignoreHash||a.hash===&quot;#&quot;)?&quot;&quot;:a.hash;var queryString=a.search;if(!queryString){var qMark=url.indexOf(&quot;?&quot;);queryString=(qMark!=-1)?url.substr(qMark):&quot;&quot;;}
urlObject.args=OpenLayers.Util.getParameters(queryString);urlObject.pathname=(a.pathname.charAt(0)==&quot;/&quot;)?a.pathname:&quot;/&quot;+a.pathname;return urlObject;};OpenLayers.Util.removeTail=function(url){var head=null;var qMark=url.indexOf(&quot;?&quot;);var hashMark=url.indexOf(&quot;#&quot;);if(qMark==-1){head=(hashMark!=-1)?url.substr(0,hashMark):url;}else{head=(hashMark!=-1)?url.substr(0,Math.min(qMark,hashMark)):url.substr(0,qMark);}
return head;};OpenLayers.Util.getBrowserName=function(){var browserName=&quot;&quot;;var ua=navigator.userAgent.toLowerCase();if(ua.indexOf(&quot;opera&quot;)!=-1){browserName=&quot;opera&quot;;}else if(ua.indexOf(&quot;msie&quot;)!=-1){browserName=&quot;msie&quot;;}else if(ua.indexOf(&quot;safari&quot;)!=-1){browserName=&quot;safari&quot;;}else if(ua.indexOf(&quot;mozilla&quot;)!=-1){if(ua.indexOf(&quot;firefox&quot;)!=-1){browserName=&quot;firefox&quot;;}else{browserName=&quot;mozilla&quot;;}}
return browserName;};OpenLayers.Util.getRenderedDimensions=function(contentHTML,size,options){var w,h;var container=document.createElement(&quot;div&quot;);container.style.visibility=&quot;hidden&quot;;var containerElement=(options&amp;&amp;options.containerElement)?options.containerElement:document.body;if(size){if(size.w){w=size.w;container.style.width=w+&quot;px&quot;;}else if(size.h){h=size.h;container.style.height=h+&quot;px&quot;;}}
if(options&amp;&amp;options.displayClass){container.className=options.displayClass;}
var content=document.createElement(&quot;div&quot;);content.innerHTML=contentHTML;content.style.overflow=&quot;visible&quot;;if(content.childNodes){for(var i=0,l=content.childNodes.length;i&lt;l;i++){if(!content.childNodes[i].style)continue;content.childNodes[i].style.overflow=&quot;visible&quot;;}}
container.appendChild(content);containerElement.appendChild(container);var parentHasPositionAbsolute=false;var parent=container.parentNode;while(parent&amp;&amp;parent.tagName.toLowerCase()!=&quot;body&quot;){var parentPosition=OpenLayers.Element.getStyle(parent,&quot;position&quot;);if(parentPosition==&quot;absolute&quot;){parentHasPositionAbsolute=true;break;}else if(parentPosition&amp;&amp;parentPosition!=&quot;static&quot;){break;}
parent=parent.parentNode;}
if(!parentHasPositionAbsolute){container.style.position=&quot;absolute&quot;;}
if(!w){w=parseInt(content.scrollWidth);container.style.width=w+&quot;px&quot;;}
if(!h){h=parseInt(content.scrollHeight);}
container.removeChild(content);containerElement.removeChild(container);return new OpenLayers.Size(w,h);};OpenLayers.Util.getScrollbarWidth=function(){var scrollbarWidth=OpenLayers.Util._scrollbarWidth;if(scrollbarWidth==null){var scr=null;var inn=null;var wNoScroll=0;var wScroll=0;scr=document.createElement(&apos;div&apos;);scr.style.position=&apos;absolute&apos;;scr.style.top=&apos;-1000px&apos;;scr.style.left=&apos;-1000px&apos;;scr.style.width=&apos;100px&apos;;scr.style.height=&apos;50px&apos;;scr.style.overflow=&apos;hidden&apos;;inn=document.createElement(&apos;div&apos;);inn.style.width=&apos;100%&apos;;inn.style.height=&apos;200px&apos;;scr.appendChild(inn);document.body.appendChild(scr);wNoScroll=inn.offsetWidth;scr.style.overflow=&apos;scroll&apos;;wScroll=inn.offsetWidth;document.body.removeChild(document.body.lastChild);OpenLayers.Util._scrollbarWidth=(wNoScroll-wScroll);scrollbarWidth=OpenLayers.Util._scrollbarWidth;}
return scrollbarWidth;};OpenLayers.Rico=new Object();OpenLayers.Rico.Corner={round:function(e,options){e=OpenLayers.Util.getElement(e);this._setOptions(options);var color=this.options.color;if(this.options.color==&quot;fromElement&quot;){color=this._background(e);}
var bgColor=this.options.bgColor;if(this.options.bgColor==&quot;fromParent&quot;){bgColor=this._background(e.offsetParent);}
this._roundCornersImpl(e,color,bgColor);},changeColor:function(theDiv,newColor){theDiv.style.backgroundColor=newColor;var spanElements=theDiv.parentNode.getElementsByTagName(&quot;span&quot;);for(var currIdx=0;currIdx&lt;spanElements.length;currIdx++){spanElements[currIdx].style.backgroundColor=newColor;}},changeOpacity:function(theDiv,newOpacity){var mozillaOpacity=newOpacity;var ieOpacity=&apos;alpha(opacity=&apos;+newOpacity*100+&apos;)&apos;;theDiv.style.opacity=mozillaOpacity;theDiv.style.filter=ieOpacity;var spanElements=theDiv.parentNode.getElementsByTagName(&quot;span&quot;);for(var currIdx=0;currIdx&lt;spanElements.length;currIdx++){spanElements[currIdx].style.opacity=mozillaOpacity;spanElements[currIdx].style.filter=ieOpacity;}},reRound:function(theDiv,options){var topRico=theDiv.parentNode.childNodes[0];var bottomRico=theDiv.parentNode.childNodes[2];theDiv.parentNode.removeChild(topRico);theDiv.parentNode.removeChild(bottomRico);this.round(theDiv.parentNode,options);},_roundCornersImpl:function(e,color,bgColor){if(this.options.border){this._renderBorder(e,bgColor);}
if(this._isTopRounded()){this._roundTopCorners(e,color,bgColor);}
if(this._isBottomRounded()){this._roundBottomCorners(e,color,bgColor);}},_renderBorder:function(el,bgColor){var borderValue=&quot;1px solid &quot;+this._borderColor(bgColor);var borderL=&quot;border-left: &quot;+borderValue;var borderR=&quot;border-right: &quot;+borderValue;var style=&quot;style=&apos;&quot;+borderL+&quot;;&quot;+borderR+&quot;&apos;&quot;;el.innerHTML=&quot;&lt;div &quot;+style+&quot;&gt;&quot;+el.innerHTML+&quot;&lt;/div&gt;&quot;;},_roundTopCorners:function(el,color,bgColor){var corner=this._createCorner(bgColor);for(var i=0;i&lt;this.options.numSlices;i++){corner.appendChild(this._createCornerSlice(color,bgColor,i,&quot;top&quot;));}
el.style.paddingTop=0;el.insertBefore(corner,el.firstChild);},_roundBottomCorners:function(el,color,bgColor){var corner=this._createCorner(bgColor);for(var i=(this.options.numSlices-1);i&gt;=0;i--){corner.appendChild(this._createCornerSlice(color,bgColor,i,&quot;bottom&quot;));}
el.style.paddingBottom=0;el.appendChild(corner);},_createCorner:function(bgColor){var corner=document.createElement(&quot;div&quot;);corner.style.backgroundColor=(this._isTransparent()?&quot;transparent&quot;:bgColor);return corner;},_createCornerSlice:function(color,bgColor,n,position){var slice=document.createElement(&quot;span&quot;);var inStyle=slice.style;inStyle.backgroundColor=color;inStyle.display=&quot;block&quot;;inStyle.height=&quot;1px&quot;;inStyle.overflow=&quot;hidden&quot;;inStyle.fontSize=&quot;1px&quot;;var borderColor=this._borderColor(color,bgColor);if(this.options.border&amp;&amp;n==0){inStyle.borderTopStyle=&quot;solid&quot;;inStyle.borderTopWidth=&quot;1px&quot;;inStyle.borderLeftWidth=&quot;0px&quot;;inStyle.borderRightWidth=&quot;0px&quot;;inStyle.borderBottomWidth=&quot;0px&quot;;inStyle.height=&quot;0px&quot;;inStyle.borderColor=borderColor;}
else if(borderColor){inStyle.borderColor=borderColor;inStyle.borderStyle=&quot;solid&quot;;inStyle.borderWidth=&quot;0px 1px&quot;;}
if(!this.options.compact&amp;&amp;(n==(this.options.numSlices-1))){inStyle.height=&quot;2px&quot;;}
this._setMargin(slice,n,position);this._setBorder(slice,n,position);return slice;},_setOptions:function(options){this.options={corners:&quot;all&quot;,color:&quot;fromElement&quot;,bgColor:&quot;fromParent&quot;,blend:true,border:false,compact:false};OpenLayers.Util.extend(this.options,options||{});this.options.numSlices=this.options.compact?2:4;if(this._isTransparent()){this.options.blend=false;}},_whichSideTop:function(){if(this._hasString(this.options.corners,&quot;all&quot;,&quot;top&quot;)){return&quot;&quot;;}
if(this.options.corners.indexOf(&quot;tl&quot;)&gt;=0&amp;&amp;this.options.corners.indexOf(&quot;tr&quot;)&gt;=0){return&quot;&quot;;}
if(this.options.corners.indexOf(&quot;tl&quot;)&gt;=0){return&quot;left&quot;;}else if(this.options.corners.indexOf(&quot;tr&quot;)&gt;=0){return&quot;right&quot;;}
return&quot;&quot;;},_whichSideBottom:function(){if(this._hasString(this.options.corners,&quot;all&quot;,&quot;bottom&quot;)){return&quot;&quot;;}
if(this.options.corners.indexOf(&quot;bl&quot;)&gt;=0&amp;&amp;this.options.corners.indexOf(&quot;br&quot;)&gt;=0){return&quot;&quot;;}
if(this.options.corners.indexOf(&quot;bl&quot;)&gt;=0){return&quot;left&quot;;}else if(this.options.corners.indexOf(&quot;br&quot;)&gt;=0){return&quot;right&quot;;}
return&quot;&quot;;},_borderColor:function(color,bgColor){if(color==&quot;transparent&quot;){return bgColor;}else if(this.options.border){return this.options.border;}else if(this.options.blend){return this._blend(bgColor,color);}else{return&quot;&quot;;}},_setMargin:function(el,n,corners){var marginSize=this._marginSize(n);var whichSide=corners==&quot;top&quot;?this._whichSideTop():this._whichSideBottom();if(whichSide==&quot;left&quot;){el.style.marginLeft=marginSize+&quot;px&quot;;el.style.marginRight=&quot;0px&quot;;}
else if(whichSide==&quot;right&quot;){el.style.marginRight=marginSize+&quot;px&quot;;el.style.marginLeft=&quot;0px&quot;;}
else{el.style.marginLeft=marginSize+&quot;px&quot;;el.style.marginRight=marginSize+&quot;px&quot;;}},_setBorder:function(el,n,corners){var borderSize=this._borderSize(n);var whichSide=corners==&quot;top&quot;?this._whichSideTop():this._whichSideBottom();if(whichSide==&quot;left&quot;){el.style.borderLeftWidth=borderSize+&quot;px&quot;;el.style.borderRightWidth=&quot;0px&quot;;}
else if(whichSide==&quot;right&quot;){el.style.borderRightWidth=borderSize+&quot;px&quot;;el.style.borderLeftWidth=&quot;0px&quot;;}
else{el.style.borderLeftWidth=borderSize+&quot;px&quot;;el.style.borderRightWidth=borderSize+&quot;px&quot;;}
if(this.options.border!=false){el.style.borderLeftWidth=borderSize+&quot;px&quot;;el.style.borderRightWidth=borderSize+&quot;px&quot;;}},_marginSize:function(n){if(this._isTransparent()){return 0;}
var marginSizes=[5,3,2,1];var blendedMarginSizes=[3,2,1,0];var compactMarginSizes=[2,1];var smBlendedMarginSizes=[1,0];if(this.options.compact&amp;&amp;this.options.blend){return smBlendedMarginSizes[n];}else if(this.options.compact){return compactMarginSizes[n];}else if(this.options.blend){return blendedMarginSizes[n];}else{return marginSizes[n];}},_borderSize:function(n){var transparentBorderSizes=[5,3,2,1];var blendedBorderSizes=[2,1,1,1];var compactBorderSizes=[1,0];var actualBorderSizes=[0,2,0,0];if(this.options.compact&amp;&amp;(this.options.blend||this._isTransparent())){return 1;}else if(this.options.compact){return compactBorderSizes[n];}else if(this.options.blend){return blendedBorderSizes[n];}else if(this.options.border){return actualBorderSizes[n];}else if(this._isTransparent()){return transparentBorderSizes[n];}
return 0;},_hasString:function(str){for(var i=1;i&lt;arguments.length;i++)if(str.indexOf(arguments[i])&gt;=0){return true;}return false;},_blend:function(c1,c2){var cc1=OpenLayers.Rico.Color.createFromHex(c1);cc1.blend(OpenLayers.Rico.Color.createFromHex(c2));return cc1;},_background:function(el){try{return OpenLayers.Rico.Color.createColorFromBackground(el).asHex();}catch(err){return&quot;#ffffff&quot;;}},_isTransparent:function(){return this.options.color==&quot;transparent&quot;;},_isTopRounded:function(){return this._hasString(this.options.corners,&quot;all&quot;,&quot;top&quot;,&quot;tl&quot;,&quot;tr&quot;);},_isBottomRounded:function(){return this._hasString(this.options.corners,&quot;all&quot;,&quot;bottom&quot;,&quot;bl&quot;,&quot;br&quot;);},_hasSingleTextChild:function(el){return el.childNodes.length==1&amp;&amp;el.childNodes[0].nodeType==3;}};(function(){if(window.google&amp;&amp;google.gears){return;}
var factory=null;if(typeof GearsFactory!=&apos;undefined&apos;){factory=new GearsFactory();}else{try{factory=new ActiveXObject(&apos;Gears.Factory&apos;);if(factory.getBuildInfo().indexOf(&apos;ie_mobile&apos;)!=-1){factory.privateSetGlobalObject(this);}}catch(e){if((typeof navigator.mimeTypes!=&apos;undefined&apos;)&amp;&amp;navigator.mimeTypes[&quot;application/x-googlegears&quot;]){factory=document.createElement(&quot;object&quot;);factory.style.display=&quot;none&quot;;factory.width=0;factory.height=0;factory.type=&quot;application/x-googlegears&quot;;document.documentElement.appendChild(factory);}}}
if(!factory){return;}
if(!window.google){google={};}
if(!google.gears){google.gears={factory:factory};}})();OpenLayers.Element={visible:function(element){return OpenLayers.Util.getElement(element).style.display!=&apos;none&apos;;},toggle:function(){for(var i=0,len=arguments.length;i&lt;len;i++){var element=OpenLayers.Util.getElement(arguments[i]);var display=OpenLayers.Element.visible(element)?&apos;hide&apos;:&apos;show&apos;;OpenLayers.Element[display](element);}},hide:function(){for(var i=0,len=arguments.length;i&lt;len;i++){var element=OpenLayers.Util.getElement(arguments[i]);element.style.display=&apos;none&apos;;}},show:function(){for(var i=0,len=arguments.length;i&lt;len;i++){var element=OpenLayers.Util.getElement(arguments[i]);element.style.display=&apos;&apos;;}},remove:function(element){element=OpenLayers.Util.getElement(element);element.parentNode.removeChild(element);},getHeight:function(element){element=OpenLayers.Util.getElement(element);return element.offsetHeight;},getDimensions:function(element){element=OpenLayers.Util.getElement(element);if(OpenLayers.Element.getStyle(element,&apos;display&apos;)!=&apos;none&apos;){return{width:element.offsetWidth,height:element.offsetHeight};}
var els=element.style;var originalVisibility=els.visibility;var originalPosition=els.position;els.visibility=&apos;hidden&apos;;els.position=&apos;absolute&apos;;els.display=&apos;&apos;;var originalWidth=element.clientWidth;var originalHeight=element.clientHeight;els.display=&apos;none&apos;;els.position=originalPosition;els.visibility=originalVisibility;return{width:originalWidth,height:originalHeight};},hasClass:function(element,name){var names=element.className;return(!!names&amp;&amp;new RegExp(&quot;(^|\\s)&quot;+name+&quot;(\\s|$)&quot;).test(names));},addClass:function(element,name){if(!OpenLayers.Element.hasClass(element,name)){element.className+=(element.className?&quot; &quot;:&quot;&quot;)+name;}
return element;},removeClass:function(element,name){var names=element.className;if(names){element.className=OpenLayers.String.trim(names.replace(new RegExp(&quot;(^|\\s+)&quot;+name+&quot;(\\s+|$)&quot;),&quot; &quot;));}
return element;},toggleClass:function(element,name){if(OpenLayers.Element.hasClass(element,name)){OpenLayers.Element.removeClass(element,name);}else{OpenLayers.Element.addClass(element,name);}
return element;},getStyle:function(element,style){element=OpenLayers.Util.getElement(element);var value=null;if(element&amp;&amp;element.style){value=element.style[OpenLayers.String.camelize(style)];if(!value){if(document.defaultView&amp;&amp;document.defaultView.getComputedStyle){var css=document.defaultView.getComputedStyle(element,null);value=css?css.getPropertyValue(style):null;}else if(element.currentStyle){value=element.currentStyle[OpenLayers.String.camelize(style)];}}
var positions=[&apos;left&apos;,&apos;top&apos;,&apos;right&apos;,&apos;bottom&apos;];if(window.opera&amp;&amp;(OpenLayers.Util.indexOf(positions,style)!=-1)&amp;&amp;(OpenLayers.Element.getStyle(element,&apos;position&apos;)==&apos;static&apos;)){value=&apos;auto&apos;;}}
return value==&apos;auto&apos;?null:value;}};OpenLayers.Size=OpenLayers.Class({w:0.0,h:0.0,initialize:function(w,h){this.w=parseFloat(w);this.h=parseFloat(h);},toString:function(){return(&quot;w=&quot;+this.w+&quot;,h=&quot;+this.h);},clone:function(){return new OpenLayers.Size(this.w,this.h);},equals:function(sz){var equals=false;if(sz!=null){equals=((this.w==sz.w&amp;&amp;this.h==sz.h)||(isNaN(this.w)&amp;&amp;isNaN(this.h)&amp;&amp;isNaN(sz.w)&amp;&amp;isNaN(sz.h)));}
return equals;},CLASS_NAME:&quot;OpenLayers.Size&quot;});OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(error){alert(error);},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:&quot;OpenLayers.Console&quot;};(function(){var scripts=document.getElementsByTagName(&quot;script&quot;);for(var i=0,len=scripts.length;i&lt;len;++i){if(scripts[i].src.indexOf(&quot;firebug.js&quot;)!=-1){if(console){OpenLayers.Util.extend(OpenLayers.Console,console);break;}}}})();OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(url,size,offset,calculateOffset){this.url=url;this.size=(size)?size:new OpenLayers.Size(20,20);this.offset=offset?offset:new OpenLayers.Pixel(-(this.size.w/2),-(this.size.h/2));this.calculateOffset=calculateOffset;var id=OpenLayers.Util.createUniqueID(&quot;OL_Icon_&quot;);this.imageDiv=OpenLayers.Util.createAlphaImageDiv(id);},destroy:function(){this.erase();OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild);this.imageDiv.innerHTML=&quot;&quot;;this.imageDiv=null;},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset);},setSize:function(size){if(size!=null){this.size=size;}
this.draw();},setUrl:function(url){if(url!=null){this.url=url;}
this.draw();},draw:function(px){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,&quot;absolute&quot;);this.moveTo(px);return this.imageDiv;},erase:function(){if(this.imageDiv!=null&amp;&amp;this.imageDiv.parentNode!=null){OpenLayers.Element.remove(this.imageDiv);}},setOpacity:function(opacity){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,opacity);},moveTo:function(px){if(px!=null){this.px=px;}
if(this.imageDiv!=null){if(this.px==null){this.display(false);}else{if(this.calculateOffset){this.offset=this.calculateOffset(this.size);}
var offsetPx=this.px.offset(this.offset);OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,offsetPx);}}},display:function(display){this.imageDiv.style.display=(display)?&quot;&quot;:&quot;none&quot;;},isDrawn:function(){var isDrawn=(this.imageDiv&amp;&amp;this.imageDiv.parentNode&amp;&amp;(this.imageDiv.parentNode.nodeType!=11));return isDrawn;},CLASS_NAME:&quot;OpenLayers.Icon&quot;});OpenLayers.Popup=OpenLayers.Class({events:null,id:&quot;&quot;,lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:&quot;&quot;,opacity:&quot;&quot;,border:&quot;&quot;,contentDiv:null,groupDiv:null,closeDiv:null,autoSize:false,minSize:null,maxSize:null,displayClass:&quot;olPopup&quot;,contentDisplayClass:&quot;olPopupContent&quot;,padding:0,disableFirefoxOverflowHack:false,fixPadding:function(){if(typeof this.padding==&quot;number&quot;){this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding);}},panMapIfOutOfView:false,keepInMap:false,closeOnMove:false,map:null,initialize:function(id,lonlat,contentSize,contentHTML,closeBox,closeBoxCallback){if(id==null){id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+&quot;_&quot;);}
this.id=id;this.lonlat=lonlat;this.contentSize=(contentSize!=null)?contentSize:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);if(contentHTML!=null){this.contentHTML=contentHTML;}
this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,&quot;hidden&quot;);this.div.className=this.displayClass;var groupDivId=this.id+&quot;_GroupDiv&quot;;this.groupDiv=OpenLayers.Util.createDiv(groupDivId,null,null,null,&quot;relative&quot;,null,&quot;hidden&quot;);var id=this.div.id+&quot;_contentDiv&quot;;this.contentDiv=OpenLayers.Util.createDiv(id,null,this.contentSize.clone(),null,&quot;relative&quot;);this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);if(closeBox){this.addCloseBox(closeBoxCallback);}
this.registerEvents();},destroy:function(){this.id=null;this.lonlat=null;this.size=null;this.contentHTML=null;this.backgroundColor=null;this.opacity=null;this.border=null;if(this.closeOnMove&amp;&amp;this.map){this.map.events.unregister(&quot;movestart&quot;,this,this.hide);}
this.events.destroy();this.events=null;if(this.closeDiv){OpenLayers.Event.stopObservingElement(this.closeDiv);this.groupDiv.removeChild(this.closeDiv);}
this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;if(this.map!=null){this.map.removePopup(this);}
this.map=null;this.div=null;this.autoSize=null;this.minSize=null;this.maxSize=null;this.padding=null;this.panMapIfOutOfView=null;},draw:function(px){if(px==null){if((this.lonlat!=null)&amp;&amp;(this.map!=null)){px=this.map.getLayerPxFromLonLat(this.lonlat);}}
if(this.closeOnMove){this.map.events.register(&quot;movestart&quot;,this,this.hide);}
if(!this.disableFirefoxOverflowHack&amp;&amp;OpenLayers.Util.getBrowserName()==&apos;firefox&apos;){this.map.events.register(&quot;movestart&quot;,this,function(){var style=document.defaultView.getComputedStyle(this.contentDiv,null);var currentOverflow=style.getPropertyValue(&quot;overflow&quot;);if(currentOverflow!=&quot;hidden&quot;){this.contentDiv._oldOverflow=currentOverflow;this.contentDiv.style.overflow=&quot;hidden&quot;;}});this.map.events.register(&quot;moveend&quot;,this,function(){var oldOverflow=this.contentDiv._oldOverflow;if(oldOverflow){this.contentDiv.style.overflow=oldOverflow;this.contentDiv._oldOverflow=null;}});}
this.moveTo(px);if(!this.autoSize&amp;&amp;!this.size){this.setSize(this.contentSize);}
this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();if(this.panMapIfOutOfView){this.panIntoView();}
return this.div;},updatePosition:function(){if((this.lonlat)&amp;&amp;(this.map)){var px=this.map.getLayerPxFromLonLat(this.lonlat);if(px){this.moveTo(px);}}},moveTo:function(px){if((px!=null)&amp;&amp;(this.div!=null)){this.div.style.left=px.x+&quot;px&quot;;this.div.style.top=px.y+&quot;px&quot;;}},visible:function(){return OpenLayers.Element.visible(this.div);},toggle:function(){if(this.visible()){this.hide();}else{this.show();}},show:function(){OpenLayers.Element.show(this.div);if(this.panMapIfOutOfView){this.panIntoView();}},hide:function(){OpenLayers.Element.hide(this.div);},setSize:function(contentSize){this.size=contentSize.clone();var contentDivPadding=this.getContentDivPadding();var wPadding=contentDivPadding.left+contentDivPadding.right;var hPadding=contentDivPadding.top+contentDivPadding.bottom;this.fixPadding();wPadding+=this.padding.left+this.padding.right;hPadding+=this.padding.top+this.padding.bottom;if(this.closeDiv){var closeDivWidth=parseInt(this.closeDiv.style.width);wPadding+=closeDivWidth+contentDivPadding.right;}
this.size.w+=wPadding;this.size.h+=hPadding;if(OpenLayers.Util.getBrowserName()==&quot;msie&quot;){this.contentSize.w+=contentDivPadding.left+contentDivPadding.right;this.contentSize.h+=contentDivPadding.bottom+contentDivPadding.top;}
if(this.div!=null){this.div.style.width=this.size.w+&quot;px&quot;;this.div.style.height=this.size.h+&quot;px&quot;;}
if(this.contentDiv!=null){this.contentDiv.style.width=contentSize.w+&quot;px&quot;;this.contentDiv.style.height=contentSize.h+&quot;px&quot;;}},updateSize:function(){var preparedHTML=&quot;&lt;div class=&apos;&quot;+this.contentDisplayClass+&quot;&apos;&gt;&quot;+
this.contentDiv.innerHTML+&quot;&lt;/div&gt;&quot;;var containerElement=(this.map)?this.map.layerContainerDiv:document.body;var realSize=OpenLayers.Util.getRenderedDimensions(preparedHTML,null,{displayClass:this.displayClass,containerElement:containerElement});var safeSize=this.getSafeContentSize(realSize);var newSize=null;if(safeSize.equals(realSize)){newSize=realSize;}else{var fixedSize=new OpenLayers.Size();fixedSize.w=(safeSize.w&lt;realSize.w)?safeSize.w:null;fixedSize.h=(safeSize.h&lt;realSize.h)?safeSize.h:null;if(fixedSize.w&amp;&amp;fixedSize.h){newSize=safeSize;}else{var clippedSize=OpenLayers.Util.getRenderedDimensions(preparedHTML,fixedSize,{displayClass:this.contentDisplayClass,containerElement:containerElement});var currentOverflow=OpenLayers.Element.getStyle(this.contentDiv,&quot;overflow&quot;);if((currentOverflow!=&quot;hidden&quot;)&amp;&amp;(clippedSize.equals(safeSize))){var scrollBar=OpenLayers.Util.getScrollbarWidth();if(fixedSize.w){clippedSize.h+=scrollBar;}else{clippedSize.w+=scrollBar;}}
newSize=this.getSafeContentSize(clippedSize);}}
this.setSize(newSize);},setBackgroundColor:function(color){if(color!=undefined){this.backgroundColor=color;}
if(this.div!=null){this.div.style.backgroundColor=this.backgroundColor;}},setOpacity:function(opacity){if(opacity!=undefined){this.opacity=opacity;}
if(this.div!=null){this.div.style.opacity=this.opacity;this.div.style.filter=&apos;alpha(opacity=&apos;+this.opacity*100+&apos;)&apos;;}},setBorder:function(border){if(border!=undefined){this.border=border;}
if(this.div!=null){this.div.style.border=this.border;}},setContentHTML:function(contentHTML){if(contentHTML!=null){this.contentHTML=contentHTML;}
if((this.contentDiv!=null)&amp;&amp;(this.contentHTML!=null)&amp;&amp;(this.contentHTML!=this.contentDiv.innerHTML)){this.contentDiv.innerHTML=this.contentHTML;if(this.autoSize){this.registerImageListeners();this.updateSize();}}},registerImageListeners:function(){var onImgLoad=function(){this.popup.updateSize();if(this.popup.visible()&amp;&amp;this.popup.panMapIfOutOfView){this.popup.panIntoView();}
OpenLayers.Event.stopObserving(this.img,&quot;load&quot;,this.img._onImageLoad);};var images=this.contentDiv.getElementsByTagName(&quot;img&quot;);for(var i=0,len=images.length;i&lt;len;i++){var img=images[i];if(img.width==0||img.height==0){var context={&apos;popup&apos;:this,&apos;img&apos;:img};img._onImgLoad=OpenLayers.Function.bind(onImgLoad,context);OpenLayers.Event.observe(img,&apos;load&apos;,img._onImgLoad);}}},getSafeContentSize:function(size){var safeContentSize=size.clone();var contentDivPadding=this.getContentDivPadding();var wPadding=contentDivPadding.left+contentDivPadding.right;var hPadding=contentDivPadding.top+contentDivPadding.bottom;this.fixPadding();wPadding+=this.padding.left+this.padding.right;hPadding+=this.padding.top+this.padding.bottom;if(this.closeDiv){var closeDivWidth=parseInt(this.closeDiv.style.width);wPadding+=closeDivWidth+contentDivPadding.right;}
if(this.minSize){safeContentSize.w=Math.max(safeContentSize.w,(this.minSize.w-wPadding));safeContentSize.h=Math.max(safeContentSize.h,(this.minSize.h-hPadding));}
if(this.maxSize){safeContentSize.w=Math.min(safeContentSize.w,(this.maxSize.w-wPadding));safeContentSize.h=Math.min(safeContentSize.h,(this.maxSize.h-hPadding));}
if(this.map&amp;&amp;this.map.size){var extraX=0,extraY=0;if(this.keepInMap&amp;&amp;!this.panMapIfOutOfView){var px=this.map.getPixelFromLonLat(this.lonlat);switch(this.relativePosition){case&quot;tr&quot;:extraX=px.x;extraY=this.map.size.h-px.y;break;case&quot;tl&quot;:extraX=this.map.size.w-px.x;extraY=this.map.size.h-px.y;break;case&quot;bl&quot;:extraX=this.map.size.w-px.x;extraY=px.y;break;case&quot;br&quot;:extraX=px.x;extraY=px.y;break;default:extraX=px.x;extraY=this.map.size.h-px.y;break;}}
var maxY=this.map.size.h-
this.map.paddingForPopups.top-
this.map.paddingForPopups.bottom-
hPadding-extraY;var maxX=this.map.size.w-
this.map.paddingForPopups.left-
this.map.paddingForPopups.right-
wPadding-extraX;safeContentSize.w=Math.min(safeContentSize.w,maxX);safeContentSize.h=Math.min(safeContentSize.h,maxY);}
return safeContentSize;},getContentDivPadding:function(){var contentDivPadding=this._contentDivPadding;if(!contentDivPadding){if(this.div.parentNode==null){this.div.style.display=&quot;none&quot;;document.body.appendChild(this.div);}
contentDivPadding=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,&quot;padding-left&quot;),OpenLayers.Element.getStyle(this.contentDiv,&quot;padding-bottom&quot;),OpenLayers.Element.getStyle(this.contentDiv,&quot;padding-right&quot;),OpenLayers.Element.getStyle(this.contentDiv,&quot;padding-top&quot;));this._contentDivPadding=contentDivPadding;if(this.div.parentNode==document.body){document.body.removeChild(this.div);this.div.style.display=&quot;&quot;;}}
return contentDivPadding;},addCloseBox:function(callback){this.closeDiv=OpenLayers.Util.createDiv(this.id+&quot;_close&quot;,null,new OpenLayers.Size(17,17));this.closeDiv.className=&quot;olPopupCloseBox&quot;;var contentDivPadding=this.getContentDivPadding();this.closeDiv.style.right=contentDivPadding.right+&quot;px&quot;;this.closeDiv.style.top=contentDivPadding.top+&quot;px&quot;;this.groupDiv.appendChild(this.closeDiv);var closePopup=callback||function(e){this.hide();OpenLayers.Event.stop(e);};OpenLayers.Event.observe(this.closeDiv,&quot;click&quot;,OpenLayers.Function.bindAsEventListener(closePopup,this));},panIntoView:function(){var mapSize=this.map.getSize();var origTL=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top)));var newTL=origTL.clone();if(origTL.x&lt;this.map.paddingForPopups.left){newTL.x=this.map.paddingForPopups.left;}else
if((origTL.x+this.size.w)&gt;(mapSize.w-this.map.paddingForPopups.right)){newTL.x=mapSize.w-this.map.paddingForPopups.right-this.size.w;}
if(origTL.y&lt;this.map.paddingForPopups.top){newTL.y=this.map.paddingForPopups.top;}else
if((origTL.y+this.size.h)&gt;(mapSize.h-this.map.paddingForPopups.bottom)){newTL.y=mapSize.h-this.map.paddingForPopups.bottom-this.size.h;}
var dx=origTL.x-newTL.x;var dy=origTL.y-newTL.y;this.map.pan(dx,dy);},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,true);this.events.on({&quot;mousedown&quot;:this.onmousedown,&quot;mousemove&quot;:this.onmousemove,&quot;mouseup&quot;:this.onmouseup,&quot;click&quot;:this.onclick,&quot;mouseout&quot;:this.onmouseout,&quot;dblclick&quot;:this.ondblclick,scope:this});},onmousedown:function(evt){this.mousedown=true;OpenLayers.Event.stop(evt,true);},onmousemove:function(evt){if(this.mousedown){OpenLayers.Event.stop(evt,true);}},onmouseup:function(evt){if(this.mousedown){this.mousedown=false;OpenLayers.Event.stop(evt,true);}},onclick:function(evt){OpenLayers.Event.stop(evt,true);},onmouseout:function(evt){this.mousedown=false;},ondblclick:function(evt){OpenLayers.Event.stop(evt,true);},CLASS_NAME:&quot;OpenLayers.Popup&quot;});OpenLayers.Popup.WIDTH=200;OpenLayers.Popup.HEIGHT=200;OpenLayers.Popup.COLOR=&quot;white&quot;;OpenLayers.Popup.OPACITY=1;OpenLayers.Popup.BORDER=&quot;0px&quot;;OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:true,initialize:function(options){options=options||{};OpenLayers.Util.extend(this,options);this.options=options;},destroy:function(){this.options=null;this.format=null;},read:function(){},create:function(){},update:function(){},&quot;delete&quot;:function(){},commit:function(){},abort:function(response){},CLASS_NAME:&quot;OpenLayers.Protocol&quot;});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:true,features:null,reqFeatures:null,priv:null,initialize:function(options){OpenLayers.Util.extend(this,options);},success:function(){return this.code&gt;0;},CLASS_NAME:&quot;OpenLayers.Protocol.Response&quot;});OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:false,size:null,resolution:null,map:null,initialize:function(containerID,options){this.container=OpenLayers.Util.getElement(containerID);},destroy:function(){this.container=null;this.extent=null;this.size=null;this.resolution=null;this.map=null;},supported:function(){return false;},setExtent:function(extent,resolutionChanged){this.extent=extent.clone();if(resolutionChanged){this.resolution=null;}},setSize:function(size){this.size=size.clone();this.resolution=null;},getResolution:function(){this.resolution=this.resolution||this.map.getResolution();return this.resolution;},drawFeature:function(feature,style){if(style==null){style=feature.style;}
if(feature.geometry){var bounds=feature.geometry.getBounds();if(bounds){if(!bounds.intersectsBounds(this.extent)){style={display:&quot;none&quot;};}
var rendered=this.drawGeometry(feature.geometry,style,feature.id);if(style.display!=&quot;none&quot;&amp;&amp;style.label&amp;&amp;rendered!==false){this.drawText(feature.id,style,feature.geometry.getCentroid());}else{this.removeText(feature.id);}
return rendered;}}},drawGeometry:function(geometry,style,featureId){},drawText:function(featureId,style,location){},removeText:function(featureId){},clear:function(){},getFeatureIdFromEvent:function(evt){},eraseFeatures:function(features){if(!(features instanceof Array)){features=[features];}
for(var i=0,len=features.length;i&lt;len;++i){this.eraseGeometry(features[i].geometry);this.removeText(features[i].id);}},eraseGeometry:function(geometry){},moveRoot:function(renderer){},getRenderLayerId:function(){return this.container.id;},CLASS_NAME:&quot;OpenLayers.Renderer&quot;});OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:true,autoDestroy:true,initialize:function(options){OpenLayers.Util.extend(this,options);this.options=options;this.active=false;},destroy:function(){this.deactivate();this.layer=null;this.options=null;},setLayer:function(layer){this.layer=layer;},activate:function(){if(!this.active){this.active=true;return true;}
return false;},deactivate:function(){if(this.active){this.active=false;return true;}
return false;},CLASS_NAME:&quot;OpenLayers.Strategy&quot;});OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(red,green,blue){this.rgb={r:red,g:green,b:blue};},setRed:function(r){this.rgb.r=r;},setGreen:function(g){this.rgb.g=g;},setBlue:function(b){this.rgb.b=b;},setHue:function(h){var hsb=this.asHSB();hsb.h=h;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(hsb.h,hsb.s,hsb.b);},setSaturation:function(s){var hsb=this.asHSB();hsb.s=s;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(hsb.h,hsb.s,hsb.b);},setBrightness:function(b){var hsb=this.asHSB();hsb.b=b;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(hsb.h,hsb.s,hsb.b);},darken:function(percent){var hsb=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(hsb.h,hsb.s,Math.max(hsb.b-percent,0));},brighten:function(percent){var hsb=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(hsb.h,hsb.s,Math.min(hsb.b+percent,1));},blend:function(other){this.rgb.r=Math.floor((this.rgb.r+other.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+other.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+other.rgb.b)/2);},isBright:function(){var hsb=this.asHSB();return this.asHSB().b&gt;0.5;},isDark:function(){return!this.isBright();},asRGB:function(){return&quot;rgb(&quot;+this.rgb.r+&quot;,&quot;+this.rgb.g+&quot;,&quot;+this.rgb.b+&quot;)&quot;;},asHex:function(){return&quot;#&quot;+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart();},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b);},toString:function(){return this.asHex();}});OpenLayers.Rico.Color.createFromHex=function(hexCode){if(hexCode.length==4){var shortHexCode=hexCode;var hexCode=&apos;#&apos;;for(var i=1;i&lt;4;i++){hexCode+=(shortHexCode.charAt(i)+
shortHexCode.charAt(i));}}
if(hexCode.indexOf(&apos;#&apos;)==0){hexCode=hexCode.substring(1);}
var red=hexCode.substring(0,2);var green=hexCode.substring(2,4);var blue=hexCode.substring(4,6);return new OpenLayers.Rico.Color(parseInt(red,16),parseInt(green,16),parseInt(blue,16));};OpenLayers.Rico.Color.createColorFromBackground=function(elem){var actualColor=RicoUtil.getElementsComputedStyle(OpenLayers.Util.getElement(elem),&quot;backgroundColor&quot;,&quot;background-color&quot;);if(actualColor==&quot;transparent&quot;&amp;&amp;elem.parentNode){return OpenLayers.Rico.Color.createColorFromBackground(elem.parentNode);}
if(actualColor==null){return new OpenLayers.Rico.Color(255,255,255);}
if(actualColor.indexOf(&quot;rgb(&quot;)==0){var colors=actualColor.substring(4,actualColor.length-1);var colorArray=colors.split(&quot;,&quot;);return new OpenLayers.Rico.Color(parseInt(colorArray[0]),parseInt(colorArray[1]),parseInt(colorArray[2]));}
else if(actualColor.indexOf(&quot;#&quot;)==0){return OpenLayers.Rico.Color.createFromHex(actualColor);}
else{return new OpenLayers.Rico.Color(255,255,255);}};OpenLayers.Rico.Color.HSBtoRGB=function(hue,saturation,brightness){var red=0;var green=0;var blue=0;if(saturation==0){red=parseInt(brightness*255.0+0.5);green=red;blue=red;}
else{var h=(hue-Math.floor(hue))*6.0;var f=h-Math.floor(h);var p=brightness*(1.0-saturation);var q=brightness*(1.0-saturation*f);var t=brightness*(1.0-(saturation*(1.0-f)));switch(parseInt(h)){case 0:red=(brightness*255.0+0.5);green=(t*255.0+0.5);blue=(p*255.0+0.5);break;case 1:red=(q*255.0+0.5);green=(brightness*255.0+0.5);blue=(p*255.0+0.5);break;case 2:red=(p*255.0+0.5);green=(brightness*255.0+0.5);blue=(t*255.0+0.5);break;case 3:red=(p*255.0+0.5);green=(q*255.0+0.5);blue=(brightness*255.0+0.5);break;case 4:red=(t*255.0+0.5);green=(p*255.0+0.5);blue=(brightness*255.0+0.5);break;case 5:red=(brightness*255.0+0.5);green=(p*255.0+0.5);blue=(q*255.0+0.5);break;}}
return{r:parseInt(red),g:parseInt(green),b:parseInt(blue)};};OpenLayers.Rico.Color.RGBtoHSB=function(r,g,b){var hue;var saturation;var brightness;var cmax=(r&gt;g)?r:g;if(b&gt;cmax){cmax=b;}
var cmin=(r&lt;g)?r:g;if(b&lt;cmin){cmin=b;}
brightness=cmax/255.0;if(cmax!=0){saturation=(cmax-cmin)/cmax;}else{saturation=0;}
if(saturation==0){hue=0;}else{var redc=(cmax-r)/(cmax-cmin);var greenc=(cmax-g)/(cmax-cmin);var bluec=(cmax-b)/(cmax-cmin);if(r==cmax){hue=bluec-greenc;}else if(g==cmax){hue=2.0+redc-bluec;}else{hue=4.0+greenc-redc;}
hue=hue/6.0;if(hue&lt;0){hue=hue+1.0;}}
return{h:hue,s:saturation,b:brightness};};OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(left,bottom,right,top){if(left!=null){this.left=OpenLayers.Util.toFloat(left);}
if(bottom!=null){this.bottom=OpenLayers.Util.toFloat(bottom);}
if(right!=null){this.right=OpenLayers.Util.toFloat(right);}
if(top!=null){this.top=OpenLayers.Util.toFloat(top);}},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top);},equals:function(bounds){var equals=false;if(bounds!=null){equals=((this.left==bounds.left)&amp;&amp;(this.right==bounds.right)&amp;&amp;(this.top==bounds.top)&amp;&amp;(this.bottom==bounds.bottom));}
return equals;},toString:function(){return(&quot;left-bottom=(&quot;+this.left+&quot;,&quot;+this.bottom+&quot;)&quot;
+&quot; right-top=(&quot;+this.right+&quot;,&quot;+this.top+&quot;)&quot;);},toArray:function(){return[this.left,this.bottom,this.right,this.top];},toBBOX:function(decimal){if(decimal==null){decimal=6;}
var mult=Math.pow(10,decimal);var bbox=Math.round(this.left*mult)/mult+&quot;,&quot;+
Math.round(this.bottom*mult)/mult+&quot;,&quot;+
Math.round(this.right*mult)/mult+&quot;,&quot;+
Math.round(this.top*mult)/mult;return bbox;},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])]);},getWidth:function(){return(this.right-this.left);},getHeight:function(){return(this.top-this.bottom);},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight());},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2);},getCenterLonLat:function(){if(!this.centerLonLat){this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2);}
return this.centerLonLat;},scale:function(ratio,origin){if(origin==null){origin=this.getCenterLonLat();}
var bounds=[];var origx,origy;if(origin.CLASS_NAME==&quot;OpenLayers.LonLat&quot;){origx=origin.lon;origy=origin.lat;}else{origx=origin.x;origy=origin.y;}
var left=(this.left-origx)*ratio+origx;var bottom=(this.bottom-origy)*ratio+origy;var right=(this.right-origx)*ratio+origx;var top=(this.top-origy)*ratio+origy;return new OpenLayers.Bounds(left,bottom,right,top);},add:function(x,y){if((x==null)||(y==null)){var msg=OpenLayers.i18n(&quot;boundsAddError&quot;);OpenLayers.Console.error(msg);return null;}
return new OpenLayers.Bounds(this.left+x,this.bottom+y,this.right+x,this.top+y);},extend:function(object){var bounds=null;if(object){switch(object.CLASS_NAME){case&quot;OpenLayers.LonLat&quot;:bounds=new OpenLayers.Bounds(object.lon,object.lat,object.lon,object.lat);break;case&quot;OpenLayers.Geometry.Point&quot;:bounds=new OpenLayers.Bounds(object.x,object.y,object.x,object.y);break;case&quot;OpenLayers.Bounds&quot;:bounds=object;break;}
if(bounds){this.centerLonLat=null;if((this.left==null)||(bounds.left&lt;this.left)){this.left=bounds.left;}
if((this.bottom==null)||(bounds.bottom&lt;this.bottom)){this.bottom=bounds.bottom;}
if((this.right==null)||(bounds.right&gt;this.right)){this.right=bounds.right;}
if((this.top==null)||(bounds.top&gt;this.top)){this.top=bounds.top;}}}},containsLonLat:function(ll,inclusive){return this.contains(ll.lon,ll.lat,inclusive);},containsPixel:function(px,inclusive){return this.contains(px.x,px.y,inclusive);},contains:function(x,y,inclusive){if(inclusive==null){inclusive=true;}
if(x==null||y==null){return false;}
x=OpenLayers.Util.toFloat(x);y=OpenLayers.Util.toFloat(y);var contains=false;if(inclusive){contains=((x&gt;=this.left)&amp;&amp;(x&lt;=this.right)&amp;&amp;(y&gt;=this.bottom)&amp;&amp;(y&lt;=this.top));}else{contains=((x&gt;this.left)&amp;&amp;(x&lt;this.right)&amp;&amp;(y&gt;this.bottom)&amp;&amp;(y&lt;this.top));}
return contains;},intersectsBounds:function(bounds,inclusive){if(inclusive==null){inclusive=true;}
var intersects=false;var mightTouch=(this.left==bounds.right||this.right==bounds.left||this.top==bounds.bottom||this.bottom==bounds.top);if(inclusive||!mightTouch){var inBottom=(((bounds.bottom&gt;=this.bottom)&amp;&amp;(bounds.bottom&lt;=this.top))||((this.bottom&gt;=bounds.bottom)&amp;&amp;(this.bottom&lt;=bounds.top)));var inTop=(((bounds.top&gt;=this.bottom)&amp;&amp;(bounds.top&lt;=this.top))||((this.top&gt;bounds.bottom)&amp;&amp;(this.top&lt;bounds.top)));var inLeft=(((bounds.left&gt;=this.left)&amp;&amp;(bounds.left&lt;=this.right))||((this.left&gt;=bounds.left)&amp;&amp;(this.left&lt;=bounds.right)));var inRight=(((bounds.right&gt;=this.left)&amp;&amp;(bounds.right&lt;=this.right))||((this.right&gt;=bounds.left)&amp;&amp;(this.right&lt;=bounds.right)));intersects=((inBottom||inTop)&amp;&amp;(inLeft||inRight));}
return intersects;},containsBounds:function(bounds,partial,inclusive){if(partial==null){partial=false;}
if(inclusive==null){inclusive=true;}
var bottomLeft=this.contains(bounds.left,bounds.bottom,inclusive);var bottomRight=this.contains(bounds.right,bounds.bottom,inclusive);var topLeft=this.contains(bounds.left,bounds.top,inclusive);var topRight=this.contains(bounds.right,bounds.top,inclusive);return(partial)?(bottomLeft||bottomRight||topLeft||topRight):(bottomLeft&amp;&amp;bottomRight&amp;&amp;topLeft&amp;&amp;topRight);},determineQuadrant:function(lonlat){var quadrant=&quot;&quot;;var center=this.getCenterLonLat();quadrant+=(lonlat.lat&lt;center.lat)?&quot;b&quot;:&quot;t&quot;;quadrant+=(lonlat.lon&lt;center.lon)?&quot;l&quot;:&quot;r&quot;;return quadrant;},transform:function(source,dest){this.centerLonLat=null;var ll=OpenLayers.Projection.transform({&apos;x&apos;:this.left,&apos;y&apos;:this.bottom},source,dest);var lr=OpenLayers.Projection.transform({&apos;x&apos;:this.right,&apos;y&apos;:this.bottom},source,dest);var ul=OpenLayers.Projection.transform({&apos;x&apos;:this.left,&apos;y&apos;:this.top},source,dest);var ur=OpenLayers.Projection.transform({&apos;x&apos;:this.right,&apos;y&apos;:this.top},source,dest);this.left=Math.min(ll.x,ul.x);this.bottom=Math.min(ll.y,lr.y);this.right=Math.max(lr.x,ur.x);this.top=Math.max(ul.y,ur.y);return this;},wrapDateLine:function(maxExtent,options){options=options||{};var leftTolerance=options.leftTolerance||0;var rightTolerance=options.rightTolerance||0;var newBounds=this.clone();if(maxExtent){while(newBounds.left&lt;maxExtent.left&amp;&amp;(newBounds.right-rightTolerance)&lt;=maxExtent.left){newBounds=newBounds.add(maxExtent.getWidth(),0);}
while((newBounds.left+leftTolerance)&gt;=maxExtent.right&amp;&amp;newBounds.right&gt;maxExtent.right){newBounds=newBounds.add(-maxExtent.getWidth(),0);}}
return newBounds;},CLASS_NAME:&quot;OpenLayers.Bounds&quot;});OpenLayers.Bounds.fromString=function(str){var bounds=str.split(&quot;,&quot;);return OpenLayers.Bounds.fromArray(bounds);};OpenLayers.Bounds.fromArray=function(bbox){return new OpenLayers.Bounds(parseFloat(bbox[0]),parseFloat(bbox[1]),parseFloat(bbox[2]),parseFloat(bbox[3]));};OpenLayers.Bounds.fromSize=function(size){return new OpenLayers.Bounds(0,size.h,size.w,0);};OpenLayers.Bounds.oppositeQuadrant=function(quadrant){var opp=&quot;&quot;;opp+=(quadrant.charAt(0)==&apos;t&apos;)?&apos;b&apos;:&apos;t&apos;;opp+=(quadrant.charAt(1)==&apos;l&apos;)?&apos;r&apos;:&apos;l&apos;;return opp;};OpenLayers.LonLat=OpenLayers.Class({lon:0.0,lat:0.0,initialize:function(lon,lat){this.lon=OpenLayers.Util.toFloat(lon);this.lat=OpenLayers.Util.toFloat(lat);},toString:function(){return(&quot;lon=&quot;+this.lon+&quot;,lat=&quot;+this.lat);},toShortString:function(){return(this.lon+&quot;, &quot;+this.lat);},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat);},add:function(lon,lat){if((lon==null)||(lat==null)){var msg=OpenLayers.i18n(&quot;lonlatAddError&quot;);OpenLayers.Console.error(msg);return null;}
return new OpenLayers.LonLat(this.lon+lon,this.lat+lat);},equals:function(ll){var equals=false;if(ll!=null){equals=((this.lon==ll.lon&amp;&amp;this.lat==ll.lat)||(isNaN(this.lon)&amp;&amp;isNaN(this.lat)&amp;&amp;isNaN(ll.lon)&amp;&amp;isNaN(ll.lat)));}
return equals;},transform:function(source,dest){var point=OpenLayers.Projection.transform({&apos;x&apos;:this.lon,&apos;y&apos;:this.lat},source,dest);this.lon=point.x;this.lat=point.y;return this;},wrapDateLine:function(maxExtent){var newLonLat=this.clone();if(maxExtent){while(newLonLat.lon&lt;maxExtent.left){newLonLat.lon+=maxExtent.getWidth();}
while(newLonLat.lon&gt;maxExtent.right){newLonLat.lon-=maxExtent.getWidth();}}
return newLonLat;},CLASS_NAME:&quot;OpenLayers.LonLat&quot;});OpenLayers.LonLat.fromString=function(str){var pair=str.split(&quot;,&quot;);return new OpenLayers.LonLat(parseFloat(pair[0]),parseFloat(pair[1]));};OpenLayers.Pixel=OpenLayers.Class({x:0.0,y:0.0,initialize:function(x,y){this.x=parseFloat(x);this.y=parseFloat(y);},toString:function(){return(&quot;x=&quot;+this.x+&quot;,y=&quot;+this.y);},clone:function(){return new OpenLayers.Pixel(this.x,this.y);},equals:function(px){var equals=false;if(px!=null){equals=((this.x==px.x&amp;&amp;this.y==px.y)||(isNaN(this.x)&amp;&amp;isNaN(this.y)&amp;&amp;isNaN(px.x)&amp;&amp;isNaN(px.y)));}
return equals;},add:function(x,y){if((x==null)||(y==null)){var msg=OpenLayers.i18n(&quot;pixelAddError&quot;);OpenLayers.Console.error(msg);return null;}
return new OpenLayers.Pixel(this.x+x,this.y+y);},offset:function(px){var newPx=this.clone();if(px){newPx=this.add(px.x,px.y);}
return newPx;},CLASS_NAME:&quot;OpenLayers.Pixel&quot;});OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:false,displayClass:&quot;&quot;,title:&quot;&quot;,active:null,handler:null,eventListeners:null,events:null,EVENT_TYPES:[&quot;activate&quot;,&quot;deactivate&quot;],initialize:function(options){this.displayClass=this.CLASS_NAME.replace(&quot;OpenLayers.&quot;,&quot;ol&quot;).replace(/\./g,&quot;&quot;);OpenLayers.Util.extend(this,options);this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners);}
if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+&quot;_&quot;);}},destroy:function(){if(this.events){if(this.eventListeners){this.events.un(this.eventListeners);}
this.events.destroy();this.events=null;}
this.eventListeners=null;if(this.handler){this.handler.destroy();this.handler=null;}
if(this.handlers){for(var key in this.handlers){if(this.handlers.hasOwnProperty(key)&amp;&amp;typeof this.handlers[key].destroy==&quot;function&quot;){this.handlers[key].destroy();}}
this.handlers=null;}
if(this.map){this.map.removeControl(this);this.map=null;}},setMap:function(map){this.map=map;if(this.handler){this.handler.setMap(map);}},draw:function(px){if(this.div==null){this.div=OpenLayers.Util.createDiv(this.id);this.div.className=this.displayClass;if(!this.allowSelection){this.div.className+=&quot; olControlNoSelect&quot;;this.div.setAttribute(&quot;unselectable&quot;,&quot;on&quot;,0);this.div.onselectstart=function(){return(false);};}
if(this.title!=&quot;&quot;){this.div.title=this.title;}}
if(px!=null){this.position=px.clone();}
this.moveTo(this.position);return this.div;},moveTo:function(px){if((px!=null)&amp;&amp;(this.div!=null)){this.div.style.left=px.x+&quot;px&quot;;this.div.style.top=px.y+&quot;px&quot;;}},activate:function(){if(this.active){return false;}
if(this.handler){this.handler.activate();}
this.active=true;if(this.map){OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,&quot;&quot;)+&quot;Active&quot;);}
this.events.triggerEvent(&quot;activate&quot;);return true;},deactivate:function(){if(this.active){if(this.handler){this.handler.deactivate();}
this.active=false;if(this.map){OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,&quot;&quot;)+&quot;Active&quot;);}
this.events.triggerEvent(&quot;deactivate&quot;);return true;}
return false;},CLASS_NAME:&quot;OpenLayers.Control&quot;});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;OpenLayers.Lang={code:null,defaultCode:&quot;en&quot;,getCode:function(){if(!OpenLayers.Lang.code){OpenLayers.Lang.setCode();}
return OpenLayers.Lang.code;},setCode:function(code){var lang;if(!code){code=(OpenLayers.Util.getBrowserName()==&quot;msie&quot;)?navigator.userLanguage:navigator.language;}
var parts=code.split(&apos;-&apos;);parts[0]=parts[0].toLowerCase();if(typeof OpenLayers.Lang[parts[0]]==&quot;object&quot;){lang=parts[0];}
if(parts[1]){var testLang=parts[0]+&apos;-&apos;+parts[1].toUpperCase();if(typeof OpenLayers.Lang[testLang]==&quot;object&quot;){lang=testLang;}}
if(!lang){OpenLayers.Console.warn(&apos;Failed to find OpenLayers.Lang.&apos;+parts.join(&quot;-&quot;)+&apos; dictionary, falling back to default language&apos;);lang=OpenLayers.Lang.defaultCode;}
OpenLayers.Lang.code=lang;},translate:function(key,context){var dictionary=OpenLayers.Lang[OpenLayers.Lang.getCode()];var message=dictionary[key];if(!message){message=key;}
if(context){message=OpenLayers.String.format(message,context);}
return message;}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:true,anchor:null,initialize:function(id,lonlat,contentSize,contentHTML,anchor,closeBox,closeBoxCallback){var newArguments=[id,lonlat,contentSize,contentHTML,closeBox,closeBoxCallback];OpenLayers.Popup.prototype.initialize.apply(this,newArguments);this.anchor=(anchor!=null)?anchor:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)};},destroy:function(){this.anchor=null;this.relativePosition=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments);},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments);},moveTo:function(px){var oldRelativePosition=this.relativePosition;this.relativePosition=this.calculateRelativePosition(px);var newPx=this.calculateNewPx(px);var newArguments=new Array(newPx);OpenLayers.Popup.prototype.moveTo.apply(this,newArguments);if(this.relativePosition!=oldRelativePosition){this.updateRelativePosition();}},setSize:function(contentSize){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if((this.lonlat)&amp;&amp;(this.map)){var px=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(px);}},calculateRelativePosition:function(px){var lonlat=this.map.getLonLatFromLayerPx(px);var extent=this.map.getExtent();var quadrant=extent.determineQuadrant(lonlat);return OpenLayers.Bounds.oppositeQuadrant(quadrant);},updateRelativePosition:function(){},calculateNewPx:function(px){var newPx=px.offset(this.anchor.offset);var size=this.size||this.contentSize;var top=(this.relativePosition.charAt(0)==&apos;t&apos;);newPx.y+=(top)?-size.h:this.anchor.size.h;var left=(this.relativePosition.charAt(1)==&apos;l&apos;);newPx.x+=(left)?-size.w:this.anchor.size.w;return newPx;},CLASS_NAME:&quot;OpenLayers.Popup.Anchored&quot;});OpenLayers.Protocol.SQL=OpenLayers.Class(OpenLayers.Protocol,{databaseName:&apos;ol&apos;,tableName:&quot;ol_vector_features&quot;,postReadFiltering:true,initialize:function(options){OpenLayers.Protocol.prototype.initialize.apply(this,[options]);},destroy:function(){OpenLayers.Protocol.prototype.destroy.apply(this);},supported:function(){return false;},evaluateFilter:function(feature,filter){return filter&amp;&amp;this.postReadFiltering?filter.evaluate(feature):true;},CLASS_NAME:&quot;OpenLayers.Protocol.SQL&quot;});OpenLayers.Protocol.WFS=function(options){options=OpenLayers.Util.applyDefaults(options,OpenLayers.Protocol.WFS.DEFAULTS);var cls=OpenLayers.Protocol.WFS[&quot;v&quot;+options.version.replace(/\./g,&quot;_&quot;)];if(!cls){throw&quot;Unsupported WFS version: &quot;+options.version;}
return new cls(options);};OpenLayers.Protocol.WFS.fromWMSLayer=function(layer,options){var typeName,featurePrefix;var param=layer.params[&quot;LAYERS&quot;];var parts=(param instanceof Array?param[0]:param).split(&quot;:&quot;);if(parts.length&gt;1){featurePrefix=parts[0];}
typeName=parts.pop();var protocolOptions={url:layer.url,featureType:typeName,featurePrefix:featurePrefix,srsName:layer.projection&amp;&amp;layer.projection.getCode()||layer.map&amp;&amp;layer.map.getProjectionObject().getCode(),version:&quot;1.1.0&quot;};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(options,protocolOptions));};OpenLayers.Protocol.WFS.DEFAULTS={&quot;version&quot;:&quot;1.0.0&quot;};OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{canvas:null,features:null,geometryMap:null,initialize:function(containerID){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement(&quot;canvas&quot;);this.container.appendChild(this.root);this.canvas=this.root.getContext(&quot;2d&quot;);this.features={};this.geometryMap={};},eraseGeometry:function(geometry){this.eraseFeatures(this.features[this.geometryMap[geometry.id]][0]);},supported:function(){var canvas=document.createElement(&quot;canvas&quot;);return!!canvas.getContext;},setExtent:function(extent){this.extent=extent.clone();this.resolution=null;this.redraw();},setSize:function(size){this.size=size.clone();this.root.style.width=size.w+&quot;px&quot;;this.root.style.height=size.h+&quot;px&quot;;this.root.width=size.w;this.root.height=size.h;this.resolution=null;},drawFeature:function(feature,style){if(style==null){style=feature.style;}
style=OpenLayers.Util.extend({&apos;fillColor&apos;:&apos;#000000&apos;,&apos;strokeColor&apos;:&apos;#000000&apos;,&apos;strokeWidth&apos;:2,&apos;fillOpacity&apos;:1,&apos;strokeOpacity&apos;:1},style);this.features[feature.id]=[feature,style];if(feature.geometry){this.geometryMap[feature.geometry.id]=feature.id;}
this.redraw();},drawGeometry:function(geometry,style){var className=geometry.CLASS_NAME;if((className==&quot;OpenLayers.Geometry.Collection&quot;)||(className==&quot;OpenLayers.Geometry.MultiPoint&quot;)||(className==&quot;OpenLayers.Geometry.MultiLineString&quot;)||(className==&quot;OpenLayers.Geometry.MultiPolygon&quot;)){for(var i=0;i&lt;geometry.components.length;i++){this.drawGeometry(geometry.components[i],style);}
return;};switch(geometry.CLASS_NAME){case&quot;OpenLayers.Geometry.Point&quot;:this.drawPoint(geometry,style);break;case&quot;OpenLayers.Geometry.LineString&quot;:this.drawLineString(geometry,style);break;case&quot;OpenLayers.Geometry.LinearRing&quot;:this.drawLinearRing(geometry,style);break;case&quot;OpenLayers.Geometry.Polygon&quot;:this.drawPolygon(geometry,style);break;default:break;}},drawExternalGraphic:function(pt,style){var img=new Image();img.src=style.externalGraphic;if(style.graphicTitle){img.title=style.graphicTitle;}
var width=style.graphicWidth||style.graphicHeight;var height=style.graphicHeight||style.graphicWidth;width=width?width:style.pointRadius*2;height=height?height:style.pointRadius*2;var xOffset=(style.graphicXOffset!=undefined)?style.graphicXOffset:-(0.5*width);var yOffset=(style.graphicYOffset!=undefined)?style.graphicYOffset:-(0.5*height);var opacity=style.graphicOpacity||style.fillOpacity;var context={img:img,x:(pt[0]+xOffset),y:(pt[1]+yOffset),width:width,height:height,canvas:this.canvas};img.onload=OpenLayers.Function.bind(function(){this.canvas.drawImage(this.img,this.x,this.y,this.width,this.height);},context);},setCanvasStyle:function(type,style){if(type==&quot;fill&quot;){this.canvas.globalAlpha=style[&apos;fillOpacity&apos;];this.canvas.fillStyle=style[&apos;fillColor&apos;];}else if(type==&quot;stroke&quot;){this.canvas.globalAlpha=style[&apos;strokeOpacity&apos;];this.canvas.strokeStyle=style[&apos;strokeColor&apos;];this.canvas.lineWidth=style[&apos;strokeWidth&apos;];}else{this.canvas.globalAlpha=0;this.canvas.lineWidth=1;}},drawPoint:function(geometry,style){if(style.graphic!==false){var pt=this.getLocalXY(geometry);if(style.externalGraphic){this.drawExternalGraphic(pt,style);}else{if(style.fill!==false){this.setCanvasStyle(&quot;fill&quot;,style);this.canvas.beginPath();this.canvas.arc(pt[0],pt[1],6,0,Math.PI*2,true);this.canvas.fill();}
if(style.stroke!==false){this.setCanvasStyle(&quot;stroke&quot;,style);this.canvas.beginPath();this.canvas.arc(pt[0],pt[1],6,0,Math.PI*2,true);this.canvas.stroke();this.setCanvasStyle(&quot;reset&quot;);}}}},drawLineString:function(geometry,style){if(style.stroke!==false){this.setCanvasStyle(&quot;stroke&quot;,style);this.canvas.beginPath();var start=this.getLocalXY(geometry.components[0]);this.canvas.moveTo(start[0],start[1]);for(var i=1;i&lt;geometry.components.length;i++){var pt=this.getLocalXY(geometry.components[i]);this.canvas.lineTo(pt[0],pt[1]);}
this.canvas.stroke();}
this.setCanvasStyle(&quot;reset&quot;);},drawLinearRing:function(geometry,style){if(style.fill!==false){this.setCanvasStyle(&quot;fill&quot;,style);this.canvas.beginPath();var start=this.getLocalXY(geometry.components[0]);this.canvas.moveTo(start[0],start[1]);for(var i=1;i&lt;geometry.components.length-1;i++){var pt=this.getLocalXY(geometry.components[i]);this.canvas.lineTo(pt[0],pt[1]);}
this.canvas.fill();}
if(style.stroke!==false){var oldWidth=this.canvas.lineWidth;this.setCanvasStyle(&quot;stroke&quot;,style);this.canvas.beginPath();var start=this.getLocalXY(geometry.components[0]);this.canvas.moveTo(start[0],start[1]);for(var i=1;i&lt;geometry.components.length;i++){var pt=this.getLocalXY(geometry.components[i]);this.canvas.lineTo(pt[0],pt[1]);}
this.canvas.stroke();}
this.setCanvasStyle(&quot;reset&quot;);},drawPolygon:function(geometry,style){this.drawLinearRing(geometry.components[0],style);for(var i=1;i&lt;geometry.components.length;i++){this.drawLinearRing(geometry.components[i],{fillOpacity:0,strokeWidth:0,strokeOpacity:0,strokeColor:&apos;#000000&apos;,fillColor:&apos;#000000&apos;});}},drawText:function(location,style){style=OpenLayers.Util.extend({fontColor:&quot;#000000&quot;,labelAlign:&quot;cm&quot;},style);var pt=this.getLocalXY(location);this.setCanvasStyle(&quot;reset&quot;);this.canvas.fillStyle=style.fontColor;this.canvas.globalAlpha=1;var fontStyle=style.fontWeight+&quot; &quot;+style.fontSize+&quot; &quot;+style.fontFamily;if(this.canvas.fillText){var labelAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[style.labelAlign[0]]||&quot;middle&quot;;this.canvas.font=fontStyle;this.canvas.textAlign=labelAlign;this.canvas.fillText(style.label,pt[0],pt[1]);}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=fontStyle;var len=this.canvas.mozMeasureText(style.label);switch(style.labelAlign[0]){case&quot;l&quot;:break;case&quot;r&quot;:pt[0]-=len;break;case&quot;c&quot;:default:pt[0]-=len/2;}
this.canvas.translate(pt[0],pt[1]);this.canvas.mozDrawText(style.label);this.canvas.translate(-1*pt[0],-1*pt[1]);}
this.setCanvasStyle(&quot;reset&quot;);},getLocalXY:function(point){var resolution=this.getResolution();var extent=this.extent;var x=(point.x/resolution+(-extent.left/resolution));var y=((extent.top/resolution)-point.y/resolution);return[x,y];},clear:function(){this.canvas.clearRect(0,0,this.root.width,this.root.height);},getFeatureIdFromEvent:function(evt){var loc=this.map.getLonLatFromPixel(evt.xy);var resolution=this.getResolution();var bounds=new OpenLayers.Bounds(loc.lon-resolution*5,loc.lat-resolution*5,loc.lon+resolution*5,loc.lat+resolution*5);var geom=bounds.toGeometry();for(var feat in this.features){if(!this.features.hasOwnProperty(feat)){continue;}
if(this.features[feat][0].geometry.intersects(geom)){return feat;}}
return null;},eraseFeatures:function(features){if(!(features instanceof Array)){features=[features];}
for(var i=0;i&lt;features.length;++i){delete this.features[features[i].id];}
this.redraw();},redraw:function(){if(!this.locked){this.clear();var labelMap=[];var feature,style;for(var id in this.features){if(!this.features.hasOwnProperty(id)){continue;}
feature=this.features[id][0];style=this.features[id][1];if(!feature.geometry){continue;}
this.drawGeometry(feature.geometry,style);if(style.label){labelMap.push([feature,style]);}}
var item;for(var i=0;len=labelMap.length,i&lt;len;++i){item=labelMap[i];this.drawText(item[0].geometry.getCentroid(),item[1]);}}},CLASS_NAME:&quot;OpenLayers.Renderer.Canvas&quot;});OpenLayers.Renderer.Canvas.LABEL_ALIGN={&quot;l&quot;:&quot;left&quot;,&quot;r&quot;:&quot;right&quot;};OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(yOrdering){this.compare=yOrdering?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.order=[];this.indices={};this.maxZIndex=0;},insert:function(newNode){if(this.exists(newNode)){this.remove(newNode);}
var nodeId=newNode.id;this.determineZIndex(newNode);var leftIndex=-1;var rightIndex=this.order.length;var middle;while(rightIndex-leftIndex&gt;1){middle=parseInt((leftIndex+rightIndex)/2);var placement=this.compare(this,newNode,OpenLayers.Util.getElement(this.order[middle]));if(placement&gt;0){leftIndex=middle;}else{rightIndex=middle;}}
this.order.splice(rightIndex,0,nodeId);this.indices[nodeId]=this.getZIndex(newNode);return this.getNextElement(rightIndex);},remove:function(node){var nodeId=node.id;var arrayIndex=OpenLayers.Util.indexOf(this.order,nodeId);if(arrayIndex&gt;=0){this.order.splice(arrayIndex,1);delete this.indices[nodeId];if(this.order.length&gt;0){var lastId=this.order[this.order.length-1];this.maxZIndex=this.indices[lastId];}else{this.maxZIndex=0;}}},clear:function(){this.order=[];this.indices={};this.maxZIndex=0;},exists:function(node){return(this.indices[node.id]!=null);},getZIndex:function(node){return node._style.graphicZIndex;},determineZIndex:function(node){var zIndex=node._style.graphicZIndex;if(zIndex==null){zIndex=this.maxZIndex;node._style.graphicZIndex=zIndex;}else if(zIndex&gt;this.maxZIndex){this.maxZIndex=zIndex;}},getNextElement:function(index){var nextIndex=index+1;if(nextIndex&lt;this.order.length){var nextElement=OpenLayers.Util.getElement(this.order[nextIndex]);if(nextElement==undefined){nextElement=this.getNextElement(nextIndex);}
return nextElement;}else{return null;}},CLASS_NAME:&quot;OpenLayers.ElementsIndexer&quot;});OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(indexer,newNode,nextNode){var newZIndex=indexer.getZIndex(newNode);var returnVal=0;if(nextNode){var nextZIndex=indexer.getZIndex(nextNode);returnVal=newZIndex-nextZIndex;}
return returnVal;},Z_ORDER_DRAWING_ORDER:function(indexer,newNode,nextNode){var returnVal=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(indexer,newNode,nextNode);if(nextNode&amp;&amp;returnVal==0){returnVal=1;}
return returnVal;},Z_ORDER_Y_ORDER:function(indexer,newNode,nextNode){var returnVal=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(indexer,newNode,nextNode);if(nextNode&amp;&amp;returnVal==0){var newLat=newNode._geometry.getBounds().bottom;var nextLat=nextNode._geometry.getBounds().bottom;var result=nextLat-newLat;returnVal=(result==0)?1:result;}
return returnVal;}};OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,indexer:null,BACKGROUND_ID_SUFFIX:&quot;_background&quot;,LABEL_ID_SUFFIX:&quot;_label&quot;,minimumSymbolizer:{strokeLinecap:&quot;round&quot;,strokeOpacity:1,strokeDashstyle:&quot;solid&quot;,fillOpacity:1,pointRadius:0},initialize:function(containerID,options){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot(&quot;_root&quot;);this.vectorRoot=this.createRoot(&quot;_vroot&quot;);this.textRoot=this.createRoot(&quot;_troot&quot;);this.root.appendChild(this.vectorRoot);this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(options&amp;&amp;(options.zIndexing||options.yOrdering)){this.indexer=new OpenLayers.ElementsIndexer(options.yOrdering);}},destroy:function(){this.clear();this.rendererRoot=null;this.root=null;this.xmlns=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments);},clear:function(){if(this.vectorRoot){while(this.vectorRoot.childNodes.length&gt;0){this.vectorRoot.removeChild(this.vectorRoot.firstChild);}}
if(this.textRoot){while(this.textRoot.childNodes.length&gt;0){this.textRoot.removeChild(this.textRoot.firstChild);}}
if(this.indexer){this.indexer.clear();}},getNodeType:function(geometry,style){},drawGeometry:function(geometry,style,featureId){var className=geometry.CLASS_NAME;var rendered=true;if((className==&quot;OpenLayers.Geometry.Collection&quot;)||(className==&quot;OpenLayers.Geometry.MultiPoint&quot;)||(className==&quot;OpenLayers.Geometry.MultiLineString&quot;)||(className==&quot;OpenLayers.Geometry.MultiPolygon&quot;)){for(var i=0,len=geometry.components.length;i&lt;len;i++){rendered=this.drawGeometry(geometry.components[i],style,featureId)&amp;&amp;rendered;}
return rendered;};rendered=false;if(style.display!=&quot;none&quot;){if(style.backgroundGraphic){this.redrawBackgroundNode(geometry.id,geometry,style,featureId);}
rendered=this.redrawNode(geometry.id,geometry,style,featureId);}
if(rendered==false){var node=document.getElementById(geometry.id);if(node){if(node._style.backgroundGraphic){node.parentNode.removeChild(document.getElementById(geometry.id+this.BACKGROUND_ID_SUFFIX));}
node.parentNode.removeChild(node);}}
return rendered;},redrawNode:function(id,geometry,style,featureId){var node=this.nodeFactory(id,this.getNodeType(geometry,style));node._featureId=featureId;node._geometry=geometry;node._geometryClass=geometry.CLASS_NAME;node._style=style;var drawResult=this.drawGeometryNode(node,geometry,style);if(drawResult===false){return false;}
node=drawResult.node;if(this.indexer){var insert=this.indexer.insert(node);if(insert){this.vectorRoot.insertBefore(node,insert);}else{this.vectorRoot.appendChild(node);}}else{if(node.parentNode!==this.vectorRoot){this.vectorRoot.appendChild(node);}}
this.postDraw(node);return drawResult.complete;},redrawBackgroundNode:function(id,geometry,style,featureId){var backgroundStyle=OpenLayers.Util.extend({},style);backgroundStyle.externalGraphic=backgroundStyle.backgroundGraphic;backgroundStyle.graphicXOffset=backgroundStyle.backgroundXOffset;backgroundStyle.graphicYOffset=backgroundStyle.backgroundYOffset;backgroundStyle.graphicZIndex=backgroundStyle.backgroundGraphicZIndex;backgroundStyle.graphicWidth=backgroundStyle.backgroundWidth||backgroundStyle.graphicWidth;backgroundStyle.graphicHeight=backgroundStyle.backgroundHeight||backgroundStyle.graphicHeight;backgroundStyle.backgroundGraphic=null;backgroundStyle.backgroundXOffset=null;backgroundStyle.backgroundYOffset=null;backgroundStyle.backgroundGraphicZIndex=null;return this.redrawNode(id+this.BACKGROUND_ID_SUFFIX,geometry,backgroundStyle,null);},drawGeometryNode:function(node,geometry,style){style=style||node._style;OpenLayers.Util.applyDefaults(style,this.minimumSymbolizer);var options={&apos;isFilled&apos;:style.fill===undefined?true:style.fill,&apos;isStroked&apos;:style.stroke===undefined?!!style.strokeWidth:style.stroke};var drawn;switch(geometry.CLASS_NAME){case&quot;OpenLayers.Geometry.Point&quot;:if(style.graphic===false){options.isFilled=false;options.isStroked=false;}
drawn=this.drawPoint(node,geometry);break;case&quot;OpenLayers.Geometry.LineString&quot;:options.isFilled=false;drawn=this.drawLineString(node,geometry);break;case&quot;OpenLayers.Geometry.LinearRing&quot;:drawn=this.drawLinearRing(node,geometry);break;case&quot;OpenLayers.Geometry.Polygon&quot;:drawn=this.drawPolygon(node,geometry);break;case&quot;OpenLayers.Geometry.Surface&quot;:drawn=this.drawSurface(node,geometry);break;case&quot;OpenLayers.Geometry.Rectangle&quot;:drawn=this.drawRectangle(node,geometry);break;default:break;}
node._style=style;node._options=options;if(drawn!=false){return{node:this.setStyle(node,style,options,geometry),complete:drawn};}else{return false;}},postDraw:function(node){},drawPoint:function(node,geometry){},drawLineString:function(node,geometry){},drawLinearRing:function(node,geometry){},drawPolygon:function(node,geometry){},drawRectangle:function(node,geometry){},drawCircle:function(node,geometry){},drawSurface:function(node,geometry){},removeText:function(featureId){var label=document.getElementById(featureId+this.LABEL_ID_SUFFIX);if(label){this.textRoot.removeChild(label);}},getFeatureIdFromEvent:function(evt){var target=evt.target;var useElement=target&amp;&amp;target.correspondingUseElement;var node=useElement?useElement:(target||evt.srcElement);var featureId=node._featureId;return featureId;},eraseGeometry:function(geometry){if((geometry.CLASS_NAME==&quot;OpenLayers.Geometry.MultiPoint&quot;)||(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.MultiLineString&quot;)||(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.MultiPolygon&quot;)||(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.Collection&quot;)){for(var i=0,len=geometry.components.length;i&lt;len;i++){this.eraseGeometry(geometry.components[i]);}}else{var element=OpenLayers.Util.getElement(geometry.id);if(element&amp;&amp;element.parentNode){if(element.geometry){element.geometry.destroy();element.geometry=null;}
element.parentNode.removeChild(element);if(this.indexer){this.indexer.remove(element);}
if(element._style.backgroundGraphic){var backgroundId=geometry.id+this.BACKGROUND_ID_SUFFIX;var bElem=OpenLayers.Util.getElement(backgroundId);if(bElem&amp;&amp;bElem.parentNode){bElem.parentNode.removeChild(bElem);}}}}},nodeFactory:function(id,type){var node=OpenLayers.Util.getElement(id);if(node){if(!this.nodeTypeCompare(node,type)){node.parentNode.removeChild(node);node=this.nodeFactory(id,type);}}else{node=this.createNode(type,id);}
return node;},nodeTypeCompare:function(node,type){},createNode:function(type,id){},moveRoot:function(renderer){var root=this.root;if(renderer.root.parentNode==this.rendererRoot){root=renderer.root;}
root.parentNode.removeChild(root);renderer.rendererRoot.appendChild(root);},getRenderLayerId:function(){return this.root.parentNode.parentNode.id;},isComplexSymbol:function(graphicName){return(graphicName!=&quot;circle&quot;)&amp;&amp;!!graphicName;},CLASS_NAME:&quot;OpenLayers.Renderer.Elements&quot;});OpenLayers.Renderer.symbol={&quot;star&quot;:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],&quot;cross&quot;:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],&quot;x&quot;:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],&quot;square&quot;:[0,0,0,1,1,1,1,0,0,0],&quot;triangle&quot;:[0,10,10,10,5,0,0,10]};OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:false,resolution:null,initialize:function(options){OpenLayers.Strategy.prototype.initialize.apply(this,[options]);},activate:function(){var activated=OpenLayers.Strategy.prototype.activate.call(this);if(activated){this.layer.events.on({&quot;beforefeaturesadded&quot;:this.cacheFeatures,&quot;moveend&quot;:this.cluster,scope:this});}
return activated;},deactivate:function(){var deactivated=OpenLayers.Strategy.prototype.deactivate.call(this);if(deactivated){this.clearCache();this.layer.events.un({&quot;beforefeaturesadded&quot;:this.cacheFeatures,&quot;moveend&quot;:this.cluster,scope:this});}
return deactivated;},cacheFeatures:function(event){var propagate=true;if(!this.clustering){this.clearCache();this.features=event.features;this.cluster();propagate=false;}
return propagate;},clearCache:function(){this.features=null;},cluster:function(event){if((!event||event.zoomChanged)&amp;&amp;this.features){var resolution=this.layer.map.getResolution();if(resolution!=this.resolution||!this.clustersExist()){this.resolution=resolution;var clusters=[];var feature,clustered,cluster;for(var i=0;i&lt;this.features.length;++i){feature=this.features[i];if(feature.geometry){clustered=false;for(var j=0;j&lt;clusters.length;++j){cluster=clusters[j];if(this.shouldCluster(cluster,feature)){this.addToCluster(cluster,feature);clustered=true;break;}}
if(!clustered){clusters.push(this.createCluster(this.features[i]));}}}
this.layer.destroyFeatures();if(clusters.length&gt;0){if(this.threshold&gt;1){var clone=clusters.slice();clusters=[];var candidate;for(var i=0,len=clone.length;i&lt;len;++i){candidate=clone[i];if(candidate.attributes.count&lt;this.threshold){Array.prototype.push.apply(clusters,candidate.cluster);}else{clusters.push(candidate);}}}
this.clustering=true;this.layer.addFeatures(clusters);this.clustering=false;}
this.clusters=clusters;}}},clustersExist:function(){var exist=false;if(this.clusters&amp;&amp;this.clusters.length&gt;0&amp;&amp;this.clusters.length==this.layer.features.length){exist=true;for(var i=0;i&lt;this.clusters.length;++i){if(this.clusters[i]!=this.layer.features[i]){exist=false;break;}}}
return exist;},shouldCluster:function(cluster,feature){var cc=cluster.geometry.getBounds().getCenterLonLat();var fc=feature.geometry.getBounds().getCenterLonLat();var distance=(Math.sqrt(Math.pow((cc.lon-fc.lon),2)+Math.pow((cc.lat-fc.lat),2))/this.resolution);return(distance&lt;=this.distance);},addToCluster:function(cluster,feature){cluster.cluster.push(feature);cluster.attributes.count+=1;},createCluster:function(feature){var center=feature.geometry.getBounds().getCenterLonLat();var cluster=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(center.lon,center.lat),{count:1});cluster.cluster=[feature];return cluster;},CLASS_NAME:&quot;OpenLayers.Strategy.Cluster&quot;});OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:false,initialize:function(options){OpenLayers.Strategy.prototype.initialize.apply(this,[options]);},destroy:function(){OpenLayers.Strategy.prototype.destroy.apply(this,arguments);},activate:function(){if(OpenLayers.Strategy.prototype.activate.apply(this,arguments)){this.layer.events.on({&quot;refresh&quot;:this.load,scope:this});if(this.layer.visibility==true||this.preload){this.load();}else{this.layer.events.on({&quot;visibilitychanged&quot;:this.load,scope:this});}
return true;}
return false;},deactivate:function(){var deactivated=OpenLayers.Strategy.prototype.deactivate.call(this);if(deactivated){this.layer.events.un({&quot;refresh&quot;:this.load,&quot;visibilitychanged&quot;:this.load,scope:this});}
return deactivated;},load:function(options){this.layer.events.triggerEvent(&quot;loadstart&quot;);this.layer.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,scope:this},options));this.layer.events.un({&quot;visibilitychanged&quot;:this.load,scope:this});},merge:function(resp){this.layer.destroyFeatures();var features=resp.features;if(features&amp;&amp;features.length&gt;0){var remote=this.layer.projection;var local=this.layer.map.getProjectionObject();if(!local.equals(remote)){var geom;for(var i=0,len=features.length;i&lt;len;++i){geom=features[i].geometry;if(geom){geom.transform(remote,local);}}}
this.layer.addFeatures(features);}
this.layer.events.triggerEvent(&quot;loadend&quot;);},CLASS_NAME:&quot;OpenLayers.Strategy.Fixed&quot;});OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:false,initialize:function(options){OpenLayers.Strategy.prototype.initialize.apply(this,[options]);},activate:function(){var activated=OpenLayers.Strategy.prototype.activate.call(this);if(activated){this.layer.events.on({&quot;beforefeaturesadded&quot;:this.cacheFeatures,scope:this});}
return activated;},deactivate:function(){var deactivated=OpenLayers.Strategy.prototype.deactivate.call(this);if(deactivated){this.clearCache();this.layer.events.un({&quot;beforefeaturesadded&quot;:this.cacheFeatures,scope:this});}
return deactivated;},cacheFeatures:function(event){if(!this.paging){this.clearCache();this.features=event.features;this.pageNext(event);}},clearCache:function(){if(this.features){for(var i=0;i&lt;this.features.length;++i){this.features[i].destroy();}}
this.features=null;this.num=null;},pageCount:function(){var numFeatures=this.features?this.features.length:0;return Math.ceil(numFeatures/this.length);},pageNum:function(){return this.num;},pageLength:function(newLength){if(newLength&amp;&amp;newLength&gt;0){this.length=newLength;}
return this.length;},pageNext:function(event){var changed=false;if(this.features){if(this.num===null){this.num=-1;}
var start=(this.num+1)*this.length;changed=this.page(start,event);}
return changed;},pagePrevious:function(){var changed=false;if(this.features){if(this.num===null){this.num=this.pageCount();}
var start=(this.num-1)*this.length;changed=this.page(start);}
return changed;},page:function(start,event){var changed=false;if(this.features){if(start&gt;=0&amp;&amp;start&lt;this.features.length){var num=Math.floor(start/this.length);if(num!=this.num){this.paging=true;var features=this.features.slice(start,start+this.length);this.layer.removeFeatures(this.layer.features);this.num=num;if(event&amp;&amp;event.features){event.features=features;}else{this.layer.addFeatures(features);}
this.paging=false;changed=true;}}}
return changed;},CLASS_NAME:&quot;OpenLayers.Strategy.Paging&quot;});OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{auto:false,timer:null,initialize:function(options){OpenLayers.Strategy.prototype.initialize.apply(this,[options]);},activate:function(){var activated=OpenLayers.Strategy.prototype.activate.call(this);if(activated){if(this.auto){if(typeof this.auto===&quot;number&quot;){this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),this.auto*1000)}else{this.layer.events.on({&quot;featureadded&quot;:this.triggerSave,&quot;afterfeaturemodified&quot;:this.triggerSave,scope:this});}}}
return activated;},deactivate:function(){var deactivated=OpenLayers.Strategy.prototype.deactivate.call(this);if(deactivated){if(this.auto){if(typeof this.auto===&quot;number&quot;){window.clearInterval(this.timer);}else{this.layer.events.un({&quot;featureadded&quot;:this.triggerSave,&quot;afterfeaturemodified&quot;:this.triggerSave,scope:this})}}}
return deactivated;},triggerSave:function(event){var feature=event.feature;if(feature.state===OpenLayers.State.INSERT||feature.state===OpenLayers.State.UPDATE||feature.state===OpenLayers.State.DELETE){this.save([event.feature]);}},save:function(features){if(!features){features=this.layer.features;}
var remote=this.layer.projection;var local=this.layer.map.getProjectionObject();if(!local.equals(remote)){var len=features.length;var clones=new Array(len);var orig,clone;for(var i=0;i&lt;len;++i){orig=features[i];clone=orig.clone();clone.fid=orig.fid;clone.state=orig.state;clone._original=orig;clone.geometry.transform(local,remote);clones[i]=clone;}
features=clones;}
this.layer.protocol.commit(features,{callback:this.onCommit,scope:this});},onCommit:function(response){if(response.success()){var features=response.reqFeatures;var state,feature;var destroys=[];var insertIds=response.insertIds||[];var j=0;for(var i=0,len=features.length;i&lt;len;++i){feature=features[i];feature=feature._original||feature;state=feature.state;if(state){if(state==OpenLayers.State.DELETE){destroys.push(feature);}else if(state==OpenLayers.State.INSERT){feature.fid=insertIds[j];++j;}
feature.state=null;}}
if(destroys.length&gt;0){this.layer.destroyFeatures(destroys);}}},CLASS_NAME:&quot;OpenLayers.Strategy.Save&quot;});OpenLayers.Tween=OpenLayers.Class({INTERVAL:10,easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,interval:null,playing:false,initialize:function(easing){this.easing=(easing)?easing:OpenLayers.Easing.Expo.easeOut;},start:function(begin,finish,duration,options){this.playing=true;this.begin=begin;this.finish=finish;this.duration=duration;this.callbacks=options.callbacks;this.time=0;if(this.interval){window.clearInterval(this.interval);this.interval=null;}
if(this.callbacks&amp;&amp;this.callbacks.start){this.callbacks.start.call(this,this.begin);}
this.interval=window.setInterval(OpenLayers.Function.bind(this.play,this),this.INTERVAL);},stop:function(){if(!this.playing){return;}
if(this.callbacks&amp;&amp;this.callbacks.done){this.callbacks.done.call(this,this.finish);}
window.clearInterval(this.interval);this.interval=null;this.playing=false;},play:function(){var value={};for(var i in this.begin){var b=this.begin[i];var f=this.finish[i];if(b==null||f==null||isNaN(b)||isNaN(f)){OpenLayers.Console.error(&apos;invalid value for Tween&apos;);}
var c=f-b;value[i]=this.easing.apply(this,[this.time,b,c,this.duration]);}
this.time++;if(this.callbacks&amp;&amp;this.callbacks.eachStep){this.callbacks.eachStep.call(this,value);}
if(this.time&gt;this.duration){if(this.callbacks&amp;&amp;this.callbacks.done){this.callbacks.done.call(this,this.finish);this.playing=false;}
window.clearInterval(this.interval);this.interval=null;}},CLASS_NAME:&quot;OpenLayers.Tween&quot;});OpenLayers.Easing={CLASS_NAME:&quot;OpenLayers.Easing&quot;};OpenLayers.Easing.Linear={easeIn:function(t,b,c,d){return c*t/d+b;},easeOut:function(t,b,c,d){return c*t/d+b;},easeInOut:function(t,b,c,d){return c*t/d+b;},CLASS_NAME:&quot;OpenLayers.Easing.Linear&quot;};OpenLayers.Easing.Expo={easeIn:function(t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b;},easeOut:function(t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b;},easeInOut:function(t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)&lt;1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b;},CLASS_NAME:&quot;OpenLayers.Easing.Expo&quot;};OpenLayers.Easing.Quad={easeIn:function(t,b,c,d){return c*(t/=d)*t+b;},easeOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b;},easeInOut:function(t,b,c,d){if((t/=d/2)&lt;1)return c/2*t*t+b;return-c/2*((--t)*(t-2)-1)+b;},CLASS_NAME:&quot;OpenLayers.Easing.Quad&quot;};OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,initialize:function(options){OpenLayers.Control.prototype.initialize.apply(this,arguments);},setMap:function(map){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var i=0,len=this.map.controls.length;i&lt;len;i++){var control=this.map.controls[i];if((control!=this)&amp;&amp;(control.CLASS_NAME==&quot;OpenLayers.Control.ArgParser&quot;)){if(control.displayProjection!=this.displayProjection){this.displayProjection=control.displayProjection;}
break;}}
if(i==this.map.controls.length){var args=OpenLayers.Util.getParameters();if(args.layers){this.layers=args.layers;this.map.events.register(&apos;addlayer&apos;,this,this.configureLayers);this.configureLayers();}
if(args.lat&amp;&amp;args.lon){this.center=new OpenLayers.LonLat(parseFloat(args.lon),parseFloat(args.lat));if(args.zoom){this.zoom=parseInt(args.zoom);}
this.map.events.register(&apos;changebaselayer&apos;,this,this.setCenter);this.setCenter();}}},setCenter:function(){if(this.map.baseLayer){this.map.events.unregister(&apos;changebaselayer&apos;,this,this.setCenter);if(this.displayProjection){this.center.transform(this.displayProjection,this.map.getProjectionObject());}
this.map.setCenter(this.center,this.zoom);}},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister(&apos;addlayer&apos;,this,this.configureLayers);for(var i=0,len=this.layers.length;i&lt;len;i++){var layer=this.map.layers[i];var c=this.layers.charAt(i);if(c==&quot;B&quot;){this.map.setBaseLayer(layer);}else if((c==&quot;T&quot;)||(c==&quot;F&quot;)){layer.setVisibility(c==&quot;T&quot;);}}}},CLASS_NAME:&quot;OpenLayers.Control.ArgParser&quot;});OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:&quot;, &quot;,initialize:function(options){OpenLayers.Control.prototype.initialize.apply(this,arguments);},destroy:function(){this.map.events.un({&quot;removelayer&quot;:this.updateAttribution,&quot;addlayer&quot;:this.updateAttribution,&quot;changelayer&quot;:this.updateAttribution,&quot;changebaselayer&quot;:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments);},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({&apos;changebaselayer&apos;:this.updateAttribution,&apos;changelayer&apos;:this.updateAttribution,&apos;addlayer&apos;:this.updateAttribution,&apos;removelayer&apos;:this.updateAttribution,scope:this});this.updateAttribution();return this.div;},updateAttribution:function(){var attributions=[];if(this.map&amp;&amp;this.map.layers){for(var i=0,len=this.map.layers.length;i&lt;len;i++){var layer=this.map.layers[i];if(layer.attribution&amp;&amp;layer.getVisibility()){attributions.push(layer.attribution);}}
this.div.innerHTML=attributions.join(this.separator);}},CLASS_NAME:&quot;OpenLayers.Control.Attribution&quot;});OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:&quot;OpenLayers.Control.Button&quot;});OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{activeColor:&quot;#007aaa&quot;,layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:true,initialize:function(options){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.layerStates=[];},destroy:function(){OpenLayers.Event.stopObservingElement(this.div);OpenLayers.Event.stopObservingElement(this.minimizeDiv);OpenLayers.Event.stopObservingElement(this.maximizeDiv);this.clearLayersArray(&quot;base&quot;);this.clearLayersArray(&quot;data&quot;);this.map.events.un({&quot;addlayer&quot;:this.redraw,&quot;changelayer&quot;:this.redraw,&quot;removelayer&quot;:this.redraw,&quot;changebaselayer&quot;:this.redraw,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments);},setMap:function(map){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.on({&quot;addlayer&quot;:this.redraw,&quot;changelayer&quot;:this.redraw,&quot;removelayer&quot;:this.redraw,&quot;changebaselayer&quot;:this.redraw,scope:this});},draw:function(){OpenLayers.Control.prototype.draw.apply(this);this.loadContents();if(!this.outsideViewport){this.minimizeControl();}
this.redraw();return this.div;},clearLayersArray:function(layersType){var layers=this[layersType+&quot;Layers&quot;];if(layers){for(var i=0,len=layers.length;i&lt;len;i++){var layer=layers[i];OpenLayers.Event.stopObservingElement(layer.inputElem);OpenLayers.Event.stopObservingElement(layer.labelSpan);}}
this[layersType+&quot;LayersDiv&quot;].innerHTML=&quot;&quot;;this[layersType+&quot;Layers&quot;]=[];},checkRedraw:function(){var redraw=false;if(!this.layerStates.length||(this.map.layers.length!=this.layerStates.length)){redraw=true;}else{for(var i=0,len=this.layerStates.length;i&lt;len;i++){var layerState=this.layerStates[i];var layer=this.map.layers[i];if((layerState.name!=layer.name)||(layerState.inRange!=layer.inRange)||(layerState.id!=layer.id)||(layerState.visibility!=layer.visibility)){redraw=true;break;}}}
return redraw;},redraw:function(){if(!this.checkRedraw()){return this.div;}
this.clearLayersArray(&quot;base&quot;);this.clearLayersArray(&quot;data&quot;);var containsOverlays=false;var containsBaseLayers=false;var len=this.map.layers.length;this.layerStates=new Array(len);for(var i=0;i&lt;len;i++){var layer=this.map.layers[i];this.layerStates[i]={&apos;name&apos;:layer.name,&apos;visibility&apos;:layer.visibility,&apos;inRange&apos;:layer.inRange,&apos;id&apos;:layer.id};}
var layers=this.map.layers.slice();if(!this.ascending){layers.reverse();}
for(var i=0,len=layers.length;i&lt;len;i++){var layer=layers[i];var baseLayer=layer.isBaseLayer;if(layer.displayInLayerSwitcher){if(baseLayer){containsBaseLayers=true;}else{containsOverlays=true;}
var checked=(baseLayer)?(layer==this.map.baseLayer):layer.getVisibility();var inputElem=document.createElement(&quot;input&quot;);inputElem.id=this.id+&quot;_input_&quot;+layer.name;inputElem.name=(baseLayer)?&quot;baseLayers&quot;:layer.name;inputElem.type=(baseLayer)?&quot;radio&quot;:&quot;checkbox&quot;;inputElem.value=layer.name;inputElem.checked=checked;inputElem.defaultChecked=checked;if(!baseLayer&amp;&amp;!layer.inRange){inputElem.disabled=true;}
var context={&apos;inputElem&apos;:inputElem,&apos;layer&apos;:layer,&apos;layerSwitcher&apos;:this};OpenLayers.Event.observe(inputElem,&quot;mouseup&quot;,OpenLayers.Function.bindAsEventListener(this.onInputClick,context));var labelSpan=document.createElement(&quot;span&quot;);if(!baseLayer&amp;&amp;!layer.inRange){labelSpan.style.color=&quot;gray&quot;;}
labelSpan.innerHTML=layer.name;labelSpan.style.verticalAlign=(baseLayer)?&quot;bottom&quot;:&quot;baseline&quot;;OpenLayers.Event.observe(labelSpan,&quot;click&quot;,OpenLayers.Function.bindAsEventListener(this.onInputClick,context));var br=document.createElement(&quot;br&quot;);var groupArray=(baseLayer)?this.baseLayers:this.dataLayers;groupArray.push({&apos;layer&apos;:layer,&apos;inputElem&apos;:inputElem,&apos;labelSpan&apos;:labelSpan});var groupDiv=(baseLayer)?this.baseLayersDiv:this.dataLayersDiv;groupDiv.appendChild(inputElem);groupDiv.appendChild(labelSpan);groupDiv.appendChild(br);}}
this.dataLbl.style.display=(containsOverlays)?&quot;&quot;:&quot;none&quot;;this.baseLbl.style.display=(containsBaseLayers)?&quot;&quot;:&quot;none&quot;;return this.div;},onInputClick:function(e){if(!this.inputElem.disabled){if(this.inputElem.type==&quot;radio&quot;){this.inputElem.checked=true;this.layer.map.setBaseLayer(this.layer);}else{this.inputElem.checked=!this.inputElem.checked;this.layerSwitcher.updateMap();}}
OpenLayers.Event.stop(e);},onLayerClick:function(e){this.updateMap();},updateMap:function(){for(var i=0,len=this.baseLayers.length;i&lt;len;i++){var layerEntry=this.baseLayers[i];if(layerEntry.inputElem.checked){this.map.setBaseLayer(layerEntry.layer,false);}}
for(var i=0,len=this.dataLayers.length;i&lt;len;i++){var layerEntry=this.dataLayers[i];layerEntry.layer.setVisibility(layerEntry.inputElem.checked);}},maximizeControl:function(e){this.div.style.width=&quot;20em&quot;;this.div.style.height=&quot;&quot;;this.showControls(false);if(e!=null){OpenLayers.Event.stop(e);}},minimizeControl:function(e){this.div.style.width=&quot;0px&quot;;this.div.style.height=&quot;0px&quot;;this.showControls(true);if(e!=null){OpenLayers.Event.stop(e);}},showControls:function(minimize){this.maximizeDiv.style.display=minimize?&quot;&quot;:&quot;none&quot;;this.minimizeDiv.style.display=minimize?&quot;none&quot;:&quot;&quot;;this.layersDiv.style.display=minimize?&quot;none&quot;:&quot;&quot;;},loadContents:function(){this.div.style.position=&quot;absolute&quot;;this.div.style.top=&quot;25px&quot;;this.div.style.right=&quot;0px&quot;;this.div.style.left=&quot;&quot;;this.div.style.fontFamily=&quot;sans-serif&quot;;this.div.style.fontWeight=&quot;bold&quot;;this.div.style.marginTop=&quot;3px&quot;;this.div.style.marginLeft=&quot;3px&quot;;this.div.style.marginBottom=&quot;3px&quot;;this.div.style.fontSize=&quot;smaller&quot;;this.div.style.color=&quot;white&quot;;this.div.style.backgroundColor=&quot;transparent&quot;;OpenLayers.Event.observe(this.div,&quot;mouseup&quot;,OpenLayers.Function.bindAsEventListener(this.mouseUp,this));OpenLayers.Event.observe(this.div,&quot;click&quot;,this.ignoreEvent);OpenLayers.Event.observe(this.div,&quot;mousedown&quot;,OpenLayers.Function.bindAsEventListener(this.mouseDown,this));OpenLayers.Event.observe(this.div,&quot;dblclick&quot;,this.ignoreEvent);this.layersDiv=document.createElement(&quot;div&quot;);this.layersDiv.id=this.id+&quot;_layersDiv&quot;;this.layersDiv.style.paddingTop=&quot;5px&quot;;this.layersDiv.style.paddingLeft=&quot;10px&quot;;this.layersDiv.style.paddingBottom=&quot;5px&quot;;this.layersDiv.style.paddingRight=&quot;75px&quot;;this.layersDiv.style.backgroundColor=this.activeColor;this.layersDiv.style.width=&quot;100%&quot;;this.layersDiv.style.height=&quot;100%&quot;;this.baseLbl=document.createElement(&quot;div&quot;);this.baseLbl.innerHTML=OpenLayers.i18n(&quot;baseLayer&quot;);this.baseLbl.style.marginTop=&quot;3px&quot;;this.baseLbl.style.marginLeft=&quot;3px&quot;;this.baseLbl.style.marginBottom=&quot;3px&quot;;this.baseLayersDiv=document.createElement(&quot;div&quot;);this.baseLayersDiv.style.paddingLeft=&quot;10px&quot;;this.dataLbl=document.createElement(&quot;div&quot;);this.dataLbl.innerHTML=OpenLayers.i18n(&quot;overlays&quot;);this.dataLbl.style.marginTop=&quot;3px&quot;;this.dataLbl.style.marginLeft=&quot;3px&quot;;this.dataLbl.style.marginBottom=&quot;3px&quot;;this.dataLayersDiv=document.createElement(&quot;div&quot;);this.dataLayersDiv.style.paddingLeft=&quot;10px&quot;;if(this.ascending){this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv);this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv);}else{this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv);this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv);}
this.div.appendChild(this.layersDiv);OpenLayers.Rico.Corner.round(this.div,{corners:&quot;tl bl&quot;,bgColor:&quot;transparent&quot;,color:this.activeColor,blend:false});OpenLayers.Rico.Corner.changeOpacity(this.layersDiv,0.75);var imgLocation=OpenLayers.Util.getImagesLocation();var sz=new OpenLayers.Size(18,18);var img=imgLocation+&apos;layer-switcher-maximize.png&apos;;this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(&quot;OpenLayers_Control_MaximizeDiv&quot;,null,sz,img,&quot;absolute&quot;);this.maximizeDiv.style.top=&quot;5px&quot;;this.maximizeDiv.style.right=&quot;0px&quot;;this.maximizeDiv.style.left=&quot;&quot;;this.maximizeDiv.style.display=&quot;none&quot;;OpenLayers.Event.observe(this.maximizeDiv,&quot;click&quot;,OpenLayers.Function.bindAsEventListener(this.maximizeControl,this));this.div.appendChild(this.maximizeDiv);var img=imgLocation+&apos;layer-switcher-minimize.png&apos;;var sz=new OpenLayers.Size(18,18);this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv(&quot;OpenLayers_Control_MinimizeDiv&quot;,null,sz,img,&quot;absolute&quot;);this.minimizeDiv.style.top=&quot;5px&quot;;this.minimizeDiv.style.right=&quot;0px&quot;;this.minimizeDiv.style.left=&quot;&quot;;this.minimizeDiv.style.display=&quot;none&quot;;OpenLayers.Event.observe(this.minimizeDiv,&quot;click&quot;,OpenLayers.Function.bindAsEventListener(this.minimizeControl,this));this.div.appendChild(this.minimizeDiv);},ignoreEvent:function(evt){OpenLayers.Event.stop(evt);},mouseDown:function(evt){this.isMouseDown=true;this.ignoreEvent(evt);},mouseUp:function(evt){if(this.isMouseDown){this.isMouseDown=false;this.ignoreEvent(evt);}},CLASS_NAME:&quot;OpenLayers.Control.LayerSwitcher&quot;});OpenLayers.Control.MouseDefaults=OpenLayers.Class(OpenLayers.Control,{performedDrag:false,wheelObserver:null,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments);},destroy:function(){if(this.handler){this.handler.destroy();}
this.handler=null;this.map.events.un({&quot;click&quot;:this.defaultClick,&quot;dblclick&quot;:this.defaultDblClick,&quot;mousedown&quot;:this.defaultMouseDown,&quot;mouseup&quot;:this.defaultMouseUp,&quot;mousemove&quot;:this.defaultMouseMove,&quot;mouseout&quot;:this.defaultMouseOut,scope:this});OpenLayers.Event.stopObserving(window,&quot;DOMMouseScroll&quot;,this.wheelObserver);OpenLayers.Event.stopObserving(window,&quot;mousewheel&quot;,this.wheelObserver);OpenLayers.Event.stopObserving(document,&quot;mousewheel&quot;,this.wheelObserver);this.wheelObserver=null;OpenLayers.Control.prototype.destroy.apply(this,arguments);},draw:function(){this.map.events.on({&quot;click&quot;:this.defaultClick,&quot;dblclick&quot;:this.defaultDblClick,&quot;mousedown&quot;:this.defaultMouseDown,&quot;mouseup&quot;:this.defaultMouseUp,&quot;mousemove&quot;:this.defaultMouseMove,&quot;mouseout&quot;:this.defaultMouseOut,scope:this});this.registerWheelEvents();},registerWheelEvents:function(){this.wheelObserver=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this);OpenLayers.Event.observe(window,&quot;DOMMouseScroll&quot;,this.wheelObserver);OpenLayers.Event.observe(window,&quot;mousewheel&quot;,this.wheelObserver);OpenLayers.Event.observe(document,&quot;mousewheel&quot;,this.wheelObserver);},defaultClick:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
var notAfterDrag=!this.performedDrag;this.performedDrag=false;return notAfterDrag;},defaultDblClick:function(evt){var newCenter=this.map.getLonLatFromViewPortPx(evt.xy);this.map.setCenter(newCenter,this.map.zoom+1);OpenLayers.Event.stop(evt);return false;},defaultMouseDown:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
this.mouseDragStart=evt.xy.clone();this.performedDrag=false;if(evt.shiftKey){this.map.div.style.cursor=&quot;crosshair&quot;;this.zoomBox=OpenLayers.Util.createDiv(&apos;zoomBox&apos;,this.mouseDragStart,null,null,&quot;absolute&quot;,&quot;2px solid red&quot;);this.zoomBox.style.backgroundColor=&quot;white&quot;;this.zoomBox.style.filter=&quot;alpha(opacity=50)&quot;;this.zoomBox.style.opacity=&quot;0.50&quot;;this.zoomBox.style.fontSize=&quot;1px&quot;;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE[&quot;Popup&quot;]-1;this.map.viewPortDiv.appendChild(this.zoomBox);}
document.onselectstart=function(){return false;};OpenLayers.Event.stop(evt);},defaultMouseMove:function(evt){this.mousePosition=evt.xy.clone();if(this.mouseDragStart!=null){if(this.zoomBox){var deltaX=Math.abs(this.mouseDragStart.x-evt.xy.x);var deltaY=Math.abs(this.mouseDragStart.y-evt.xy.y);this.zoomBox.style.width=Math.max(1,deltaX)+&quot;px&quot;;this.zoomBox.style.height=Math.max(1,deltaY)+&quot;px&quot;;if(evt.xy.x&lt;this.mouseDragStart.x){this.zoomBox.style.left=evt.xy.x+&quot;px&quot;;}
if(evt.xy.y&lt;this.mouseDragStart.y){this.zoomBox.style.top=evt.xy.y+&quot;px&quot;;}}else{var deltaX=this.mouseDragStart.x-evt.xy.x;var deltaY=this.mouseDragStart.y-evt.xy.y;var size=this.map.getSize();var newXY=new OpenLayers.Pixel(size.w/2+deltaX,size.h/2+deltaY);var newCenter=this.map.getLonLatFromViewPortPx(newXY);this.map.setCenter(newCenter,null,true);this.mouseDragStart=evt.xy.clone();this.map.div.style.cursor=&quot;move&quot;;}
this.performedDrag=true;}},defaultMouseUp:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
if(this.zoomBox){this.zoomBoxEnd(evt);}else{if(this.performedDrag){this.map.setCenter(this.map.center);}}
document.onselectstart=null;this.mouseDragStart=null;this.map.div.style.cursor=&quot;&quot;;},defaultMouseOut:function(evt){if(this.mouseDragStart!=null&amp;&amp;OpenLayers.Util.mouseLeft(evt,this.map.div)){if(this.zoomBox){this.removeZoomBox();}
this.mouseDragStart=null;}},defaultWheelUp:function(evt){if(this.map.getZoom()&lt;=this.map.getNumZoomLevels()){this.map.setCenter(this.map.getLonLatFromPixel(evt.xy),this.map.getZoom()+1);}},defaultWheelDown:function(evt){if(this.map.getZoom()&gt;0){this.map.setCenter(this.map.getLonLatFromPixel(evt.xy),this.map.getZoom()-1);}},zoomBoxEnd:function(evt){if(this.mouseDragStart!=null){if(Math.abs(this.mouseDragStart.x-evt.xy.x)&gt;5||Math.abs(this.mouseDragStart.y-evt.xy.y)&gt;5){var start=this.map.getLonLatFromViewPortPx(this.mouseDragStart);var end=this.map.getLonLatFromViewPortPx(evt.xy);var top=Math.max(start.lat,end.lat);var bottom=Math.min(start.lat,end.lat);var left=Math.min(start.lon,end.lon);var right=Math.max(start.lon,end.lon);var bounds=new OpenLayers.Bounds(left,bottom,right,top);this.map.zoomToExtent(bounds);}else{var end=this.map.getLonLatFromViewPortPx(evt.xy);this.map.setCenter(new OpenLayers.LonLat((end.lon),(end.lat)),this.map.getZoom()+1);}
this.removeZoomBox();}},removeZoomBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.zoomBox=null;},onWheelEvent:function(e){var inMap=false;var elem=OpenLayers.Event.element(e);while(elem!=null){if(this.map&amp;&amp;elem==this.map.div){inMap=true;break;}
elem=elem.parentNode;}
if(inMap){var delta=0;if(!e){e=window.event;}
if(e.wheelDelta){delta=e.wheelDelta/120;if(window.opera&amp;&amp;window.opera.version()&lt;9.2){delta=-delta;}}else if(e.detail){delta=-e.detail/3;}
if(delta){e.xy=this.mousePosition;if(delta&lt;0){this.defaultWheelDown(e);}else{this.defaultWheelUp(e);}}
OpenLayers.Event.stop(e);}},CLASS_NAME:&quot;OpenLayers.Control.MouseDefaults&quot;});OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{element:null,prefix:&apos;&apos;,separator:&apos;, &apos;,suffix:&apos;&apos;,numDigits:5,granularity:10,lastXy:null,displayProjection:null,initialize:function(options){OpenLayers.Control.prototype.initialize.apply(this,arguments);},destroy:function(){if(this.map){this.map.events.unregister(&apos;mousemove&apos;,this,this.redraw);}
OpenLayers.Control.prototype.destroy.apply(this,arguments);},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.div.left=&quot;&quot;;this.div.top=&quot;&quot;;this.element=this.div;}
this.redraw();return this.div;},redraw:function(evt){var lonLat;if(evt==null){lonLat=new OpenLayers.LonLat(0,0);}else{if(this.lastXy==null||Math.abs(evt.xy.x-this.lastXy.x)&gt;this.granularity||Math.abs(evt.xy.y-this.lastXy.y)&gt;this.granularity)
{this.lastXy=evt.xy;return;}
lonLat=this.map.getLonLatFromPixel(evt.xy);if(!lonLat){return;}
if(this.displayProjection){lonLat.transform(this.map.getProjectionObject(),this.displayProjection);}
this.lastXy=evt.xy;}
var newHtml=this.formatOutput(lonLat);if(newHtml!=this.element.innerHTML){this.element.innerHTML=newHtml;}},formatOutput:function(lonLat){var digits=parseInt(this.numDigits);var newHtml=this.prefix+
lonLat.lon.toFixed(digits)+
this.separator+
lonLat.lat.toFixed(digits)+
this.suffix;return newHtml;},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.register(&apos;mousemove&apos;,this,this.redraw);},CLASS_NAME:&quot;OpenLayers.Control.MousePosition&quot;});OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,direction:null,type:OpenLayers.Control.TYPE_BUTTON,initialize:function(direction,options){this.direction=direction;this.CLASS_NAME+=this.direction;OpenLayers.Control.prototype.initialize.apply(this,[options]);},trigger:function(){switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,this.slideFactor);break;case OpenLayers.Control.Pan.WEST:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(this.slideFactor,0);break;}},CLASS_NAME:&quot;OpenLayers.Control.Pan&quot;});OpenLayers.Control.Pan.NORTH=&quot;North&quot;;OpenLayers.Control.Pan.SOUTH=&quot;South&quot;;OpenLayers.Control.Pan.EAST=&quot;East&quot;;OpenLayers.Control.Pan.WEST=&quot;West&quot;;OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(options){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(this,arguments);},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);this.removeButtons();this.buttons=null;this.position=null;},draw:function(px){OpenLayers.Control.prototype.draw.apply(this,arguments);px=this.position;this.buttons=[];var sz=new OpenLayers.Size(18,18);var centered=new OpenLayers.Pixel(px.x+sz.w/2,px.y);this._addButton(&quot;panup&quot;,&quot;north-mini.png&quot;,centered,sz);px.y=centered.y+sz.h;this._addButton(&quot;panleft&quot;,&quot;west-mini.png&quot;,px,sz);this._addButton(&quot;panright&quot;,&quot;east-mini.png&quot;,px.add(sz.w,0),sz);this._addButton(&quot;pandown&quot;,&quot;south-mini.png&quot;,centered.add(0,sz.h*2),sz);this._addButton(&quot;zoomin&quot;,&quot;zoom-plus-mini.png&quot;,centered.add(0,sz.h*3+5),sz);this._addButton(&quot;zoomworld&quot;,&quot;zoom-world-mini.png&quot;,centered.add(0,sz.h*4+5),sz);this._addButton(&quot;zoomout&quot;,&quot;zoom-minus-mini.png&quot;,centered.add(0,sz.h*5+5),sz);return this.div;},_addButton:function(id,img,xy,sz){var imgLocation=OpenLayers.Util.getImagesLocation()+img;var btn=OpenLayers.Util.createAlphaImageDiv(this.id+&quot;_&quot;+id,xy,sz,imgLocation,&quot;absolute&quot;);this.div.appendChild(btn);OpenLayers.Event.observe(btn,&quot;mousedown&quot;,OpenLayers.Function.bindAsEventListener(this.buttonDown,btn));OpenLayers.Event.observe(btn,&quot;dblclick&quot;,OpenLayers.Function.bindAsEventListener(this.doubleClick,btn));OpenLayers.Event.observe(btn,&quot;click&quot;,OpenLayers.Function.bindAsEventListener(this.doubleClick,btn));btn.action=id;btn.map=this.map;if(!this.slideRatio){var slideFactorPixels=this.slideFactor;var getSlideFactor=function(){return slideFactorPixels;};}else{var slideRatio=this.slideRatio;var getSlideFactor=function(dim){return this.map.getSize()[dim]*slideRatio;};}
btn.getSlideFactor=getSlideFactor;this.buttons.push(btn);return btn;},_removeButton:function(btn){OpenLayers.Event.stopObservingElement(btn);btn.map=null;this.div.removeChild(btn);OpenLayers.Util.removeItem(this.buttons,btn);},removeButtons:function(){for(var i=this.buttons.length-1;i&gt;=0;--i){this._removeButton(this.buttons[i]);}},doubleClick:function(evt){OpenLayers.Event.stop(evt);return false;},buttonDown:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
switch(this.action){case&quot;panup&quot;:this.map.pan(0,-this.getSlideFactor(&quot;h&quot;));break;case&quot;pandown&quot;:this.map.pan(0,this.getSlideFactor(&quot;h&quot;));break;case&quot;panleft&quot;:this.map.pan(-this.getSlideFactor(&quot;w&quot;),0);break;case&quot;panright&quot;:this.map.pan(this.getSlideFactor(&quot;w&quot;),0);break;case&quot;zoomin&quot;:this.map.zoomIn();break;case&quot;zoomout&quot;:this.map.zoomOut();break;case&quot;zoomworld&quot;:this.map.zoomToMaxExtent();break;}
OpenLayers.Event.stop(evt);},CLASS_NAME:&quot;OpenLayers.Control.PanZoom&quot;});OpenLayers.Control.PanZoom.X=4;OpenLayers.Control.PanZoom.Y=4;OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,defaultControl:null,initialize:function(options){OpenLayers.Control.prototype.initialize.apply(this,[options]);this.controls=[];},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var i=this.controls.length-1;i&gt;=0;i--){if(this.controls[i].events){this.controls[i].events.un({&quot;activate&quot;:this.redraw,&quot;deactivate&quot;:this.redraw,scope:this});}
OpenLayers.Event.stopObservingElement(this.controls[i].panel_div);this.controls[i].panel_div=null;}},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var i=0,len=this.controls.length;i&lt;len;i++){if(this.controls[i]==this.defaultControl){this.controls[i].activate();}}
this.redraw();return true;}else{return false;}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var i=0,len=this.controls.length;i&lt;len;i++){this.controls[i].deactivate();}
return true;}else{return false;}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);for(var i=0,len=this.controls.length;i&lt;len;i++){this.map.addControl(this.controls[i]);this.controls[i].deactivate();this.controls[i].events.on({&quot;activate&quot;:this.redraw,&quot;deactivate&quot;:this.redraw,scope:this});}
this.activate();return this.div;},redraw:function(){this.div.innerHTML=&quot;&quot;;if(this.active){for(var i=0,len=this.controls.length;i&lt;len;i++){var element=this.controls[i].panel_div;if(this.controls[i].active){element.className=this.controls[i].displayClass+&quot;ItemActive&quot;;}else{element.className=this.controls[i].displayClass+&quot;ItemInactive&quot;;}
this.div.appendChild(element);}}},activateControl:function(control){if(!this.active){return false;}
if(control.type==OpenLayers.Control.TYPE_BUTTON){control.trigger();this.redraw();return;}
if(control.type==OpenLayers.Control.TYPE_TOGGLE){if(control.active){control.deactivate();}else{control.activate();}
this.redraw();return;}
for(var i=0,len=this.controls.length;i&lt;len;i++){if(this.controls[i]!=control){if(this.controls[i].type!=OpenLayers.Control.TYPE_TOGGLE){this.controls[i].deactivate();}}}
control.activate();},addControls:function(controls){if(!(controls instanceof Array)){controls=[controls];}
this.controls=this.controls.concat(controls);for(var i=0,len=controls.length;i&lt;len;i++){var element=document.createElement(&quot;div&quot;);var textNode=document.createTextNode(&quot; &quot;);controls[i].panel_div=element;if(controls[i].title!=&quot;&quot;){controls[i].panel_div.title=controls[i].title;}
OpenLayers.Event.observe(controls[i].panel_div,&quot;click&quot;,OpenLayers.Function.bind(this.onClick,this,controls[i]));OpenLayers.Event.observe(controls[i].panel_div,&quot;mousedown&quot;,OpenLayers.Function.bindAsEventListener(OpenLayers.Event.stop));}
if(this.map){for(var i=0,len=controls.length;i&lt;len;i++){this.map.addControl(controls[i]);controls[i].deactivate();controls[i].events.on({&quot;activate&quot;:this.redraw,&quot;deactivate&quot;:this.redraw,scope:this});}
this.redraw();}},onClick:function(ctrl,evt){OpenLayers.Event.stop(evt?evt:window.event);this.activateControl(ctrl);},getControlsBy:function(property,match){var test=(typeof match.test==&quot;function&quot;);var found=OpenLayers.Array.filter(this.controls,function(item){return item[property]==match||(test&amp;&amp;match.test(item[property]));});return found;},getControlsByName:function(match){return this.getControlsBy(&quot;name&quot;,match);},getControlsByClass:function(match){return this.getControlsBy(&quot;CLASS_NAME&quot;,match);},CLASS_NAME:&quot;OpenLayers.Control.Panel&quot;});OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,initialize:function(element,options){OpenLayers.Control.prototype.initialize.apply(this,[options]);this.element=OpenLayers.Util.getElement(element);},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.element=document.createElement(&quot;div&quot;);this.div.appendChild(this.element);}
this.map.events.register(&apos;moveend&apos;,this,this.updateScale);this.updateScale();return this.div;},updateScale:function(){var scale=this.map.getScale();if(!scale){return;}
if(scale&gt;=9500&amp;&amp;scale&lt;=950000){scale=Math.round(scale/1000)+&quot;K&quot;;}else if(scale&gt;=950000){scale=Math.round(scale/1000000)+&quot;M&quot;;}else{scale=Math.round(scale);}
this.element.innerHTML=OpenLayers.i18n(&quot;scale&quot;,{&apos;scaleDenom&apos;:scale});},CLASS_NAME:&quot;OpenLayers.Control.Scale&quot;});OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:&quot;km&quot;,topInUnits:&quot;m&quot;,bottomOutUnits:&quot;mi&quot;,bottomInUnits:&quot;ft&quot;,eTop:null,eBottom:null,initialize:function(options){OpenLayers.Control.prototype.initialize.apply(this,[options]);},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.eTop){this.div.style.display=&quot;block&quot;;this.div.style.position=&quot;absolute&quot;;this.eTop=document.createElement(&quot;div&quot;);this.eTop.className=this.displayClass+&quot;Top&quot;;var theLen=this.topInUnits.length;this.div.appendChild(this.eTop);if((this.topOutUnits==&quot;&quot;)||(this.topInUnits==&quot;&quot;)){this.eTop.style.visibility=&quot;hidden&quot;;}else{this.eTop.style.visibility=&quot;visible&quot;;}
this.eBottom=document.createElement(&quot;div&quot;);this.eBottom.className=this.displayClass+&quot;Bottom&quot;;this.div.appendChild(this.eBottom);if((this.bottomOutUnits==&quot;&quot;)||(this.bottomInUnits==&quot;&quot;)){this.eBottom.style.visibility=&quot;hidden&quot;;}else{this.eBottom.style.visibility=&quot;visible&quot;;}}
this.map.events.register(&apos;moveend&apos;,this,this.update);this.update();return this.div;},getBarLen:function(maxLen){var digits=parseInt(Math.log(maxLen)/Math.log(10));var pow10=Math.pow(10,digits);var firstChar=parseInt(maxLen/pow10);var barLen;if(firstChar&gt;5){barLen=5;}else if(firstChar&gt;2){barLen=2;}else{barLen=1;}
return barLen*pow10;},update:function(){var res=this.map.getResolution();if(!res){return;}
var curMapUnits=this.map.getUnits();var inches=OpenLayers.INCHES_PER_UNIT;var maxSizeData=this.maxWidth*res*inches[curMapUnits];var topUnits;var bottomUnits;if(maxSizeData&gt;100000){topUnits=this.topOutUnits;bottomUnits=this.bottomOutUnits;}else{topUnits=this.topInUnits;bottomUnits=this.bottomInUnits;}
var topMax=maxSizeData/inches[topUnits];var bottomMax=maxSizeData/inches[bottomUnits];var topRounded=this.getBarLen(topMax);var bottomRounded=this.getBarLen(bottomMax);topMax=topRounded/inches[curMapUnits]*inches[topUnits];bottomMax=bottomRounded/inches[curMapUnits]*inches[bottomUnits];var topPx=topMax/res;var bottomPx=bottomMax/res;if(this.eBottom.style.visibility==&quot;visible&quot;){this.eBottom.style.width=Math.round(bottomPx)+&quot;px&quot;;this.eBottom.innerHTML=bottomRounded+&quot; &quot;+bottomUnits;}
if(this.eTop.style.visibility==&quot;visible&quot;){this.eTop.style.width=Math.round(topPx)+&quot;px&quot;;this.eTop.innerHTML=topRounded+&quot; &quot;+topUnits;}},CLASS_NAME:&quot;OpenLayers.Control.ScaleLine&quot;});OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomIn();},CLASS_NAME:&quot;OpenLayers.Control.ZoomIn&quot;});OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomOut();},CLASS_NAME:&quot;OpenLayers.Control.ZoomOut&quot;});OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){if(this.map){this.map.zoomToMaxExtent();}},CLASS_NAME:&quot;OpenLayers.Control.ZoomToMaxExtent&quot;});OpenLayers.Event={observers:false,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(event){return event.target||event.srcElement;},isLeftClick:function(event){return(((event.which)&amp;&amp;(event.which==1))||((event.button)&amp;&amp;(event.button==1)));},isRightClick:function(event){return(((event.which)&amp;&amp;(event.which==3))||((event.button)&amp;&amp;(event.button==2)));},stop:function(event,allowDefault){if(!allowDefault){if(event.preventDefault){event.preventDefault();}else{event.returnValue=false;}}
if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}},findElement:function(event,tagName){var element=OpenLayers.Event.element(event);while(element.parentNode&amp;&amp;(!element.tagName||(element.tagName.toUpperCase()!=tagName.toUpperCase()))){element=element.parentNode;}
return element;},observe:function(elementParam,name,observer,useCapture){var element=OpenLayers.Util.getElement(elementParam);useCapture=useCapture||false;if(name==&apos;keypress&apos;&amp;&amp;(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||element.attachEvent)){name=&apos;keydown&apos;;}
if(!this.observers){this.observers={};}
if(!element._eventCacheID){var idPrefix=&quot;eventCacheID_&quot;;if(element.id){idPrefix=element.id+&quot;_&quot;+idPrefix;}
element._eventCacheID=OpenLayers.Util.createUniqueID(idPrefix);}
var cacheID=element._eventCacheID;if(!this.observers[cacheID]){this.observers[cacheID]=[];}
this.observers[cacheID].push({&apos;element&apos;:element,&apos;name&apos;:name,&apos;observer&apos;:observer,&apos;useCapture&apos;:useCapture});if(element.addEventListener){element.addEventListener(name,observer,useCapture);}else if(element.attachEvent){element.attachEvent(&apos;on&apos;+name,observer);}},stopObservingElement:function(elementParam){var element=OpenLayers.Util.getElement(elementParam);var cacheID=element._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[cacheID]);},_removeElementObservers:function(elementObservers){if(elementObservers){for(var i=elementObservers.length-1;i&gt;=0;i--){var entry=elementObservers[i];var args=new Array(entry.element,entry.name,entry.observer,entry.useCapture);var removed=OpenLayers.Event.stopObserving.apply(this,args);}}},stopObserving:function(elementParam,name,observer,useCapture){useCapture=useCapture||false;var element=OpenLayers.Util.getElement(elementParam);var cacheID=element._eventCacheID;if(name==&apos;keypress&apos;){if(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||element.detachEvent){name=&apos;keydown&apos;;}}
var foundEntry=false;var elementObservers=OpenLayers.Event.observers[cacheID];if(elementObservers){var i=0;while(!foundEntry&amp;&amp;i&lt;elementObservers.length){var cacheEntry=elementObservers[i];if((cacheEntry.name==name)&amp;&amp;(cacheEntry.observer==observer)&amp;&amp;(cacheEntry.useCapture==useCapture)){elementObservers.splice(i,1);if(elementObservers.length==0){delete OpenLayers.Event.observers[cacheID];}
foundEntry=true;break;}
i++;}}
if(foundEntry){if(element.removeEventListener){element.removeEventListener(name,observer,useCapture);}else if(element&amp;&amp;element.detachEvent){element.detachEvent(&apos;on&apos;+name,observer);}}
return foundEntry;},unloadCache:function(){if(OpenLayers.Event&amp;&amp;OpenLayers.Event.observers){for(var cacheID in OpenLayers.Event.observers){var elementObservers=OpenLayers.Event.observers[cacheID];OpenLayers.Event._removeElementObservers.apply(this,[elementObservers]);}
OpenLayers.Event.observers=false;}},CLASS_NAME:&quot;OpenLayers.Event&quot;};OpenLayers.Event.observe(window,&apos;unload&apos;,OpenLayers.Event.unloadCache,false);if(window.Event){OpenLayers.Util.applyDefaults(window.Event,OpenLayers.Event);}else{var Event=OpenLayers.Event;}
OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:[&quot;mouseover&quot;,&quot;mouseout&quot;,&quot;mousedown&quot;,&quot;mouseup&quot;,&quot;mousemove&quot;,&quot;click&quot;,&quot;dblclick&quot;,&quot;rightclick&quot;,&quot;dblrightclick&quot;,&quot;resize&quot;,&quot;focus&quot;,&quot;blur&quot;],listeners:null,object:null,element:null,eventTypes:null,eventHandler:null,fallThrough:null,includeXY:false,clearMouseListener:null,initialize:function(object,element,eventTypes,fallThrough,options){OpenLayers.Util.extend(this,options);this.object=object;this.fallThrough=fallThrough;this.listeners={};this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this);this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this);this.eventTypes=[];if(eventTypes!=null){for(var i=0,len=eventTypes.length;i&lt;len;i++){this.addEventType(eventTypes[i]);}}
if(element!=null){this.attachToElement(element);}},destroy:function(){if(this.element){OpenLayers.Event.stopObservingElement(this.element);if(this.element.hasScrollEvent){OpenLayers.Event.stopObserving(window,&quot;scroll&quot;,this.clearMouseListener);}}
this.element=null;this.listeners=null;this.object=null;this.eventTypes=null;this.fallThrough=null;this.eventHandler=null;},addEventType:function(eventName){if(!this.listeners[eventName]){this.eventTypes.push(eventName);this.listeners[eventName]=[];}},attachToElement:function(element){if(this.element){OpenLayers.Event.stopObservingElement(this.element);}
this.element=element;for(var i=0,len=this.BROWSER_EVENTS.length;i&lt;len;i++){var eventType=this.BROWSER_EVENTS[i];this.addEventType(eventType);OpenLayers.Event.observe(element,eventType,this.eventHandler);}
OpenLayers.Event.observe(element,&quot;dragstart&quot;,OpenLayers.Event.stop);},on:function(object){for(var type in object){if(type!=&quot;scope&quot;){this.register(type,object.scope,object[type]);}}},register:function(type,obj,func){if((func!=null)&amp;&amp;(OpenLayers.Util.indexOf(this.eventTypes,type)!=-1)){if(obj==null){obj=this.object;}
var listeners=this.listeners[type];listeners.push({obj:obj,func:func});}},registerPriority:function(type,obj,func){if(func!=null){if(obj==null){obj=this.object;}
var listeners=this.listeners[type];if(listeners!=null){listeners.unshift({obj:obj,func:func});}}},un:function(object){for(var type in object){if(type!=&quot;scope&quot;){this.unregister(type,object.scope,object[type]);}}},unregister:function(type,obj,func){if(obj==null){obj=this.object;}
var listeners=this.listeners[type];if(listeners!=null){for(var i=0,len=listeners.length;i&lt;len;i++){if(listeners[i].obj==obj&amp;&amp;listeners[i].func==func){listeners.splice(i,1);break;}}}},remove:function(type){if(this.listeners[type]!=null){this.listeners[type]=[];}},triggerEvent:function(type,evt){var listeners=this.listeners[type];if(!listeners||listeners.length==0){return;}
if(evt==null){evt={};}
evt.object=this.object;evt.element=this.element;if(!evt.type){evt.type=type;}
var listeners=listeners.slice(),continueChain;for(var i=0,len=listeners.length;i&lt;len;i++){var callback=listeners[i];continueChain=callback.func.apply(callback.obj,[evt]);if((continueChain!=undefined)&amp;&amp;(continueChain==false)){break;}}
if(!this.fallThrough){OpenLayers.Event.stop(evt,true);}
return continueChain;},handleBrowserEvent:function(evt){if(this.includeXY){evt.xy=this.getMousePosition(evt);}
this.triggerEvent(evt.type,evt);},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;this.element.offsets=null;},getMousePosition:function(evt){if(!this.includeXY){this.clearMouseCache();}else if(!this.element.hasScrollEvent){OpenLayers.Event.observe(window,&quot;scroll&quot;,this.clearMouseListener);this.element.hasScrollEvent=true;}
if(!this.element.scrolls){this.element.scrolls=[(document.documentElement.scrollLeft||document.body.scrollLeft),(document.documentElement.scrollTop||document.body.scrollTop)];}
if(!this.element.lefttop){this.element.lefttop=[(document.documentElement.clientLeft||0),(document.documentElement.clientTop||0)];}
if(!this.element.offsets){this.element.offsets=OpenLayers.Util.pagePosition(this.element);this.element.offsets[0]+=this.element.scrolls[0];this.element.offsets[1]+=this.element.scrolls[1];}
return new OpenLayers.Pixel((evt.clientX+this.element.scrolls[0])-this.element.offsets[0]
-this.element.lefttop[0],(evt.clientY+this.element.scrolls[1])-this.element.offsets[1]
-this.element.lefttop[1]);},CLASS_NAME:&quot;OpenLayers.Events&quot;});OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:false,initialize:function(options){OpenLayers.Util.extend(this,options);this.options=options;},destroy:function(){},read:function(data){OpenLayers.Console.userError(OpenLayers.i18n(&quot;readNotImplemented&quot;));},write:function(object){OpenLayers.Console.userError(OpenLayers.i18n(&quot;writeNotImplemented&quot;));},CLASS_NAME:&quot;OpenLayers.Format&quot;});OpenLayers.Lang.en={&apos;unhandledRequest&apos;:&quot;Unhandled request return ${statusText}&quot;,&apos;permalink&apos;:&quot;Permalink&quot;,&apos;overlays&apos;:&quot;Overlays&quot;,&apos;baseLayer&apos;:&quot;Base Layer&quot;,&apos;sameProjection&apos;:&quot;The overview map only works when it is in the same projection as the main map&quot;,&apos;readNotImplemented&apos;:&quot;Read not implemented.&quot;,&apos;writeNotImplemented&apos;:&quot;Write not implemented.&quot;,&apos;noFID&apos;:&quot;Can&apos;t update a feature for which there is no FID.&quot;,&apos;errorLoadingGML&apos;:&quot;Error in loading GML file ${url}&quot;,&apos;browserNotSupported&apos;:&quot;Your browser does not support vector rendering. Currently supported renderers are:\n${renderers}&quot;,&apos;componentShouldBe&apos;:&quot;addFeatures : component should be an ${geomType}&quot;,&apos;getFeatureError&apos;:&quot;getFeatureFromEvent called on layer with no renderer. This usually means you &quot;+&quot;destroyed a layer, but not some handler which is associated with it.&quot;,&apos;minZoomLevelError&apos;:&quot;The minZoomLevel property is only intended for use &quot;+&quot;with the FixedZoomLevels-descendent layers. That this &quot;+&quot;wfs layer checks for minZoomLevel is a relic of the&quot;+&quot;past. We cannot, however, remove it without possibly &quot;+&quot;breaking OL based applications that may depend on it.&quot;+&quot; Therefore we are deprecating it -- the minZoomLevel &quot;+&quot;check below will be removed at 3.0. Please instead &quot;+&quot;use min/max resolution setting as described here: &quot;+&quot;http://trac.openlayers.org/wiki/SettingZoomLevels&quot;,&apos;commitSuccess&apos;:&quot;WFS Transaction: SUCCESS ${response}&quot;,&apos;commitFailed&apos;:&quot;WFS Transaction: FAILED ${response}&quot;,&apos;googleWarning&apos;:&quot;The Google Layer was unable to load correctly.&lt;br&gt;&lt;br&gt;&quot;+&quot;To get rid of this message, select a new BaseLayer &quot;+&quot;in the layer switcher in the upper-right corner.&lt;br&gt;&lt;br&gt;&quot;+&quot;Most likely, this is because the Google Maps library &quot;+&quot;script was either not included, or does not contain the &quot;+&quot;correct API key for your site.&lt;br&gt;&lt;br&gt;&quot;+&quot;Developers: For help getting this working correctly, &quot;+&quot;&lt;a href=&apos;http://trac.openlayers.org/wiki/Google&apos; &quot;+&quot;target=&apos;_blank&apos;&gt;click here&lt;/a&gt;&quot;,&apos;getLayerWarning&apos;:&quot;The ${layerType} Layer was unable to load correctly.&lt;br&gt;&lt;br&gt;&quot;+&quot;To get rid of this message, select a new BaseLayer &quot;+&quot;in the layer switcher in the upper-right corner.&lt;br&gt;&lt;br&gt;&quot;+&quot;Most likely, this is because the ${layerLib} library &quot;+&quot;script was not correctly included.&lt;br&gt;&lt;br&gt;&quot;+&quot;Developers: For help getting this working correctly, &quot;+&quot;&lt;a href=&apos;http://trac.openlayers.org/wiki/${layerLib}&apos; &quot;+&quot;target=&apos;_blank&apos;&gt;click here&lt;/a&gt;&quot;,&apos;scale&apos;:&quot;Scale = 1 : ${scaleDenom}&quot;,&apos;layerAlreadyAdded&apos;:&quot;You tried to add the layer: ${layerName} to the map, but it has already been added&quot;,&apos;reprojectDeprecated&apos;:&quot;You are using the &apos;reproject&apos; option &quot;+&quot;on the ${layerName} layer. This option is deprecated: &quot;+&quot;its use was designed to support displaying data over commercial &quot;+&quot;basemaps, but that functionality should now be achieved by using &quot;+&quot;Spherical Mercator support. More information is available from &quot;+&quot;http://trac.openlayers.org/wiki/SphericalMercator.&quot;,&apos;methodDeprecated&apos;:&quot;This method has been deprecated and will be removed in 3.0. &quot;+&quot;Please use ${newMethod} instead.&quot;,&apos;boundsAddError&apos;:&quot;You must pass both x and y values to the add function.&quot;,&apos;lonlatAddError&apos;:&quot;You must pass both lon and lat values to the add function.&quot;,&apos;pixelAddError&apos;:&quot;You must pass both x and y values to the add function.&quot;,&apos;unsupportedGeometryType&apos;:&quot;Unsupported geometry type: ${geomType}&quot;,&apos;pagePositionFailed&apos;:&quot;OpenLayers.Util.pagePosition failed: element with id ${elemId} may be misplaced.&quot;,&apos;end&apos;:&apos;&apos;,&apos;filterEvaluateNotImplemented&apos;:&quot;evaluate is not implemented for this filter type.&quot;};OpenLayers.Popup.AnchoredBubble=OpenLayers.Class(OpenLayers.Popup.Anchored,{rounded:false,initialize:function(id,lonlat,contentSize,contentHTML,anchor,closeBox,closeBoxCallback){this.padding=new OpenLayers.Bounds(0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE,0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE);OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);},draw:function(px){OpenLayers.Popup.Anchored.prototype.draw.apply(this,arguments);this.setContentHTML();this.setBackgroundColor();this.setOpacity();return this.div;},updateRelativePosition:function(){this.setRicoCorners();},setSize:function(contentSize){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.setRicoCorners();},setBackgroundColor:function(color){if(color!=undefined){this.backgroundColor=color;}
if(this.div!=null){if(this.contentDiv!=null){this.div.style.background=&quot;transparent&quot;;OpenLayers.Rico.Corner.changeColor(this.groupDiv,this.backgroundColor);}}},setOpacity:function(opacity){OpenLayers.Popup.Anchored.prototype.setOpacity.call(this,opacity);if(this.div!=null){if(this.groupDiv!=null){OpenLayers.Rico.Corner.changeOpacity(this.groupDiv,this.opacity);}}},setBorder:function(border){this.border=0;},setRicoCorners:function(){var corners=this.getCornersToRound(this.relativePosition);var options={corners:corners,color:this.backgroundColor,bgColor:&quot;transparent&quot;,blend:false};if(!this.rounded){OpenLayers.Rico.Corner.round(this.div,options);this.rounded=true;}else{OpenLayers.Rico.Corner.reRound(this.groupDiv,options);this.setBackgroundColor();this.setOpacity();}},getCornersToRound:function(){var corners=[&apos;tl&apos;,&apos;tr&apos;,&apos;bl&apos;,&apos;br&apos;];var corner=OpenLayers.Bounds.oppositeQuadrant(this.relativePosition);OpenLayers.Util.removeItem(corners,corner);return corners.join(&quot; &quot;);},CLASS_NAME:&quot;OpenLayers.Popup.AnchoredBubble&quot;});OpenLayers.Popup.AnchoredBubble.CORNER_SIZE=5;OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:false,positionBlocks:null,blocks:null,fixedRelativePosition:false,initialize:function(id,lonlat,contentSize,contentHTML,anchor,closeBox,closeBoxCallback){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);if(this.fixedRelativePosition){this.updateRelativePosition();this.calculateRelativePosition=function(px){return this.relativePosition;};}
this.contentDiv.style.position=&quot;absolute&quot;;this.contentDiv.style.zIndex=1;if(closeBox){this.closeDiv.style.zIndex=1;}
this.groupDiv.style.position=&quot;absolute&quot;;this.groupDiv.style.top=&quot;0px&quot;;this.groupDiv.style.left=&quot;0px&quot;;this.groupDiv.style.height=&quot;100%&quot;;this.groupDiv.style.width=&quot;100%&quot;;},destroy:function(){this.imageSrc=null;this.imageSize=null;this.isAlphaImage=null;this.fixedRelativePosition=false;this.positionBlocks=null;for(var i=0;i&lt;this.blocks.length;i++){var block=this.blocks[i];if(block.image){block.div.removeChild(block.image);}
block.image=null;if(block.div){this.groupDiv.removeChild(block.div);}
block.div=null;}
this.blocks=null;OpenLayers.Popup.Anchored.prototype.destroy.apply(this,arguments);},setBackgroundColor:function(color){},setBorder:function(){},setOpacity:function(opacity){},setSize:function(contentSize){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks();},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var contentDivPadding=this.getContentDivPadding();this.closeDiv.style.right=contentDivPadding.right+
this.padding.right+&quot;px&quot;;this.closeDiv.style.top=contentDivPadding.top+
this.padding.top+&quot;px&quot;;}
this.updateBlocks();},calculateNewPx:function(px){var newPx=OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);newPx=newPx.offset(this.positionBlocks[this.relativePosition].offset);return newPx;},createBlocks:function(){this.blocks=[];var firstPosition=null;for(var key in this.positionBlocks){firstPosition=key;break;}
var position=this.positionBlocks[firstPosition];for(var i=0;i&lt;position.blocks.length;i++){var block={};this.blocks.push(block);var divId=this.id+&apos;_FrameDecorationDiv_&apos;+i;block.div=OpenLayers.Util.createDiv(divId,null,null,null,&quot;absolute&quot;,null,&quot;hidden&quot;,null);var imgId=this.id+&apos;_FrameDecorationImg_&apos;+i;var imageCreator=(this.isAlphaImage)?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage;block.image=imageCreator(imgId,null,this.imageSize,this.imageSrc,&quot;absolute&quot;,null,null,null);block.div.appendChild(block.image);this.groupDiv.appendChild(block.div);}},updateBlocks:function(){if(!this.blocks){this.createBlocks();}
if(this.size&amp;&amp;this.relativePosition){var position=this.positionBlocks[this.relativePosition];for(var i=0;i&lt;position.blocks.length;i++){var positionBlock=position.blocks[i];var block=this.blocks[i];var l=positionBlock.anchor.left;var b=positionBlock.anchor.bottom;var r=positionBlock.anchor.right;var t=positionBlock.anchor.top;var w=(isNaN(positionBlock.size.w))?this.size.w-(r+l):positionBlock.size.w;var h=(isNaN(positionBlock.size.h))?this.size.h-(b+t):positionBlock.size.h;block.div.style.width=(w&lt;0?0:w)+&apos;px&apos;;block.div.style.height=(h&lt;0?0:h)+&apos;px&apos;;block.div.style.left=(l!=null)?l+&apos;px&apos;:&apos;&apos;;block.div.style.bottom=(b!=null)?b+&apos;px&apos;:&apos;&apos;;block.div.style.right=(r!=null)?r+&apos;px&apos;:&apos;&apos;;block.div.style.top=(t!=null)?t+&apos;px&apos;:&apos;&apos;;block.image.style.left=positionBlock.position.x+&apos;px&apos;;block.image.style.top=positionBlock.position.y+&apos;px&apos;;}
this.contentDiv.style.left=this.padding.left+&quot;px&quot;;this.contentDiv.style.top=this.padding.top+&quot;px&quot;;}},CLASS_NAME:&quot;OpenLayers.Popup.Framed&quot;});OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,initialize:function(projCode,options){OpenLayers.Util.extend(this,options);this.projCode=projCode;if(window.Proj4js){this.proj=new Proj4js.Proj(projCode);}},getCode:function(){return this.proj?this.proj.srsCode:this.projCode;},getUnits:function(){return this.proj?this.proj.units:null;},toString:function(){return this.getCode();},equals:function(projection){if(projection&amp;&amp;projection.getCode){return this.getCode()==projection.getCode();}else{return false;}},destroy:function(){delete this.proj;delete this.projCode;},CLASS_NAME:&quot;OpenLayers.Projection&quot;});OpenLayers.Projection.transforms={};OpenLayers.Projection.addTransform=function(from,to,method){if(!OpenLayers.Projection.transforms[from]){OpenLayers.Projection.transforms[from]={};}
OpenLayers.Projection.transforms[from][to]=method;};OpenLayers.Projection.transform=function(point,source,dest){if(source.proj&amp;&amp;dest.proj){point=Proj4js.transform(source.proj,dest.proj,point);}else if(source&amp;&amp;dest&amp;&amp;OpenLayers.Projection.transforms[source.getCode()]&amp;&amp;OpenLayers.Projection.transforms[source.getCode()][dest.getCode()]){OpenLayers.Projection.transforms[source.getCode()][dest.getCode()](point);}
return point;};OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:&quot;EPSG:4326&quot;,featureType:null,featureNS:null,geometryName:&quot;the_geom&quot;,schema:null,featurePrefix:&quot;feature&quot;,formatOptions:null,initialize:function(options){OpenLayers.Protocol.prototype.initialize.apply(this,[options]);if(!options.format){this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,srsName:this.srsName,schema:this.schema},this.formatOptions));}
if(!this.featureNS){var readNode=this.format.readNode;this.format.readNode=function(node,obj){if(!this.featureNS&amp;&amp;node.prefix==this.featurePrefix){this.featureNS=node.namespaceURI;this.setNamespace(&quot;feature&quot;,this.featureNS);}
return readNode.apply(this,arguments);}}},destroy:function(){if(this.options&amp;&amp;!this.options.format){this.format.destroy();}
this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this);},createCallback:function(method,response,options){return OpenLayers.Function.bind(function(){method.apply(this,[response,options]);},this);},read:function(options){options=OpenLayers.Util.extend({},options);OpenLayers.Util.applyDefaults(options,this.options||{});var response=new OpenLayers.Protocol.Response({requestType:&quot;read&quot;});var data=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode(&quot;wfs:GetFeature&quot;,options)]);response.priv=OpenLayers.Request.POST({url:options.url,callback:this.createCallback(this.handleRead,response,options),params:options.params,headers:options.headers,data:data});return response;},handleRead:function(response,options){if(options.callback){var request=response.priv;if(request.status&gt;=200&amp;&amp;request.status&lt;300){response.features=this.parseFeatures(request);response.code=OpenLayers.Protocol.Response.SUCCESS;}else{response.code=OpenLayers.Protocol.Response.FAILURE;}
options.callback.call(options.scope,response);};},parseFeatures:function(request){var doc=request.responseXML;if(!doc||!doc.documentElement){doc=request.responseText;}
if(!doc||doc.length&lt;=0){return null;}
return this.format.read(doc);},commit:function(features,options){options=OpenLayers.Util.extend({},options);OpenLayers.Util.applyDefaults(options,this.options);var response=new OpenLayers.Protocol.Response({requestType:&quot;commit&quot;,reqFeatures:features});response.priv=OpenLayers.Request.POST({url:options.url,data:this.format.write(features,options),callback:this.createCallback(this.handleCommit,response,options)});return response;},handleCommit:function(response,options){if(options.callback){var request=response.priv;var data=request.responseXML;if(!data||!data.documentElement){data=request.responseText;}
var obj=this.format.read(data)||{};response.insertIds=obj.insertIds||[];response.code=(obj.success)?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE;options.callback.call(options.scope,response);}},filterDelete:function(filter,options){options=OpenLayers.Util.extend({},options);OpenLayers.Util.applyDefaults(options,this.options);var response=new OpenLayers.Protocol.Response({requestType:&quot;commit&quot;});var root=this.format.createElementNSPlus(&quot;wfs:Transaction&quot;,{attributes:{service:&quot;WFS&quot;,version:this.version}});var deleteNode=this.format.createElementNSPlus(&quot;wfs:Delete&quot;,{attributes:{typeName:(options.featureNS?this.featurePrefix+&quot;:&quot;:&quot;&quot;)+
options.featureType}});if(options.featureNS){deleteNode.setAttribute(&quot;xmlns:&quot;+this.featurePrefix,options.featureNS);}
var filterNode=this.format.writeNode(&quot;ogc:Filter&quot;,filter);deleteNode.appendChild(filterNode);root.appendChild(deleteNode);var data=OpenLayers.Format.XML.prototype.write.apply(this.format,[root]);return OpenLayers.Request.POST({url:this.url,callback:options.callback||function(){},data:data});},abort:function(response){if(response){response.priv.abort();}},CLASS_NAME:&quot;OpenLayers.Protocol.WFS.v1&quot;});OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:&quot;http://www.w3.org/2000/svg&quot;,xlinkns:&quot;http://www.w3.org/1999/xlink&quot;,MAX_PIXEL:15000,translationParameters:null,symbolSize:{},isGecko:null,initialize:function(containerID){if(!this.supported()){return;}
OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments);this.translationParameters={x:0,y:0};this.isGecko=(navigator.userAgent.toLowerCase().indexOf(&quot;gecko/&quot;)!=-1);},destroy:function(){OpenLayers.Renderer.Elements.prototype.destroy.apply(this,arguments);},supported:function(){var svgFeature=&quot;http://www.w3.org/TR/SVG11/feature#&quot;;return(document.implementation&amp;&amp;(document.implementation.hasFeature(&quot;org.w3c.svg&quot;,&quot;1.0&quot;)||document.implementation.hasFeature(svgFeature+&quot;SVG&quot;,&quot;1.1&quot;)||document.implementation.hasFeature(svgFeature+&quot;BasicStructure&quot;,&quot;1.1&quot;)));},inValidRange:function(x,y,xyOnly){var left=x+(xyOnly?0:this.translationParameters.x);var top=y+(xyOnly?0:this.translationParameters.y);return(left&gt;=-this.MAX_PIXEL&amp;&amp;left&lt;=this.MAX_PIXEL&amp;&amp;top&gt;=-this.MAX_PIXEL&amp;&amp;top&lt;=this.MAX_PIXEL);},setExtent:function(extent,resolutionChanged){OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var resolution=this.getResolution();var left=-extent.left/resolution;var top=extent.top/resolution;if(resolutionChanged){this.left=left;this.top=top;var extentString=&quot;0 0 &quot;+this.size.w+&quot; &quot;+this.size.h;this.rendererRoot.setAttributeNS(null,&quot;viewBox&quot;,extentString);this.translate(0,0);return true;}else{var inRange=this.translate(left-this.left,top-this.top);if(!inRange){this.setExtent(extent,true);}
return inRange;}},translate:function(x,y){if(!this.inValidRange(x,y,true)){return false;}else{var transformString=&quot;&quot;;if(x||y){transformString=&quot;translate(&quot;+x+&quot;,&quot;+y+&quot;)&quot;;}
this.root.setAttributeNS(null,&quot;transform&quot;,transformString);this.translationParameters={x:x,y:y};return true;}},setSize:function(size){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,&quot;width&quot;,this.size.w);this.rendererRoot.setAttributeNS(null,&quot;height&quot;,this.size.h);},getNodeType:function(geometry,style){var nodeType=null;switch(geometry.CLASS_NAME){case&quot;OpenLayers.Geometry.Point&quot;:if(style.externalGraphic){nodeType=&quot;image&quot;;}else if(this.isComplexSymbol(style.graphicName)){nodeType=&quot;use&quot;;}else{nodeType=&quot;circle&quot;;}
break;case&quot;OpenLayers.Geometry.Rectangle&quot;:nodeType=&quot;rect&quot;;break;case&quot;OpenLayers.Geometry.LineString&quot;:nodeType=&quot;polyline&quot;;break;case&quot;OpenLayers.Geometry.LinearRing&quot;:nodeType=&quot;polygon&quot;;break;case&quot;OpenLayers.Geometry.Polygon&quot;:case&quot;OpenLayers.Geometry.Curve&quot;:case&quot;OpenLayers.Geometry.Surface&quot;:nodeType=&quot;path&quot;;break;default:break;}
return nodeType;},setStyle:function(node,style,options){style=style||node._style;options=options||node._options;var r=parseFloat(node.getAttributeNS(null,&quot;r&quot;));var widthFactor=1;var pos;if(node._geometryClass==&quot;OpenLayers.Geometry.Point&quot;&amp;&amp;r){node.style.visibility=&quot;&quot;;if(style.graphic===false){node.style.visibility=&quot;hidden&quot;;}else if(style.externalGraphic){pos=this.getPosition(node);if(style.graphicTitle){node.setAttributeNS(null,&quot;title&quot;,style.graphicTitle);}
if(style.graphicWidth&amp;&amp;style.graphicHeight){node.setAttributeNS(null,&quot;preserveAspectRatio&quot;,&quot;none&quot;);}
var width=style.graphicWidth||style.graphicHeight;var height=style.graphicHeight||style.graphicWidth;width=width?width:style.pointRadius*2;height=height?height:style.pointRadius*2;var xOffset=(style.graphicXOffset!=undefined)?style.graphicXOffset:-(0.5*width);var yOffset=(style.graphicYOffset!=undefined)?style.graphicYOffset:-(0.5*height);var opacity=style.graphicOpacity||style.fillOpacity;node.setAttributeNS(null,&quot;x&quot;,(pos.x+xOffset).toFixed());node.setAttributeNS(null,&quot;y&quot;,(pos.y+yOffset).toFixed());node.setAttributeNS(null,&quot;width&quot;,width);node.setAttributeNS(null,&quot;height&quot;,height);node.setAttributeNS(this.xlinkns,&quot;href&quot;,style.externalGraphic);node.setAttributeNS(null,&quot;style&quot;,&quot;opacity: &quot;+opacity);}else if(this.isComplexSymbol(style.graphicName)){var offset=style.pointRadius*3;var size=offset*2;var id=this.importSymbol(style.graphicName);var href=&quot;#&quot;+id;pos=this.getPosition(node);widthFactor=this.symbolSize[id]/size;var parent=node.parentNode;var nextSibling=node.nextSibling;if(parent){parent.removeChild(node);}
node.setAttributeNS(this.xlinkns,&quot;href&quot;,href);node.setAttributeNS(null,&quot;width&quot;,size);node.setAttributeNS(null,&quot;height&quot;,size);node.setAttributeNS(null,&quot;x&quot;,pos.x-offset);node.setAttributeNS(null,&quot;y&quot;,pos.y-offset);if(nextSibling){parent.insertBefore(node,nextSibling);}else if(parent){parent.appendChild(node);}}else{node.setAttributeNS(null,&quot;r&quot;,style.pointRadius);}
if(typeof style.rotation!=&quot;undefined&quot;&amp;&amp;pos){var rotation=OpenLayers.String.format(&quot;rotate(${0} ${1} ${2})&quot;,[style.rotation,pos.x,pos.y]);node.setAttributeNS(null,&quot;transform&quot;,rotation);}}
if(options.isFilled){node.setAttributeNS(null,&quot;fill&quot;,style.fillColor);node.setAttributeNS(null,&quot;fill-opacity&quot;,style.fillOpacity);}else{node.setAttributeNS(null,&quot;fill&quot;,&quot;none&quot;);}
if(options.isStroked){node.setAttributeNS(null,&quot;stroke&quot;,style.strokeColor);node.setAttributeNS(null,&quot;stroke-opacity&quot;,style.strokeOpacity);node.setAttributeNS(null,&quot;stroke-width&quot;,style.strokeWidth*widthFactor);node.setAttributeNS(null,&quot;stroke-linecap&quot;,style.strokeLinecap);node.setAttributeNS(null,&quot;stroke-linejoin&quot;,&quot;round&quot;);node.setAttributeNS(null,&quot;stroke-dasharray&quot;,this.dashStyle(style,widthFactor));}else{node.setAttributeNS(null,&quot;stroke&quot;,&quot;none&quot;);}
if(style.pointerEvents){node.setAttributeNS(null,&quot;pointer-events&quot;,style.pointerEvents);}
if(style.cursor!=null){node.setAttributeNS(null,&quot;cursor&quot;,style.cursor);}
return node;},dashStyle:function(style,widthFactor){var w=style.strokeWidth*widthFactor;switch(style.strokeDashstyle){case&apos;solid&apos;:return&apos;none&apos;;case&apos;dot&apos;:return[1,4*w].join();case&apos;dash&apos;:return[4*w,4*w].join();case&apos;dashdot&apos;:return[4*w,4*w,1,4*w].join();case&apos;longdash&apos;:return[8*w,4*w].join();case&apos;longdashdot&apos;:return[8*w,4*w,1,4*w].join();default:return style.strokeDashstyle.replace(/ /g,&quot;,&quot;);}},createNode:function(type,id){var node=document.createElementNS(this.xmlns,type);if(id){node.setAttributeNS(null,&quot;id&quot;,id);}
return node;},nodeTypeCompare:function(node,type){return(type==node.nodeName);},createRenderRoot:function(){return this.nodeFactory(this.container.id+&quot;_svgRoot&quot;,&quot;svg&quot;);},createRoot:function(suffix){return this.nodeFactory(this.container.id+suffix,&quot;g&quot;);},createDefs:function(){var defs=this.nodeFactory(this.container.id+&quot;_defs&quot;,&quot;defs&quot;);this.rendererRoot.appendChild(defs);return defs;},drawPoint:function(node,geometry){return this.drawCircle(node,geometry,1);},drawCircle:function(node,geometry,radius){var resolution=this.getResolution();var x=(geometry.x/resolution+this.left);var y=(this.top-geometry.y/resolution);if(this.inValidRange(x,y)){node.setAttributeNS(null,&quot;cx&quot;,x);node.setAttributeNS(null,&quot;cy&quot;,y);node.setAttributeNS(null,&quot;r&quot;,radius);return node;}else{return false;}},drawLineString:function(node,geometry){var componentsResult=this.getComponentsString(geometry.components);if(componentsResult.path){node.setAttributeNS(null,&quot;points&quot;,componentsResult.path);return(componentsResult.complete?node:null);}else{return false;}},drawLinearRing:function(node,geometry){var componentsResult=this.getComponentsString(geometry.components);if(componentsResult.path){node.setAttributeNS(null,&quot;points&quot;,componentsResult.path);return(componentsResult.complete?node:null);}else{return false;}},drawPolygon:function(node,geometry){var d=&quot;&quot;;var draw=true;var complete=true;var linearRingResult,path;for(var j=0,len=geometry.components.length;j&lt;len;j++){d+=&quot; M&quot;;linearRingResult=this.getComponentsString(geometry.components[j].components,&quot; &quot;);path=linearRingResult.path;if(path){d+=&quot; &quot;+path;complete=linearRingResult.complete&amp;&amp;complete;}else{draw=false;}}
d+=&quot; z&quot;;if(draw){node.setAttributeNS(null,&quot;d&quot;,d);node.setAttributeNS(null,&quot;fill-rule&quot;,&quot;evenodd&quot;);return complete?node:null;}else{return false;}},drawRectangle:function(node,geometry){var resolution=this.getResolution();var x=(geometry.x/resolution+this.left);var y=(this.top-geometry.y/resolution);if(this.inValidRange(x,y)){node.setAttributeNS(null,&quot;x&quot;,x);node.setAttributeNS(null,&quot;y&quot;,y);node.setAttributeNS(null,&quot;width&quot;,geometry.width/resolution);node.setAttributeNS(null,&quot;height&quot;,geometry.height/resolution);return node;}else{return false;}},drawSurface:function(node,geometry){var d=null;var draw=true;for(var i=0,len=geometry.components.length;i&lt;len;i++){if((i%3)==0&amp;&amp;(i/3)==0){var component=this.getShortString(geometry.components[i]);if(!component){draw=false;}
d=&quot;M &quot;+component;}else if((i%3)==1){var component=this.getShortString(geometry.components[i]);if(!component){draw=false;}
d+=&quot; C &quot;+component;}else{var component=this.getShortString(geometry.components[i]);if(!component){draw=false;}
d+=&quot; &quot;+component;}}
d+=&quot; Z&quot;;if(draw){node.setAttributeNS(null,&quot;d&quot;,d);return node;}else{return false;}},drawText:function(featureId,style,location){var resolution=this.getResolution();var x=(location.x/resolution+this.left);var y=(location.y/resolution-this.top);var label=this.nodeFactory(featureId+this.LABEL_ID_SUFFIX,&quot;text&quot;);var tspan=this.nodeFactory(featureId+this.LABEL_ID_SUFFIX+&quot;_tspan&quot;,&quot;tspan&quot;);label.setAttributeNS(null,&quot;x&quot;,x);label.setAttributeNS(null,&quot;y&quot;,-y);label.setAttributeNS(null,&quot;pointer-events&quot;,&quot;none&quot;);if(style.fontColor){label.setAttributeNS(null,&quot;fill&quot;,style.fontColor);}
if(style.fontFamily){label.setAttributeNS(null,&quot;font-family&quot;,style.fontFamily);}
if(style.fontSize){label.setAttributeNS(null,&quot;font-size&quot;,style.fontSize);}
if(style.fontWeight){label.setAttributeNS(null,&quot;font-weight&quot;,style.fontWeight);}
var align=style.labelAlign||&quot;cm&quot;;label.setAttributeNS(null,&quot;text-anchor&quot;,OpenLayers.Renderer.SVG.LABEL_ALIGN[align[0]]||&quot;middle&quot;);if(this.isGecko){label.setAttributeNS(null,&quot;dominant-baseline&quot;,OpenLayers.Renderer.SVG.LABEL_ALIGN[align[1]]||&quot;central&quot;);}else{tspan.setAttributeNS(null,&quot;baseline-shift&quot;,OpenLayers.Renderer.SVG.LABEL_VSHIFT[align[1]]||&quot;-35%&quot;);}
tspan.textContent=style.label;if(!label.parentNode){label.appendChild(tspan);this.textRoot.appendChild(label);}},getComponentsString:function(components,separator){var renderCmp=[];var complete=true;var len=components.length;var strings=[];var str,component,j;for(var i=0;i&lt;len;i++){component=components[i];renderCmp.push(component);str=this.getShortString(component);if(str){strings.push(str);}else{if(i&gt;0){if(this.getShortString(components[i-1])){strings.push(this.clipLine(components[i],components[i-1]));}}
if(i&lt;len-1){if(this.getShortString(components[i+1])){strings.push(this.clipLine(components[i],components[i+1]));}}
complete=false;}}
return{path:strings.join(separator||&quot;,&quot;),complete:complete};},clipLine:function(badComponent,goodComponent){if(goodComponent.equals(badComponent)){return&quot;&quot;;}
var resolution=this.getResolution();var maxX=this.MAX_PIXEL-this.translationParameters.x;var maxY=this.MAX_PIXEL-this.translationParameters.y;var x1=goodComponent.x/resolution+this.left;var y1=this.top-goodComponent.y/resolution;var x2=badComponent.x/resolution+this.left;var y2=this.top-badComponent.y/resolution;var k;if(x2&lt;-maxX||x2&gt;maxX){k=(y2-y1)/(x2-x1);x2=x2&lt;0?-maxX:maxX;y2=y1+(x2-x1)*k;}
if(y2&lt;-maxY||y2&gt;maxY){k=(x2-x1)/(y2-y1);y2=y2&lt;0?-maxY:maxY;x2=x1+(y2-y1)*k;}
return x2+&quot;,&quot;+y2;},getShortString:function(point){var resolution=this.getResolution();var x=(point.x/resolution+this.left);var y=(this.top-point.y/resolution);if(this.inValidRange(x,y)){return x+&quot;,&quot;+y;}else{return false;}},getPosition:function(node){return({x:parseFloat(node.getAttributeNS(null,&quot;cx&quot;)),y:parseFloat(node.getAttributeNS(null,&quot;cy&quot;))});},importSymbol:function(graphicName){if(!this.defs){this.defs=this.createDefs();}
var id=this.container.id+&quot;-&quot;+graphicName;if(document.getElementById(id)!=null){return id;}
var symbol=OpenLayers.Renderer.symbol[graphicName];if(!symbol){throw new Error(graphicName+&apos; is not a valid symbol name&apos;);return;}
var symbolNode=this.nodeFactory(id,&quot;symbol&quot;);var node=this.nodeFactory(null,&quot;polygon&quot;);symbolNode.appendChild(node);var symbolExtent=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var points=&quot;&quot;;var x,y;for(var i=0;i&lt;symbol.length;i=i+2){x=symbol[i];y=symbol[i+1];symbolExtent.left=Math.min(symbolExtent.left,x);symbolExtent.bottom=Math.min(symbolExtent.bottom,y);symbolExtent.right=Math.max(symbolExtent.right,x);symbolExtent.top=Math.max(symbolExtent.top,y);points+=&quot; &quot;+x+&quot;,&quot;+y;}
node.setAttributeNS(null,&quot;points&quot;,points);var width=symbolExtent.getWidth();var height=symbolExtent.getHeight();var viewBox=[symbolExtent.left-width,symbolExtent.bottom-height,width*3,height*3];symbolNode.setAttributeNS(null,&quot;viewBox&quot;,viewBox.join(&quot; &quot;));this.symbolSize[id]=Math.max(width,height)*3;this.defs.appendChild(symbolNode);return symbolNode.id;},CLASS_NAME:&quot;OpenLayers.Renderer.SVG&quot;});OpenLayers.Renderer.SVG.LABEL_ALIGN={&quot;l&quot;:&quot;start&quot;,&quot;r&quot;:&quot;end&quot;,&quot;b&quot;:&quot;bottom&quot;,&quot;t&quot;:&quot;hanging&quot;};OpenLayers.Renderer.SVG.LABEL_VSHIFT={&quot;t&quot;:&quot;-70%&quot;,&quot;b&quot;:&quot;0&quot;};OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:&quot;urn:schemas-microsoft-com:vml&quot;,symbolCache:{},offset:null,initialize:function(containerID){if(!this.supported()){return;}
if(!document.namespaces.olv){document.namespaces.add(&quot;olv&quot;,this.xmlns);var style=document.createStyleSheet();var shapes=[&apos;shape&apos;,&apos;rect&apos;,&apos;oval&apos;,&apos;fill&apos;,&apos;stroke&apos;,&apos;imagedata&apos;,&apos;group&apos;,&apos;textbox&apos;];for(var i=0,len=shapes.length;i&lt;len;i++){style.addRule(&apos;olv\\:&apos;+shapes[i],&quot;behavior: url(#default#VML); &quot;+&quot;position: absolute; display: inline-block;&quot;);}}
OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments);this.offset={x:0,y:0};},destroy:function(){OpenLayers.Renderer.Elements.prototype.destroy.apply(this,arguments);},supported:function(){return!!(document.namespaces);},setExtent:function(extent,resolutionChanged){OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var resolution=this.getResolution();var left=extent.left/resolution;var top=extent.top/resolution-this.size.h;if(resolutionChanged){this.offset={x:left,y:top};left=0;top=0;}else{left=left-this.offset.x;top=top-this.offset.y;}
var org=left+&quot; &quot;+top;this.root.coordorigin=org;var roots=[this.root,this.vectorRoot,this.textRoot];var root;for(var i=0,len=roots.length;i&lt;len;++i){root=roots[i];var size=this.size.w+&quot; &quot;+this.size.h;root.coordsize=size;}
this.root.style.flip=&quot;y&quot;;return true;},setSize:function(size){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);var roots=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot];var w=this.size.w+&quot;px&quot;;var h=this.size.h+&quot;px&quot;;var root;for(var i=0,len=roots.length;i&lt;len;++i){root=roots[i];root.style.width=w;root.style.height=h;}},getNodeType:function(geometry,style){var nodeType=null;switch(geometry.CLASS_NAME){case&quot;OpenLayers.Geometry.Point&quot;:if(style.externalGraphic){nodeType=&quot;olv:rect&quot;;}else if(this.isComplexSymbol(style.graphicName)){nodeType=&quot;olv:shape&quot;;}else{nodeType=&quot;olv:oval&quot;;}
break;case&quot;OpenLayers.Geometry.Rectangle&quot;:nodeType=&quot;olv:rect&quot;;break;case&quot;OpenLayers.Geometry.LineString&quot;:case&quot;OpenLayers.Geometry.LinearRing&quot;:case&quot;OpenLayers.Geometry.Polygon&quot;:case&quot;OpenLayers.Geometry.Curve&quot;:case&quot;OpenLayers.Geometry.Surface&quot;:nodeType=&quot;olv:shape&quot;;break;default:break;}
return nodeType;},setStyle:function(node,style,options,geometry){style=style||node._style;options=options||node._options;var widthFactor=1;if(node._geometryClass==&quot;OpenLayers.Geometry.Point&quot;){if(style.externalGraphic){if(style.graphicTitle){node.title=style.graphicTitle;}
var width=style.graphicWidth||style.graphicHeight;var height=style.graphicHeight||style.graphicWidth;width=width?width:style.pointRadius*2;height=height?height:style.pointRadius*2;var resolution=this.getResolution();var xOffset=(style.graphicXOffset!=undefined)?style.graphicXOffset:-(0.5*width);var yOffset=(style.graphicYOffset!=undefined)?style.graphicYOffset:-(0.5*height);node.style.left=((geometry.x/resolution-this.offset.x)+xOffset).toFixed();node.style.top=((geometry.y/resolution-this.offset.y)-(yOffset+height)).toFixed();node.style.width=width+&quot;px&quot;;node.style.height=height+&quot;px&quot;;node.style.flip=&quot;y&quot;;style.fillColor=&quot;none&quot;;options.isStroked=false;}else if(this.isComplexSymbol(style.graphicName)){var cache=this.importSymbol(style.graphicName);node.path=cache.path;node.coordorigin=cache.left+&quot;,&quot;+cache.bottom;var size=cache.size;node.coordsize=size+&quot;,&quot;+size;this.drawCircle(node,geometry,style.pointRadius);node.style.flip=&quot;y&quot;;}else{this.drawCircle(node,geometry,style.pointRadius);}}
if(options.isFilled){node.fillcolor=style.fillColor;}else{node.filled=&quot;false&quot;;}
var fills=node.getElementsByTagName(&quot;fill&quot;);var fill=(fills.length==0)?null:fills[0];if(!options.isFilled){if(fill){node.removeChild(fill);}}else{if(!fill){fill=this.createNode(&apos;olv:fill&apos;,node.id+&quot;_fill&quot;);}
fill.opacity=style.fillOpacity;if(node._geometryClass==&quot;OpenLayers.Geometry.Point&quot;&amp;&amp;style.externalGraphic){if(style.graphicOpacity){fill.opacity=style.graphicOpacity;}
fill.src=style.externalGraphic;fill.type=&quot;frame&quot;;if(!(style.graphicWidth&amp;&amp;style.graphicHeight)){fill.aspect=&quot;atmost&quot;;}}
if(fill.parentNode!=node){node.appendChild(fill);}}
if(typeof style.rotation!=&quot;undefined&quot;){if(style.externalGraphic){this.graphicRotate(node,xOffset,yOffset);fill.opacity=0;}else{node.style.rotation=style.rotation;}}
if(options.isStroked){node.strokecolor=style.strokeColor;node.strokeweight=style.strokeWidth+&quot;px&quot;;}else{node.stroked=false;}
var strokes=node.getElementsByTagName(&quot;stroke&quot;);var stroke=(strokes.length==0)?null:strokes[0];if(!options.isStroked){if(stroke){node.removeChild(stroke);}}else{if(!stroke){stroke=this.createNode(&apos;olv:stroke&apos;,node.id+&quot;_stroke&quot;);node.appendChild(stroke);}
stroke.opacity=style.strokeOpacity;stroke.endcap=!style.strokeLinecap||style.strokeLinecap==&apos;butt&apos;?&apos;flat&apos;:style.strokeLinecap;stroke.dashstyle=this.dashStyle(style);}
if(style.cursor!=&quot;inherit&quot;&amp;&amp;style.cursor!=null){node.style.cursor=style.cursor;}
return node;},graphicRotate:function(node,xOffset,yOffset){var style=style||node._style;var options=node._options;var aspectRatio,size;if(!(style.graphicWidth&amp;&amp;style.graphicHeight)){var img=new Image();img.onreadystatechange=OpenLayers.Function.bind(function(){if(img.readyState==&quot;complete&quot;||img.readyState==&quot;interactive&quot;){aspectRatio=img.width/img.height;size=Math.max(style.pointRadius*2,style.graphicWidth||0,style.graphicHeight||0);xOffset=xOffset*aspectRatio;style.graphicWidth=size*aspectRatio;style.graphicHeight=size;this.graphicRotate(node,xOffset,yOffset);}},this);img.src=style.externalGraphic;return;}else{size=Math.max(style.graphicWidth,style.graphicHeight);aspectRatio=style.graphicWidth/style.graphicHeight;}
var width=Math.round(style.graphicWidth||size*aspectRatio);var height=Math.round(style.graphicHeight||size);node.style.width=width+&quot;px&quot;;node.style.height=height+&quot;px&quot;;var image=document.getElementById(node.id+&quot;_image&quot;);if(!image){image=this.createNode(&quot;olv:imagedata&quot;,node.id+&quot;_image&quot;);node.appendChild(image);}
image.style.width=width+&quot;px&quot;;image.style.height=height+&quot;px&quot;;image.src=style.externalGraphic;image.style.filter=&quot;progid:DXImageTransform.Microsoft.AlphaImageLoader(&quot;+&quot;src=&apos;&apos;, sizingMethod=&apos;scale&apos;)&quot;;var rotation=style.rotation*Math.PI/180;var sintheta=Math.sin(rotation);var costheta=Math.cos(rotation);var filter=&quot;progid:DXImageTransform.Microsoft.Matrix(M11=&quot;+costheta+&quot;,M12=&quot;+(-sintheta)+&quot;,M21=&quot;+sintheta+&quot;,M22=&quot;+costheta+&quot;,SizingMethod=&apos;auto expand&apos;)\n&quot;;var opacity=style.graphicOpacity||style.fillOpacity;if(opacity&amp;&amp;opacity!=1){filter+=&quot;progid:DXImageTransform.Microsoft.BasicImage(opacity=&quot;+
opacity+&quot;)\n&quot;;}
node.style.filter=filter;var centerPoint=new OpenLayers.Geometry.Point(-xOffset,-yOffset);var imgBox=new OpenLayers.Bounds(0,0,width,height).toGeometry();imgBox.rotate(style.rotation,centerPoint);var imgBounds=imgBox.getBounds();node.style.left=Math.round(parseInt(node.style.left)+imgBounds.left)+&quot;px&quot;;node.style.top=Math.round(parseInt(node.style.top)-imgBounds.bottom)+&quot;px&quot;;},postDraw:function(node){var fillColor=node._style.fillColor;var strokeColor=node._style.strokeColor;if(fillColor==&quot;none&quot;&amp;&amp;node.fillcolor!=fillColor){node.fillcolor=fillColor;}
if(strokeColor==&quot;none&quot;&amp;&amp;node.strokecolor!=strokeColor){node.strokecolor=strokeColor;}},setNodeDimension:function(node,geometry){var bbox=geometry.getBounds();if(bbox){var resolution=this.getResolution();var scaledBox=new OpenLayers.Bounds((bbox.left/resolution-this.offset.x).toFixed(),(bbox.bottom/resolution-this.offset.y).toFixed(),(bbox.right/resolution-this.offset.x).toFixed(),(bbox.top/resolution-this.offset.y).toFixed());node.style.left=scaledBox.left+&quot;px&quot;;node.style.top=scaledBox.top+&quot;px&quot;;node.style.width=scaledBox.getWidth()+&quot;px&quot;;node.style.height=scaledBox.getHeight()+&quot;px&quot;;node.coordorigin=scaledBox.left+&quot; &quot;+scaledBox.top;node.coordsize=scaledBox.getWidth()+&quot; &quot;+scaledBox.getHeight();}},dashStyle:function(style){var dash=style.strokeDashstyle;switch(dash){case&apos;solid&apos;:case&apos;dot&apos;:case&apos;dash&apos;:case&apos;dashdot&apos;:case&apos;longdash&apos;:case&apos;longdashdot&apos;:return dash;default:var parts=dash.split(/[ ,]/);if(parts.length==2){if(1*parts[0]&gt;=2*parts[1]){return&quot;longdash&quot;;}
return(parts[0]==1||parts[1]==1)?&quot;dot&quot;:&quot;dash&quot;;}else if(parts.length==4){return(1*parts[0]&gt;=2*parts[1])?&quot;longdashdot&quot;:&quot;dashdot&quot;;}
return&quot;solid&quot;;}},createNode:function(type,id){var node=document.createElement(type);if(id){node.id=id;}
node.unselectable=&apos;on&apos;;node.onselectstart=function(){return(false);};return node;},nodeTypeCompare:function(node,type){var subType=type;var splitIndex=subType.indexOf(&quot;:&quot;);if(splitIndex!=-1){subType=subType.substr(splitIndex+1);}
var nodeName=node.nodeName;splitIndex=nodeName.indexOf(&quot;:&quot;);if(splitIndex!=-1){nodeName=nodeName.substr(splitIndex+1);}
return(subType==nodeName);},createRenderRoot:function(){return this.nodeFactory(this.container.id+&quot;_vmlRoot&quot;,&quot;div&quot;);},createRoot:function(suffix){return this.nodeFactory(this.container.id+suffix,&quot;olv:group&quot;);},drawPoint:function(node,geometry){return this.drawCircle(node,geometry,1);},drawCircle:function(node,geometry,radius){if(!isNaN(geometry.x)&amp;&amp;!isNaN(geometry.y)){var resolution=this.getResolution();node.style.left=((geometry.x/resolution-this.offset.x).toFixed()-radius)+&quot;px&quot;;node.style.top=((geometry.y/resolution-this.offset.y).toFixed()-radius)+&quot;px&quot;;var diameter=radius*2;node.style.width=diameter+&quot;px&quot;;node.style.height=diameter+&quot;px&quot;;return node;}
return false;},drawLineString:function(node,geometry){return this.drawLine(node,geometry,false);},drawLinearRing:function(node,geometry){return this.drawLine(node,geometry,true);},drawLine:function(node,geometry,closeLine){this.setNodeDimension(node,geometry);var resolution=this.getResolution();var numComponents=geometry.components.length;var parts=new Array(numComponents);var comp,x,y;for(var i=0;i&lt;numComponents;i++){comp=geometry.components[i];x=(comp.x/resolution-this.offset.x);y=(comp.y/resolution-this.offset.y);parts[i]=&quot; &quot;+x.toFixed()+&quot;,&quot;+y.toFixed()+&quot; l &quot;;}
var end=(closeLine)?&quot; x e&quot;:&quot; e&quot;;node.path=&quot;m&quot;+parts.join(&quot;&quot;)+end;return node;},drawPolygon:function(node,geometry){this.setNodeDimension(node,geometry);var resolution=this.getResolution();var path=[];var linearRing,i,j,len,ilen,comp,x,y;for(j=0,len=geometry.components.length;j&lt;len;j++){linearRing=geometry.components[j];path.push(&quot;m&quot;);for(i=0,ilen=linearRing.components.length;i&lt;ilen;i++){comp=linearRing.components[i];x=comp.x/resolution-this.offset.x;y=comp.y/resolution-this.offset.y;path.push(&quot; &quot;+x.toFixed()+&quot;,&quot;+y.toFixed());if(i==0){path.push(&quot; l&quot;);}}
path.push(&quot; x &quot;);}
path.push(&quot;e&quot;);node.path=path.join(&quot;&quot;);return node;},drawRectangle:function(node,geometry){var resolution=this.getResolution();node.style.left=(geometry.x/resolution-this.offset.x)+&quot;px&quot;;node.style.top=(geometry.y/resolution-this.offset.y)+&quot;px&quot;;node.style.width=geometry.width/resolution+&quot;px&quot;;node.style.height=geometry.height/resolution+&quot;px&quot;;return node;},drawText:function(featureId,style,location){var label=this.nodeFactory(featureId+this.LABEL_ID_SUFFIX,&quot;olv:rect&quot;);var textbox=this.nodeFactory(featureId+this.LABEL_ID_SUFFIX+&quot;_textbox&quot;,&quot;olv:textbox&quot;);var resolution=this.getResolution();label.style.left=(location.x/resolution-this.offset.x).toFixed()+&quot;px&quot;;label.style.top=(location.y/resolution-this.offset.y).toFixed()+&quot;px&quot;;label.style.flip=&quot;y&quot;;textbox.innerText=style.label;if(style.fillColor){textbox.style.color=style.fontColor;}
if(style.fontFamily){textbox.style.fontFamily=style.fontFamily;}
if(style.fontSize){textbox.style.fontSize=style.fontSize;}
if(style.fontWeight){textbox.style.fontWeight=style.fontWeight;}
textbox.style.whiteSpace=&quot;nowrap&quot;;textbox.inset=&quot;1px,0px,0px,0px&quot;;if(!label.parentNode){label.appendChild(textbox);this.textRoot.appendChild(label);}
var align=style.labelAlign||&quot;cm&quot;;var xshift=textbox.clientWidth*(OpenLayers.Renderer.VML.LABEL_SHIFT[align.substr(0,1)]);var yshift=textbox.clientHeight*(OpenLayers.Renderer.VML.LABEL_SHIFT[align.substr(1,1)]);label.style.left=parseInt(label.style.left)-xshift-1+&quot;px&quot;;label.style.top=parseInt(label.style.top)+yshift+&quot;px&quot;;},drawSurface:function(node,geometry){this.setNodeDimension(node,geometry);var resolution=this.getResolution();var path=[];var comp,x,y;for(var i=0,len=geometry.components.length;i&lt;len;i++){comp=geometry.components[i];x=comp.x/resolution-this.offset.x;y=comp.y/resolution-this.offset.y;if((i%3)==0&amp;&amp;(i/3)==0){path.push(&quot;m&quot;);}else if((i%3)==1){path.push(&quot; c&quot;);}
path.push(&quot; &quot;+x+&quot;,&quot;+y);}
path.push(&quot; x e&quot;);node.path=path.join(&quot;&quot;);return node;},moveRoot:function(renderer){var layer=this.map.getLayer(renderer.container.id);if(layer instanceof OpenLayers.Layer.Vector.RootContainer){layer=this.map.getLayer(this.container.id);}
layer&amp;&amp;layer.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);layer&amp;&amp;layer.redraw();},importSymbol:function(graphicName){var id=this.container.id+&quot;-&quot;+graphicName;var cache=this.symbolCache[id];if(cache){return cache;}
var symbol=OpenLayers.Renderer.symbol[graphicName];if(!symbol){throw new Error(graphicName+&apos; is not a valid symbol name&apos;);return;}
var symbolExtent=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var pathitems=[&quot;m&quot;];for(var i=0;i&lt;symbol.length;i=i+2){x=symbol[i];y=symbol[i+1];symbolExtent.left=Math.min(symbolExtent.left,x);symbolExtent.bottom=Math.min(symbolExtent.bottom,y);symbolExtent.right=Math.max(symbolExtent.right,x);symbolExtent.top=Math.max(symbolExtent.top,y);pathitems.push(x);pathitems.push(y);if(i==0){pathitems.push(&quot;l&quot;);}}
pathitems.push(&quot;x e&quot;);var path=pathitems.join(&quot; &quot;);var diff=(symbolExtent.getWidth()-symbolExtent.getHeight())/2;if(diff&gt;0){symbolExtent.bottom=symbolExtent.bottom-diff;symbolExtent.top=symbolExtent.top+diff;}else{symbolExtent.left=symbolExtent.left-diff;symbolExtent.right=symbolExtent.right+diff;}
cache={path:path,size:symbolExtent.getWidth(),left:symbolExtent.left,bottom:symbolExtent.bottom};this.symbolCache[id]=cache;return cache;},CLASS_NAME:&quot;OpenLayers.Renderer.VML&quot;});OpenLayers.Renderer.VML.LABEL_SHIFT={&quot;l&quot;:0,&quot;c&quot;:.5,&quot;r&quot;:1,&quot;t&quot;:0,&quot;m&quot;:.5,&quot;b&quot;:1};OpenLayers.Tile=OpenLayers.Class({EVENT_TYPES:[&quot;loadstart&quot;,&quot;loadend&quot;,&quot;reload&quot;,&quot;unload&quot;],events:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:false,initialize:function(layer,position,bounds,url,size){this.layer=layer;this.position=position.clone();this.bounds=bounds.clone();this.url=url;this.size=size.clone();this.id=OpenLayers.Util.createUniqueID(&quot;Tile_&quot;);this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES);},unload:function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent(&quot;unload&quot;);}},destroy:function(){this.layer=null;this.bounds=null;this.size=null;this.position=null;this.events.destroy();this.events=null;},clone:function(obj){if(obj==null){obj=new OpenLayers.Tile(this.layer,this.position,this.bounds,this.url,this.size);}
OpenLayers.Util.applyDefaults(obj,this);return obj;},draw:function(){var maxExtent=this.layer.maxExtent;var withinMaxExtent=(maxExtent&amp;&amp;this.bounds.intersectsBounds(maxExtent,false));this.shouldDraw=(withinMaxExtent||this.layer.displayOutsideMaxExtent);this.clear();return this.shouldDraw;},moveTo:function(bounds,position,redraw){if(redraw==null){redraw=true;}
this.bounds=bounds.clone();this.position=position.clone();if(redraw){this.draw();}},clear:function(){},getBoundsFromBaseLayer:function(position){var msg=OpenLayers.i18n(&apos;reprojectDeprecated&apos;,{&apos;layerName&apos;:this.layer.name});OpenLayers.Console.warn(msg);var topLeft=this.layer.map.getLonLatFromLayerPx(position);var bottomRightPx=position.clone();bottomRightPx.x+=this.size.w;bottomRightPx.y+=this.size.h;var bottomRight=this.layer.map.getLonLatFromLayerPx(bottomRightPx);if(topLeft.lon&gt;bottomRight.lon){if(topLeft.lon&lt;0){topLeft.lon=-180-(topLeft.lon+180);}else{bottomRight.lon=180+bottomRight.lon+180;}}
var bounds=new OpenLayers.Bounds(topLeft.lon,bottomRight.lat,bottomRight.lon,topLeft.lat);return bounds;},showTile:function(){if(this.shouldDraw){this.show();}},show:function(){},hide:function(){},CLASS_NAME:&quot;OpenLayers.Tile&quot;});OpenLayers.Control.MouseToolbar=OpenLayers.Class(OpenLayers.Control.MouseDefaults,{mode:null,buttons:null,direction:&quot;vertical&quot;,buttonClicked:null,initialize:function(position,direction){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.position=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,OpenLayers.Control.MouseToolbar.Y);if(position){this.position=position;}
if(direction){this.direction=direction;}
this.measureDivs=[];},destroy:function(){for(var btnId in this.buttons){var btn=this.buttons[btnId];btn.map=null;btn.events.destroy();}
OpenLayers.Control.MouseDefaults.prototype.destroy.apply(this,arguments);},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);OpenLayers.Control.MouseDefaults.prototype.draw.apply(this,arguments);this.buttons={};var sz=new OpenLayers.Size(28,28);var centered=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,0);this._addButton(&quot;zoombox&quot;,&quot;drag-rectangle-off.png&quot;,&quot;drag-rectangle-on.png&quot;,centered,sz,&quot;Shift-&gt;Drag to zoom to area&quot;);centered=centered.add((this.direction==&quot;vertical&quot;?0:sz.w),(this.direction==&quot;vertical&quot;?sz.h:0));this._addButton(&quot;pan&quot;,&quot;panning-hand-off.png&quot;,&quot;panning-hand-on.png&quot;,centered,sz,&quot;Drag the map to pan.&quot;);centered=centered.add((this.direction==&quot;vertical&quot;?0:sz.w),(this.direction==&quot;vertical&quot;?sz.h:0));this.switchModeTo(&quot;pan&quot;);return this.div;},_addButton:function(id,img,activeImg,xy,sz,title){var imgLocation=OpenLayers.Util.getImagesLocation()+img;var activeImgLocation=OpenLayers.Util.getImagesLocation()+activeImg;var btn=OpenLayers.Util.createAlphaImageDiv(&quot;OpenLayers_Control_MouseToolbar_&quot;+id,xy,sz,imgLocation,&quot;absolute&quot;);this.div.appendChild(btn);btn.imgLocation=imgLocation;btn.activeImgLocation=activeImgLocation;btn.events=new OpenLayers.Events(this,btn,null,true);btn.events.on({&quot;mousedown&quot;:this.buttonDown,&quot;mouseup&quot;:this.buttonUp,&quot;dblclick&quot;:OpenLayers.Event.stop,scope:this});btn.action=id;btn.title=title;btn.alt=title;btn.map=this.map;this.buttons[id]=btn;return btn;},buttonDown:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
this.buttonClicked=evt.element.action;OpenLayers.Event.stop(evt);},buttonUp:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
if(this.buttonClicked!=null){if(this.buttonClicked==evt.element.action){this.switchModeTo(evt.element.action);}
OpenLayers.Event.stop(evt);this.buttonClicked=null;}},defaultDblClick:function(evt){this.switchModeTo(&quot;pan&quot;);this.performedDrag=false;var newCenter=this.map.getLonLatFromViewPortPx(evt.xy);this.map.setCenter(newCenter,this.map.zoom+1);OpenLayers.Event.stop(evt);return false;},defaultMouseDown:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
this.mouseDragStart=evt.xy.clone();this.performedDrag=false;this.startViaKeyboard=false;if(evt.shiftKey&amp;&amp;this.mode!=&quot;zoombox&quot;){this.switchModeTo(&quot;zoombox&quot;);this.startViaKeyboard=true;}else if(evt.altKey&amp;&amp;this.mode!=&quot;measure&quot;){this.switchModeTo(&quot;measure&quot;);}else if(!this.mode){this.switchModeTo(&quot;pan&quot;);}
switch(this.mode){case&quot;zoombox&quot;:this.map.div.style.cursor=&quot;crosshair&quot;;this.zoomBox=OpenLayers.Util.createDiv(&apos;zoomBox&apos;,this.mouseDragStart,null,null,&quot;absolute&quot;,&quot;2px solid red&quot;);this.zoomBox.style.backgroundColor=&quot;white&quot;;this.zoomBox.style.filter=&quot;alpha(opacity=50)&quot;;this.zoomBox.style.opacity=&quot;0.50&quot;;this.zoomBox.style.fontSize=&quot;1px&quot;;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE[&quot;Popup&quot;]-1;this.map.viewPortDiv.appendChild(this.zoomBox);this.performedDrag=true;break;case&quot;measure&quot;:var distance=&quot;&quot;;if(this.measureStart){var measureEnd=this.map.getLonLatFromViewPortPx(this.mouseDragStart);distance=OpenLayers.Util.distVincenty(this.measureStart,measureEnd);distance=Math.round(distance*100)/100;distance=distance+&quot;km&quot;;this.measureStartBox=this.measureBox;}
this.measureStart=this.map.getLonLatFromViewPortPx(this.mouseDragStart);;this.measureBox=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),-2-parseInt(this.map.layerContainerDiv.style.top)),null,null,&quot;absolute&quot;);this.measureBox.style.width=&quot;4px&quot;;this.measureBox.style.height=&quot;4px&quot;;this.measureBox.style.fontSize=&quot;1px&quot;;this.measureBox.style.backgroundColor=&quot;red&quot;;this.measureBox.style.zIndex=this.map.Z_INDEX_BASE[&quot;Popup&quot;]-1;this.map.layerContainerDiv.appendChild(this.measureBox);if(distance){this.measureBoxDistance=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),2-parseInt(this.map.layerContainerDiv.style.top)),null,null,&quot;absolute&quot;);this.measureBoxDistance.innerHTML=distance;this.measureBoxDistance.style.zIndex=this.map.Z_INDEX_BASE[&quot;Popup&quot;]-1;this.map.layerContainerDiv.appendChild(this.measureBoxDistance);this.measureDivs.push(this.measureBoxDistance);}
this.measureBox.style.zIndex=this.map.Z_INDEX_BASE[&quot;Popup&quot;]-1;this.map.layerContainerDiv.appendChild(this.measureBox);this.measureDivs.push(this.measureBox);break;default:this.map.div.style.cursor=&quot;move&quot;;break;}
document.onselectstart=function(){return false;};OpenLayers.Event.stop(evt);},switchModeTo:function(mode){if(mode!=this.mode){if(this.mode&amp;&amp;this.buttons[this.mode]){OpenLayers.Util.modifyAlphaImageDiv(this.buttons[this.mode],null,null,null,this.buttons[this.mode].imgLocation);}
if(this.mode==&quot;measure&quot;&amp;&amp;mode!=&quot;measure&quot;){for(var i=0,len=this.measureDivs.length;i&lt;len;i++){if(this.measureDivs[i]){this.map.layerContainerDiv.removeChild(this.measureDivs[i]);}}
this.measureDivs=[];this.measureStart=null;}
this.mode=mode;if(this.buttons[mode]){OpenLayers.Util.modifyAlphaImageDiv(this.buttons[mode],null,null,null,this.buttons[mode].activeImgLocation);}
switch(this.mode){case&quot;zoombox&quot;:this.map.div.style.cursor=&quot;crosshair&quot;;break;default:this.map.div.style.cursor=&quot;&quot;;break;}}},leaveMode:function(){this.switchModeTo(&quot;pan&quot;);},defaultMouseMove:function(evt){if(this.mouseDragStart!=null){switch(this.mode){case&quot;zoombox&quot;:var deltaX=Math.abs(this.mouseDragStart.x-evt.xy.x);var deltaY=Math.abs(this.mouseDragStart.y-evt.xy.y);this.zoomBox.style.width=Math.max(1,deltaX)+&quot;px&quot;;this.zoomBox.style.height=Math.max(1,deltaY)+&quot;px&quot;;if(evt.xy.x&lt;this.mouseDragStart.x){this.zoomBox.style.left=evt.xy.x+&quot;px&quot;;}
if(evt.xy.y&lt;this.mouseDragStart.y){this.zoomBox.style.top=evt.xy.y+&quot;px&quot;;}
break;default:var deltaX=this.mouseDragStart.x-evt.xy.x;var deltaY=this.mouseDragStart.y-evt.xy.y;var size=this.map.getSize();var newXY=new OpenLayers.Pixel(size.w/2+deltaX,size.h/2+deltaY);var newCenter=this.map.getLonLatFromViewPortPx(newXY);this.map.setCenter(newCenter,null,true);this.mouseDragStart=evt.xy.clone();}
this.performedDrag=true;}},defaultMouseUp:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
switch(this.mode){case&quot;zoombox&quot;:this.zoomBoxEnd(evt);if(this.startViaKeyboard){this.leaveMode();}
break;case&quot;pan&quot;:if(this.performedDrag){this.map.setCenter(this.map.center);}}
document.onselectstart=null;this.mouseDragStart=null;this.map.div.style.cursor=&quot;default&quot;;},defaultMouseOut:function(evt){if(this.mouseDragStart!=null&amp;&amp;OpenLayers.Util.mouseLeft(evt,this.map.div)){if(this.zoomBox){this.removeZoomBox();if(this.startViaKeyboard){this.leaveMode();}}
this.mouseDragStart=null;this.map.div.style.cursor=&quot;default&quot;;}},defaultClick:function(evt){if(this.performedDrag){this.performedDrag=false;return false;}},CLASS_NAME:&quot;OpenLayers.Control.MouseToolbar&quot;});OpenLayers.Control.MouseToolbar.X=6;OpenLayers.Control.MouseToolbar.Y=300;OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,activateOnDraw:true,clearOnDeactivate:false,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:false,initialize:function(options){OpenLayers.Control.prototype.initialize.apply(this,[options]);this.registry=OpenLayers.Util.extend({&quot;moveend&quot;:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution()};}},this.registry);this.clear();var previousOptions={trigger:OpenLayers.Function.bind(this.previousTrigger,this),displayClass:this.displayClass+&quot; &quot;+this.displayClass+&quot;Previous&quot;};OpenLayers.Util.extend(previousOptions,this.previousOptions);this.previous=new OpenLayers.Control.Button(previousOptions);var nextOptions={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+&quot; &quot;+this.displayClass+&quot;Next&quot;};OpenLayers.Util.extend(nextOptions,this.nextOptions);this.next=new OpenLayers.Control.Button(nextOptions);},onPreviousChange:function(state,length){if(state&amp;&amp;!this.previous.active){this.previous.activate();}else if(!state&amp;&amp;this.previous.active){this.previous.deactivate();}},onNextChange:function(state,length){if(state&amp;&amp;!this.next.active){this.next.activate();}else if(!state&amp;&amp;this.next.active){this.next.deactivate();}},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this);this.previous.destroy();this.next.destroy();this.deactivate();for(var prop in this){this[prop]=null;}},setMap:function(map){this.map=map;this.next.setMap(map);this.previous.setMap(map);},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.next.draw();this.previous.draw();if(this.activateOnDraw){this.activate();}},previousTrigger:function(){var current=this.previousStack.shift();var state=this.previousStack.shift();if(state!=undefined){this.nextStack.unshift(current);this.previousStack.unshift(state);this.restoring=true;this.restore(state);this.restoring=false;this.onNextChange(this.nextStack[0],this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1);}else{this.previousStack.unshift(current);}
return state;},nextTrigger:function(){var state=this.nextStack.shift();if(state!=undefined){this.previousStack.unshift(state);this.restoring=true;this.restore(state);this.restoring=false;this.onNextChange(this.nextStack[0],this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1);}
return state;},clear:function(){this.previousStack=[];this.nextStack=[];},restore:function(state){var zoom=this.map.getZoomForResolution(state.resolution);this.map.setCenter(state.center,zoom);},setListeners:function(){this.listeners={};for(var type in this.registry){this.listeners[type]=OpenLayers.Function.bind(function(){if(!this.restoring){var state=this.registry[type].apply(this,arguments);this.previousStack.unshift(state);if(this.previousStack.length&gt;1){this.onPreviousChange(this.previousStack[1],this.previousStack.length-1);}
if(this.previousStack.length&gt;(this.limit+1)){this.previousStack.pop();}
if(this.nextStack.length&gt;0){this.nextStack=[];this.onNextChange(null,0);}}
return true;},this);}},activate:function(){var activated=false;if(this.map){if(OpenLayers.Control.prototype.activate.apply(this)){if(this.listeners==null){this.setListeners();}
for(var type in this.listeners){this.map.events.register(type,this,this.listeners[type]);}
activated=true;if(this.previousStack.length==0){this.initStack();}}}
return activated;},initStack:function(){if(this.map.getCenter()){this.listeners.moveend();}},deactivate:function(){var deactivated=false;if(this.map){if(OpenLayers.Control.prototype.deactivate.apply(this)){for(var type in this.listeners){this.map.events.unregister(type,this,this.listeners[type]);}
if(this.clearOnDeactivate){this.clear();}
deactivated=true;}}
return deactivated;},CLASS_NAME:&quot;OpenLayers.Control.NavigationHistory&quot;});OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(options){OpenLayers.Control.Panel.prototype.initialize.apply(this,[options]);this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST)]);},CLASS_NAME:&quot;OpenLayers.Control.PanPanel&quot;});OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoomBarDiv:null,divEvents:null,zoomWorldIcon:false,initialize:function(){OpenLayers.Control.PanZoom.prototype.initialize.apply(this,arguments);},destroy:function(){this._removeZoomBar();this.map.events.un({&quot;changebaselayer&quot;:this.redraw,scope:this});OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments);},setMap:function(map){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,arguments);this.map.events.register(&quot;changebaselayer&quot;,this,this.redraw);},redraw:function(){if(this.div!=null){this.removeButtons();this._removeZoomBar();}
this.draw();},draw:function(px){OpenLayers.Control.prototype.draw.apply(this,arguments);px=this.position.clone();this.buttons=[];var sz=new OpenLayers.Size(18,18);var centered=new OpenLayers.Pixel(px.x+sz.w/2,px.y);var wposition=sz.w;if(this.zoomWorldIcon){centered=new OpenLayers.Pixel(px.x+sz.w,px.y);}
this._addButton(&quot;panup&quot;,&quot;north-mini.png&quot;,centered,sz);px.y=centered.y+sz.h;this._addButton(&quot;panleft&quot;,&quot;west-mini.png&quot;,px,sz);if(this.zoomWorldIcon){this._addButton(&quot;zoomworld&quot;,&quot;zoom-world-mini.png&quot;,px.add(sz.w,0),sz);wposition*=2;}
this._addButton(&quot;panright&quot;,&quot;east-mini.png&quot;,px.add(wposition,0),sz);this._addButton(&quot;pandown&quot;,&quot;south-mini.png&quot;,centered.add(0,sz.h*2),sz);this._addButton(&quot;zoomin&quot;,&quot;zoom-plus-mini.png&quot;,centered.add(0,sz.h*3+5),sz);centered=this._addZoomBar(centered.add(0,sz.h*4+5));this._addButton(&quot;zoomout&quot;,&quot;zoom-minus-mini.png&quot;,centered,sz);return this.div;},_addZoomBar:function(centered){var imgLocation=OpenLayers.Util.getImagesLocation();var id=this.id+&quot;_&quot;+this.map.id;var zoomsToEnd=this.map.getNumZoomLevels()-1-this.map.getZoom();var slider=OpenLayers.Util.createAlphaImageDiv(id,centered.add(-1,zoomsToEnd*this.zoomStopHeight),new OpenLayers.Size(20,9),imgLocation+&quot;slider.png&quot;,&quot;absolute&quot;);this.slider=slider;this.sliderEvents=new OpenLayers.Events(this,slider,null,true,{includeXY:true});this.sliderEvents.on({&quot;mousedown&quot;:this.zoomBarDown,&quot;mousemove&quot;:this.zoomBarDrag,&quot;mouseup&quot;:this.zoomBarUp,&quot;dblclick&quot;:this.doubleClick,&quot;click&quot;:this.doubleClick});var sz=new OpenLayers.Size();sz.h=this.zoomStopHeight*this.map.getNumZoomLevels();sz.w=this.zoomStopWidth;var div=null;if(OpenLayers.Util.alphaHack()){var id=this.id+&quot;_&quot;+this.map.id;div=OpenLayers.Util.createAlphaImageDiv(id,centered,new OpenLayers.Size(sz.w,this.zoomStopHeight),imgLocation+&quot;zoombar.png&quot;,&quot;absolute&quot;,null,&quot;crop&quot;);div.style.height=sz.h+&quot;px&quot;;}else{div=OpenLayers.Util.createDiv(&apos;OpenLayers_Control_PanZoomBar_Zoombar&apos;+this.map.id,centered,sz,imgLocation+&quot;zoombar.png&quot;);}
this.zoombarDiv=div;this.divEvents=new OpenLayers.Events(this,div,null,true,{includeXY:true});this.divEvents.on({&quot;mousedown&quot;:this.divClick,&quot;mousemove&quot;:this.passEventToSlider,&quot;dblclick&quot;:this.doubleClick,&quot;click&quot;:this.doubleClick});this.div.appendChild(div);this.startTop=parseInt(div.style.top);this.div.appendChild(slider);this.map.events.register(&quot;zoomend&quot;,this,this.moveZoomBar);centered=centered.add(0,this.zoomStopHeight*this.map.getNumZoomLevels());return centered;},_removeZoomBar:function(){this.sliderEvents.un({&quot;mousedown&quot;:this.zoomBarDown,&quot;mousemove&quot;:this.zoomBarDrag,&quot;mouseup&quot;:this.zoomBarUp,&quot;dblclick&quot;:this.doubleClick,&quot;click&quot;:this.doubleClick});this.sliderEvents.destroy();this.divEvents.un({&quot;mousedown&quot;:this.divClick,&quot;mousemove&quot;:this.passEventToSlider,&quot;dblclick&quot;:this.doubleClick,&quot;click&quot;:this.doubleClick});this.divEvents.destroy();this.div.removeChild(this.zoombarDiv);this.zoombarDiv=null;this.div.removeChild(this.slider);this.slider=null;this.map.events.unregister(&quot;zoomend&quot;,this,this.moveZoomBar);},passEventToSlider:function(evt){this.sliderEvents.handleBrowserEvent(evt);},divClick:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
var y=evt.xy.y;var top=OpenLayers.Util.pagePosition(evt.object)[1];var levels=(y-top)/this.zoomStopHeight;if(!this.map.fractionalZoom){levels=Math.floor(levels);}
var zoom=(this.map.getNumZoomLevels()-1)-levels;zoom=Math.min(Math.max(zoom,0),this.map.getNumZoomLevels()-1);this.map.zoomTo(zoom);OpenLayers.Event.stop(evt);},zoomBarDown:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
this.map.events.on({&quot;mousemove&quot;:this.passEventToSlider,&quot;mouseup&quot;:this.passEventToSlider,scope:this});this.mouseDragStart=evt.xy.clone();this.zoomStart=evt.xy.clone();this.div.style.cursor=&quot;move&quot;;this.zoombarDiv.offsets=null;OpenLayers.Event.stop(evt);},zoomBarDrag:function(evt){if(this.mouseDragStart!=null){var deltaY=this.mouseDragStart.y-evt.xy.y;var offsets=OpenLayers.Util.pagePosition(this.zoombarDiv);if((evt.clientY-offsets[1])&gt;0&amp;&amp;(evt.clientY-offsets[1])&lt;parseInt(this.zoombarDiv.style.height)-2){var newTop=parseInt(this.slider.style.top)-deltaY;this.slider.style.top=newTop+&quot;px&quot;;this.mouseDragStart=evt.xy.clone();}
OpenLayers.Event.stop(evt);}},zoomBarUp:function(evt){if(!OpenLayers.Event.isLeftClick(evt)){return;}
if(this.zoomStart){this.div.style.cursor=&quot;&quot;;this.map.events.un({&quot;mouseup&quot;:this.passEventToSlider,&quot;mousemove&quot;:this.passEventToSlider,scope:this});var deltaY=this.zoomStart.y-evt.xy.y;var zoomLevel=this.map.zoom;if(this.map.fractionalZoom){zoomLevel+=deltaY/this.zoomStopHeight;zoomLevel=Math.min(Math.max(zoomLevel,0),this.map.getNumZoomLevels()-1);}else{zoomLevel+=Math.round(deltaY/this.zoomStopHeight);}
this.map.zoomTo(zoomLevel);this.moveZoomBar();this.mouseDragStart=null;OpenLayers.Event.stop(evt);}},moveZoomBar:function(){var newTop=((this.map.getNumZoomLevels()-1)-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.slider.style.top=newTop+&quot;px&quot;;},CLASS_NAME:&quot;OpenLayers.Control.PanZoomBar&quot;});OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,base:&apos;&apos;,displayProjection:null,initialize:function(element,base,options){OpenLayers.Control.prototype.initialize.apply(this,[options]);this.element=OpenLayers.Util.getElement(element);this.base=base||document.location.href;},destroy:function(){if(this.element.parentNode==this.div){this.div.removeChild(this.element);}
this.element=null;this.map.events.unregister(&apos;moveend&apos;,this,this.updateLink);OpenLayers.Control.prototype.destroy.apply(this,arguments);},setMap:function(map){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var i=0,len=this.map.controls.length;i&lt;len;i++){var control=this.map.controls[i];if(control.CLASS_NAME==this.argParserClass.CLASS_NAME){if(control.displayProjection!=this.displayProjection){this.displayProjection=control.displayProjection;}
break;}}
if(i==this.map.controls.length){this.map.addControl(new this.argParserClass({&apos;displayProjection&apos;:this.displayProjection}));}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.div.className=this.displayClass;this.element=document.createElement(&quot;a&quot;);this.element.innerHTML=OpenLayers.i18n(&quot;permalink&quot;);this.element.href=&quot;&quot;;this.div.appendChild(this.element);}
this.map.events.on({&apos;moveend&apos;:this.updateLink,&apos;changelayer&apos;:this.updateLink,&apos;changebaselayer&apos;:this.updateLink,scope:this});this.updateLink();return this.div;},updateLink:function(){var href=this.base;if(href.indexOf(&apos;?&apos;)!=-1){href=href.substring(0,href.indexOf(&apos;?&apos;));}
href+=&apos;?&apos;+OpenLayers.Util.getParameterString(this.createParams());this.element.href=href;},createParams:function(center,zoom,layers){center=center||this.map.getCenter();var params=OpenLayers.Util.getParameters(this.base);if(center){params.zoom=zoom||this.map.getZoom();var lat=center.lat;var lon=center.lon;if(this.displayProjection){var mapPosition=OpenLayers.Projection.transform({x:lon,y:lat},this.map.getProjectionObject(),this.displayProjection);lon=mapPosition.x;lat=mapPosition.y;}
params.lat=Math.round(lat*100000)/100000;params.lon=Math.round(lon*100000)/100000;layers=layers||this.map.layers;params.layers=&apos;&apos;;for(var i=0,len=layers.length;i&lt;len;i++){var layer=layers[i];if(layer.isBaseLayer){params.layers+=(layer==this.map.baseLayer)?&quot;B&quot;:&quot;0&quot;;}else{params.layers+=(layer.getVisibility())?&quot;T&quot;:&quot;F&quot;;}}}
return params;},CLASS_NAME:&quot;OpenLayers.Control.Permalink&quot;});OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(options){OpenLayers.Control.Panel.prototype.initialize.apply(this,[options]);this.addControls([new OpenLayers.Control.ZoomIn(),new OpenLayers.Control.ZoomToMaxExtent(),new OpenLayers.Control.ZoomOut()]);},CLASS_NAME:&quot;OpenLayers.Control.ZoomPanel&quot;});OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:&quot;    &quot;,space:&quot; &quot;,newline:&quot;\n&quot;,level:0,pretty:false,initialize:function(options){OpenLayers.Format.prototype.initialize.apply(this,[options]);},read:function(json,filter){try{if(/^[\],:{}\s]*$/.test(json.replace(/\\[&quot;\\\/bfnrtu]/g,&apos;@&apos;).replace(/&quot;[^&quot;\\\n\r]*&quot;|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,&apos;]&apos;).replace(/(?:^|:|,)(?:\s*\[)+/g,&apos;&apos;))){var object=eval(&apos;(&apos;+json+&apos;)&apos;);if(typeof filter===&apos;function&apos;){function walk(k,v){if(v&amp;&amp;typeof v===&apos;object&apos;){for(var i in v){if(v.hasOwnProperty(i)){v[i]=walk(i,v[i]);}}}
return filter(k,v);}
object=walk(&apos;&apos;,object);}
if(this.keepData){this.data=object;}
return object;}}catch(e){}
return null;},write:function(value,pretty){this.pretty=!!pretty;var json=null;var type=typeof value;if(this.serialize[type]){try{json=this.serialize[type].apply(this,[value]);}catch(err){OpenLayers.Console.error(&quot;Trouble serializing: &quot;+err);}}
return json;},writeIndent:function(){var pieces=[];if(this.pretty){for(var i=0;i&lt;this.level;++i){pieces.push(this.indent);}}
return pieces.join(&apos;&apos;);},writeNewline:function(){return(this.pretty)?this.newline:&apos;&apos;;},writeSpace:function(){return(this.pretty)?this.space:&apos;&apos;;},serialize:{&apos;object&apos;:function(object){if(object==null){return&quot;null&quot;;}
if(object.constructor==Date){return this.serialize.date.apply(this,[object]);}
if(object.constructor==Array){return this.serialize.array.apply(this,[object]);}
var pieces=[&apos;{&apos;];this.level+=1;var key,keyJSON,valueJSON;var addComma=false;for(key in object){if(object.hasOwnProperty(key)){keyJSON=OpenLayers.Format.JSON.prototype.write.apply(this,[key,this.pretty]);valueJSON=OpenLayers.Format.JSON.prototype.write.apply(this,[object[key],this.pretty]);if(keyJSON!=null&amp;&amp;valueJSON!=null){if(addComma){pieces.push(&apos;,&apos;);}
pieces.push(this.writeNewline(),this.writeIndent(),keyJSON,&apos;:&apos;,this.writeSpace(),valueJSON);addComma=true;}}}
this.level-=1;pieces.push(this.writeNewline(),this.writeIndent(),&apos;}&apos;);return pieces.join(&apos;&apos;);},&apos;array&apos;:function(array){var json;var pieces=[&apos;[&apos;];this.level+=1;for(var i=0,len=array.length;i&lt;len;++i){json=OpenLayers.Format.JSON.prototype.write.apply(this,[array[i],this.pretty]);if(json!=null){if(i&gt;0){pieces.push(&apos;,&apos;);}
pieces.push(this.writeNewline(),this.writeIndent(),json);}}
this.level-=1;pieces.push(this.writeNewline(),this.writeIndent(),&apos;]&apos;);return pieces.join(&apos;&apos;);},&apos;string&apos;:function(string){var m={&apos;\b&apos;:&apos;\\b&apos;,&apos;\t&apos;:&apos;\\t&apos;,&apos;\n&apos;:&apos;\\n&apos;,&apos;\f&apos;:&apos;\\f&apos;,&apos;\r&apos;:&apos;\\r&apos;,&apos;&quot;&apos;:&apos;\\&quot;&apos;,&apos;\\&apos;:&apos;\\\\&apos;};if(/[&quot;\\\x00-\x1f]/.test(string)){return&apos;&quot;&apos;+string.replace(/([\x00-\x1f\\&quot;])/g,function(a,b){var c=m[b];if(c){return c;}
c=b.charCodeAt();return&apos;\\u00&apos;+
Math.floor(c/16).toString(16)+
(c%16).toString(16);})+&apos;&quot;&apos;;}
return&apos;&quot;&apos;+string+&apos;&quot;&apos;;},&apos;number&apos;:function(number){return isFinite(number)?String(number):&quot;null&quot;;},&apos;boolean&apos;:function(bool){return String(bool);},&apos;date&apos;:function(date){function format(number){return(number&lt;10)?&apos;0&apos;+number:number;}
return&apos;&quot;&apos;+date.getFullYear()+&apos;-&apos;+
format(date.getMonth()+1)+&apos;-&apos;+
format(date.getDate())+&apos;T&apos;+
format(date.getHours())+&apos;:&apos;+
format(date.getMinutes())+&apos;:&apos;+
format(date.getSeconds())+&apos;&quot;&apos;;}},CLASS_NAME:&quot;OpenLayers.Format.JSON&quot;});OpenLayers.Format.WFST=function(options){options=OpenLayers.Util.applyDefaults(options,OpenLayers.Format.WFST.DEFAULTS);var cls=OpenLayers.Format.WFST[&quot;v&quot;+options.version.replace(/\./g,&quot;_&quot;)];if(!cls){throw&quot;Unsupported WFST version: &quot;+options.version;}
return new cls(options);};OpenLayers.Format.WFST.DEFAULTS={&quot;version&quot;:&quot;1.0.0&quot;};OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:&quot;1.1.1&quot;,version:null,parser:null,initialize:function(options){OpenLayers.Format.prototype.initialize.apply(this,[options]);this.options=options;},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var root=data.documentElement;var version=this.version||root.getAttribute(&quot;version&quot;)||this.defaultVersion;if(!this.parser||this.parser.version!==version){var constr=OpenLayers.Format.WMSCapabilities[&quot;v&quot;+version.replace(/\./g,&quot;_&quot;)];if(!constr){throw&quot;Can&apos;t find a WMS capabilities parser for version &quot;+version;}
var parser=new constr(this.options);}
var capabilities=parser.read(data);capabilities.version=version;return capabilities;},CLASS_NAME:&quot;OpenLayers.Format.WMSCapabilities&quot;});OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(options){if(window.ActiveXObject){this.xmldom=new ActiveXObject(&quot;Microsoft.XMLDOM&quot;);}
OpenLayers.Format.prototype.initialize.apply(this,[options]);this.namespaces=OpenLayers.Util.extend({},this.namespaces);this.namespaceAlias={};for(var alias in this.namespaces){this.namespaceAlias[this.namespaces[alias]]=alias;}},destroy:function(){this.xmldom=null;OpenLayers.Format.prototype.destroy.apply(this,arguments);},setNamespace:function(alias,uri){this.namespaces[alias]=uri;this.namespaceAlias[uri]=alias;},read:function(text){var index=text.indexOf(&apos;&lt;&apos;);if(index&gt;0){text=text.substring(index);}
var node=OpenLayers.Util.Try(OpenLayers.Function.bind((function(){var xmldom;if(window.ActiveXObject&amp;&amp;!this.xmldom){xmldom=new ActiveXObject(&quot;Microsoft.XMLDOM&quot;);}else{xmldom=this.xmldom;}
xmldom.loadXML(text);return xmldom;}),this),function(){return new DOMParser().parseFromString(text,&apos;text/xml&apos;);},function(){var req=new XMLHttpRequest();req.open(&quot;GET&quot;,&quot;data:&quot;+&quot;text/xml&quot;+&quot;;charset=utf-8,&quot;+encodeURIComponent(text),false);if(req.overrideMimeType){req.overrideMimeType(&quot;text/xml&quot;);}
req.send(null);return req.responseXML;});if(this.keepData){this.data=node;}
return node;},write:function(node){var data;if(this.xmldom){data=node.xml;}else{var serializer=new XMLSerializer();if(node.nodeType==1){var doc=document.implementation.createDocument(&quot;&quot;,&quot;&quot;,null);if(doc.importNode){node=doc.importNode(node,true);}
doc.appendChild(node);data=serializer.serializeToString(doc);}else{data=serializer.serializeToString(node);}}
return data;},createElementNS:function(uri,name){var element;if(this.xmldom){if(typeof uri==&quot;string&quot;){element=this.xmldom.createNode(1,name,uri);}else{element=this.xmldom.createNode(1,name,&quot;&quot;);}}else{element=document.createElementNS(uri,name);}
return element;},createTextNode:function(text){var node;if(this.xmldom){node=this.xmldom.createTextNode(text);}else{node=document.createTextNode(text);}
return node;},getElementsByTagNameNS:function(node,uri,name){var elements=[];if(node.getElementsByTagNameNS){elements=node.getElementsByTagNameNS(uri,name);}else{var allNodes=node.getElementsByTagName(&quot;*&quot;);var potentialNode,fullName;for(var i=0,len=allNodes.length;i&lt;len;++i){potentialNode=allNodes[i];fullName=(potentialNode.prefix)?(potentialNode.prefix+&quot;:&quot;+name):name;if((name==&quot;*&quot;)||(fullName==potentialNode.nodeName)){if((uri==&quot;*&quot;)||(uri==potentialNode.namespaceURI)){elements.push(potentialNode);}}}}
return elements;},getAttributeNodeNS:function(node,uri,name){var attributeNode=null;if(node.getAttributeNodeNS){attributeNode=node.getAttributeNodeNS(uri,name);}else{var attributes=node.attributes;var potentialNode,fullName;for(var i=0,len=attributes.length;i&lt;len;++i){potentialNode=attributes[i];if(potentialNode.namespaceURI==uri){fullName=(potentialNode.prefix)?(potentialNode.prefix+&quot;:&quot;+name):name;if(fullName==potentialNode.nodeName){attributeNode=potentialNode;break;}}}}
return attributeNode;},getAttributeNS:function(node,uri,name){var attributeValue=&quot;&quot;;if(node.getAttributeNS){attributeValue=node.getAttributeNS(uri,name)||&quot;&quot;;}else{var attributeNode=this.getAttributeNodeNS(node,uri,name);if(attributeNode){attributeValue=attributeNode.nodeValue;}}
return attributeValue;},getChildValue:function(node,def){var value=def||&quot;&quot;;if(node){for(var child=node.firstChild;child;child=child.nextSibling){switch(child.nodeType){case 3:case 4:value+=child.nodeValue;}}}
return value;},concatChildValues:function(node,def){var value=&quot;&quot;;var child=node.firstChild;var childValue;while(child){childValue=child.nodeValue;if(childValue){value+=childValue;}
child=child.nextSibling;}
if(value==&quot;&quot;&amp;&amp;def!=undefined){value=def;}
return value;},isSimpleContent:function(node){var simple=true;for(var child=node.firstChild;child;child=child.nextSibling){if(child.nodeType===1){simple=false;break;}}
return simple;},contentType:function(node){var simple=false,complex=false;var type=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY;for(var child=node.firstChild;child;child=child.nextSibling){switch(child.nodeType){case 1:complex=true;break;case 8:break;default:simple=true;}
if(complex&amp;&amp;simple){break;}}
if(complex&amp;&amp;simple){type=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;}else if(complex){return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;}else if(simple){return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE;}
return type;},hasAttributeNS:function(node,uri,name){var found=false;if(node.hasAttributeNS){found=node.hasAttributeNS(uri,name);}else{found=!!this.getAttributeNodeNS(node,uri,name);}
return found;},setAttributeNS:function(node,uri,name,value){if(node.setAttributeNS){node.setAttributeNS(uri,name,value);}else{if(this.xmldom){if(uri){var attribute=node.ownerDocument.createNode(2,name,uri);attribute.nodeValue=value;node.setAttributeNode(attribute);}else{node.setAttribute(name,value);}}else{throw&quot;setAttributeNS not implemented&quot;;}}},createElementNSPlus:function(name,options){options=options||{};var uri=options.uri||this.namespaces[options.prefix];if(!uri){var loc=name.indexOf(&quot;:&quot;);uri=this.namespaces[name.substring(0,loc)];}
if(!uri){uri=this.namespaces[this.defaultPrefix];}
var node=this.createElementNS(uri,name);if(options.attributes){this.setAttributes(node,options.attributes);}
var value=options.value;if(value!=null){if(typeof value==&quot;boolean&quot;){value=String(value);}
node.appendChild(this.createTextNode(value));}
return node;},setAttributes:function(node,obj){var value,uri;for(var name in obj){if(obj[name]!=null&amp;&amp;obj[name].toString){value=obj[name].toString();uri=this.namespaces[name.substring(0,name.indexOf(&quot;:&quot;))]||null;this.setAttributeNS(node,uri,name,value);}}},readNode:function(node,obj){if(!obj){obj={};}
var group=this.readers[this.namespaceAlias[node.namespaceURI]];if(group){var local=node.localName||node.nodeName.split(&quot;:&quot;).pop();var reader=group[local]||group[&quot;*&quot;];if(reader){reader.apply(this,[node,obj]);}}
return obj;},readChildNodes:function(node,obj){if(!obj){obj={};}
var children=node.childNodes;var child;for(var i=0,len=children.length;i&lt;len;++i){child=children[i];if(child.nodeType==1){this.readNode(child,obj);}}
return obj;},writeNode:function(name,obj,parent){var prefix,local;var split=name.indexOf(&quot;:&quot;);if(split&gt;0){prefix=name.substring(0,split);local=name.substring(split+1);}else{if(parent){prefix=this.namespaceAlias[parent.namespaceURI];}else{prefix=this.defaultPrefix;}
local=name;}
var child=this.writers[prefix][local].apply(this,[obj]);if(parent){parent.appendChild(child);}
return child;},getChildEl:function(node,name,uri){return node&amp;&amp;this.getThisOrNextEl(node.firstChild,name,uri);},getNextEl:function(node,name,uri){return node&amp;&amp;this.getThisOrNextEl(node.nextSibling,name,uri);},getThisOrNextEl:function(node,name,uri){outer:for(var sibling=node;sibling;sibling=sibling.nextSibling){switch(sibling.nodeType){case 1:if((!name||name===(sibling.localName||sibling.nodeName.split(&quot;:&quot;).pop()))&amp;&amp;(!uri||uri===sibling.namespaceURI)){break outer;}
sibling=null;break outer;case 3:if(/^\s*$/.test(sibling.nodeValue)){break;}
case 4:case 6:case 12:case 10:case 11:sibling=null;break outer;}}
return sibling||null;},lookupNamespaceURI:function(node,prefix){var uri=null;if(node){if(node.lookupNamespaceURI){uri=node.lookupNamespaceURI(prefix);}else{outer:switch(node.nodeType){case 1:if(node.namespaceURI!==null&amp;&amp;node.prefix===prefix){uri=node.namespaceURI;break outer;}
var len=node.attributes.length;if(len){var attr;for(var i=0;i&lt;len;++i){attr=node.attributes[i];if(attr.prefix===&quot;xmlns&quot;&amp;&amp;attr.name===&quot;xmlns:&quot;+prefix){uri=attr.value||null;break outer;}else if(attr.name===&quot;xmlns&quot;&amp;&amp;prefix===null){uri=attr.value||null;break outer;}}}
uri=this.lookupNamespaceURI(node.parentNode,prefix);break outer;case 2:uri=this.lookupNamespaceURI(node.ownerElement,prefix);break outer;case 9:uri=this.lookupNamespaceURI(node.documentElement,prefix);break outer;case 6:case 12:case 10:case 11:break outer;default:uri=this.lookupNamespaceURI(node.parentNode,prefix);break outer;}}}
return uri;},CLASS_NAME:&quot;OpenLayers.Format.XML&quot;});OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3};OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:false,evt:null,initialize:function(control,callbacks,options){OpenLayers.Util.extend(this,options);this.control=control;this.callbacks=callbacks;if(control.map){this.setMap(control.map);}
OpenLayers.Util.extend(this,options);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+&quot;_&quot;);},setMap:function(map){this.map=map;},checkModifiers:function(evt){if(this.keyMask==null){return true;}
var keyModifiers=(evt.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(evt.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(evt.altKey?OpenLayers.Handler.MOD_ALT:0);return(keyModifiers==this.keyMask);},activate:function(){if(this.active){return false;}
var events=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var i=0,len=events.length;i&lt;len;i++){if(this[events[i]]){this.register(events[i],this[events[i]]);}}
this.active=true;return true;},deactivate:function(){if(!this.active){return false;}
var events=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var i=0,len=events.length;i&lt;len;i++){if(this[events[i]]){this.unregister(events[i],this[events[i]]);}}
this.active=false;return true;},callback:function(name,args){if(name&amp;&amp;this.callbacks[name]){this.callbacks[name].apply(this.control,args);}},register:function(name,method){this.map.events.registerPriority(name,this,method);this.map.events.registerPriority(name,this,this.setEvent);},unregister:function(name,method){this.map.events.unregister(name,this,method);this.map.events.unregister(name,this,this.setEvent);},setEvent:function(evt){this.evt=evt;return true;},destroy:function(){this.deactivate();this.control=this.map=null;},CLASS_NAME:&quot;OpenLayers.Handler&quot;});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1000},EVENT_TYPES:[&quot;preaddlayer&quot;,&quot;addlayer&quot;,&quot;removelayer&quot;,&quot;changelayer&quot;,&quot;movestart&quot;,&quot;move&quot;,&quot;moveend&quot;,&quot;zoomend&quot;,&quot;popupopen&quot;,&quot;popupclose&quot;,&quot;addmarker&quot;,&quot;removemarker&quot;,&quot;clearmarkers&quot;,&quot;mouseover&quot;,&quot;mouseout&quot;,&quot;mousemove&quot;,&quot;dragstart&quot;,&quot;drag&quot;,&quot;dragend&quot;,&quot;changebaselayer&quot;],id:null,fractionalZoom:false,events:null,allOverlays:false,div:null,dragging:false,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,viewRequestID:0,tileSize:null,projection:&quot;EPSG:4326&quot;,units:&apos;degrees&apos;,resolutions:null,maxResolution:1.40625,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:true,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,initialize:function(div,options){if(arguments.length===1&amp;&amp;typeof div===&quot;object&quot;){options=div;div=options&amp;&amp;options.div;}
this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT);this.maxExtent=new OpenLayers.Bounds(-180,-90,180,90);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+&apos;style.css&apos;;OpenLayers.Util.extend(this,options);this.id=OpenLayers.Util.createUniqueID(&quot;OpenLayers.Map_&quot;);this.div=OpenLayers.Util.getElement(div);if(!this.div){this.div=document.createElement(&quot;div&quot;);this.div.style.height=&quot;1px&quot;;this.div.style.width=&quot;1px&quot;;}
OpenLayers.Element.addClass(this.div,&apos;olMap&apos;);var id=this.div.id+&quot;_OpenLayers_ViewPort&quot;;this.viewPortDiv=OpenLayers.Util.createDiv(id,null,null,null,&quot;relative&quot;,null,&quot;hidden&quot;);this.viewPortDiv.style.width=&quot;100%&quot;;this.viewPortDiv.style.height=&quot;100%&quot;;this.viewPortDiv.className=&quot;olMapViewport&quot;;this.div.appendChild(this.viewPortDiv);id=this.div.id+&quot;_OpenLayers_Container&quot;;this.layerContainerDiv=OpenLayers.Util.createDiv(id);this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE[&apos;Popup&apos;]-1;this.viewPortDiv.appendChild(this.layerContainerDiv);this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES,this.fallThrough,{includeXY:true});this.updateSize();if(this.eventListeners instanceof Object){this.events.on(this.eventListeners);}
this.events.register(&quot;movestart&quot;,this,this.updateSize);if(OpenLayers.String.contains(navigator.appName,&quot;Microsoft&quot;)){this.events.register(&quot;resize&quot;,this,this.updateSize);}else{this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this);OpenLayers.Event.observe(window,&apos;resize&apos;,this.updateSizeDestroy);}
if(this.theme){var addNode=true;var nodes=document.getElementsByTagName(&apos;link&apos;);for(var i=0,len=nodes.length;i&lt;len;++i){if(OpenLayers.Util.isEquivalentUrl(nodes.item(i).href,this.theme)){addNode=false;break;}}
if(addNode){var cssNode=document.createElement(&apos;link&apos;);cssNode.setAttribute(&apos;rel&apos;,&apos;stylesheet&apos;);cssNode.setAttribute(&apos;type&apos;,&apos;text/css&apos;);cssNode.setAttribute(&apos;href&apos;,this.theme);document.getElementsByTagName(&apos;head&apos;)[0].appendChild(cssNode);}}
this.layers=[];if(this.controls==null){if(OpenLayers.Control!=null){this.controls=[new OpenLayers.Control.Navigation(),new OpenLayers.Control.PanZoom(),new OpenLayers.Control.ArgParser(),new OpenLayers.Control.Attribution()];}else{this.controls=[];}}
for(var i=0,len=this.controls.length;i&lt;len;i++){this.addControlToMap(this.controls[i]);}
this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,&apos;unload&apos;,this.unloadDestroy);},render:function(div){this.div=OpenLayers.Util.getElement(div);OpenLayers.Element.addClass(this.div,&apos;olMap&apos;);this.events.attachToElement(this.div);this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize();},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy){return false;}
OpenLayers.Event.stopObserving(window,&apos;unload&apos;,this.unloadDestroy);this.unloadDestroy=null;if(this.updateSizeDestroy){OpenLayers.Event.stopObserving(window,&apos;resize&apos;,this.updateSizeDestroy);}else{this.events.unregister(&quot;resize&quot;,this,this.updateSize);}
this.paddingForPopups=null;if(this.controls!=null){for(var i=this.controls.length-1;i&gt;=0;--i){this.controls[i].destroy();}
this.controls=null;}
if(this.layers!=null){for(var i=this.layers.length-1;i&gt;=0;--i){this.layers[i].destroy(false);}
this.layers=null;}
if(this.viewPortDiv){this.div.removeChild(this.viewPortDiv);}
this.viewPortDiv=null;if(this.eventListeners){this.events.un(this.eventListeners);this.eventListeners=null;}
this.events.destroy();this.events=null;},setOptions:function(options){OpenLayers.Util.extend(this,options);},getTileSize:function(){return this.tileSize;},getBy:function(array,property,match){var test=(typeof match.test==&quot;function&quot;);var found=OpenLayers.Array.filter(this[array],function(item){return item[property]==match||(test&amp;&amp;match.test(item[property]));});return found;},getLayersBy:function(property,match){return this.getBy(&quot;layers&quot;,property,match);},getLayersByName:function(match){return this.getLayersBy(&quot;name&quot;,match);},getLayersByClass:function(match){return this.getLayersBy(&quot;CLASS_NAME&quot;,match);},getControlsBy:function(property,match){return this.getBy(&quot;controls&quot;,property,match);},getControlsByClass:function(match){return this.getControlsBy(&quot;CLASS_NAME&quot;,match);},getLayer:function(id){var foundLayer=null;for(var i=0,len=this.layers.length;i&lt;len;i++){var layer=this.layers[i];if(layer.id==id){foundLayer=layer;break;}}
return foundLayer;},setLayerZIndex:function(layer,zIdx){layer.setZIndex(this.Z_INDEX_BASE[layer.isBaseLayer?&apos;BaseLayer&apos;:&apos;Overlay&apos;]
+zIdx*5);},resetLayersZIndex:function(){for(var i=0,len=this.layers.length;i&lt;len;i++){var layer=this.layers[i];this.setLayerZIndex(layer,i);}},addLayer:function(layer){for(var i=0,len=this.layers.length;i&lt;len;i++){if(this.layers[i]==layer){var msg=OpenLayers.i18n(&apos;layerAlreadyAdded&apos;,{&apos;layerName&apos;:layer.name});OpenLayers.Console.warn(msg);return false;}}
if(this.allOverlays){layer.isBaseLayer=false;}
this.events.triggerEvent(&quot;preaddlayer&quot;,{layer:layer});layer.div.className=&quot;olLayerDiv&quot;;layer.div.style.overflow=&quot;&quot;;this.setLayerZIndex(layer,this.layers.length);if(layer.isFixed){this.viewPortDiv.appendChild(layer.div);}else{this.layerContainerDiv.appendChild(layer.div);}
this.layers.push(layer);layer.setMap(this);if(layer.isBaseLayer||(this.allOverlays&amp;&amp;!this.baseLayer)){if(this.baseLayer==null){this.setBaseLayer(layer);}else{layer.setVisibility(false);}}else{layer.redraw();}
this.events.triggerEvent(&quot;addlayer&quot;,{layer:layer});layer.afterAdd();},addLayers:function(layers){for(var i=0,len=layers.length;i&lt;len;i++){this.addLayer(layers[i]);}},removeLayer:function(layer,setNewBaseLayer){if(setNewBaseLayer==null){setNewBaseLayer=true;}
if(layer.isFixed){this.viewPortDiv.removeChild(layer.div);}else{this.layerContainerDiv.removeChild(layer.div);}
OpenLayers.Util.removeItem(this.layers,layer);layer.removeMap(this);layer.map=null;if(this.baseLayer==layer){this.baseLayer=null;if(setNewBaseLayer){for(var i=0,len=this.layers.length;i&lt;len;i++){var iLayer=this.layers[i];if(iLayer.isBaseLayer||this.allOverlays){this.setBaseLayer(iLayer);break;}}}}
this.resetLayersZIndex();this.events.triggerEvent(&quot;removelayer&quot;,{layer:layer});},getNumLayers:function(){return this.layers.length;},getLayerIndex:function(layer){return OpenLayers.Util.indexOf(this.layers,layer);},setLayerIndex:function(layer,idx){var base=this.getLayerIndex(layer);if(idx&lt;0){idx=0;}else if(idx&gt;this.layers.length){idx=this.layers.length;}
if(base!=idx){this.layers.splice(base,1);this.layers.splice(idx,0,layer);for(var i=0,len=this.layers.length;i&lt;len;i++){this.setLayerZIndex(this.layers[i],i);}
this.events.triggerEvent(&quot;changelayer&quot;,{layer:layer,property:&quot;order&quot;});if(this.allOverlays){if(idx===0){this.setBaseLayer(layer);}else if(this.baseLayer!==this.layers[0]){this.setBaseLayer(this.layers[0]);}}}},raiseLayer:function(layer,delta){var idx=this.getLayerIndex(layer)+delta;this.setLayerIndex(layer,idx);},setBaseLayer:function(newBaseLayer){var oldExtent=null;if(this.baseLayer){oldExtent=this.baseLayer.getExtent();}
if(newBaseLayer!=this.baseLayer){if(OpenLayers.Util.indexOf(this.layers,newBaseLayer)!=-1){if(this.baseLayer!=null&amp;&amp;!this.allOverlays){this.baseLayer.setVisibility(false);}
this.baseLayer=newBaseLayer;this.viewRequestID++;if(!this.allOverlays){this.baseLayer.visibility=true;}
var center=this.getCenter();if(center!=null){var newCenter=(oldExtent)?oldExtent.getCenterLonLat():center;var newZoom=(oldExtent)?this.getZoomForExtent(oldExtent,true):this.getZoomForResolution(this.resolution,true);this.setCenter(newCenter,newZoom,false,true);}
this.events.triggerEvent(&quot;changebaselayer&quot;,{layer:this.baseLayer});}}},addControl:function(control,px){this.controls.push(control);this.addControlToMap(control,px);},addControlToMap:function(control,px){control.outsideViewport=(control.div!=null);if(this.displayProjection&amp;&amp;!control.displayProjection){control.displayProjection=this.displayProjection;}
control.setMap(this);var div=control.draw(px);if(div){if(!control.outsideViewport){div.style.zIndex=this.Z_INDEX_BASE[&apos;Control&apos;]+
this.controls.length;this.viewPortDiv.appendChild(div);}}},getControl:function(id){var returnControl=null;for(var i=0,len=this.controls.length;i&lt;len;i++){var control=this.controls[i];if(control.id==id){returnControl=control;break;}}
return returnControl;},removeControl:function(control){if((control)&amp;&amp;(control==this.getControl(control.id))){if(control.div&amp;&amp;(control.div.parentNode==this.viewPortDiv)){this.viewPortDiv.removeChild(control.div);}
OpenLayers.Util.removeItem(this.controls,control);}},addPopup:function(popup,exclusive){if(exclusive){for(var i=this.popups.length-1;i&gt;=0;--i){this.removePopup(this.popups[i]);}}
popup.map=this;this.popups.push(popup);var popupDiv=popup.draw();if(popupDiv){popupDiv.style.zIndex=this.Z_INDEX_BASE[&apos;Popup&apos;]+
this.popups.length;this.layerContainerDiv.appendChild(popupDiv);}},removePopup:function(popup){OpenLayers.Util.removeItem(this.popups,popup);if(popup.div){try{this.layerContainerDiv.removeChild(popup.div);}
catch(e){}}
popup.map=null;},getSize:function(){var size=null;if(this.size!=null){size=this.size.clone();}
return size;},updateSize:function(){this.events.clearMouseCache();var newSize=this.getCurrentSize();var oldSize=this.getSize();if(oldSize==null){this.size=oldSize=newSize;}
if(!newSize.equals(oldSize)){this.size=newSize;for(var i=0,len=this.layers.length;i&lt;len;i++){this.layers[i].onMapResize();}
if(this.baseLayer!=null){var center=new OpenLayers.Pixel(newSize.w/2,newSize.h/2);var centerLL=this.getLonLatFromViewPortPx(center);var zoom=this.getZoom();this.zoom=null;this.setCenter(this.getCenter(),zoom);}}},getCurrentSize:function(){var size=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(size.w==0&amp;&amp;size.h==0||isNaN(size.w)&amp;&amp;isNaN(size.h)){var dim=OpenLayers.Element.getDimensions(this.div);size.w=dim.width;size.h=dim.height;}
if(size.w==0&amp;&amp;size.h==0||isNaN(size.w)&amp;&amp;isNaN(size.h)){size.w=parseInt(this.div.style.width);size.h=parseInt(this.div.style.height);}
return size;},calculateBounds:function(center,resolution){var extent=null;if(center==null){center=this.getCenter();}
if(resolution==null){resolution=this.getResolution();}
if((center!=null)&amp;&amp;(resolution!=null)){var size=this.getSize();var w_deg=size.w*resolution;var h_deg=size.h*resolution;extent=new OpenLayers.Bounds(center.lon-w_deg/2,center.lat-h_deg/2,center.lon+w_deg/2,center.lat+h_deg/2);}
return extent;},getCenter:function(){var center=null;if(this.center){center=this.center.clone();}
return center;},getZoom:function(){return this.zoom;},pan:function(dx,dy,options){options=OpenLayers.Util.applyDefaults(options,{animate:true,dragging:false});var centerPx=this.getViewPortPxFromLonLat(this.getCenter());var newCenterPx=centerPx.add(dx,dy);if(!options.dragging||!newCenterPx.equals(centerPx)){var newCenterLonLat=this.getLonLatFromViewPortPx(newCenterPx);if(options.animate){this.panTo(newCenterLonLat);}else{this.setCenter(newCenterLonLat,null,options.dragging);}}},panTo:function(lonlat){if(this.panMethod&amp;&amp;this.getExtent().scale(this.panRatio).containsLonLat(lonlat)){if(!this.panTween){this.panTween=new OpenLayers.Tween(this.panMethod);}
var center=this.getCenter();if(lonlat.lon==center.lon&amp;&amp;lonlat.lat==center.lat){return;}
var from={lon:center.lon,lat:center.lat};var to={lon:lonlat.lon,lat:lonlat.lat};this.panTween.start(from,to,this.panDuration,{callbacks:{start:OpenLayers.Function.bind(function(lonlat){this.events.triggerEvent(&quot;movestart&quot;);},this),eachStep:OpenLayers.Function.bind(function(lonlat){lonlat=new OpenLayers.LonLat(lonlat.lon,lonlat.lat);this.moveTo(lonlat,this.zoom,{&apos;dragging&apos;:true,&apos;noEvent&apos;:true});},this),done:OpenLayers.Function.bind(function(lonlat){lonlat=new OpenLayers.LonLat(lonlat.lon,lonlat.lat);this.moveTo(lonlat,this.zoom,{&apos;noEvent&apos;:true});this.events.triggerEvent(&quot;moveend&quot;);},this)}});}else{this.setCenter(lonlat);}},setCenter:function(lonlat,zoom,dragging,forceZoomChange){this.moveTo(lonlat,zoom,{&apos;dragging&apos;:dragging,&apos;forceZoomChange&apos;:forceZoomChange,&apos;caller&apos;:&apos;setCenter&apos;});},moveTo:function(lonlat,zoom,options){if(!options){options={};}
var dragging=options.dragging;var forceZoomChange=options.forceZoomChange;var noEvent=options.noEvent;if(this.panTween&amp;&amp;options.caller==&quot;setCenter&quot;){this.panTween.stop();}
if(!this.center&amp;&amp;!this.isValidLonLat(lonlat)){lonlat=this.maxExtent.getCenterLonLat();}
if(this.restrictedExtent!=null){if(lonlat==null){lonlat=this.getCenter();}
if(zoom==null){zoom=this.getZoom();}
var resolution=this.getResolutionForZoom(zoom);var extent=this.calculateBounds(lonlat,resolution);if(!this.restrictedExtent.containsBounds(extent)){var maxCenter=this.restrictedExtent.getCenterLonLat();if(extent.getWidth()&gt;this.restrictedExtent.getWidth()){lonlat=new OpenLayers.LonLat(maxCenter.lon,lonlat.lat);}else if(extent.left&lt;this.restrictedExtent.left){lonlat=lonlat.add(this.restrictedExtent.left-
extent.left,0);}else if(extent.right&gt;this.restrictedExtent.right){lonlat=lonlat.add(this.restrictedExtent.right-
extent.right,0);}
if(extent.getHeight()&gt;this.restrictedExtent.getHeight()){lonlat=new OpenLayers.LonLat(lonlat.lon,maxCenter.lat);}else if(extent.bottom&lt;this.restrictedExtent.bottom){lonlat=lonlat.add(0,this.restrictedExtent.bottom-
extent.bottom);}
else if(extent.top&gt;this.restrictedExtent.top){lonlat=lonlat.add(0,this.restrictedExtent.top-
extent.top);}}}
var zoomChanged=forceZoomChange||((this.isValidZoomLevel(zoom))&amp;&amp;(zoom!=this.getZoom()));var centerChanged=(this.isValidLonLat(lonlat))&amp;&amp;(!lonlat.equals(this.center));if(zoomChanged||centerChanged||!dragging){if(!this.dragging&amp;&amp;!noEvent){this.events.triggerEvent(&quot;movestart&quot;);}
if(centerChanged){if((!zoomChanged)&amp;&amp;(this.center)){this.centerLayerContainer(lonlat);}
this.center=lonlat.clone();}
if((zoomChanged)||(this.layerContainerOrigin==null)){this.layerContainerOrigin=this.center.clone();this.layerContainerDiv.style.left=&quot;0px&quot;;this.layerContainerDiv.style.top=&quot;0px&quot;;}
if(zoomChanged){this.zoom=zoom;this.resolution=this.getResolutionForZoom(zoom);this.viewRequestID++;}
var bounds=this.getExtent();if(this.baseLayer.visibility){this.baseLayer.moveTo(bounds,zoomChanged,dragging);if(dragging){this.baseLayer.events.triggerEvent(&quot;move&quot;);}else{this.baseLayer.events.triggerEvent(&quot;moveend&quot;,{&quot;zoomChanged&quot;:zoomChanged});}}
bounds=this.baseLayer.getExtent();for(var i=0,len=this.layers.length;i&lt;len;i++){var layer=this.layers[i];if(layer!==this.baseLayer&amp;&amp;!layer.isBaseLayer){var inRange=layer.calculateInRange();if(layer.inRange!=inRange){layer.inRange=inRange;if(!inRange){layer.display(false);}
this.events.triggerEvent(&quot;changelayer&quot;,{layer:layer,property:&quot;visibility&quot;});}
if(inRange&amp;&amp;layer.visibility){layer.moveTo(bounds,zoomChanged,dragging);if(dragging){layer.events.triggerEvent(&quot;move&quot;);}else{layer.events.triggerEvent(&quot;moveend&quot;,{&quot;zoomChanged&quot;:zoomChanged});}}}}
if(zoomChanged){for(var i=0,len=this.popups.length;i&lt;len;i++){this.popups[i].updatePosition();}}
this.events.triggerEvent(&quot;move&quot;);if(zoomChanged){this.events.triggerEvent(&quot;zoomend&quot;);}}
if(!dragging&amp;&amp;!noEvent){this.events.triggerEvent(&quot;moveend&quot;);}
this.dragging=!!dragging;},centerLayerContainer:function(lonlat){var originPx=this.getViewPortPxFromLonLat(this.layerContainerOrigin);var newPx=this.getViewPortPxFromLonLat(lonlat);if((originPx!=null)&amp;&amp;(newPx!=null)){this.layerContainerDiv.style.left=Math.round(originPx.x-newPx.x)+&quot;px&quot;;this.layerContainerDiv.style.top=Math.round(originPx.y-newPx.y)+&quot;px&quot;;}},isValidZoomLevel:function(zoomLevel){return((zoomLevel!=null)&amp;&amp;(zoomLevel&gt;=0)&amp;&amp;(zoomLevel&lt;this.getNumZoomLevels()));},isValidLonLat:function(lonlat){var valid=false;if(lonlat!=null){var maxExtent=this.getMaxExtent();valid=maxExtent.containsLonLat(lonlat);}
return valid;},getProjection:function(){var projection=this.getProjectionObject();return projection?projection.getCode():null;},getProjectionObject:function(){var projection=null;if(this.baseLayer!=null){projection=this.baseLayer.projection;}
return projection;},getMaxResolution:function(){var maxResolution=null;if(this.baseLayer!=null){maxResolution=this.baseLayer.maxResolution;}
return maxResolution;},getMaxExtent:function(options){var maxExtent=null;if(options&amp;&amp;options.restricted&amp;&amp;this.restrictedExtent){maxExtent=this.restrictedExtent;}else if(this.baseLayer!=null){maxExtent=this.baseLayer.maxExtent;}
return maxExtent;},getNumZoomLevels:function(){var numZoomLevels=null;if(this.baseLayer!=null){numZoomLevels=this.baseLayer.numZoomLevels;}
return numZoomLevels;},getExtent:function(){var extent=null;if(this.baseLayer!=null){extent=this.baseLayer.getExtent();}
return extent;},getResolution:function(){var resolution=null;if(this.baseLayer!=null){resolution=this.baseLayer.getResolution();}
return resolution;},getUnits:function(){var units=null;if(this.baseLayer!=null){units=this.baseLayer.units;}
return units;},getScale:function(){var scale=null;if(this.baseLayer!=null){var res=this.getResolution();var units=this.baseLayer.units;scale=OpenLayers.Util.getScaleFromResolution(res,units);}
return scale;},getZoomForExtent:function(bounds,closest){var zoom=null;if(this.baseLayer!=null){zoom=this.baseLayer.getZoomForExtent(bounds,closest);}
return zoom;},getResolutionForZoom:function(zoom){var resolution=null;if(this.baseLayer){resolution=this.baseLayer.getResolutionForZoom(zoom);}
return resolution;},getZoomForResolution:function(resolution,closest){var zoom=null;if(this.baseLayer!=null){zoom=this.baseLayer.getZoomForResolution(resolution,closest);}
return zoom;},zoomTo:function(zoom){if(this.isValidZoomLevel(zoom)){this.setCenter(null,zoom);}},zoomIn:function(){this.zoomTo(this.getZoom()+1);},zoomOut:function(){this.zoomTo(this.getZoom()-1);},zoomToExtent:function(bounds,closest){var center=bounds.getCenterLonLat();if(this.baseLayer.wrapDateLine){var maxExtent=this.getMaxExtent();bounds=bounds.clone();while(bounds.right&lt;bounds.left){bounds.right+=maxExtent.getWidth();}
center=bounds.getCenterLonLat().wrapDateLine(maxExtent);}
this.setCenter(center,this.getZoomForExtent(bounds,closest));},zoomToMaxExtent:function(options){var restricted=(options)?options.restricted:true;var maxExtent=this.getMaxExtent({&apos;restricted&apos;:restricted});this.zoomToExtent(maxExtent);},zoomToScale:function(scale,closest){var res=OpenLayers.Util.getResolutionFromScale(scale,this.baseLayer.units);var size=this.getSize();var w_deg=size.w*res;var h_deg=size.h*res;var center=this.getCenter();var extent=new OpenLayers.Bounds(center.lon-w_deg/2,center.lat-h_deg/2,center.lon+w_deg/2,center.lat+h_deg/2);this.zoomToExtent(extent,closest);},getLonLatFromViewPortPx:function(viewPortPx){var lonlat=null;if(this.baseLayer!=null){lonlat=this.baseLayer.getLonLatFromViewPortPx(viewPortPx);}
return lonlat;},getViewPortPxFromLonLat:function(lonlat){var px=null;if(this.baseLayer!=null){px=this.baseLayer.getViewPortPxFromLonLat(lonlat);}
return px;},getLonLatFromPixel:function(px){return this.getLonLatFromViewPortPx(px);},getPixelFromLonLat:function(lonlat){var px=this.getViewPortPxFromLonLat(lonlat);px.x=Math.round(px.x);px.y=Math.round(px.y);return px;},getViewPortPxFromLayerPx:function(layerPx){var viewPortPx=null;if(layerPx!=null){var dX=parseInt(this.layerContainerDiv.style.left);var dY=parseInt(this.layerContainerDiv.style.top);viewPortPx=layerPx.add(dX,dY);}
return viewPortPx;},getLayerPxFromViewPortPx:function(viewPortPx){var layerPx=null;if(viewPortPx!=null){var dX=-parseInt(this.layerContainerDiv.style.left);var dY=-parseInt(this.layerContainerDiv.style.top);layerPx=viewPortPx.add(dX,dY);if(isNaN(layerPx.x)||isNaN(layerPx.y)){layerPx=null;}}
return layerPx;},getLonLatFromLayerPx:function(px){px=this.getViewPortPxFromLayerPx(px);return this.getLonLatFromViewPortPx(px);},getLayerPxFromLonLat:function(lonlat){var px=this.getPixelFromLonLat(lonlat);return this.getLayerPxFromViewPortPx(px);},CLASS_NAME:&quot;OpenLayers.Map&quot;});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(lonlat,icon){this.lonlat=lonlat;var newIcon=(icon)?icon:OpenLayers.Marker.defaultIcon();if(this.icon==null){this.icon=newIcon;}else{this.icon.url=newIcon.url;this.icon.size=newIcon.size;this.icon.offset=newIcon.offset;this.icon.calculateOffset=newIcon.calculateOffset;}
this.events=new OpenLayers.Events(this,this.icon.imageDiv,null);},destroy:function(){this.erase();this.map=null;this.events.destroy();this.events=null;if(this.icon!=null){this.icon.destroy();this.icon=null;}},draw:function(px){return this.icon.draw(px);},erase:function(){if(this.icon!=null){this.icon.erase();}},moveTo:function(px){if((px!=null)&amp;&amp;(this.icon!=null)){this.icon.moveTo(px);}
this.lonlat=this.map.getLonLatFromLayerPx(px);},isDrawn:function(){var isDrawn=(this.icon&amp;&amp;this.icon.isDrawn());return isDrawn;},onScreen:function(){var onScreen=false;if(this.map){var screenBounds=this.map.getExtent();onScreen=screenBounds.containsLonLat(this.lonlat);}
return onScreen;},inflate:function(inflate){if(this.icon){var newSize=new OpenLayers.Size(this.icon.size.w*inflate,this.icon.size.h*inflate);this.icon.setSize(newSize);}},setOpacity:function(opacity){this.icon.setOpacity(opacity);},setUrl:function(url){this.icon.setUrl(url);},display:function(display){this.icon.display(display);},CLASS_NAME:&quot;OpenLayers.Marker&quot;});OpenLayers.Marker.defaultIcon=function(){var url=OpenLayers.Util.getImagesLocation()+&quot;marker.png&quot;;var size=new OpenLayers.Size(21,25);var calculateOffset=function(size){return new OpenLayers.Pixel(-(size.w/2),-size.h);};return new OpenLayers.Icon(url,size,null,calculateOffset);};OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:&quot;olFramedCloudPopupContent&quot;,autoSize:true,panMapIfOutOfView:true,imageSize:new OpenLayers.Size(676,736),isAlphaImage:false,fixedRelativePosition:false,positionBlocks:{&quot;tl&quot;:{&apos;offset&apos;:new OpenLayers.Pixel(44,0),&apos;padding&apos;:new OpenLayers.Bounds(8,40,8,9),&apos;blocks&apos;:[{size:new OpenLayers.Size(&apos;auto&apos;,&apos;auto&apos;),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,&apos;auto&apos;),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size(&apos;auto&apos;,19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-638,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},&quot;tr&quot;:{&apos;offset&apos;:new OpenLayers.Pixel(-45,0),&apos;padding&apos;:new OpenLayers.Bounds(8,40,8,9),&apos;blocks&apos;:[{size:new OpenLayers.Size(&apos;auto&apos;,&apos;auto&apos;),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,&apos;auto&apos;),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size(&apos;auto&apos;,19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-638,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},&quot;bl&quot;:{&apos;offset&apos;:new OpenLayers.Pixel(45,0),&apos;padding&apos;:new OpenLayers.Bounds(8,9,8,40),&apos;blocks&apos;:[{size:new OpenLayers.Size(&apos;auto&apos;,&apos;auto&apos;),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,&apos;auto&apos;),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size(&apos;auto&apos;,21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-638,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},&quot;br&quot;:{&apos;offset&apos;:new OpenLayers.Pixel(-44,0),&apos;padding&apos;:new OpenLayers.Bounds(8,9,8,40),&apos;blocks&apos;:[{size:new OpenLayers.Size(&apos;auto&apos;,&apos;auto&apos;),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,&apos;auto&apos;),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size(&apos;auto&apos;,21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-638,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(600,660),initialize:function(id,lonlat,contentSize,contentHTML,anchor,closeBox,closeBoxCallback){this.imageSrc=OpenLayers.Util.getImagesLocation()+&apos;cloud-popup-relative.png&apos;;OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass;},destroy:function(){OpenLayers.Popup.Framed.prototype.destroy.apply(this,arguments);},CLASS_NAME:&quot;OpenLayers.Popup.FramedCloud&quot;});OpenLayers.Request={DEFAULT_CONFIG:{method:&quot;GET&quot;,url:window.location.href,async:true,user:undefined,password:undefined,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},events:new OpenLayers.Events(this,null,[&quot;complete&quot;,&quot;success&quot;,&quot;failure&quot;]),issue:function(config){var defaultConfig=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});config=OpenLayers.Util.applyDefaults(config,defaultConfig);var request=new OpenLayers.Request.XMLHttpRequest();var url=config.url;if(config.params){var paramString=OpenLayers.Util.getParameterString(config.params);if(paramString.length&gt;0){var separator=(url.indexOf(&apos;?&apos;)&gt;-1)?&apos;&amp;&apos;:&apos;?&apos;;url+=separator+paramString;}}
if(config.proxy&amp;&amp;(url.indexOf(&quot;http&quot;)==0)){url=config.proxy+encodeURIComponent(url);}
request.open(config.method,url,config.async,config.user,config.password);for(var header in config.headers){request.setRequestHeader(header,config.headers[header]);}
var complete=(config.scope)?OpenLayers.Function.bind(config.callback,config.scope):config.callback;var success;if(config.success){success=(config.scope)?OpenLayers.Function.bind(config.success,config.scope):config.success;}
var failure;if(config.failure){failure=(config.scope)?OpenLayers.Function.bind(config.failure,config.scope):config.failure;}
var events=this.events;request.onreadystatechange=function(){if(request.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var proceed=events.triggerEvent(&quot;complete&quot;,{request:request,config:config,requestUrl:url});if(proceed!==false){complete(request);if(!request.status||(request.status&gt;=200&amp;&amp;request.status&lt;300)){events.triggerEvent(&quot;success&quot;,{request:request,config:config,requestUrl:url});if(success){success(request);}}
if(request.status&amp;&amp;(request.status&lt;200||request.status&gt;=300)){events.triggerEvent(&quot;failure&quot;,{request:request,config:config,requestUrl:url});if(failure){failure(request);}}}}};if(config.async===false){request.send(config.data);}else{window.setTimeout(function(){request.send(config.data);},0);}
return request;},GET:function(config){config=OpenLayers.Util.extend(config,{method:&quot;GET&quot;});return OpenLayers.Request.issue(config);},POST:function(config){config=OpenLayers.Util.extend(config,{method:&quot;POST&quot;});config.headers=config.headers?config.headers:{};if(!(&quot;CONTENT-TYPE&quot;in OpenLayers.Util.upperCaseObject(config.headers))){config.headers[&quot;Content-Type&quot;]=&quot;application/xml&quot;;}
return OpenLayers.Request.issue(config);},PUT:function(config){config=OpenLayers.Util.extend(config,{method:&quot;PUT&quot;});config.headers=config.headers?config.headers:{};if(!(&quot;CONTENT-TYPE&quot;in OpenLayers.Util.upperCaseObject(config.headers))){config.headers[&quot;Content-Type&quot;]=&quot;application/xml&quot;;}
return OpenLayers.Request.issue(config);},DELETE:function(config){config=OpenLayers.Util.extend(config,{method:&quot;DELETE&quot;});return OpenLayers.Request.issue(config);},HEAD:function(config){config=OpenLayers.Util.extend(config,{method:&quot;HEAD&quot;});return OpenLayers.Request.issue(config);},OPTIONS:function(config){config=OpenLayers.Util.extend(config,{method:&quot;OPTIONS&quot;});return OpenLayers.Request.issue(config);}};OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,layerAlphaHack:null,isBackBuffer:false,lastRatio:1,isFirstDraw:true,backBufferTile:null,initialize:function(layer,position,bounds,url,size){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=url;this.frame=document.createElement(&apos;div&apos;);this.frame.style.overflow=&apos;hidden&apos;;this.frame.style.position=&apos;absolute&apos;;this.layerAlphaHack=this.layer.alpha&amp;&amp;OpenLayers.Util.alphaHack();},destroy:function(){if(this.imgDiv!=null){if(this.layerAlphaHack){OpenLayers.Event.stopObservingElement(this.imgDiv.childNodes[0].id);}
OpenLayers.Event.stopObservingElement(this.imgDiv.id);if(this.imgDiv.parentNode==this.frame){this.frame.removeChild(this.imgDiv);this.imgDiv.map=null;}
this.imgDiv.urls=null;this.imgDiv.src=OpenLayers.Util.getImagesLocation()+&quot;blank.gif&quot;;}
this.imgDiv=null;if((this.frame!=null)&amp;&amp;(this.frame.parentNode==this.layer.div)){this.layer.div.removeChild(this.frame);}
this.frame=null;if(this.backBufferTile){this.backBufferTile.destroy();this.backBufferTile=null;}
this.layer.events.unregister(&quot;loadend&quot;,this,this.resetBackBuffer);OpenLayers.Tile.prototype.destroy.apply(this,arguments);},clone:function(obj){if(obj==null){obj=new OpenLayers.Tile.Image(this.layer,this.position,this.bounds,this.url,this.size);}
obj=OpenLayers.Tile.prototype.clone.apply(this,[obj]);obj.imgDiv=null;return obj;},draw:function(){if(this.layer!=this.layer.map.baseLayer&amp;&amp;this.layer.reproject){this.bounds=this.getBoundsFromBaseLayer(this.position);}
var drawTile=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(OpenLayers.Util.indexOf(this.layer.SUPPORTED_TRANSITIONS,this.layer.transitionEffect)!=-1){if(drawTile){if(!this.backBufferTile){this.backBufferTile=this.clone();this.backBufferTile.hide();this.backBufferTile.isBackBuffer=true;this.events.register(&apos;loadend&apos;,this,this.resetBackBuffer);this.layer.events.register(&quot;loadend&quot;,this,this.resetBackBuffer);}
this.startTransition();}else{if(this.backBufferTile){this.backBufferTile.clear();}}}else{if(drawTile&amp;&amp;this.isFirstDraw){this.events.register(&apos;loadend&apos;,this,this.showTile);this.isFirstDraw=false;}}
if(!drawTile){return false;}
if(this.isLoading){this.events.triggerEvent(&quot;reload&quot;);}else{this.isLoading=true;this.events.triggerEvent(&quot;loadstart&quot;);}
return this.renderTile();},resetBackBuffer:function(){this.showTile();if(this.backBufferTile&amp;&amp;(this.isFirstDraw||!this.layer.numLoadingTiles)){this.isFirstDraw=false;var maxExtent=this.layer.maxExtent;var withinMaxExtent=(maxExtent&amp;&amp;this.bounds.intersectsBounds(maxExtent,false));if(withinMaxExtent){this.backBufferTile.position=this.position;this.backBufferTile.bounds=this.bounds;this.backBufferTile.size=this.size;this.backBufferTile.imageSize=this.layer.imageSize||this.size;this.backBufferTile.imageOffset=this.layer.imageOffset;this.backBufferTile.resolution=this.layer.getResolution();this.backBufferTile.renderTile();}
this.backBufferTile.hide();}},renderTile:function(){if(this.imgDiv==null){this.initImgDiv();}
this.imgDiv.viewRequestID=this.layer.map.viewRequestID;if(this.layer.async){this.layer.getURLasync(this.bounds,this,&quot;url&quot;,this.positionImage);}else{if(this.layer.url instanceof Array){this.imgDiv.urls=this.layer.url.slice();}
this.url=this.layer.getURL(this.bounds);this.positionImage();}
return true;},positionImage:function(){if(this.layer==null)
return;OpenLayers.Util.modifyDOMElement(this.frame,null,this.position,this.size);var imageSize=this.layer.getImageSize();if(this.layerAlphaHack){OpenLayers.Util.modifyAlphaImageDiv(this.imgDiv,null,null,imageSize,this.url);}else{OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,imageSize);this.imgDiv.src=this.url;}},clear:function(){if(this.imgDiv){this.hide();if(OpenLayers.Tile.Image.useBlankTile){this.imgDiv.src=OpenLayers.Util.getImagesLocation()+&quot;blank.gif&quot;;}}},initImgDiv:function(){var offset=this.layer.imageOffset;var size=this.layer.getImageSize();if(this.layerAlphaHack){this.imgDiv=OpenLayers.Util.createAlphaImageDiv(null,offset,size,null,&quot;relative&quot;,null,null,null,true);}else{this.imgDiv=OpenLayers.Util.createImage(null,offset,size,null,&quot;relative&quot;,null,null,true);}
this.imgDiv.className=&apos;olTileImage&apos;;this.frame.style.zIndex=this.isBackBuffer?0:1;this.frame.appendChild(this.imgDiv);this.layer.div.appendChild(this.frame);if(this.layer.opacity!=null){OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity);}
this.imgDiv.map=this.layer.map;var onload=function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent(&quot;loadend&quot;);}};if(this.layerAlphaHack){OpenLayers.Event.observe(this.imgDiv.childNodes[0],&apos;load&apos;,OpenLayers.Function.bind(onload,this));}else{OpenLayers.Event.observe(this.imgDiv,&apos;load&apos;,OpenLayers.Function.bind(onload,this));}
var onerror=function(){if(this.imgDiv._attempts&gt;OpenLayers.IMAGE_RELOAD_ATTEMPTS){onload.call(this);}};OpenLayers.Event.observe(this.imgDiv,&quot;error&quot;,OpenLayers.Function.bind(onerror,this));},checkImgURL:function(){if(this.layer){var loaded=this.layerAlphaHack?this.imgDiv.firstChild.src:this.imgDiv.src;if(!OpenLayers.Util.isEquivalentUrl(loaded,this.url)){this.hide();}}},startTransition:function(){if(!this.backBufferTile||!this.backBufferTile.imgDiv){return;}
var ratio=1;if(this.backBufferTile.resolution){ratio=this.backBufferTile.resolution/this.layer.getResolution();}
if(ratio!=this.lastRatio){if(this.layer.transitionEffect==&apos;resize&apos;){var upperLeft=new OpenLayers.LonLat(this.backBufferTile.bounds.left,this.backBufferTile.bounds.top);var size=new OpenLayers.Size(this.backBufferTile.size.w*ratio,this.backBufferTile.size.h*ratio);var px=this.layer.map.getLayerPxFromLonLat(upperLeft);OpenLayers.Util.modifyDOMElement(this.backBufferTile.frame,null,px,size);var imageSize=this.backBufferTile.imageSize;imageSize=new OpenLayers.Size(imageSize.w*ratio,imageSize.h*ratio);var imageOffset=this.backBufferTile.imageOffset;if(imageOffset){imageOffset=new OpenLayers.Pixel(imageOffset.x*ratio,imageOffset.y*ratio);}
OpenLayers.Util.modifyDOMElement(this.backBufferTile.imgDiv,null,imageOffset,imageSize);this.backBufferTile.show();}}else{if(this.layer.singleTile){this.backBufferTile.show();}else{this.backBufferTile.hide();}}
this.lastRatio=ratio;},show:function(){this.frame.style.display=&apos;&apos;;if(OpenLayers.Util.indexOf(this.layer.SUPPORTED_TRANSITIONS,this.layer.transitionEffect)!=-1){if(navigator.userAgent.toLowerCase().indexOf(&quot;gecko&quot;)!=-1){this.frame.scrollLeft=this.frame.scrollLeft;}}},hide:function(){this.frame.style.display=&apos;none&apos;;},CLASS_NAME:&quot;OpenLayers.Tile.Image&quot;});OpenLayers.Tile.Image.useBlankTile=(OpenLayers.Util.getBrowserName()==&quot;safari&quot;||OpenLayers.Util.getBrowserName()==&quot;opera&quot;);OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:new OpenLayers.Size(180,90),layers:null,minRectSize:15,minRectDisplayClass:&quot;RectReplacement&quot;,minRatio:8,maxRatio:32,mapOptions:null,autoPan:false,handlers:null,resolutionFactor:1,initialize:function(options){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[options]);},destroy:function(){if(!this.mapDiv){return;}
this.handlers.click.destroy();this.mapDiv.removeChild(this.extentRectangle);this.extentRectangle=null;this.rectEvents.destroy();this.rectEvents=null;this.ovmap.destroy();this.ovmap=null;this.element.removeChild(this.mapDiv);this.mapDiv=null;this.div.removeChild(this.element);this.element=null;if(this.maximizeDiv){OpenLayers.Event.stopObservingElement(this.maximizeDiv);this.div.removeChild(this.maximizeDiv);this.maximizeDiv=null;}
if(this.minimizeDiv){OpenLayers.Event.stopObservingElement(this.minimizeDiv);this.div.removeChild(this.minimizeDiv);this.minimizeDiv=null;}
this.map.events.un({&quot;moveend&quot;:this.update,&quot;changebaselayer&quot;:this.baseLayerDraw,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments);},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!(this.layers.length&gt;0)){if(this.map.baseLayer){var layer=this.map.baseLayer.clone();this.layers=[layer];}else{this.map.events.register(&quot;changebaselayer&quot;,this,this.baseLayerDraw);return this.div;}}
this.element=document.createElement(&apos;div&apos;);this.element.className=this.displayClass+&apos;Element&apos;;this.element.style.display=&apos;none&apos;;this.mapDiv=document.createElement(&apos;div&apos;);this.mapDiv.style.width=this.size.w+&apos;px&apos;;this.mapDiv.style.height=this.size.h+&apos;px&apos;;this.mapDiv.style.position=&apos;relative&apos;;this.mapDiv.style.overflow=&apos;hidden&apos;;this.mapDiv.id=OpenLayers.Util.createUniqueID(&apos;overviewMap&apos;);this.extentRectangle=document.createElement(&apos;div&apos;);this.extentRectangle.style.position=&apos;absolute&apos;;this.extentRectangle.style.zIndex=1000;this.extentRectangle.className=this.displayClass+&apos;ExtentRectangle&apos;;this.mapDiv.appendChild(this.extentRectangle);this.element.appendChild(this.mapDiv);this.div.appendChild(this.element);if(!this.outsideViewport){this.div.className+=&quot; &quot;+this.displayClass+&apos;Container&apos;;var imgLocation=OpenLayers.Util.getImagesLocation();var img=imgLocation+&apos;layer-switcher-maximize.png&apos;;this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+&apos;MaximizeButton&apos;,null,new OpenLayers.Size(18,18),img,&apos;absolute&apos;);this.maximizeDiv.style.display=&apos;none&apos;;this.maximizeDiv.className=this.displayClass+&apos;MaximizeButton&apos;;OpenLayers.Event.observe(this.maximizeDiv,&apos;click&apos;,OpenLayers.Function.bindAsEventListener(this.maximizeControl,this));this.div.appendChild(this.maximizeDiv);var img=imgLocation+&apos;layer-switcher-minimize.png&apos;;this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv(&apos;OpenLayers_Control_minimizeDiv&apos;,null,new OpenLayers.Size(18,18),img,&apos;absolute&apos;);this.minimizeDiv.style.display=&apos;none&apos;;this.minimizeDiv.className=this.displayClass+&apos;MinimizeButton&apos;;OpenLayers.Event.observe(this.minimizeDiv,&apos;click&apos;,OpenLayers.Function.bindAsEventListener(this.minimizeControl,this));this.div.appendChild(this.minimizeDiv);var eventsToStop=[&apos;dblclick&apos;,&apos;mousedown&apos;];for(var i=0,len=eventsToStop.length;i&lt;len;i++){OpenLayers.Event.observe(this.maximizeDiv,eventsToStop[i],OpenLayers.Event.stop);OpenLayers.Event.observe(this.minimizeDiv,eventsToStop[i],OpenLayers.Event.stop);}
this.minimizeControl();}else{this.element.style.display=&apos;&apos;;}
if(this.map.getExtent()){this.update();}
this.map.events.register(&apos;moveend&apos;,this,this.update);return this.div;},baseLayerDraw:function(){this.draw();this.map.events.unregister(&quot;changebaselayer&quot;,this,this.baseLayerDraw);},rectDrag:function(px){var deltaX=this.handlers.drag.last.x-px.x;var deltaY=this.handlers.drag.last.y-px.y;if(deltaX!=0||deltaY!=0){var rectTop=this.rectPxBounds.top;var rectLeft=this.rectPxBounds.left;var rectHeight=Math.abs(this.rectPxBounds.getHeight());var rectWidth=this.rectPxBounds.getWidth();var newTop=Math.max(0,(rectTop-deltaY));newTop=Math.min(newTop,this.ovmap.size.h-this.hComp-rectHeight);var newLeft=Math.max(0,(rectLeft-deltaX));newLeft=Math.min(newLeft,this.ovmap.size.w-this.wComp-rectWidth);this.setRectPxBounds(new OpenLayers.Bounds(newLeft,newTop+rectHeight,newLeft+rectWidth,newTop));}},mapDivClick:function(evt){var pxCenter=this.rectPxBounds.getCenterPixel();var deltaX=evt.xy.x-pxCenter.x;var deltaY=evt.xy.y-pxCenter.y;var top=this.rectPxBounds.top;var left=this.rectPxBounds.left;var height=Math.abs(this.rectPxBounds.getHeight());var width=this.rectPxBounds.getWidth();var newTop=Math.max(0,(top+deltaY));newTop=Math.min(newTop,this.ovmap.size.h-height);var newLeft=Math.max(0,(left+deltaX));newLeft=Math.min(newLeft,this.ovmap.size.w-width);this.setRectPxBounds(new OpenLayers.Bounds(newLeft,newTop+height,newLeft+width,newTop));this.updateMapToRect();},maximizeControl:function(e){this.element.style.display=&apos;&apos;;this.showToggle(false);if(e!=null){OpenLayers.Event.stop(e);}},minimizeControl:function(e){this.element.style.display=&apos;none&apos;;this.showToggle(true);if(e!=null){OpenLayers.Event.stop(e);}},showToggle:function(minimize){this.maximizeDiv.style.display=minimize?&apos;&apos;:&apos;none&apos;;this.minimizeDiv.style.display=minimize?&apos;none&apos;:&apos;&apos;;},update:function(){if(this.ovmap==null){this.createMap();}
if(this.autoPan||!this.isSuitableOverview()){this.updateOverview();}
this.updateRectToMap();},isSuitableOverview:function(){var mapExtent=this.map.getExtent();var maxExtent=this.map.maxExtent;var testExtent=new OpenLayers.Bounds(Math.max(mapExtent.left,maxExtent.left),Math.max(mapExtent.bottom,maxExtent.bottom),Math.min(mapExtent.right,maxExtent.right),Math.min(mapExtent.top,maxExtent.top));if(this.ovmap.getProjection()!=this.map.getProjection()){testExtent=testExtent.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject());}
var resRatio=this.ovmap.getResolution()/this.map.getResolution();return((resRatio&gt;this.minRatio)&amp;&amp;(resRatio&lt;=this.maxRatio)&amp;&amp;(this.ovmap.getExtent().containsBounds(testExtent)));},updateOverview:function(){var mapRes=this.map.getResolution();var targetRes=this.ovmap.getResolution();var resRatio=targetRes/mapRes;if(resRatio&gt;this.maxRatio){targetRes=this.minRatio*mapRes;}else if(resRatio&lt;=this.minRatio){targetRes=this.maxRatio*mapRes;}
var center;if(this.ovmap.getProjection()!=this.map.getProjection()){center=this.map.center.clone();center.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject());}else{center=this.map.center;}
this.ovmap.setCenter(center,this.ovmap.getZoomForResolution(targetRes*this.resolutionFactor));this.updateRectToMap();},createMap:function(){var options=OpenLayers.Util.extend({controls:[],maxResolution:&apos;auto&apos;,fallThrough:false},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,options);OpenLayers.Event.stopObserving(window,&apos;unload&apos;,this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,&apos;border-left-width&apos;))+
parseInt(OpenLayers.Element.getStyle(this.extentRectangle,&apos;border-right-width&apos;));this.wComp=(this.wComp)?this.wComp:2;this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,&apos;border-top-width&apos;))+
parseInt(OpenLayers.Element.getStyle(this.extentRectangle,&apos;border-bottom-width&apos;));this.hComp=(this.hComp)?this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{&quot;click&quot;:this.mapDivClick},{&quot;single&quot;:true,&quot;double&quot;:false,&quot;stopSingle&quot;:true,&quot;stopDouble&quot;:true,&quot;pixelTolerance&quot;:1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,true);this.rectEvents.register(&quot;mouseover&quot;,this,function(e){if(!this.handlers.drag.active&amp;&amp;!this.map.dragging){this.handlers.drag.activate();}});this.rectEvents.register(&quot;mouseout&quot;,this,function(e){if(!this.handlers.drag.dragging){this.handlers.drag.deactivate();}});if(this.ovmap.getProjection()!=this.map.getProjection()){var sourceUnits=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;var targetUnits=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=sourceUnits&amp;&amp;targetUnits?OpenLayers.INCHES_PER_UNIT[sourceUnits]/OpenLayers.INCHES_PER_UNIT[targetUnits]:1;}},updateRectToMap:function(){var bounds;if(this.ovmap.getProjection()!=this.map.getProjection()){bounds=this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject());}else{bounds=this.map.getExtent();}
var pxBounds=this.getRectBoundsFromMapBounds(bounds);if(pxBounds){this.setRectPxBounds(pxBounds);}},updateMapToRect:function(){var lonLatBounds=this.getMapBoundsFromRectBounds(this.rectPxBounds);if(this.ovmap.getProjection()!=this.map.getProjection()){lonLatBounds=lonLatBounds.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject());}
this.map.panTo(lonLatBounds.getCenterLonLat());},setRectPxBounds:function(pxBounds){var top=Math.max(pxBounds.top,0);var left=Math.max(pxBounds.left,0);var bottom=Math.min(pxBounds.top+Math.abs(pxBounds.getHeight()),this.ovmap.size.h-this.hComp);var right=Math.min(pxBounds.left+pxBounds.getWidth(),this.ovmap.size.w-this.wComp);var width=Math.max(right-left,0);var height=Math.max(bottom-top,0);if(width&lt;this.minRectSize||height&lt;this.minRectSize){this.extentRectangle.className=this.displayClass+
this.minRectDisplayClass;var rLeft=left+(width/2)-(this.minRectSize/2);var rTop=top+(height/2)-(this.minRectSize/2);this.extentRectangle.style.top=Math.round(rTop)+&apos;px&apos;;this.extentRectangle.style.left=Math.round(rLeft)+&apos;px&apos;;this.extentRectangle.style.height=this.minRectSize+&apos;px&apos;;this.extentRectangle.style.width=this.minRectSize+&apos;px&apos;;}else{this.extentRectangle.className=this.displayClass+&apos;ExtentRectangle&apos;;this.extentRectangle.style.top=Math.round(top)+&apos;px&apos;;this.extentRectangle.style.left=Math.round(left)+&apos;px&apos;;this.extentRectangle.style.height=Math.round(height)+&apos;px&apos;;this.extentRectangle.style.width=Math.round(width)+&apos;px&apos;;}
this.rectPxBounds=new OpenLayers.Bounds(Math.round(left),Math.round(bottom),Math.round(right),Math.round(top));},getRectBoundsFromMapBounds:function(lonLatBounds){var leftBottomLonLat=new OpenLayers.LonLat(lonLatBounds.left,lonLatBounds.bottom);var rightTopLonLat=new OpenLayers.LonLat(lonLatBounds.right,lonLatBounds.top);var leftBottomPx=this.getOverviewPxFromLonLat(leftBottomLonLat);var rightTopPx=this.getOverviewPxFromLonLat(rightTopLonLat);var bounds=null;if(leftBottomPx&amp;&amp;rightTopPx){bounds=new OpenLayers.Bounds(leftBottomPx.x,leftBottomPx.y,rightTopPx.x,rightTopPx.y);}
return bounds;},getMapBoundsFromRectBounds:function(pxBounds){var leftBottomPx=new OpenLayers.Pixel(pxBounds.left,pxBounds.bottom);var rightTopPx=new OpenLayers.Pixel(pxBounds.right,pxBounds.top);var leftBottomLonLat=this.getLonLatFromOverviewPx(leftBottomPx);var rightTopLonLat=this.getLonLatFromOverviewPx(rightTopPx);return new OpenLayers.Bounds(leftBottomLonLat.lon,leftBottomLonLat.lat,rightTopLonLat.lon,rightTopLonLat.lat);},getLonLatFromOverviewPx:function(overviewMapPx){var size=this.ovmap.size;var res=this.ovmap.getResolution();var center=this.ovmap.getExtent().getCenterLonLat();var delta_x=overviewMapPx.x-(size.w/2);var delta_y=overviewMapPx.y-(size.h/2);return new OpenLayers.LonLat(center.lon+delta_x*res,center.lat-delta_y*res);},getOverviewPxFromLonLat:function(lonlat){var res=this.ovmap.getResolution();var extent=this.ovmap.getExtent();var px=null;if(extent){px=new OpenLayers.Pixel(Math.round(1/res*(lonlat.lon-extent.left)),Math.round(1/res*(extent.top-lonlat.lat)));}
return px;},CLASS_NAME:&apos;OpenLayers.Control.OverviewMap&apos;});OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:OpenLayers.Popup.AnchoredBubble,popup:null,initialize:function(layer,lonlat,data){this.layer=layer;this.lonlat=lonlat;this.data=(data!=null)?data:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+&quot;_&quot;);},destroy:function(){if((this.layer!=null)&amp;&amp;(this.layer.map!=null)){if(this.popup!=null){this.layer.map.removePopup(this.popup);}}
this.layer=null;this.id=null;this.lonlat=null;this.data=null;if(this.marker!=null){this.destroyMarker(this.marker);this.marker=null;}
if(this.popup!=null){this.destroyPopup(this.popup);this.popup=null;}},onScreen:function(){var onScreen=false;if((this.layer!=null)&amp;&amp;(this.layer.map!=null)){var screenBounds=this.layer.map.getExtent();onScreen=screenBounds.containsLonLat(this.lonlat);}
return onScreen;},createMarker:function(){if(this.lonlat!=null){this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon);}
return this.marker;},destroyMarker:function(){this.marker.destroy();},createPopup:function(closeBox){if(this.lonlat!=null){var id=this.id+&quot;_popup&quot;;var anchor=(this.marker)?this.marker.icon:null;if(!this.popup){this.popup=new this.popupClass(id,this.lonlat,this.data.popupSize,this.data.popupContentHTML,anchor,closeBox);}
if(this.data.overflow!=null){this.popup.contentDiv.style.overflow=this.data.overflow;}
this.popup.feature=this;}
return this.popup;},destroyPopup:function(){if(this.popup){this.popup.feature=null;this.popup.destroy();this.popup=null;}},CLASS_NAME:&quot;OpenLayers.Feature&quot;});OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:&quot;1.1.0&quot;,version:null,initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);this.options=options;},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var root=data.documentElement;var version=this.version;if(!version){version=root.getAttribute(&quot;version&quot;);if(!version){version=this.defaultVersion;}}
var constr=OpenLayers.Format.WFSCapabilities[&quot;v&quot;+version.replace(/\./g,&quot;_&quot;)];if(!constr){throw&quot;Can&apos;t find a WFS capabilities parser for version &quot;+version;}
var parser=new constr(this.options);var capabilities=parser.read(data);capabilities.version=version;return capabilities;},CLASS_NAME:&quot;OpenLayers.Format.WFSCapabilities&quot;});OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xsd:&quot;http://www.w3.org/2001/XMLSchema&quot;},initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},readers:{&quot;xsd&quot;:{&quot;schema&quot;:function(node,obj){var complexTypes=[];var customTypes={};var schema={complexTypes:complexTypes,customTypes:customTypes};this.readChildNodes(node,schema);var attributes=node.attributes;var attr,name;for(var i=0,len=attributes.length;i&lt;len;++i){attr=attributes[i];name=attr.name;if(name.indexOf(&quot;xmlns&quot;)==0){this.setNamespace(name.split(&quot;:&quot;)[1]||&quot;&quot;,attr.value);}else{obj[name]=attr.value;}}
obj.featureTypes=complexTypes;obj.targetPrefix=this.namespaceAlias[obj.targetNamespace];var complexType,customType;for(var i=0,len=complexTypes.length;i&lt;len;++i){complexType=complexTypes[i];customType=customTypes[complexType.typeName];if(customTypes[complexType.typeName]){complexType.typeName=customType.name;}}},&quot;complexType&quot;:function(node,obj){var complexType={&quot;typeName&quot;:node.getAttribute(&quot;name&quot;)};this.readChildNodes(node,complexType);obj.complexTypes.push(complexType);},&quot;complexContent&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;extension&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;sequence&quot;:function(node,obj){var sequence={elements:[]};this.readChildNodes(node,sequence);obj.properties=sequence.elements;},&quot;element&quot;:function(node,obj){if(obj.elements){var element={};var attributes=node.attributes;var attr;for(var i=0,len=attributes.length;i&lt;len;++i){attr=attributes[i];element[attr.name]=attr.value;}
var type=element.type;if(!type){type={};this.readChildNodes(node,type);element.restriction=type;element.type=type.base;}
var fullType=type.base||type;element.localType=fullType.split(&quot;:&quot;).pop();obj.elements.push(element);}
if(obj.complexTypes){var type=node.getAttribute(&quot;type&quot;);var localType=type.split(&quot;:&quot;).pop();obj.customTypes[localType]={&quot;name&quot;:node.getAttribute(&quot;name&quot;),&quot;type&quot;:type};}},&quot;simpleType&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;restriction&quot;:function(node,obj){obj.base=node.getAttribute(&quot;base&quot;);this.readRestriction(node,obj);}}},readRestriction:function(node,obj){var children=node.childNodes;var child,nodeName,value;for(var i=0,len=children.length;i&lt;len;++i){child=children[i];if(child.nodeType==1){nodeName=child.nodeName.split(&quot;:&quot;).pop();value=child.getAttribute(&quot;value&quot;);if(!obj[nodeName]){obj[nodeName]=value;}else{if(typeof obj[nodeName]==&quot;string&quot;){obj[nodeName]=[obj[nodeName]];}
obj[nodeName].push(value);}}}},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
if(data&amp;&amp;data.nodeType==9){data=data.documentElement;}
var schema={};this.readNode(data,schema);return schema;},CLASS_NAME:&quot;OpenLayers.Format.WFSDescribeFeatureType&quot;});OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:&quot;http://www.w3.org/1999/xlink&quot;,xsi:&quot;http://www.w3.org/2001/XMLSchema-instance&quot;,wfs:&quot;http://www.opengis.net/wfs&quot;,gml:&quot;http://www.opengis.net/gml&quot;,ogc:&quot;http://www.opengis.net/ogc&quot;},defaultPrefix:&quot;wfs&quot;,version:null,schemaLocations:null,srsName:null,extractAttributes:true,xy:true,stateName:null,initialize:function(options){this.stateName={};this.stateName[OpenLayers.State.INSERT]=&quot;wfs:Insert&quot;;this.stateName[OpenLayers.State.UPDATE]=&quot;wfs:Update&quot;;this.stateName[OpenLayers.State.DELETE]=&quot;wfs:Delete&quot;;OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},getSrsName:function(feature,options){var srsName=options&amp;&amp;options.srsName;if(!srsName){if(feature&amp;&amp;feature.layer){srsName=feature.layer.projection.getCode();}else{srsName=this.srsName;}}
return srsName;},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
if(data&amp;&amp;data.nodeType==9){data=data.documentElement;}
var obj={};this.readNode(data,obj);if(obj.features){obj=obj.features;}
return obj;},readers:{&quot;wfs&quot;:{&quot;FeatureCollection&quot;:function(node,obj){obj.features=[];this.readChildNodes(node,obj);}}},write:function(features){var node=this.writeNode(&quot;wfs:Transaction&quot;,features);var value=this.schemaLocationAttr();if(value){this.setAttributeNS(node,this.namespaces[&quot;xsi&quot;],&quot;xsi:schemaLocation&quot;,value)}
return OpenLayers.Format.XML.prototype.write.apply(this,[node]);},writers:{&quot;wfs&quot;:{&quot;GetFeature&quot;:function(options){var node=this.createElementNSPlus(&quot;wfs:GetFeature&quot;,{attributes:{service:&quot;WFS&quot;,version:this.version,maxFeatures:options&amp;&amp;options.maxFeatures,&quot;xsi:schemaLocation&quot;:this.schemaLocationAttr(options)}});this.writeNode(&quot;Query&quot;,options,node);return node;},&quot;Query&quot;:function(options){options=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},options);var node=this.createElementNSPlus(&quot;wfs:Query&quot;,{attributes:{typeName:(options.featureNS?options.featurePrefix+&quot;:&quot;:&quot;&quot;)+
options.featureType,srsName:options.srsName}});if(options.featureNS){node.setAttribute(&quot;xmlns:&quot;+options.featurePrefix,options.featureNS);}
if(options.filter){this.setFilterProperty(options.filter);this.writeNode(&quot;ogc:Filter&quot;,options.filter,node);}
return node;},&quot;Transaction&quot;:function(features){var node=this.createElementNSPlus(&quot;wfs:Transaction&quot;,{attributes:{service:&quot;WFS&quot;,version:this.version}});if(features){var name,feature;for(var i=0,len=features.length;i&lt;len;++i){feature=features[i];name=this.stateName[feature.state];if(name){this.writeNode(name,feature,node);}}}
return node;},&quot;Insert&quot;:function(feature){var node=this.createElementNSPlus(&quot;wfs:Insert&quot;);this.srsName=this.getSrsName(feature);this.writeNode(&quot;feature:_typeName&quot;,feature,node);return node;},&quot;Update&quot;:function(feature){var node=this.createElementNSPlus(&quot;wfs:Update&quot;,{attributes:{typeName:(this.featureNS?this.featurePrefix+&quot;:&quot;:&quot;&quot;)+
this.featureType}});if(this.featureNS){node.setAttribute(&quot;xmlns:&quot;+this.featurePrefix,this.featureNS);}
this.writeNode(&quot;Property&quot;,{name:this.geometryName,value:feature},node);for(var key in feature.attributes){this.writeNode(&quot;Property&quot;,{name:key,value:feature.attributes[key]},node);}
this.writeNode(&quot;ogc:Filter&quot;,new OpenLayers.Filter.FeatureId({fids:[feature.fid]}),node);return node;},&quot;Property&quot;:function(obj){var node=this.createElementNSPlus(&quot;wfs:Property&quot;);this.writeNode(&quot;Name&quot;,obj.name,node);this.writeNode(&quot;Value&quot;,obj.value,node);return node;},&quot;Name&quot;:function(name){return this.createElementNSPlus(&quot;wfs:Name&quot;,{value:name});},&quot;Value&quot;:function(obj){var node;if(obj instanceof OpenLayers.Feature.Vector){node=this.createElementNSPlus(&quot;wfs:Value&quot;);this.srsName=this.getSrsName(obj);var geom=this.writeNode(&quot;feature:_geometry&quot;,obj.geometry).firstChild;node.appendChild(geom);}else{node=this.createElementNSPlus(&quot;wfs:Value&quot;,{value:obj});}
return node;},&quot;Delete&quot;:function(feature){var node=this.createElementNSPlus(&quot;wfs:Delete&quot;,{attributes:{typeName:(this.featureNS?this.featurePrefix+&quot;:&quot;:&quot;&quot;)+
this.featureType}});if(this.featureNS){node.setAttribute(&quot;xmlns:&quot;+this.featurePrefix,this.featureNS);}
this.writeNode(&quot;ogc:Filter&quot;,new OpenLayers.Filter.FeatureId({fids:[feature.fid]}),node);return node;}}},schemaLocationAttr:function(options){options=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},options);var schemaLocations=OpenLayers.Util.extend({},this.schemaLocations);if(options.schema){schemaLocations[options.featurePrefix]=options.schema;}
var parts=[];var uri;for(var key in schemaLocations){uri=this.namespaces[key];if(uri){parts.push(uri+&quot; &quot;+schemaLocations[key]);}}
var value=parts.join(&quot; &quot;)||undefined;return value;},setFilterProperty:function(filter){if(filter.filters){for(var i=0,len=filter.filters.length;i&lt;len;++i){this.setFilterProperty(filter.filters[i]);}}else{if(filter instanceof OpenLayers.Filter.Spatial){filter.property=this.geometryName;}}},CLASS_NAME:&quot;OpenLayers.Format.WFST.v1&quot;});OpenLayers.Format.WMC=OpenLayers.Class({defaultVersion:&quot;1.1.0&quot;,version:null,layerOptions:null,layerParams:null,parser:null,initialize:function(options){OpenLayers.Util.extend(this,options);this.options=options;},read:function(data,options){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var root=data.documentElement;var version=this.version;if(!version){version=root.getAttribute(&quot;version&quot;);if(!version){version=this.defaultVersion;}}
if(!this.parser||this.parser.VERSION!=version){var format=OpenLayers.Format.WMC[&quot;v&quot;+version.replace(/\./g,&quot;_&quot;)];if(!format){throw&quot;Can&apos;t find a WMC parser for version &quot;+
version;}
this.parser=new format(this.options);}
var context=this.parser.read(data,options);var map;if(options.map){this.context=context;if(options.map instanceof OpenLayers.Map){map=this.mergeContextToMap(context,options.map);}else{map=this.contextToMap(context,options.map);}}else{map=context;}
return map;},contextToMap:function(context,id){var map=new OpenLayers.Map(id,{maxExtent:context.maxExtent,projection:context.projection});map.addLayers(context.layers);map.setCenter(context.bounds.getCenterLonLat(),map.getZoomForExtent(context.bounds,true));return map;},mergeContextToMap:function(context,map){map.addLayers(context.layers);return map;},write:function(obj,options){if(obj.CLASS_NAME==&quot;OpenLayers.Map&quot;){obj=this.mapToContext(obj);}
var version=(options&amp;&amp;options.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=version){var format=OpenLayers.Format.WMC[&quot;v&quot;+version.replace(/\./g,&quot;_&quot;)];if(!format){throw&quot;Can&apos;t find a WMS capabilities parser for version &quot;+
version;}
this.parser=new format(this.options);}
var wmc=this.parser.write(obj,options);return wmc;},mapToContext:function(map){var context={bounds:map.getExtent(),maxExtent:map.maxExtent,projection:map.projection,layers:map.layers,size:map.getSize()};return context;},CLASS_NAME:&quot;OpenLayers.Format.WMC&quot;});OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.XML,{initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);this.options=options;},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var capabilities={};var root=data.documentElement;this.runChildNodes(capabilities,root);return capabilities;},runChildNodes:function(obj,node){var children=node.childNodes;var childNode,processor;for(var i=0;i&lt;children.length;++i){childNode=children[i];if(childNode.nodeType==1){processor=this[&quot;read_cap_&quot;+childNode.nodeName];if(processor){processor.apply(this,[obj,childNode]);}}}},read_cap_Capability:function(capabilities,node){var capability={layers:[]};this.runChildNodes(capability,node);capabilities.capability=capability;},read_cap_Request:function(obj,node){var request={};this.runChildNodes(request,node);obj.request=request;},read_cap_GetMap:function(request,node){var getmap={formats:[]};this.runChildNodes(getmap,node);request.getmap=getmap;},read_cap_Format:function(obj,node){if(obj.formats){obj.formats.push(this.getChildValue(node));}},read_cap_DCPType:function(obj,node){var children=node.getElementsByTagName(&quot;OnlineResource&quot;);if(children.length&gt;0){this.read_cap_OnlineResource(obj,children[0]);}},read_cap_Service:function(capabilities,node){var service={};this.runChildNodes(service,node);capabilities.service=service;},read_cap_Layer:function(capability,node,parentLayer){var layer={formats:capability.request.getmap.formats||[],styles:[],queryable:(node.getAttribute(&quot;queryable&quot;)===&quot;1&quot;||node.getAttribute(&quot;queryable&quot;)===&quot;true&quot;)};if(parentLayer){layer.styles=layer.styles.concat(parentLayer.styles);layer.llbbox=parentLayer.llbbox;layer.minScale=parentLayer.minScale;layer.maxScale=parentLayer.maxScale;}
var children=node.childNodes;var childNode,nodeName,processor;for(var i=0;i&lt;children.length;++i){childNode=children[i];nodeName=childNode.nodeName;processor=this[&quot;read_cap_&quot;+childNode.nodeName];if(processor){if(nodeName==&quot;Layer&quot;){processor.apply(this,[capability,childNode,layer]);}else{processor.apply(this,[layer,childNode]);}}}
if(layer.name){var index=layer.name.indexOf(&quot;:&quot;);if(index&gt;0){layer.prefix=layer.name.substring(0,index);}
capability.layers.push(layer);}},read_cap_ScaleHint:function(layer,node){var min=node.getAttribute(&quot;min&quot;);var max=node.getAttribute(&quot;max&quot;);var rad2=Math.pow(2,0.5);var ipm=OpenLayers.INCHES_PER_UNIT[&quot;m&quot;];layer.maxScale=parseFloat(((rad2*min)*ipm*OpenLayers.DOTS_PER_INCH).toPrecision(13));layer.minScale=parseFloat(((rad2*max)*ipm*OpenLayers.DOTS_PER_INCH).toPrecision(13));},read_cap_Name:function(obj,node){var name=this.getChildValue(node);if(name){obj.name=name;}},read_cap_Title:function(obj,node){var title=this.getChildValue(node);if(title){obj.title=title;}},read_cap_Abstract:function(obj,node){var abst=this.getChildValue(node);if(abst){obj[&quot;abstract&quot;]=abst;}},read_cap_LatLonBoundingBox:function(layer,node){layer.llbbox=[parseFloat(node.getAttribute(&quot;minx&quot;)),parseFloat(node.getAttribute(&quot;miny&quot;)),parseFloat(node.getAttribute(&quot;maxx&quot;)),parseFloat(node.getAttribute(&quot;maxy&quot;))];},read_cap_Style:function(layer,node){var style={};this.runChildNodes(style,node);layer.styles.push(style);},read_cap_LegendURL:function(style,node){var legend={width:node.getAttribute(&apos;width&apos;),height:node.getAttribute(&apos;height&apos;)};var links=node.getElementsByTagName(&quot;OnlineResource&quot;);if(links.length&gt;0){this.read_cap_OnlineResource(legend,links[0]);}
style.legend=legend;},read_cap_OnlineResource:function(obj,node){obj.href=this.getAttributeNS(node,&quot;http://www.w3.org/1999/xlink&quot;,&quot;href&quot;);},CLASS_NAME:&quot;OpenLayers.Format.WMSCapabilities.v1_1&quot;});OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:&quot;1.1.1&quot;,version:null,initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);this.options=options;},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var root=data.documentElement;var version=this.version;if(!version){version=root.getAttribute(&quot;version&quot;);if(!version){version=this.defaultVersion;}}
if(version==&quot;1.1.1&quot;||version==&quot;1.1.0&quot;){version=&quot;1.1&quot;;}
var constructor=OpenLayers.Format.WMSDescribeLayer[&quot;v&quot;+version.replace(/\./g,&quot;_&quot;)];if(!constructor){throw&quot;Can&apos;t find a WMS DescribeLayer parser for version &quot;+
version;}
var parser=new constructor(this.options);var describelayer=parser.read(data);describelayer.version=version;return describelayer;},CLASS_NAME:&quot;OpenLayers.Format.WMSDescribeLayer&quot;});OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:&apos;_layer&apos;,featureIdentifier:&apos;_feature&apos;,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},gmlFormat:null,initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,arguments);OpenLayers.Util.extend(this,options);this.options=options;},read:function(data){var result;if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var root=data.documentElement;if(root){var scope=this;var read=this[&quot;read_&quot;+root.nodeName];if(read){result=read.call(this,root);}else{result=new OpenLayers.Format.GML((this.options?this.options:{})).read(data);}}else{result=data;}
return result;},read_msGMLOutput:function(data){var response=[];var layerNodes=this.getSiblingNodesByTagCriteria(data,this.layerIdentifier);if(layerNodes){for(var i=0,len=layerNodes.length;i&lt;len;++i){var node=layerNodes[i];var layerName=node.nodeName;if(node.prefix){layerName=layerName.split(&apos;:&apos;)[1];}
var layerName=layerName.replace(this.layerIdentifier,&apos;&apos;);var featureNodes=this.getSiblingNodesByTagCriteria(node,this.featureIdentifier);if(featureNodes){for(var j=0;j&lt;featureNodes.length;j++){var featureNode=featureNodes[j];var geom=this.parseGeometry(featureNode);var attributes=this.parseAttributes(featureNode);var feature=new OpenLayers.Feature.Vector(geom,attributes,null);feature.type=layerName;response.push(feature);}}}}
return response;},read_FeatureInfoResponse:function(data){var response=[];var featureNodes=this.getElementsByTagNameNS(data,&apos;*&apos;,&apos;FIELDS&apos;);for(var i=0,len=featureNodes.length;i&lt;len;i++){var featureNode=featureNodes[i];var geom=null;var attributes={};for(var j=0,jlen=featureNode.attributes.length;j&lt;jlen;j++){var attribute=featureNode.attributes[j];attributes[attribute.nodeName]=attribute.nodeValue;}
response.push(new OpenLayers.Feature.Vector(geom,attributes,null));}
return response;},getSiblingNodesByTagCriteria:function(node,criteria){var nodes=[];var children,tagName,n,matchNodes,child;if(node&amp;&amp;node.hasChildNodes()){children=node.childNodes;n=children.length;for(var k=0;k&lt;n;k++){child=children[k];while(child&amp;&amp;child.nodeType!=1){child=child.nextSibling;k++;}
tagName=(child?child.nodeName:&apos;&apos;);if(tagName.length&gt;0&amp;&amp;tagName.indexOf(criteria)&gt;-1){nodes.push(child);}else{matchNodes=this.getSiblingNodesByTagCriteria(child,criteria);if(matchNodes.length&gt;0){(nodes.length==0)?nodes=matchNodes:nodes.push(matchNodes);}}}}
return nodes;},parseAttributes:function(node){var attributes={};if(node.nodeType==1){var children=node.childNodes;n=children.length;for(var i=0;i&lt;n;++i){var child=children[i];if(child.nodeType==1){var grandchildren=child.childNodes;if(grandchildren.length==1){var grandchild=grandchildren[0];if(grandchild.nodeType==3||grandchild.nodeType==4){var name=(child.prefix)?child.nodeName.split(&quot;:&quot;)[1]:child.nodeName;var value=grandchild.nodeValue.replace(this.regExes.trimSpace,&quot;&quot;);attributes[name]=value;}}}}}
return attributes;},parseGeometry:function(node){if(!this.gmlFormat){this.gmlFormat=new OpenLayers.Format.GML();}
var feature=this.gmlFormat.parseFeature(node);var geometry=null;if(feature&amp;&amp;feature.geometry){geometry=feature.geometry.clone();feature.destroy();}
return geometry;},CLASS_NAME:&quot;OpenLayers.Format.WMSGetFeatureInfo&quot;});OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:true,&apos;double&apos;:false,pixelTolerance:0,stopSingle:false,stopDouble:false,timerId:null,down:null,rightclickTimerId:null,initialize:function(control,callbacks,options){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(this.pixelTolerance!=null){this.mousedown=function(evt){this.down=evt.xy;return true;};}},mousedown:null,mouseup:function(evt){var propagate=true;if(this.checkModifiers(evt)&amp;&amp;this.control.handleRightClicks&amp;&amp;OpenLayers.Event.isRightClick(evt)){propagate=this.rightclick(evt);}
return propagate;},rightclick:function(evt){if(this.passesTolerance(evt)){if(this.rightclickTimerId!=null){this.clearTimer();this.callback(&apos;dblrightclick&apos;,[evt]);return!this.stopDouble;}else{var clickEvent=this[&apos;double&apos;]?OpenLayers.Util.extend({},evt):this.callback(&apos;rightclick&apos;,[evt]);var delayedRightCall=OpenLayers.Function.bind(this.delayedRightCall,this,clickEvent);this.rightclickTimerId=window.setTimeout(delayedRightCall,this.delay);}}
return!this.stopSingle;},delayedRightCall:function(evt){this.rightclickTimerId=null;if(evt){this.callback(&apos;rightclick&apos;,[evt]);}
return!this.stopSingle;},dblclick:function(evt){if(this.passesTolerance(evt)){if(this[&quot;double&quot;]){this.callback(&apos;dblclick&apos;,[evt]);}
this.clearTimer();}
return!this.stopDouble;},click:function(evt){if(this.passesTolerance(evt)){if(this.timerId!=null){this.clearTimer();}else{var clickEvent=this.single?OpenLayers.Util.extend({},evt):null;this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,clickEvent),this.delay);}}
return!this.stopSingle;},passesTolerance:function(evt){var passes=true;if(this.pixelTolerance!=null&amp;&amp;this.down){var dpx=Math.sqrt(Math.pow(this.down.x-evt.xy.x,2)+
Math.pow(this.down.y-evt.xy.y,2));if(dpx&gt;this.pixelTolerance){passes=false;}}
return passes;},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null;}
if(this.rightclickTimerId!=null){window.clearTimeout(this.rightclickTimerId);this.rightclickTimerId=null;}},delayedCall:function(evt){this.timerId=null;if(evt){this.callback(&apos;click&apos;,[evt]);}},deactivate:function(){var deactivated=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();this.down=null;deactivated=true;}
return deactivated;},CLASS_NAME:&quot;OpenLayers.Handler.Click&quot;});OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:false,stopDown:true,dragging:false,last:null,start:null,oldOnselectstart:null,interval:0,timeoutId:null,initialize:function(control,callbacks,options){OpenLayers.Handler.prototype.initialize.apply(this,arguments);},down:function(evt){},move:function(evt){},up:function(evt){},out:function(evt){},mousedown:function(evt){var propagate=true;this.dragging=false;if(this.checkModifiers(evt)&amp;&amp;OpenLayers.Event.isLeftClick(evt)){this.started=true;this.start=evt.xy;this.last=evt.xy;OpenLayers.Element.addClass(this.map.viewPortDiv,&quot;olDragDown&quot;);this.down(evt);this.callback(&quot;down&quot;,[evt.xy]);OpenLayers.Event.stop(evt);if(!this.oldOnselectstart){this.oldOnselectstart=(document.onselectstart)?document.onselectstart:function(){return true;};document.onselectstart=function(){return false;};}
propagate=!this.stopDown;}else{this.started=false;this.start=null;this.last=null;}
return propagate;},mousemove:function(evt){if(this.started&amp;&amp;!this.timeoutId&amp;&amp;(evt.xy.x!=this.last.x||evt.xy.y!=this.last.y)){if(this.interval&gt;0){this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval);}
this.dragging=true;this.move(evt);this.callback(&quot;move&quot;,[evt.xy]);if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart;document.onselectstart=function(){return false;};}
this.last=this.evt.xy;}
return true;},removeTimeout:function(){this.timeoutId=null;},mouseup:function(evt){if(this.started){var dragged=(this.start!=this.last);this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,&quot;olDragDown&quot;);this.up(evt);this.callback(&quot;up&quot;,[evt.xy]);if(dragged){this.callback(&quot;done&quot;,[evt.xy]);}
document.onselectstart=this.oldOnselectstart;}
return true;},mouseout:function(evt){if(this.started&amp;&amp;OpenLayers.Util.mouseLeft(evt,this.map.div)){var dragged=(this.start!=this.last);this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,&quot;olDragDown&quot;);this.out(evt);this.callback(&quot;out&quot;,[]);if(dragged){this.callback(&quot;done&quot;,[evt.xy]);}
if(document.onselectstart){document.onselectstart=this.oldOnselectstart;}}
return true;},click:function(evt){return(this.start==this.last);},activate:function(){var activated=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragging=false;activated=true;}
return activated;},deactivate:function(){var deactivated=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.started=false;this.dragging=false;this.start=null;this.last=null;deactivated=true;OpenLayers.Element.removeClass(this.map.viewPortDiv,&quot;olDragDown&quot;);}
return deactivated;},CLASS_NAME:&quot;OpenLayers.Handler.Drag&quot;});OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{&apos;click&apos;:{&apos;in&apos;:&apos;click&apos;,&apos;out&apos;:&apos;clickout&apos;},&apos;mousemove&apos;:{&apos;in&apos;:&apos;over&apos;,&apos;out&apos;:&apos;out&apos;},&apos;dblclick&apos;:{&apos;in&apos;:&apos;dblclick&apos;,&apos;out&apos;:null},&apos;mousedown&apos;:{&apos;in&apos;:null,&apos;out&apos;:null},&apos;mouseup&apos;:{&apos;in&apos;:null,&apos;out&apos;:null}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:true,stopDown:true,stopUp:false,initialize:function(control,layer,callbacks,options){OpenLayers.Handler.prototype.initialize.apply(this,[control,callbacks,options]);this.layer=layer;},mousedown:function(evt){this.down=evt.xy;return this.handle(evt)?!this.stopDown:true;},mouseup:function(evt){this.up=evt.xy;return this.handle(evt)?!this.stopUp:true;},click:function(evt){return this.handle(evt)?!this.stopClick:true;},mousemove:function(evt){if(!this.callbacks[&apos;over&apos;]&amp;&amp;!this.callbacks[&apos;out&apos;]){return true;}
this.handle(evt);return true;},dblclick:function(evt){return!this.handle(evt);},geometryTypeMatches:function(feature){return this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,feature.geometry.CLASS_NAME)&gt;-1;},handle:function(evt){if(this.feature&amp;&amp;!this.feature.layer){this.feature=null;}
var type=evt.type;var handled=false;var previouslyIn=!!(this.feature);var click=(type==&quot;click&quot;||type==&quot;dblclick&quot;);this.feature=this.layer.getFeatureFromEvent(evt);if(this.feature&amp;&amp;!this.feature.layer){this.feature=null;}
if(this.lastFeature&amp;&amp;!this.lastFeature.layer){this.lastFeature=null;}
if(this.feature){var inNew=(this.feature!=this.lastFeature);if(this.geometryTypeMatches(this.feature)){if(previouslyIn&amp;&amp;inNew){if(this.lastFeature){this.triggerCallback(type,&apos;out&apos;,[this.lastFeature]);}
this.triggerCallback(type,&apos;in&apos;,[this.feature]);}else if(!previouslyIn||click){this.triggerCallback(type,&apos;in&apos;,[this.feature]);}
this.lastFeature=this.feature;handled=true;}else{if(this.lastFeature&amp;&amp;(previouslyIn&amp;&amp;inNew||click)){this.triggerCallback(type,&apos;out&apos;,[this.lastFeature]);}
this.feature=null;}}else{if(this.lastFeature&amp;&amp;(previouslyIn||click)){this.triggerCallback(type,&apos;out&apos;,[this.lastFeature]);}}
return handled;},triggerCallback:function(type,mode,args){var key=this.EVENTMAP[type][mode];if(key){if(type==&apos;click&apos;&amp;&amp;this.up&amp;&amp;this.down){var dpx=Math.sqrt(Math.pow(this.up.x-this.down.x,2)+
Math.pow(this.up.y-this.down.y,2));if(dpx&lt;=this.clickTolerance){this.callback(key,args);}}else{this.callback(key,args);}}},activate:function(){var activated=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.moveLayerToTop();this.map.events.on({&quot;removelayer&quot;:this.handleMapEvents,&quot;changelayer&quot;:this.handleMapEvents,scope:this});activated=true;}
return activated;},deactivate:function(){var deactivated=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.moveLayerBack();this.feature=null;this.lastFeature=null;this.down=null;this.up=null;this.map.events.un({&quot;removelayer&quot;:this.handleMapEvents,&quot;changelayer&quot;:this.handleMapEvents,scope:this});deactivated=true;}
return deactivated;},handleMapEvents:function(evt){if(!evt.property||evt.property==&quot;order&quot;){this.moveLayerToTop();}},moveLayerToTop:function(){var index=Math.max(this.map.Z_INDEX_BASE[&apos;Feature&apos;]-1,this.layer.getZIndex())+1;this.layer.setZIndex(index);},moveLayerBack:function(){var index=this.layer.getZIndex()-1;if(index&gt;=this.map.Z_INDEX_BASE[&apos;Feature&apos;]){this.layer.setZIndex(index);}else{this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer));}},CLASS_NAME:&quot;OpenLayers.Handler.Feature&quot;});OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:false,px:null,timerId:null,initialize:function(control,callbacks,options){OpenLayers.Handler.prototype.initialize.apply(this,arguments);},mousemove:function(evt){if(this.passesTolerance(evt.xy)){this.clearTimer();this.callback(&apos;move&apos;,[evt]);this.px=evt.xy;evt=OpenLayers.Util.extend({},evt);this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,evt),this.delay);}
return!this.stopMove;},mouseout:function(evt){if(OpenLayers.Util.mouseLeft(evt,this.map.div)){this.clearTimer();this.callback(&apos;move&apos;,[evt]);}
return true;},passesTolerance:function(px){var passes=true;if(this.pixelTolerance&amp;&amp;this.px){var dpx=Math.sqrt(Math.pow(this.px.x-px.x,2)+
Math.pow(this.px.y-px.y,2));if(dpx&lt;this.pixelTolerance){passes=false;}}
return passes;},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null;}},delayedCall:function(evt){this.callback(&apos;pause&apos;,[evt]);},deactivate:function(){var deactivated=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();deactivated=true;}
return deactivated;},CLASS_NAME:&quot;OpenLayers.Handler.Hover&quot;});OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:[&quot;keydown&quot;,&quot;keyup&quot;],eventListener:null,initialize:function(control,callbacks,options){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this);},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments);},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){for(var i=0,len=this.KEY_EVENTS.length;i&lt;len;i++){OpenLayers.Event.observe(document,this.KEY_EVENTS[i],this.eventListener);}
return true;}else{return false;}},deactivate:function(){var deactivated=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var i=0,len=this.KEY_EVENTS.length;i&lt;len;i++){OpenLayers.Event.stopObserving(document,this.KEY_EVENTS[i],this.eventListener);}
deactivated=true;}
return deactivated;},handleKeyEvent:function(evt){if(this.checkModifiers(evt)){this.callback(evt.type,[evt]);}},CLASS_NAME:&quot;OpenLayers.Handler.Keyboard&quot;});OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,initialize:function(control,callbacks,options){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this);},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null;},onWheelEvent:function(e){if(!this.map||!this.checkModifiers(e)){return;}
var overScrollableDiv=false;var overLayerDiv=false;var overMapDiv=false;var elem=OpenLayers.Event.element(e);while((elem!=null)&amp;&amp;!overMapDiv&amp;&amp;!overScrollableDiv){if(!overScrollableDiv){try{if(elem.currentStyle){overflow=elem.currentStyle[&quot;overflow&quot;];}else{var style=document.defaultView.getComputedStyle(elem,null);var overflow=style.getPropertyValue(&quot;overflow&quot;);}
overScrollableDiv=(overflow&amp;&amp;(overflow==&quot;auto&quot;)||(overflow==&quot;scroll&quot;));}catch(err){}}
if(!overLayerDiv){for(var i=0,len=this.map.layers.length;i&lt;len;i++){if(elem==this.map.layers[i].div||elem==this.map.layers[i].pane){overLayerDiv=true;break;}}}
overMapDiv=(elem==this.map.div);elem=elem.parentNode;}
if(!overScrollableDiv&amp;&amp;overMapDiv){if(overLayerDiv){this.wheelZoom(e);}
OpenLayers.Event.stop(e);}},wheelZoom:function(e){var delta=0;if(!e){e=window.event;}
if(e.wheelDelta){delta=e.wheelDelta/120;if(window.opera&amp;&amp;window.opera.version()&lt;9.2){delta=-delta;}}else if(e.detail){delta=-e.detail/3;}
if(delta){if(this.mousePosition){e.xy=this.mousePosition;}
if(!e.xy){e.xy=this.map.getPixelFromLonLat(this.map.getCenter());}
if(delta&lt;0){this.callback(&quot;down&quot;,[e,delta]);}else{this.callback(&quot;up&quot;,[e,delta]);}}},mousemove:function(evt){this.mousePosition=evt.xy;},activate:function(evt){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var wheelListener=this.wheelListener;OpenLayers.Event.observe(window,&quot;DOMMouseScroll&quot;,wheelListener);OpenLayers.Event.observe(window,&quot;mousewheel&quot;,wheelListener);OpenLayers.Event.observe(document,&quot;mousewheel&quot;,wheelListener);return true;}else{return false;}},deactivate:function(evt){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var wheelListener=this.wheelListener;OpenLayers.Event.stopObserving(window,&quot;DOMMouseScroll&quot;,wheelListener);OpenLayers.Event.stopObserving(window,&quot;mousewheel&quot;,wheelListener);OpenLayers.Event.stopObserving(document,&quot;mousewheel&quot;,wheelListener);return true;}else{return false;}},CLASS_NAME:&quot;OpenLayers.Handler.MouseWheel&quot;});OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:null,alwaysInRange:null,EVENT_TYPES:[&quot;loadstart&quot;,&quot;loadend&quot;,&quot;loadcancel&quot;,&quot;visibilitychanged&quot;,&quot;move&quot;,&quot;moveend&quot;],events:null,map:null,isBaseLayer:false,alpha:false,displayInLayerSwitcher:true,visibility:true,attribution:null,inRange:false,imageSize:null,imageOffset:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:false,wrapDateLine:false,transitionEffect:null,SUPPORTED_TRANSITIONS:[&apos;resize&apos;],initialize:function(name,options){this.addOptions(options);this.name=name;if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+&quot;_&quot;);this.div=OpenLayers.Util.createDiv(this.id);this.div.style.width=&quot;100%&quot;;this.div.style.height=&quot;100%&quot;;this.div.dir=&quot;ltr&quot;;this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners);}}
if(this.wrapDateLine){this.displayOutsideMaxExtent=true;}},destroy:function(setNewBaseLayer){if(setNewBaseLayer==null){setNewBaseLayer=true;}
if(this.map!=null){this.map.removeLayer(this,setNewBaseLayer);}
this.projection=null;this.map=null;this.name=null;this.div=null;this.options=null;if(this.events){if(this.eventListeners){this.events.un(this.eventListeners);}
this.events.destroy();}
this.eventListeners=null;this.events=null;},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer(this.name,this.options);}
OpenLayers.Util.applyDefaults(obj,this);obj.map=null;return obj;},setName:function(newName){if(newName!=this.name){this.name=newName;if(this.map!=null){this.map.events.triggerEvent(&quot;changelayer&quot;,{layer:this,property:&quot;name&quot;});}}},addOptions:function(newOptions){if(this.options==null){this.options={};}
OpenLayers.Util.extend(this.options,newOptions);OpenLayers.Util.extend(this,newOptions);},onMapResize:function(){},redraw:function(){var redrawn=false;if(this.map){this.inRange=this.calculateInRange();var extent=this.getExtent();if(extent&amp;&amp;this.inRange&amp;&amp;this.visibility){var zoomChanged=true;this.moveTo(extent,zoomChanged,false);this.events.triggerEvent(&quot;moveend&quot;,{&quot;zoomChanged&quot;:zoomChanged});redrawn=true;}}
return redrawn;},moveTo:function(bounds,zoomChanged,dragging){var display=this.visibility;if(!this.isBaseLayer){display=display&amp;&amp;this.inRange;}
this.display(display);},setMap:function(map){if(this.map==null){this.map=map;this.maxExtent=this.maxExtent||this.map.maxExtent;this.projection=this.projection||this.map.projection;if(this.projection&amp;&amp;typeof this.projection==&quot;string&quot;){this.projection=new OpenLayers.Projection(this.projection);}
this.units=this.projection.getUnits()||this.units||this.map.units;this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();var show=((this.visibility)&amp;&amp;(this.inRange));this.div.style.display=show?&quot;&quot;:&quot;none&quot;;}
this.setTileSize();}},afterAdd:function(){},removeMap:function(map){},getImageSize:function(){return(this.imageSize||this.tileSize);},setTileSize:function(size){var tileSize=(size)?size:((this.tileSize)?this.tileSize:this.map.getTileSize());this.tileSize=tileSize;if(this.gutter){this.imageOffset=new OpenLayers.Pixel(-this.gutter,-this.gutter);this.imageSize=new OpenLayers.Size(tileSize.w+(2*this.gutter),tileSize.h+(2*this.gutter));}},getVisibility:function(){return this.visibility;},setVisibility:function(visibility){if(visibility!=this.visibility){this.visibility=visibility;this.display(visibility);this.redraw();if(this.map!=null){this.map.events.triggerEvent(&quot;changelayer&quot;,{layer:this,property:&quot;visibility&quot;});}
this.events.triggerEvent(&quot;visibilitychanged&quot;);}},display:function(display){var inRange=this.calculateInRange();if(display!=(this.div.style.display!=&quot;none&quot;)){this.div.style.display=(display&amp;&amp;inRange)?&quot;block&quot;:&quot;none&quot;;}},calculateInRange:function(){var inRange=false;if(this.alwaysInRange){inRange=true;}else{if(this.map){var resolution=this.map.getResolution();inRange=((resolution&gt;=this.minResolution)&amp;&amp;(resolution&lt;=this.maxResolution));}}
return inRange;},setIsBaseLayer:function(isBaseLayer){if(isBaseLayer!=this.isBaseLayer){this.isBaseLayer=isBaseLayer;if(this.map!=null){this.map.events.triggerEvent(&quot;changebaselayer&quot;,{layer:this});}}},initResolutions:function(){var props=new Array(&apos;projection&apos;,&apos;units&apos;,&apos;scales&apos;,&apos;resolutions&apos;,&apos;maxScale&apos;,&apos;minScale&apos;,&apos;maxResolution&apos;,&apos;minResolution&apos;,&apos;minExtent&apos;,&apos;maxExtent&apos;,&apos;numZoomLevels&apos;,&apos;maxZoomLevel&apos;);var notScaleProps=[&apos;projection&apos;,&apos;units&apos;];var useInRange=false;var confProps={};for(var i=0,len=props.length;i&lt;len;i++){var property=props[i];if(this.options[property]&amp;&amp;OpenLayers.Util.indexOf(notScaleProps,property)==-1){useInRange=true;}
confProps[property]=this.options[property]||this.map[property];}
if(this.alwaysInRange==null){this.alwaysInRange=!useInRange;}
if((this.options.minScale!=null||this.options.maxScale!=null)&amp;&amp;this.options.scales==null){confProps.scales=null;}
if((this.options.minResolution!=null||this.options.maxResolution!=null)&amp;&amp;this.options.resolutions==null){confProps.resolutions=null;}
if((!confProps.numZoomLevels)&amp;&amp;(confProps.maxZoomLevel)){confProps.numZoomLevels=confProps.maxZoomLevel+1;}
if((confProps.scales!=null)||(confProps.resolutions!=null)){if(confProps.scales!=null){confProps.resolutions=[];for(var i=0,len=confProps.scales.length;i&lt;len;i++){var scale=confProps.scales[i];confProps.resolutions[i]=OpenLayers.Util.getResolutionFromScale(scale,confProps.units);}}
confProps.numZoomLevels=confProps.resolutions.length;}else{if(confProps.minScale){confProps.maxResolution=OpenLayers.Util.getResolutionFromScale(confProps.minScale,confProps.units);}else if(confProps.maxResolution==&quot;auto&quot;){var viewSize=this.map.getSize();var wRes=confProps.maxExtent.getWidth()/viewSize.w;var hRes=confProps.maxExtent.getHeight()/viewSize.h;confProps.maxResolution=Math.max(wRes,hRes);}
if(confProps.maxScale!=null){confProps.minResolution=OpenLayers.Util.getResolutionFromScale(confProps.maxScale,confProps.units);}else if((confProps.minResolution==&quot;auto&quot;)&amp;&amp;(confProps.minExtent!=null)){var viewSize=this.map.getSize();var wRes=confProps.minExtent.getWidth()/viewSize.w;var hRes=confProps.minExtent.getHeight()/viewSize.h;confProps.minResolution=Math.max(wRes,hRes);}
if(confProps.minResolution!=null&amp;&amp;this.options.numZoomLevels==undefined){var ratio=confProps.maxResolution/confProps.minResolution;confProps.numZoomLevels=Math.floor(Math.log(ratio)/Math.log(2))+1;}
confProps.resolutions=new Array(confProps.numZoomLevels);var base=2;if(typeof confProps.minResolution==&quot;number&quot;&amp;&amp;confProps.numZoomLevels&gt;1){base=Math.pow((confProps.maxResolution/confProps.minResolution),(1/(confProps.numZoomLevels-1)));}
for(var i=0;i&lt;confProps.numZoomLevels;i++){var res=confProps.maxResolution/Math.pow(base,i);confProps.resolutions[i]=res;}}
confProps.resolutions.sort(function(a,b){return(b-a);});this.resolutions=confProps.resolutions;this.maxResolution=confProps.resolutions[0];var lastIndex=confProps.resolutions.length-1;this.minResolution=confProps.resolutions[lastIndex];this.scales=[];for(var i=0,len=confProps.resolutions.length;i&lt;len;i++){this.scales[i]=OpenLayers.Util.getScaleFromResolution(confProps.resolutions[i],confProps.units);}
this.minScale=this.scales[0];this.maxScale=this.scales[this.scales.length-1];this.numZoomLevels=confProps.numZoomLevels;},getResolution:function(){var zoom=this.map.getZoom();return this.getResolutionForZoom(zoom);},getExtent:function(){return this.map.calculateBounds();},getZoomForExtent:function(extent,closest){var viewSize=this.map.getSize();var idealResolution=Math.max(extent.getWidth()/viewSize.w,extent.getHeight()/viewSize.h);return this.getZoomForResolution(idealResolution,closest);},getDataExtent:function(){},getResolutionForZoom:function(zoom){zoom=Math.max(0,Math.min(zoom,this.resolutions.length-1));var resolution;if(this.map.fractionalZoom){var low=Math.floor(zoom);var high=Math.ceil(zoom);resolution=this.resolutions[low]-
((zoom-low)*(this.resolutions[low]-this.resolutions[high]));}else{resolution=this.resolutions[Math.round(zoom)];}
return resolution;},getZoomForResolution:function(resolution,closest){var zoom;if(this.map.fractionalZoom){var lowZoom=0;var highZoom=this.resolutions.length-1;var highRes=this.resolutions[lowZoom];var lowRes=this.resolutions[highZoom];var res;for(var i=0,len=this.resolutions.length;i&lt;len;++i){res=this.resolutions[i];if(res&gt;=resolution){highRes=res;lowZoom=i;}
if(res&lt;=resolution){lowRes=res;highZoom=i;break;}}
var dRes=highRes-lowRes;if(dRes&gt;0){zoom=lowZoom+((highRes-resolution)/dRes);}else{zoom=lowZoom;}}else{var diff;var minDiff=Number.POSITIVE_INFINITY;for(var i=0,len=this.resolutions.length;i&lt;len;i++){if(closest){diff=Math.abs(this.resolutions[i]-resolution);if(diff&gt;minDiff){break;}
minDiff=diff;}else{if(this.resolutions[i]&lt;resolution){break;}}}
zoom=Math.max(0,i-1);}
return zoom;},getLonLatFromViewPortPx:function(viewPortPx){var lonlat=null;if(viewPortPx!=null){var size=this.map.getSize();var center=this.map.getCenter();if(center){var res=this.map.getResolution();var delta_x=viewPortPx.x-(size.w/2);var delta_y=viewPortPx.y-(size.h/2);lonlat=new OpenLayers.LonLat(center.lon+delta_x*res,center.lat-delta_y*res);if(this.wrapDateLine){lonlat=lonlat.wrapDateLine(this.maxExtent);}}}
return lonlat;},getViewPortPxFromLonLat:function(lonlat){var px=null;if(lonlat!=null){var resolution=this.map.getResolution();var extent=this.map.getExtent();px=new OpenLayers.Pixel((1/resolution*(lonlat.lon-extent.left)),(1/resolution*(extent.top-lonlat.lat)));}
return px;},setOpacity:function(opacity){if(opacity!=this.opacity){this.opacity=opacity;for(var i=0,len=this.div.childNodes.length;i&lt;len;++i){var element=this.div.childNodes[i].firstChild;OpenLayers.Util.modifyDOMElement(element,null,null,null,null,null,null,opacity);}}},getZIndex:function(){return this.div.style.zIndex;},setZIndex:function(zIndex){this.div.style.zIndex=zIndex;},adjustBounds:function(bounds){if(this.gutter){var mapGutter=this.gutter*this.map.getResolution();bounds=new OpenLayers.Bounds(bounds.left-mapGutter,bounds.bottom-mapGutter,bounds.right+mapGutter,bounds.top+mapGutter);}
if(this.wrapDateLine){var wrappingOptions={&apos;rightTolerance&apos;:this.getResolution()};bounds=bounds.wrapDateLine(this.maxExtent,wrappingOptions);}
return bounds;},CLASS_NAME:&quot;OpenLayers.Layer&quot;});OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(bounds,borderColor,borderWidth){this.bounds=bounds;this.div=OpenLayers.Util.createDiv();this.div.style.overflow=&apos;hidden&apos;;this.events=new OpenLayers.Events(this,this.div,null);this.setBorder(borderColor,borderWidth);},destroy:function(){this.bounds=null;this.div=null;OpenLayers.Marker.prototype.destroy.apply(this,arguments);},setBorder:function(color,width){if(!color){color=&quot;red&quot;;}
if(!width){width=2;}
this.div.style.border=width+&quot;px solid &quot;+color;},draw:function(px,sz){OpenLayers.Util.modifyDOMElement(this.div,null,px,sz);return this.div;},onScreen:function(){var onScreen=false;if(this.map){var screenBounds=this.map.getExtent();onScreen=screenBounds.containsBounds(this.bounds,true,true);}
return onScreen;},display:function(display){this.div.style.display=(display)?&quot;&quot;:&quot;none&quot;;},CLASS_NAME:&quot;OpenLayers.Marker.Box&quot;});(function(){var oXMLHttpRequest=window.XMLHttpRequest;var bGecko=!!window.controllers,bIE=window.document.all&amp;&amp;!window.opera;function cXMLHttpRequest(){this._object=oXMLHttpRequest?new oXMLHttpRequest:new window.ActiveXObject(&apos;Microsoft.XMLHTTP&apos;);};if(bGecko&amp;&amp;oXMLHttpRequest.wrapped)
cXMLHttpRequest.wrapped=oXMLHttpRequest.wrapped;cXMLHttpRequest.UNSENT=0;cXMLHttpRequest.OPENED=1;cXMLHttpRequest.HEADERS_RECEIVED=2;cXMLHttpRequest.LOADING=3;cXMLHttpRequest.DONE=4;cXMLHttpRequest.prototype.readyState=cXMLHttpRequest.UNSENT;cXMLHttpRequest.prototype.responseText=&quot;&quot;;cXMLHttpRequest.prototype.responseXML=null;cXMLHttpRequest.prototype.status=0;cXMLHttpRequest.prototype.statusText=&quot;&quot;;cXMLHttpRequest.prototype.onreadystatechange=null;cXMLHttpRequest.onreadystatechange=null;cXMLHttpRequest.onopen=null;cXMLHttpRequest.onsend=null;cXMLHttpRequest.onabort=null;cXMLHttpRequest.prototype.open=function(sMethod,sUrl,bAsync,sUser,sPassword){this._async=bAsync;var oRequest=this,nState=this.readyState;if(bIE){var fOnUnload=function(){if(oRequest._object.readyState!=cXMLHttpRequest.DONE)
fCleanTransport(oRequest);};if(bAsync)
window.attachEvent(&quot;onunload&quot;,fOnUnload);}
this._object.onreadystatechange=function(){if(bGecko&amp;&amp;!bAsync)
return;oRequest.readyState=oRequest._object.readyState;fSynchronizeValues(oRequest);if(oRequest._aborted){oRequest.readyState=cXMLHttpRequest.UNSENT;return;}
if(oRequest.readyState==cXMLHttpRequest.DONE){fCleanTransport(oRequest);if(bIE&amp;&amp;bAsync)
window.detachEvent(&quot;onunload&quot;,fOnUnload);}
if(nState!=oRequest.readyState)
fReadyStateChange(oRequest);nState=oRequest.readyState;};if(cXMLHttpRequest.onopen)
cXMLHttpRequest.onopen.apply(this,arguments);this._object.open(sMethod,sUrl,bAsync,sUser,sPassword);if(!bAsync&amp;&amp;bGecko){this.readyState=cXMLHttpRequest.OPENED;fReadyStateChange(this);}};cXMLHttpRequest.prototype.send=function(vData){if(cXMLHttpRequest.onsend)
cXMLHttpRequest.onsend.apply(this,arguments);if(vData&amp;&amp;vData.nodeType){vData=window.XMLSerializer?new window.XMLSerializer().serializeToString(vData):vData.xml;if(!this._headers[&quot;Content-Type&quot;])
this._object.setRequestHeader(&quot;Content-Type&quot;,&quot;application/xml&quot;);}
this._object.send(vData);if(bGecko&amp;&amp;!this._async){this.readyState=cXMLHttpRequest.OPENED;fSynchronizeValues(this);while(this.readyState&lt;cXMLHttpRequest.DONE){this.readyState++;fReadyStateChange(this);if(this._aborted)
return;}}};cXMLHttpRequest.prototype.abort=function(){if(cXMLHttpRequest.onabort)
cXMLHttpRequest.onabort.apply(this,arguments);if(this.readyState&gt;cXMLHttpRequest.UNSENT)
this._aborted=true;this._object.abort();fCleanTransport(this);};cXMLHttpRequest.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders();};cXMLHttpRequest.prototype.getResponseHeader=function(sName){return this._object.getResponseHeader(sName);};cXMLHttpRequest.prototype.setRequestHeader=function(sName,sValue){if(!this._headers)
this._headers={};this._headers[sName]=sValue;return this._object.setRequestHeader(sName,sValue);};cXMLHttpRequest.prototype.toString=function(){return&apos;[&apos;+&quot;object&quot;+&apos; &apos;+&quot;XMLHttpRequest&quot;+&apos;]&apos;;};cXMLHttpRequest.toString=function(){return&apos;[&apos;+&quot;XMLHttpRequest&quot;+&apos;]&apos;;};function fReadyStateChange(oRequest){if(oRequest.onreadystatechange)
oRequest.onreadystatechange.apply(oRequest);if(cXMLHttpRequest.onreadystatechange)
cXMLHttpRequest.onreadystatechange.apply(oRequest);};function fGetDocument(oRequest){var oDocument=oRequest.responseXML;if(bIE&amp;&amp;oDocument&amp;&amp;!oDocument.documentElement&amp;&amp;oRequest.getResponseHeader(&quot;Content-Type&quot;).match(/[^\/]+\/[^\+]+\+xml/)){oDocument=new ActiveXObject(&apos;Microsoft.XMLDOM&apos;);oDocument.loadXML(oRequest.responseText);}
if(oDocument)
if((bIE&amp;&amp;oDocument.parseError!=0)||(oDocument.documentElement&amp;&amp;oDocument.documentElement.tagName==&quot;parsererror&quot;))
return null;return oDocument;};function fSynchronizeValues(oRequest){try{oRequest.responseText=oRequest._object.responseText;}catch(e){}
try{oRequest.responseXML=fGetDocument(oRequest._object);}catch(e){}
try{oRequest.status=oRequest._object.status;}catch(e){}
try{oRequest.statusText=oRequest._object.statusText;}catch(e){}};function fCleanTransport(oRequest){oRequest._object.onreadystatechange=new window.Function;delete oRequest._headers;};if(!window.Function.prototype.apply){window.Function.prototype.apply=function(oRequest,oArguments){if(!oArguments)
oArguments=[];oRequest.__func=this;oRequest.__func(oArguments[0],oArguments[1],oArguments[2],oArguments[3],oArguments[4]);delete oRequest.__func;};};OpenLayers.Request.XMLHttpRequest=cXMLHttpRequest;})();OpenLayers.ProxyHost=&quot;&quot;;OpenLayers.nullHandler=function(request){OpenLayers.Console.userError(OpenLayers.i18n(&quot;unhandledRequest&quot;,{&apos;statusText&apos;:request.statusText}));};OpenLayers.loadURL=function(uri,params,caller,onComplete,onFailure){if(typeof params==&apos;string&apos;){params=OpenLayers.Util.getParameters(params);}
var success=(onComplete)?onComplete:OpenLayers.nullHandler;var failure=(onFailure)?onFailure:OpenLayers.nullHandler;return OpenLayers.Request.GET({url:uri,params:params,success:success,failure:failure,scope:caller});};OpenLayers.parseXMLString=function(text){var index=text.indexOf(&apos;&lt;&apos;);if(index&gt;0){text=text.substring(index);}
var ajaxResponse=OpenLayers.Util.Try(function(){var xmldom=new ActiveXObject(&apos;Microsoft.XMLDOM&apos;);xmldom.loadXML(text);return xmldom;},function(){return new DOMParser().parseFromString(text,&apos;text/xml&apos;);},function(){var req=new XMLHttpRequest();req.open(&quot;GET&quot;,&quot;data:&quot;+&quot;text/xml&quot;+&quot;;charset=utf-8,&quot;+encodeURIComponent(text),false);if(req.overrideMimeType){req.overrideMimeType(&quot;text/xml&quot;);}
req.send(null);return req.responseXML;});return ajaxResponse;};OpenLayers.Ajax={emptyFunction:function(){},getTransport:function(){return OpenLayers.Util.Try(function(){return new XMLHttpRequest();},function(){return new ActiveXObject(&apos;Msxml2.XMLHTTP&apos;);},function(){return new ActiveXObject(&apos;Microsoft.XMLHTTP&apos;);})||false;},activeRequestCount:0};OpenLayers.Ajax.Responders={responders:[],register:function(responderToAdd){for(var i=0;i&lt;this.responders.length;i++){if(responderToAdd==this.responders[i]){return;}}
this.responders.push(responderToAdd);},unregister:function(responderToRemove){OpenLayers.Util.removeItem(this.reponders,responderToRemove);},dispatch:function(callback,request,transport){var responder;for(var i=0;i&lt;this.responders.length;i++){responder=this.responders[i];if(responder[callback]&amp;&amp;typeof responder[callback]==&apos;function&apos;){try{responder[callback].apply(responder,[request,transport]);}catch(e){}}}}};OpenLayers.Ajax.Responders.register({onCreate:function(){OpenLayers.Ajax.activeRequestCount++;},onComplete:function(){OpenLayers.Ajax.activeRequestCount--;}});OpenLayers.Ajax.Base=OpenLayers.Class({initialize:function(options){this.options={method:&apos;post&apos;,asynchronous:true,contentType:&apos;application/xml&apos;,parameters:&apos;&apos;};OpenLayers.Util.extend(this.options,options||{});this.options.method=this.options.method.toLowerCase();if(typeof this.options.parameters==&apos;string&apos;){this.options.parameters=OpenLayers.Util.getParameters(this.options.parameters);}}});OpenLayers.Ajax.Request=OpenLayers.Class(OpenLayers.Ajax.Base,{_complete:false,initialize:function(url,options){OpenLayers.Ajax.Base.prototype.initialize.apply(this,[options]);if(OpenLayers.ProxyHost&amp;&amp;OpenLayers.String.startsWith(url,&quot;http&quot;)){url=OpenLayers.ProxyHost+encodeURIComponent(url);}
this.transport=OpenLayers.Ajax.getTransport();this.request(url);},request:function(url){this.url=url;this.method=this.options.method;var params=OpenLayers.Util.extend({},this.options.parameters);if(this.method!=&apos;get&apos;&amp;&amp;this.method!=&apos;post&apos;){params[&apos;_method&apos;]=this.method;this.method=&apos;post&apos;;}
this.parameters=params;if(params=OpenLayers.Util.getParameterString(params)){if(this.method==&apos;get&apos;){this.url+=((this.url.indexOf(&apos;?&apos;)&gt;-1)?&apos;&amp;&apos;:&apos;?&apos;)+params;}else if(/Konqueror|Safari|KHTML/.test(navigator.userAgent)){params+=&apos;&amp;_=&apos;;}}
try{var response=new OpenLayers.Ajax.Response(this);if(this.options.onCreate){this.options.onCreate(response);}
OpenLayers.Ajax.Responders.dispatch(&apos;onCreate&apos;,this,response);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous){window.setTimeout(OpenLayers.Function.bind(this.respondToReadyState,this,1),10);}
this.transport.onreadystatechange=OpenLayers.Function.bind(this.onStateChange,this);this.setRequestHeaders();this.body=this.method==&apos;post&apos;?(this.options.postBody||params):null;this.transport.send(this.body);if(!this.options.asynchronous&amp;&amp;this.transport.overrideMimeType){this.onStateChange();}}catch(e){this.dispatchException(e);}},onStateChange:function(){var readyState=this.transport.readyState;if(readyState&gt;1&amp;&amp;!((readyState==4)&amp;&amp;this._complete)){this.respondToReadyState(this.transport.readyState);}},setRequestHeaders:function(){var headers={&apos;X-Requested-With&apos;:&apos;XMLHttpRequest&apos;,&apos;Accept&apos;:&apos;text/javascript, text/html, application/xml, text/xml, */*&apos;,&apos;OpenLayers&apos;:true};if(this.method==&apos;post&apos;){headers[&apos;Content-type&apos;]=this.options.contentType+
(this.options.encoding?&apos;; charset=&apos;+this.options.encoding:&apos;&apos;);if(this.transport.overrideMimeType&amp;&amp;(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]&lt;2005){headers[&apos;Connection&apos;]=&apos;close&apos;;}}
if(typeof this.options.requestHeaders==&apos;object&apos;){var extras=this.options.requestHeaders;if(typeof extras.push==&apos;function&apos;){for(var i=0,length=extras.length;i&lt;length;i+=2){headers[extras[i]]=extras[i+1];}}else{for(var i in extras){headers[i]=extras[i];}}}
for(var name in headers){this.transport.setRequestHeader(name,headers[name]);}},success:function(){var status=this.getStatus();return!status||(status&gt;=200&amp;&amp;status&lt;300);},getStatus:function(){try{return this.transport.status||0;}catch(e){return 0;}},respondToReadyState:function(readyState){var state=OpenLayers.Ajax.Request.Events[readyState];var response=new OpenLayers.Ajax.Response(this);if(state==&apos;Complete&apos;){try{this._complete=true;(this.options[&apos;on&apos;+response.status]||this.options[&apos;on&apos;+(this.success()?&apos;Success&apos;:&apos;Failure&apos;)]||OpenLayers.Ajax.emptyFunction)(response);}catch(e){this.dispatchException(e);}
var contentType=response.getHeader(&apos;Content-type&apos;);}
try{(this.options[&apos;on&apos;+state]||OpenLayers.Ajax.emptyFunction)(response);OpenLayers.Ajax.Responders.dispatch(&apos;on&apos;+state,this,response);}catch(e){this.dispatchException(e);}
if(state==&apos;Complete&apos;){this.transport.onreadystatechange=OpenLayers.Ajax.emptyFunction;}},getHeader:function(name){try{return this.transport.getResponseHeader(name);}catch(e){return null;}},dispatchException:function(exception){var handler=this.options.onException;if(handler){handler(this,exception);OpenLayers.Ajax.Responders.dispatch(&apos;onException&apos;,this,exception);}else{var listener=false;var responders=OpenLayers.Ajax.Responders.responders;for(var i=0;i&lt;responders.length;i++){if(responders[i].onException){listener=true;break;}}
if(listener){OpenLayers.Ajax.Responders.dispatch(&apos;onException&apos;,this,exception);}else{throw exception;}}}});OpenLayers.Ajax.Request.Events=[&apos;Uninitialized&apos;,&apos;Loading&apos;,&apos;Loaded&apos;,&apos;Interactive&apos;,&apos;Complete&apos;];OpenLayers.Ajax.Response=OpenLayers.Class({status:0,statusText:&apos;&apos;,initialize:function(request){this.request=request;var transport=this.transport=request.transport,readyState=this.readyState=transport.readyState;if((readyState&gt;2&amp;&amp;!(!!(window.attachEvent&amp;&amp;!window.opera)))||readyState==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=transport.responseText==null?&apos;&apos;:String(transport.responseText);}
if(readyState==4){var xml=transport.responseXML;this.responseXML=xml===undefined?null:xml;}},getStatus:OpenLayers.Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||&apos;&apos;;}catch(e){return&apos;&apos;;}},getHeader:OpenLayers.Ajax.Request.prototype.getHeader,getResponseHeader:function(name){return this.transport.getResponseHeader(name);}});OpenLayers.Ajax.getElementsByTagNameNS=function(parentnode,nsuri,nsprefix,tagname){var elem=null;if(parentnode.getElementsByTagNameNS){elem=parentnode.getElementsByTagNameNS(nsuri,tagname);}else{elem=parentnode.getElementsByTagName(nsprefix+&apos;:&apos;+tagname);}
return elem;};OpenLayers.Ajax.serializeXMLToString=function(xmldom){var serializer=new XMLSerializer();var data=serializer.serializeToString(xmldom);return data;};OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(feature,pixel){},onDrag:function(feature,pixel){},onComplete:function(feature,pixel){},layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(layer,options){OpenLayers.Control.prototype.initialize.apply(this,[options]);this.layer=layer;this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks)),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})};},destroy:function(){this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[]);},activate:function(){return(this.handlers.feature.activate()&amp;&amp;OpenLayers.Control.prototype.activate.apply(this,arguments));},deactivate:function(){this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.feature=null;this.dragging=false;this.lastPixel=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+&quot;Over&quot;);return OpenLayers.Control.prototype.deactivate.apply(this,arguments);},overFeature:function(feature){if(!this.handlers.drag.dragging){this.feature=feature;this.handlers.drag.activate();this.over=true;OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+&quot;Over&quot;);}else{if(this.feature.id==feature.id){this.over=true;}else{this.over=false;}}},downFeature:function(pixel){this.lastPixel=pixel;this.onStart(this.feature,pixel);},moveFeature:function(pixel){var res=this.map.getResolution();this.feature.geometry.move(res*(pixel.x-this.lastPixel.x),res*(this.lastPixel.y-pixel.y));this.layer.drawFeature(this.feature);this.lastPixel=pixel;this.onDrag(this.feature,pixel);},upFeature:function(pixel){if(!this.over){this.handlers.drag.deactivate();}},doneDragging:function(pixel){this.onComplete(this.feature,pixel);},outFeature:function(feature){if(!this.handlers.drag.dragging){this.over=false;this.handlers.drag.deactivate();OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+&quot;Over&quot;);this.feature=null;}else{if(this.feature.id==feature.id){this.over=false;}}},cancel:function(){this.handlers.drag.deactivate();this.over=false;},setMap:function(map){this.handlers.drag.setMap(map);this.handlers.feature.setMap(map);OpenLayers.Control.prototype.setMap.apply(this,arguments);},CLASS_NAME:&quot;OpenLayers.Control.DragFeature&quot;});OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:false,interval:25,draw:function(){this.handler=new OpenLayers.Handler.Drag(this,{&quot;move&quot;:this.panMap,&quot;done&quot;:this.panMapDone},{interval:this.interval});},panMap:function(xy){this.panned=true;this.map.pan(this.handler.last.x-xy.x,this.handler.last.y-xy.y,{dragging:this.handler.dragging,animate:false});},panMapDone:function(xy){if(this.panned){this.panMap(xy);this.panned=false;}},CLASS_NAME:&quot;OpenLayers.Control.DragPan&quot;});OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{slideFactor:75,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments);},destroy:function(){if(this.handler){this.handler.destroy();}
this.handler=null;OpenLayers.Control.prototype.destroy.apply(this,arguments);},draw:function(){this.handler=new OpenLayers.Handler.Keyboard(this,{&quot;keydown&quot;:this.defaultKeyPress});this.activate();},defaultKeyPress:function(evt){switch(evt.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:var size=this.map.getSize();this.map.pan(0,-0.75*size.h);break;case 34:var size=this.map.getSize();this.map.pan(0,0.75*size.h);break;case 35:var size=this.map.getSize();this.map.pan(0.75*size.w,0);break;case 36:var size=this.map.getSize();this.map.pan(-0.75*size.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break;}},CLASS_NAME:&quot;OpenLayers.Control.KeyboardDefaults&quot;});OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:false,maxFeatures:10,layers:null,queryVisible:false,url:null,layerUrls:null,infoFormat:&apos;text/html&apos;,vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,EVENT_TYPES:[&quot;getfeatureinfo&quot;],initialize:function(options){this.EVENT_TYPES=OpenLayers.Control.WMSGetFeatureInfo.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);options=options||{};options.handlerOptions=options.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[options]);if(!this.format){this.format=new OpenLayers.Format.WMSGetFeatureInfo(options.formatOptions);}
if(this.hover){this.handler=new OpenLayers.Handler.Hover(this,{&apos;move&apos;:this.cancelHover,&apos;pause&apos;:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{&apos;delay&apos;:250}));}else{this.handler=new OpenLayers.Handler.Click(this,{click:this.getInfoForClick},this.handlerOptions.click||{});}},activate:function(){if(!this.active){this.handler.activate();}
return OpenLayers.Control.prototype.activate.apply(this,arguments);},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments);},getInfoForClick:function(evt){OpenLayers.Element.addClass(this.map.viewPortDiv,&quot;olCursorWait&quot;);this.request(evt.xy,{});},getInfoForHover:function(evt){this.request(evt.xy,{hover:true});},cancelHover:function(){if(this.hoverRequest){this.hoverRequest.abort();this.hoverRequest=null;}},findLayers:function(){var layers=[];var candidates=this.layers||this.map.layers;var layer,url;for(var i=0,len=candidates.length;i&lt;len;++i){layer=candidates[i];if(layer instanceof OpenLayers.Layer.WMS&amp;&amp;(!this.queryVisible||layer.getVisibility())){url=layer.url instanceof Array?layer.url[0]:layer.url;if(!this.url){this.url=url;}
if(this.urlMatches(url)){layers.push(layer);}}}
return layers;},urlMatches:function(url){var matches=OpenLayers.Util.isEquivalentUrl(this.url,url);if(!matches&amp;&amp;this.layerUrls){for(var i=0,len=this.layerUrls.length;i&lt;len;++i){if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[i],url)){matches=true;break;}}}
return matches;},request:function(clickPosition,options){options=options||{};var layerNames=[];var styleNames=[];var layers=this.findLayers();if(layers.length&gt;0){for(var i=0,len=layers.length;i&lt;len;i++){layerNames=layerNames.concat(layers[i].params.LAYERS);if(layers[i].params.STYLES){styleNames=styleNames.concat(layers[i].params.STYLES);}else{if(layers[i].params.LAYERS instanceof Array){styleNames=styleNames.concat(new Array(layers[i].params.LAYERS.length));}else{styleNames=styleNames.concat(layers[i].params.LAYERS.replace(/[^,]/g,&quot;&quot;));}}}
var wmsOptions={url:this.url,params:OpenLayers.Util.applyDefaults({service:&quot;WMS&quot;,version:&quot;1.1.0&quot;,request:&quot;GetFeatureInfo&quot;,layers:layerNames,query_layers:layerNames,styles:styleNames,bbox:this.map.getExtent().toBBOX(),srs:this.map.getProjection(),feature_count:this.maxFeatures,x:clickPosition.x,y:clickPosition.y,height:this.map.getSize().h,width:this.map.getSize().w,info_format:this.infoFormat},this.vendorParams),callback:function(request){this.handleResponse(clickPosition,request);},scope:this};var response=OpenLayers.Request.GET(wmsOptions);if(options.hover===true){this.hoverRequest=response.priv;}}else{OpenLayers.Element.removeClass(this.map.viewPortDiv,&quot;olCursorWait&quot;);}},handleResponse:function(xy,request){var doc=request.responseXML;if(!doc||!doc.documentElement){doc=request.responseText;}
var features=this.format.read(doc);this.events.triggerEvent(&quot;getfeatureinfo&quot;,{text:request.responseText,features:features,request:request,xy:xy});OpenLayers.Element.removeClass(this.map.viewPortDiv,&quot;olCursorWait&quot;);},setMap:function(map){this.handler.setMap(map);OpenLayers.Control.prototype.setMap.apply(this,arguments);},CLASS_NAME:&quot;OpenLayers.Control.WMSGetFeatureInfo&quot;});OpenLayers.State={UNKNOWN:&apos;Unknown&apos;,INSERT:&apos;Insert&apos;,UPDATE:&apos;Update&apos;,DELETE:&apos;Delete&apos;};OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,renderIntent:&quot;default&quot;,initialize:function(geometry,attributes,style){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,attributes]);this.lonlat=null;this.geometry=geometry?geometry:null;this.state=null;this.attributes={};if(attributes){this.attributes=OpenLayers.Util.extend(this.attributes,attributes);}
this.style=style?style:null;},destroy:function(){if(this.layer){this.layer.removeFeatures(this);this.layer=null;}
this.geometry=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments);},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style);},onScreen:function(boundsOnly){var onScreen=false;if(this.layer&amp;&amp;this.layer.map){var screenBounds=this.layer.map.getExtent();if(boundsOnly){var featureBounds=this.geometry.getBounds();onScreen=screenBounds.intersectsBounds(featureBounds);}else{var screenPoly=screenBounds.toGeometry();onScreen=screenPoly.intersects(this.geometry);}}
return onScreen;},createMarker:function(){return null;},destroyMarker:function(){},createPopup:function(){return null;},atPoint:function(lonlat,toleranceLon,toleranceLat){var atPoint=false;if(this.geometry){atPoint=this.geometry.atPoint(lonlat,toleranceLon,toleranceLat);}
return atPoint;},destroyPopup:function(){},move:function(location){if(!this.layer||!this.geometry.move){return;}
var pixel;if(location.CLASS_NAME==&quot;OpenLayers.LonLat&quot;){pixel=this.layer.getViewPortPxFromLonLat(location);}else{pixel=location;}
var lastPixel=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat());var res=this.layer.map.getResolution();this.geometry.move(res*(pixel.x-lastPixel.x),res*(lastPixel.y-pixel.y));this.layer.drawFeature(this);return lastPixel;},toState:function(state){if(state==OpenLayers.State.UPDATE){switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=state;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:break;}}else if(state==OpenLayers.State.INSERT){switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=state;break;}}else if(state==OpenLayers.State.DELETE){switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=state;break;}}else if(state==OpenLayers.State.UNKNOWN){this.state=state;}},CLASS_NAME:&quot;OpenLayers.Feature.Vector&quot;});OpenLayers.Feature.Vector.style={&apos;default&apos;:{fillColor:&quot;#ee9900&quot;,fillOpacity:0.4,hoverFillColor:&quot;white&quot;,hoverFillOpacity:0.8,strokeColor:&quot;#ee9900&quot;,strokeOpacity:1,strokeWidth:1,strokeLinecap:&quot;round&quot;,strokeDashstyle:&quot;solid&quot;,hoverStrokeColor:&quot;red&quot;,hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:&quot;%&quot;,pointerEvents:&quot;visiblePainted&quot;,cursor:&quot;inherit&quot;},&apos;select&apos;:{fillColor:&quot;blue&quot;,fillOpacity:0.4,hoverFillColor:&quot;white&quot;,hoverFillOpacity:0.8,strokeColor:&quot;blue&quot;,strokeOpacity:1,strokeWidth:2,strokeLinecap:&quot;round&quot;,strokeDashstyle:&quot;solid&quot;,hoverStrokeColor:&quot;red&quot;,hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:&quot;%&quot;,pointerEvents:&quot;visiblePainted&quot;,cursor:&quot;pointer&quot;},&apos;temporary&apos;:{fillColor:&quot;#66cccc&quot;,fillOpacity:0.2,hoverFillColor:&quot;white&quot;,hoverFillOpacity:0.8,strokeColor:&quot;#66cccc&quot;,strokeOpacity:1,strokeLinecap:&quot;round&quot;,strokeWidth:2,strokeDashstyle:&quot;solid&quot;,hoverStrokeColor:&quot;red&quot;,hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:&quot;%&quot;,pointerEvents:&quot;visiblePainted&quot;,cursor:&quot;inherit&quot;},&apos;delete&apos;:{display:&quot;none&quot;}};OpenLayers.Feature.WFS=OpenLayers.Class(OpenLayers.Feature,{initialize:function(layer,xmlNode){var newArguments=arguments;var data=this.processXMLNode(xmlNode);newArguments=new Array(layer,data.lonlat,data);OpenLayers.Feature.prototype.initialize.apply(this,newArguments);this.createMarker();this.layer.addMarker(this.marker);},destroy:function(){if(this.marker!=null){this.layer.removeMarker(this.marker);}
OpenLayers.Feature.prototype.destroy.apply(this,arguments);},processXMLNode:function(xmlNode){var point=OpenLayers.Ajax.getElementsByTagNameNS(xmlNode,&quot;http://www.opengis.net/gml&quot;,&quot;gml&quot;,&quot;Point&quot;);var text=OpenLayers.Util.getXmlNodeValue(OpenLayers.Ajax.getElementsByTagNameNS(point[0],&quot;http://www.opengis.net/gml&quot;,&quot;gml&quot;,&quot;coordinates&quot;)[0]);var floats=text.split(&quot;,&quot;);return{lonlat:new OpenLayers.LonLat(parseFloat(floats[0]),parseFloat(floats[1])),id:null};},CLASS_NAME:&quot;OpenLayers.Feature.WFS&quot;});OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.WFSCapabilities,{initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);this.options=options;},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var capabilities={};var root=data.documentElement;this.runChildNodes(capabilities,root);return capabilities;},runChildNodes:function(obj,node){var children=node.childNodes;var childNode,processor;for(var i=0;i&lt;children.length;++i){childNode=children[i];if(childNode.nodeType==1){processor=this[&quot;read_cap_&quot;+childNode.nodeName];if(processor){processor.apply(this,[obj,childNode]);}}}},read_cap_FeatureTypeList:function(request,node){var featureTypeList={featureTypes:[]};this.runChildNodes(featureTypeList,node);request.featureTypeList=featureTypeList;},read_cap_FeatureType:function(featureTypeList,node,parentLayer){var featureType={};this.runChildNodes(featureType,node);featureTypeList.featureTypes.push(featureType);},read_cap_Name:function(obj,node){var name=this.getChildValue(node);if(name){obj.name=name;}},read_cap_Title:function(obj,node){var title=this.getChildValue(node);if(title){obj.title=title;}},read_cap_Abstract:function(obj,node){var abst=this.getChildValue(node);if(abst){obj[&quot;abstract&quot;]=abst;}},CLASS_NAME:&quot;OpenLayers.Format.WFSCapabilities.v1&quot;});OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:&quot;http://openlayers.org/context&quot;,wmc:&quot;http://www.opengis.net/context&quot;,sld:&quot;http://www.opengis.net/sld&quot;,xlink:&quot;http://www.w3.org/1999/xlink&quot;,xsi:&quot;http://www.w3.org/2001/XMLSchema-instance&quot;},schemaLocation:&quot;&quot;,getNamespacePrefix:function(uri){var prefix=null;if(uri==null){prefix=this.namespaces[this.defaultPrefix];}else{for(prefix in this.namespaces){if(this.namespaces[prefix]==uri){break;}}}
return prefix;},defaultPrefix:&quot;wmc&quot;,rootPrefix:null,defaultStyleName:&quot;&quot;,defaultStyleTitle:&quot;Default&quot;,initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var root=data.documentElement;this.rootPrefix=root.prefix;var context={version:root.getAttribute(&quot;version&quot;)};this.runChildNodes(context,root);return context;},runChildNodes:function(obj,node){var children=node.childNodes;var childNode,processor,prefix,local;for(var i=0,len=children.length;i&lt;len;++i){childNode=children[i];if(childNode.nodeType==1){prefix=this.getNamespacePrefix(childNode.namespaceURI);local=childNode.nodeName.split(&quot;:&quot;).pop();processor=this[&quot;read_&quot;+prefix+&quot;_&quot;+local];if(processor){processor.apply(this,[obj,childNode]);}}}},read_wmc_General:function(context,node){this.runChildNodes(context,node);},read_wmc_BoundingBox:function(context,node){context.projection=node.getAttribute(&quot;SRS&quot;);context.bounds=new OpenLayers.Bounds(parseFloat(node.getAttribute(&quot;minx&quot;)),parseFloat(node.getAttribute(&quot;miny&quot;)),parseFloat(node.getAttribute(&quot;maxx&quot;)),parseFloat(node.getAttribute(&quot;maxy&quot;)));},read_wmc_LayerList:function(context,node){context.layers=[];this.runChildNodes(context,node);},read_wmc_Layer:function(context,node){var layerInfo={params:this.layerParams||{},options:{visibility:(node.getAttribute(&quot;hidden&quot;)!=&quot;1&quot;),queryable:(node.getAttribute(&quot;queryable&quot;)==&quot;1&quot;)},formats:[],styles:[]};this.runChildNodes(layerInfo,node);layerInfo.params.layers=layerInfo.name;layerInfo.options.maxExtent=layerInfo.maxExtent;var layer=this.getLayerFromInfo(layerInfo);context.layers.push(layer);},getLayerFromInfo:function(layerInfo){var options=layerInfo.options;if(this.layerOptions){OpenLayers.Util.applyDefaults(options,this.layerOptions);}
var layer=new OpenLayers.Layer.WMS(layerInfo.title,layerInfo.href,layerInfo.params,options);return layer;},read_wmc_Extension:function(obj,node){this.runChildNodes(obj,node);},read_ol_units:function(layerInfo,node){layerInfo.options.units=this.getChildValue(node);},read_ol_maxExtent:function(obj,node){var bounds=new OpenLayers.Bounds(node.getAttribute(&quot;minx&quot;),node.getAttribute(&quot;miny&quot;),node.getAttribute(&quot;maxx&quot;),node.getAttribute(&quot;maxy&quot;));obj.maxExtent=bounds;},read_ol_transparent:function(layerInfo,node){layerInfo.params.transparent=this.getChildValue(node);},read_ol_numZoomLevels:function(layerInfo,node){layerInfo.options.numZoomLevels=parseInt(this.getChildValue(node));},read_ol_opacity:function(layerInfo,node){layerInfo.options.opacity=parseFloat(this.getChildValue(node));},read_ol_singleTile:function(layerInfo,node){layerInfo.options.singleTile=(this.getChildValue(node)==&quot;true&quot;);},read_ol_isBaseLayer:function(layerInfo,node){layerInfo.options.isBaseLayer=(this.getChildValue(node)==&quot;true&quot;);},read_ol_displayInLayerSwitcher:function(layerInfo,node){layerInfo.options.displayInLayerSwitcher=(this.getChildValue(node)==&quot;true&quot;);},read_wmc_Server:function(layerInfo,node){layerInfo.params.version=node.getAttribute(&quot;version&quot;);this.runChildNodes(layerInfo,node);},read_wmc_FormatList:function(layerInfo,node){this.runChildNodes(layerInfo,node);},read_wmc_Format:function(layerInfo,node){var format=this.getChildValue(node);layerInfo.formats.push(format);if(node.getAttribute(&quot;current&quot;)==&quot;1&quot;){layerInfo.params.format=format;}},read_wmc_StyleList:function(layerInfo,node){this.runChildNodes(layerInfo,node);},read_wmc_Style:function(layerInfo,node){var style={};this.runChildNodes(style,node);if(node.getAttribute(&quot;current&quot;)==&quot;1&quot;){if(style.href){layerInfo.params.sld=style.href;}else if(style.body){layerInfo.params.sld_body=style.body;}else{layerInfo.params.styles=style.name;}}
layerInfo.styles.push(style);},read_wmc_SLD:function(style,node){this.runChildNodes(style,node);},read_sld_StyledLayerDescriptor:function(sld,node){var xml=OpenLayers.Format.XML.prototype.write.apply(this,[node]);sld.body=xml;},read_wmc_OnlineResource:function(obj,node){obj.href=this.getAttributeNS(node,this.namespaces.xlink,&quot;href&quot;);},read_wmc_Name:function(obj,node){var name=this.getChildValue(node);if(name){obj.name=name;}},read_wmc_Title:function(obj,node){var title=this.getChildValue(node);if(title){obj.title=title;}},read_wmc_MetadataURL:function(layerInfo,node){var metadataURL={};var links=node.getElementsByTagName(&quot;OnlineResource&quot;);if(links.length&gt;0){this.read_wmc_OnlineResource(metadataURL,links[0]);}
layerInfo.options.metadataURL=metadataURL.href;},read_wmc_Abstract:function(obj,node){var abst=this.getChildValue(node);if(abst){obj[&quot;abstract&quot;]=abst;}},read_wmc_LatLonBoundingBox:function(layer,node){layer.llbbox=[parseFloat(node.getAttribute(&quot;minx&quot;)),parseFloat(node.getAttribute(&quot;miny&quot;)),parseFloat(node.getAttribute(&quot;maxx&quot;)),parseFloat(node.getAttribute(&quot;maxy&quot;))];},read_wmc_LegendURL:function(style,node){var legend={width:node.getAttribute(&apos;width&apos;),height:node.getAttribute(&apos;height&apos;)};var links=node.getElementsByTagName(&quot;OnlineResource&quot;);if(links.length&gt;0){this.read_wmc_OnlineResource(legend,links[0]);}
style.legend=legend;},write:function(context,options){var root=this.createElementDefaultNS(&quot;ViewContext&quot;);this.setAttributes(root,{version:this.VERSION,id:(options&amp;&amp;typeof options.id==&quot;string&quot;)?options.id:OpenLayers.Util.createUniqueID(&quot;OpenLayers_Context_&quot;)});this.setAttributeNS(root,this.namespaces.xsi,&quot;xsi:schemaLocation&quot;,this.schemaLocation);root.appendChild(this.write_wmc_General(context));root.appendChild(this.write_wmc_LayerList(context));return OpenLayers.Format.XML.prototype.write.apply(this,[root]);},createElementDefaultNS:function(name,childValue,attributes){var node=this.createElementNS(this.namespaces[this.defaultPrefix],name);if(childValue){node.appendChild(this.createTextNode(childValue));}
if(attributes){this.setAttributes(node,attributes);}
return node;},setAttributes:function(node,obj){var value;for(var name in obj){value=obj[name].toString();if(value.match(/[A-Z]/)){this.setAttributeNS(node,null,name,value);}else{node.setAttribute(name,value);}}},write_wmc_General:function(context){var node=this.createElementDefaultNS(&quot;General&quot;);if(context.size){node.appendChild(this.createElementDefaultNS(&quot;Window&quot;,null,{width:context.size.w,height:context.size.h}));}
var bounds=context.bounds;node.appendChild(this.createElementDefaultNS(&quot;BoundingBox&quot;,null,{minx:bounds.left.toPrecision(10),miny:bounds.bottom.toPrecision(10),maxx:bounds.right.toPrecision(10),maxy:bounds.top.toPrecision(10),SRS:context.projection}));node.appendChild(this.createElementDefaultNS(&quot;Title&quot;,context.title));node.appendChild(this.write_ol_MapExtension(context));return node;},write_ol_MapExtension:function(context){var node=this.createElementDefaultNS(&quot;Extension&quot;);var bounds=context.maxExtent;if(bounds){var maxExtent=this.createElementNS(this.namespaces.ol,&quot;ol:maxExtent&quot;);this.setAttributes(maxExtent,{minx:bounds.left.toPrecision(10),miny:bounds.bottom.toPrecision(10),maxx:bounds.right.toPrecision(10),maxy:bounds.top.toPrecision(10)});node.appendChild(maxExtent);}
return node;},write_wmc_LayerList:function(context){var list=this.createElementDefaultNS(&quot;LayerList&quot;);var layer;for(var i=0,len=context.layers.length;i&lt;len;++i){layer=context.layers[i];if(layer instanceof OpenLayers.Layer.WMS){list.appendChild(this.write_wmc_Layer(layer));}}
return list;},write_wmc_Layer:function(layer){var node=this.createElementDefaultNS(&quot;Layer&quot;,null,{queryable:layer.queryable?&quot;1&quot;:&quot;0&quot;,hidden:layer.visibility?&quot;0&quot;:&quot;1&quot;});node.appendChild(this.write_wmc_Server(layer));node.appendChild(this.createElementDefaultNS(&quot;Name&quot;,layer.params[&quot;LAYERS&quot;]));node.appendChild(this.createElementDefaultNS(&quot;Title&quot;,layer.name));if(layer.metadataURL){node.appendChild(this.write_wmc_MetadataURL(layer));}
node.appendChild(this.write_wmc_FormatList(layer));node.appendChild(this.write_wmc_StyleList(layer));node.appendChild(this.write_wmc_LayerExtension(layer));return node;},write_wmc_LayerExtension:function(layer){var node=this.createElementDefaultNS(&quot;Extension&quot;);var bounds=layer.maxExtent;var maxExtent=this.createElementNS(this.namespaces.ol,&quot;ol:maxExtent&quot;);this.setAttributes(maxExtent,{minx:bounds.left.toPrecision(10),miny:bounds.bottom.toPrecision(10),maxx:bounds.right.toPrecision(10),maxy:bounds.top.toPrecision(10)});node.appendChild(maxExtent);var param=layer.params[&quot;TRANSPARENT&quot;];if(param){var trans=this.createElementNS(this.namespaces.ol,&quot;ol:transparent&quot;);trans.appendChild(this.createTextNode(param));node.appendChild(trans);}
var properties=[&quot;numZoomLevels&quot;,&quot;units&quot;,&quot;isBaseLayer&quot;,&quot;opacity&quot;,&quot;displayInLayerSwitcher&quot;,&quot;singleTile&quot;];var child;for(var i=0,len=properties.length;i&lt;len;++i){child=this.createOLPropertyNode(layer,properties[i]);if(child){node.appendChild(child);}}
return node;},createOLPropertyNode:function(obj,prop){var node=null;if(obj[prop]!=null){node=this.createElementNS(this.namespaces.ol,&quot;ol:&quot;+prop);node.appendChild(this.createTextNode(obj[prop].toString()));}
return node;},write_wmc_Server:function(layer){var node=this.createElementDefaultNS(&quot;Server&quot;);this.setAttributes(node,{service:&quot;OGC:WMS&quot;,version:layer.params[&quot;VERSION&quot;]});node.appendChild(this.write_wmc_OnlineResource(layer.url));return node;},write_wmc_MetadataURL:function(layer){var node=this.createElementDefaultNS(&quot;MetadataURL&quot;);node.appendChild(this.write_wmc_OnlineResource(layer.metadataURL));return node;},write_wmc_FormatList:function(layer){var node=this.createElementDefaultNS(&quot;FormatList&quot;);node.appendChild(this.createElementDefaultNS(&quot;Format&quot;,layer.params[&quot;FORMAT&quot;],{current:&quot;1&quot;}));return node;},write_wmc_StyleList:function(layer){var node=this.createElementDefaultNS(&quot;StyleList&quot;);var style=this.createElementDefaultNS(&quot;Style&quot;,null,{current:&quot;1&quot;});if(layer.params[&quot;SLD&quot;]){var sld=this.createElementDefaultNS(&quot;SLD&quot;);var link=this.write_wmc_OnlineResource(layer.params[&quot;SLD&quot;]);sld.appendChild(link);style.appendChild(sld);}else if(layer.params[&quot;SLD_BODY&quot;]){var sld=this.createElementDefaultNS(&quot;SLD&quot;);var body=layer.params[&quot;SLD_BODY&quot;];var doc=OpenLayers.Format.XML.prototype.read.apply(this,[body]);var imported=doc.documentElement;if(sld.ownerDocument&amp;&amp;sld.ownerDocument.importNode){imported=sld.ownerDocument.importNode(imported,true);}
sld.appendChild(imported);style.appendChild(sld);}else{var name=layer.params[&quot;STYLES&quot;]?layer.params[&quot;STYLES&quot;]:this.defaultStyleName;style.appendChild(this.createElementDefaultNS(&quot;Name&quot;,name));style.appendChild(this.createElementDefaultNS(&quot;Title&quot;,this.defaultStyleTitle));}
node.appendChild(style);return node;},write_wmc_OnlineResource:function(href){var node=this.createElementDefaultNS(&quot;OnlineResource&quot;);this.setAttributeNS(node,this.namespaces.xlink,&quot;xlink:type&quot;,&quot;simple&quot;);this.setAttributeNS(node,this.namespaces.xlink,&quot;xlink:href&quot;,href);return node;},CLASS_NAME:&quot;OpenLayers.Format.WMC.v1&quot;});OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:&quot;1.1.0&quot;,initialize:function(options){OpenLayers.Format.WMSCapabilities.v1_1.prototype.initialize.apply(this,[options]);},CLASS_NAME:&quot;OpenLayers.Format.WMSCapabilities.v1_1_0&quot;});OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:&quot;1.1.1&quot;,initialize:function(options){OpenLayers.Format.WMSCapabilities.v1_1.prototype.initialize.apply(this,[options]);},CLASS_NAME:&quot;OpenLayers.Format.WMSCapabilities.v1_1_1&quot;});OpenLayers.Format.WMSDescribeLayer.v1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(options){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[options]);},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var root=data.documentElement;var children=root.childNodes;var describelayer=[];for(var i=0;i&lt;children.length;++i){childNode=children[i];nodeName=childNode.nodeName;if(nodeName==&apos;LayerDescription&apos;){var owsType=&apos;&apos;;var owsURL=&apos;&apos;;var typeName=&apos;&apos;;if(childNode.getAttribute(&apos;owsType&apos;)){owsType=childNode.getAttribute(&apos;owsType&apos;);owsURL=childNode.getAttribute(&apos;owsURL&apos;);}else{if(childNode.getAttribute(&apos;wfs&apos;)!=&apos;&apos;){owsType=&apos;WFS&apos;;owsURL=childNode.getAttribute(&apos;wfs&apos;);}else if(childNode.getAttribute(&apos;wcs&apos;)!=&apos;&apos;){owsType=&apos;WCS&apos;;owsURL=childNode.getAttribute(&apos;wcs&apos;);}}
query=childNode.getElementsByTagName(&apos;Query&apos;);if(query.length&gt;0){typeName=query[0].getAttribute(&apos;typeName&apos;);if(!typeName){typeName=query[0].getAttribute(&apos;typename&apos;);}}
describelayer.push({owsType:owsType,owsURL:owsURL,typeName:typeName});}}
return describelayer;},CLASS_NAME:&quot;OpenLayers.Format.WMSDescribeLayer.v1_1&quot;});OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:&apos;olHandlerBoxZoomBox&apos;,boxCharacteristics:null,initialize:function(control,callbacks,options){OpenLayers.Handler.prototype.initialize.apply(this,arguments);var callbacks={&quot;down&quot;:this.startBox,&quot;move&quot;:this.moveBox,&quot;out&quot;:this.removeBox,&quot;up&quot;:this.endBox};this.dragHandler=new OpenLayers.Handler.Drag(this,callbacks,{keyMask:this.keyMask});},setMap:function(map){OpenLayers.Handler.prototype.setMap.apply(this,arguments);if(this.dragHandler){this.dragHandler.setMap(map);}},startBox:function(xy){this.zoomBox=OpenLayers.Util.createDiv(&apos;zoomBox&apos;,this.dragHandler.start);this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE[&quot;Popup&quot;]-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,&quot;olDrawBox&quot;);},moveBox:function(xy){var startX=this.dragHandler.start.x;var startY=this.dragHandler.start.y;var deltaX=Math.abs(startX-xy.x);var deltaY=Math.abs(startY-xy.y);this.zoomBox.style.width=Math.max(1,deltaX)+&quot;px&quot;;this.zoomBox.style.height=Math.max(1,deltaY)+&quot;px&quot;;this.zoomBox.style.left=xy.x&lt;startX?xy.x+&quot;px&quot;:startX+&quot;px&quot;;this.zoomBox.style.top=xy.y&lt;startY?xy.y+&quot;px&quot;:startY+&quot;px&quot;;var box=this.getBoxCharacteristics();if(box.newBoxModel){if(xy.x&gt;startX){this.zoomBox.style.width=Math.max(1,deltaX-box.xOffset)+&quot;px&quot;;}
if(xy.y&gt;startY){this.zoomBox.style.height=Math.max(1,deltaY-box.yOffset)+&quot;px&quot;;}}},endBox:function(end){var result;if(Math.abs(this.dragHandler.start.x-end.x)&gt;5||Math.abs(this.dragHandler.start.y-end.y)&gt;5){var start=this.dragHandler.start;var top=Math.min(start.y,end.y);var bottom=Math.max(start.y,end.y);var left=Math.min(start.x,end.x);var right=Math.max(start.x,end.x);result=new OpenLayers.Bounds(left,bottom,right,top);}else{result=this.dragHandler.start.clone();}
this.removeBox();this.callback(&quot;done&quot;,[result]);},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.zoomBox=null;this.boxCharacteristics=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,&quot;olDrawBox&quot;);},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragHandler.activate();return true;}else{return false;}},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.dragHandler.deactivate();return true;}else{return false;}},getBoxCharacteristics:function(){if(!this.boxCharacteristics){var xOffset=parseInt(OpenLayers.Element.getStyle(this.zoomBox,&quot;border-left-width&quot;))+parseInt(OpenLayers.Element.getStyle(this.zoomBox,&quot;border-right-width&quot;))+1;var yOffset=parseInt(OpenLayers.Element.getStyle(this.zoomBox,&quot;border-top-width&quot;))+parseInt(OpenLayers.Element.getStyle(this.zoomBox,&quot;border-bottom-width&quot;))+1;var newBoxModel=OpenLayers.Util.getBrowserName()==&quot;msie&quot;?document.compatMode!=&quot;BackCompat&quot;:true;this.boxCharacteristics={xOffset:xOffset,yOffset:yOffset,newBoxModel:newBoxModel};}
return this.boxCharacteristics;},CLASS_NAME:&quot;OpenLayers.Handler.Box&quot;});OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:&apos;shiftKey&apos;,persist:false,irregular:false,angle:null,fixedRadius:false,feature:null,layer:null,origin:null,initialize:function(control,callbacks,options){this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style[&apos;default&apos;],{});OpenLayers.Handler.prototype.initialize.apply(this,[control,callbacks,options]);this.options=(options)?options:new Object();},setOptions:function(newOptions){OpenLayers.Util.extend(this.options,newOptions);OpenLayers.Util.extend(this,newOptions);},activate:function(){var activated=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var options={displayInLayerSwitcher:false,calculateInRange:function(){return true;}};this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,options);this.map.addLayer(this.layer);activated=true;}
return activated;},deactivate:function(){var deactivated=false;if(OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)){if(this.dragging){this.cancel();}
if(this.layer.map!=null){this.layer.destroy(false);if(this.feature){this.feature.destroy();}}
this.layer=null;this.feature=null;deactivated=true;}
return deactivated;},down:function(evt){this.fixedRadius=!!(this.radius);var maploc=this.map.getLonLatFromPixel(evt.xy);this.origin=new OpenLayers.Geometry.Point(maploc.lon,maploc.lat);if(!this.fixedRadius||this.irregular){this.radius=this.map.getResolution();}
if(this.persist){this.clear();}
this.feature=new OpenLayers.Feature.Vector();this.createGeometry();this.callback(&quot;create&quot;,[this.origin,this.feature]);this.layer.addFeatures([this.feature],{silent:true});this.layer.drawFeature(this.feature,this.style);},move:function(evt){var maploc=this.map.getLonLatFromPixel(evt.xy);var point=new OpenLayers.Geometry.Point(maploc.lon,maploc.lat);if(this.irregular){var ry=Math.sqrt(2)*Math.abs(point.y-this.origin.y)/2;this.radius=Math.max(this.map.getResolution()/2,ry);}else if(this.fixedRadius){this.origin=point;}else{this.calculateAngle(point,evt);this.radius=Math.max(this.map.getResolution()/2,point.distanceTo(this.origin));}
this.modifyGeometry();if(this.irregular){var dx=point.x-this.origin.x;var dy=point.y-this.origin.y;var ratio;if(dy==0){ratio=dx/(this.radius*Math.sqrt(2));}else{ratio=dx/dy;}
this.feature.geometry.resize(1,this.origin,ratio);this.feature.geometry.move(dx/2,dy/2);}
this.layer.drawFeature(this.feature,this.style);},up:function(evt){this.finalize();if(this.start==this.last){this.callback(&quot;done&quot;,[evt.xy]);}},out:function(evt){this.finalize();},createGeometry:function(){this.angle=Math.PI*((1/this.sides)-(1/2));if(this.snapAngle){this.angle+=this.snapAngle*(Math.PI/180);}
this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle);},modifyGeometry:function(){var angle,dx,dy,point;var ring=this.feature.geometry.components[0];if(ring.components.length!=(this.sides+1)){this.createGeometry();ring=this.feature.geometry.components[0];}
for(var i=0;i&lt;this.sides;++i){point=ring.components[i];angle=this.angle+(i*2*Math.PI/this.sides);point.x=this.origin.x+(this.radius*Math.cos(angle));point.y=this.origin.y+(this.radius*Math.sin(angle));point.clearBounds();}},calculateAngle:function(point,evt){var alpha=Math.atan2(point.y-this.origin.y,point.x-this.origin.x);if(this.snapAngle&amp;&amp;(this.snapToggle&amp;&amp;!evt[this.snapToggle])){var snapAngleRad=(Math.PI/180)*this.snapAngle;this.angle=Math.round(alpha/snapAngleRad)*snapAngleRad;}else{this.angle=alpha;}},cancel:function(){this.callback(&quot;cancel&quot;,null);this.finalize();},finalize:function(){this.origin=null;this.radius=this.options.radius;},clear:function(){this.layer.renderer.clear();this.layer.destroyFeatures();},callback:function(name,args){if(this.callbacks[name]){this.callbacks[name].apply(this.control,[this.feature.geometry.clone()]);}
if(!this.persist&amp;&amp;(name==&quot;done&quot;||name==&quot;cancel&quot;)){this.clear();}},CLASS_NAME:&quot;OpenLayers.Handler.RegularPolygon&quot;});OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:true,isBaseLayer:true,isFixed:true,pane:null,mapObject:null,initialize:function(name,options){OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(this.pane==null){this.pane=OpenLayers.Util.createDiv(this.div.id+&quot;_EventPane&quot;);}},destroy:function(){this.mapObject=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments);},setMap:function(map){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width=&quot;100%&quot;;this.pane.style.height=&quot;100%&quot;;if(OpenLayers.Util.getBrowserName()==&quot;msie&quot;){this.pane.style.background=&quot;url(&quot;+OpenLayers.Util.getImagesLocation()+&quot;blank.gif)&quot;;}
if(this.isFixed){this.map.viewPortDiv.appendChild(this.pane);}else{this.map.layerContainerDiv.appendChild(this.pane);}
this.loadMapObject();if(this.mapObject==null){this.loadWarningMessage();}},removeMap:function(map){if(this.pane&amp;&amp;this.pane.parentNode){this.pane.parentNode.removeChild(this.pane);this.pane=null;}
OpenLayers.Layer.prototype.removeMap.apply(this,arguments);},loadWarningMessage:function(){this.div.style.backgroundColor=&quot;#007aaa&quot;;var viewSize=this.map.getSize();var msgW=Math.min(viewSize.w,300);var msgH=Math.min(viewSize.h,200);var size=new OpenLayers.Size(msgW,msgH);var centerPx=new OpenLayers.Pixel(viewSize.w/2,viewSize.h/2);var topLeft=centerPx.add(-size.w/2,-size.h/2);var div=OpenLayers.Util.createDiv(this.name+&quot;_warning&quot;,topLeft,size,null,null,null,&quot;auto&quot;);div.style.padding=&quot;7px&quot;;div.style.backgroundColor=&quot;yellow&quot;;div.innerHTML=this.getWarningHTML();this.div.appendChild(div);},getWarningHTML:function(){return&quot;&quot;;},display:function(display){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display;},setZIndex:function(zIndex){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1;},moveTo:function(bounds,zoomChanged,dragging){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(this.mapObject!=null){var newCenter=this.map.getCenter();var newZoom=this.map.getZoom();if(newCenter!=null){var moOldCenter=this.getMapObjectCenter();var oldCenter=this.getOLLonLatFromMapObjectLonLat(moOldCenter);var moOldZoom=this.getMapObjectZoom();var oldZoom=this.getOLZoomFromMapObjectZoom(moOldZoom);if(!(newCenter.equals(oldCenter))||!(newZoom==oldZoom)){if(dragging&amp;&amp;this.dragPanMapObject&amp;&amp;this.smoothDragPan){var oldPx=this.map.getViewPortPxFromLonLat(oldCenter);var newPx=this.map.getViewPortPxFromLonLat(newCenter);this.dragPanMapObject(newPx.x-oldPx.x,oldPx.y-newPx.y);}else{var center=this.getMapObjectLonLatFromOLLonLat(newCenter);var zoom=this.getMapObjectZoomFromOLZoom(newZoom);this.setMapObjectCenter(center,zoom,dragging);}}}}},getLonLatFromViewPortPx:function(viewPortPx){var lonlat=null;if((this.mapObject!=null)&amp;&amp;(this.getMapObjectCenter()!=null)){var moPixel=this.getMapObjectPixelFromOLPixel(viewPortPx);var moLonLat=this.getMapObjectLonLatFromMapObjectPixel(moPixel);lonlat=this.getOLLonLatFromMapObjectLonLat(moLonLat);}
return lonlat;},getViewPortPxFromLonLat:function(lonlat){var viewPortPx=null;if((this.mapObject!=null)&amp;&amp;(this.getMapObjectCenter()!=null)){var moLonLat=this.getMapObjectLonLatFromOLLonLat(lonlat);var moPixel=this.getMapObjectPixelFromMapObjectLonLat(moLonLat);viewPortPx=this.getOLPixelFromMapObjectPixel(moPixel);}
return viewPortPx;},getOLLonLatFromMapObjectLonLat:function(moLonLat){var olLonLat=null;if(moLonLat!=null){var lon=this.getLongitudeFromMapObjectLonLat(moLonLat);var lat=this.getLatitudeFromMapObjectLonLat(moLonLat);olLonLat=new OpenLayers.LonLat(lon,lat);}
return olLonLat;},getMapObjectLonLatFromOLLonLat:function(olLonLat){var moLatLng=null;if(olLonLat!=null){moLatLng=this.getMapObjectLonLatFromLonLat(olLonLat.lon,olLonLat.lat);}
return moLatLng;},getOLPixelFromMapObjectPixel:function(moPixel){var olPixel=null;if(moPixel!=null){var x=this.getXFromMapObjectPixel(moPixel);var y=this.getYFromMapObjectPixel(moPixel);olPixel=new OpenLayers.Pixel(x,y);}
return olPixel;},getMapObjectPixelFromOLPixel:function(olPixel){var moPixel=null;if(olPixel!=null){moPixel=this.getMapObjectPixelFromXY(olPixel.x,olPixel.y);}
return moPixel;},CLASS_NAME:&quot;OpenLayers.Layer.EventPane&quot;});OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){var props=new Array(&apos;minZoomLevel&apos;,&apos;maxZoomLevel&apos;,&apos;numZoomLevels&apos;);for(var i=0,len=props.length;i&lt;len;i++){var property=props[i];this[property]=(this.options[property]!=null)?this.options[property]:this.map[property];}
if((this.minZoomLevel==null)||(this.minZoomLevel&lt;this.MIN_ZOOM_LEVEL)){this.minZoomLevel=this.MIN_ZOOM_LEVEL;}
var desiredZoomLevels;var limitZoomLevels=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;if(((this.options.numZoomLevels==null)&amp;&amp;(this.options.maxZoomLevel!=null))||((this.numZoomLevels==null)&amp;&amp;(this.maxZoomLevel!=null))){desiredZoomLevels=this.maxZoomLevel-this.minZoomLevel+1;}else{desiredZoomLevels=this.numZoomLevels;}
if(desiredZoomLevels!=null){this.numZoomLevels=Math.min(desiredZoomLevels,limitZoomLevels);}else{this.numZoomLevels=limitZoomLevels;}
this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(this.RESOLUTIONS!=null){var resolutionsIndex=0;this.resolutions=[];for(var i=this.minZoomLevel;i&lt;=this.maxZoomLevel;i++){this.resolutions[resolutionsIndex++]=this.RESOLUTIONS[i];}
this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1];}},getResolution:function(){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getResolution.apply(this,arguments);}else{var resolution=null;var viewSize=this.map.getSize();var extent=this.getExtent();if((viewSize!=null)&amp;&amp;(extent!=null)){resolution=Math.max(extent.getWidth()/viewSize.w,extent.getHeight()/viewSize.h);}
return resolution;}},getExtent:function(){var extent=null;var size=this.map.getSize();var tlPx=new OpenLayers.Pixel(0,0);var tlLL=this.getLonLatFromViewPortPx(tlPx);var brPx=new OpenLayers.Pixel(size.w,size.h);var brLL=this.getLonLatFromViewPortPx(brPx);if((tlLL!=null)&amp;&amp;(brLL!=null)){extent=new OpenLayers.Bounds(tlLL.lon,brLL.lat,brLL.lon,tlLL.lat);}
return extent;},getZoomForResolution:function(resolution){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments);}else{var extent=OpenLayers.Layer.prototype.getExtent.apply(this,[]);return this.getZoomForExtent(extent);}},getOLZoomFromMapObjectZoom:function(moZoom){var zoom=null;if(moZoom!=null){zoom=moZoom-this.minZoomLevel;}
return zoom;},getMapObjectZoomFromOLZoom:function(olZoom){var zoom=null;if(olZoom!=null){zoom=olZoom+this.minZoomLevel;}
return zoom;},CLASS_NAME:&quot;OpenLayers.Layer.FixedZoomLevels&quot;});OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:false,initialize:function(name,url,params,options){var newArguments=arguments;newArguments=[name,options];OpenLayers.Layer.prototype.initialize.apply(this,newArguments);this.url=url;this.params=OpenLayers.Util.extend({},params);},destroy:function(){this.url=null;this.params=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments);},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.options);}
obj=OpenLayers.Layer.prototype.clone.apply(this,[obj]);return obj;},setUrl:function(newUrl){this.url=newUrl;},mergeNewParams:function(newParams){this.params=OpenLayers.Util.extend(this.params,newParams);return this.redraw();},redraw:function(force){if(force){return this.mergeNewParams({&quot;_olSalt&quot;:Math.random()});}else{return OpenLayers.Layer.prototype.redraw.apply(this,[]);}},selectUrl:function(paramString,urls){var product=1;for(var i=0,len=paramString.length;i&lt;len;i++){product*=paramString.charCodeAt(i)*this.URL_HASH_FACTOR;product-=Math.floor(product);}
return urls[Math.floor(product*urls.length)];},getFullRequestString:function(newParams,altUrl){var url=altUrl||this.url;var allParams=OpenLayers.Util.extend({},this.params);allParams=OpenLayers.Util.extend(allParams,newParams);var paramsString=OpenLayers.Util.getParameterString(allParams);if(url instanceof Array){url=this.selectUrl(paramsString,url);}
var urlParams=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(url));for(var key in allParams){if(key.toUpperCase()in urlParams){delete allParams[key];}}
paramsString=OpenLayers.Util.getParameterString(allParams);var requestString=url;if(paramsString!=&quot;&quot;){var lastServerChar=url.charAt(url.length-1);if((lastServerChar==&quot;&amp;&quot;)||(lastServerChar==&quot;?&quot;)){requestString+=paramsString;}else{if(url.indexOf(&apos;?&apos;)==-1){requestString+=&apos;?&apos;+paramsString;}else{requestString+=&apos;&amp;&apos;+paramsString;}}}
return requestString;},CLASS_NAME:&quot;OpenLayers.Layer.HTTPRequest&quot;});OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:true,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(name,url,extent,size,options){this.url=url;this.extent=extent;this.maxExtent=extent;this.size=size;OpenLayers.Layer.prototype.initialize.apply(this,[name,options]);this.aspectRatio=(this.extent.getHeight()/this.size.h)/(this.extent.getWidth()/this.size.w);},destroy:function(){if(this.tile){this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null;}
OpenLayers.Layer.prototype.destroy.apply(this,arguments);},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.options);}
obj=OpenLayers.Layer.prototype.clone.apply(this,[obj]);return obj;},setMap:function(map){if(this.options.maxResolution==null){this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w;}
OpenLayers.Layer.prototype.setMap.apply(this,arguments);},moveTo:function(bounds,zoomChanged,dragging){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var firstRendering=(this.tile==null);if(zoomChanged||firstRendering){this.setTileSize();var ul=new OpenLayers.LonLat(this.extent.left,this.extent.top);var ulPx=this.map.getLayerPxFromLonLat(ul);if(firstRendering){this.tile=new OpenLayers.Tile.Image(this,ulPx,this.extent,null,this.tileSize);this.addTileMonitoringHooks(this.tile);}else{this.tile.size=this.tileSize.clone();this.tile.position=ulPx.clone();}
this.tile.draw();}},setTileSize:function(){var tileWidth=this.extent.getWidth()/this.map.getResolution();var tileHeight=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(tileWidth,tileHeight);},addTileMonitoringHooks:function(tile){tile.onLoadStart=function(){this.events.triggerEvent(&quot;loadstart&quot;);};tile.events.register(&quot;loadstart&quot;,this,tile.onLoadStart);tile.onLoadEnd=function(){this.events.triggerEvent(&quot;loadend&quot;);};tile.events.register(&quot;loadend&quot;,this,tile.onLoadEnd);tile.events.register(&quot;unload&quot;,this,tile.onLoadEnd);},removeTileMonitoringHooks:function(tile){tile.unload();tile.events.un({&quot;loadstart&quot;:tile.onLoadStart,&quot;loadend&quot;:tile.onLoadEnd,&quot;unload&quot;:tile.onLoadEnd,scope:this});},setUrl:function(newUrl){this.url=newUrl;this.tile.draw();},getURL:function(bounds){return this.url;},CLASS_NAME:&quot;OpenLayers.Layer.Image&quot;});OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:false,markers:null,drawn:false,initialize:function(name,options){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.markers=[];},destroy:function(){this.clearMarkers();this.markers=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments);},setOpacity:function(opacity){if(opacity!=this.opacity){this.opacity=opacity;for(var i=0,len=this.markers.length;i&lt;len;i++){this.markers[i].setOpacity(this.opacity);}}},moveTo:function(bounds,zoomChanged,dragging){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(zoomChanged||!this.drawn){for(var i=0,len=this.markers.length;i&lt;len;i++){this.drawMarker(this.markers[i]);}
this.drawn=true;}},addMarker:function(marker){this.markers.push(marker);if(this.opacity!=null){marker.setOpacity(this.opacity);}
if(this.map&amp;&amp;this.map.getExtent()){marker.map=this.map;this.drawMarker(marker);}},removeMarker:function(marker){if(this.markers&amp;&amp;this.markers.length){OpenLayers.Util.removeItem(this.markers,marker);marker.erase();}},clearMarkers:function(){if(this.markers!=null){while(this.markers.length&gt;0){this.removeMarker(this.markers[0]);}}},drawMarker:function(marker){var px=this.map.getLayerPxFromLonLat(marker.lonlat);if(px==null){marker.display(false);}else{if(!marker.isDrawn()){var markerImg=marker.draw(px);this.div.appendChild(markerImg);}else if(marker.icon){marker.icon.moveTo(px);}}},getDataExtent:function(){var maxExtent=null;if(this.markers&amp;&amp;(this.markers.length&gt;0)){var maxExtent=new OpenLayers.Bounds();for(var i=0,len=this.markers.length;i&lt;len;i++){var marker=this.markers[i];maxExtent.extend(marker.lonlat);}}
return maxExtent;},CLASS_NAME:&quot;OpenLayers.Layer.Markers&quot;});OpenLayers.Layer.SphericalMercator={getExtent:function(){var extent=null;if(this.sphericalMercator){extent=this.map.calculateBounds();}else{extent=OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this);}
return extent;},initMercatorParameters:function(){this.RESOLUTIONS=[];var maxResolution=156543.0339;for(var zoom=0;zoom&lt;=this.MAX_ZOOM_LEVEL;++zoom){this.RESOLUTIONS[zoom]=maxResolution/Math.pow(2,zoom);}
this.units=&quot;m&quot;;this.projection=&quot;EPSG:900913&quot;;},forwardMercator:function(lon,lat){var x=lon*20037508.34/180;var y=Math.log(Math.tan((90+lat)*Math.PI/360))/(Math.PI/180);y=y*20037508.34/180;return new OpenLayers.LonLat(x,y);},inverseMercator:function(x,y){var lon=(x/20037508.34)*180;var lat=(y/20037508.34)*180;lat=180/Math.PI*(2*Math.atan(Math.exp(lat*Math.PI/180))-Math.PI/2);return new OpenLayers.LonLat(lon,lat);},projectForward:function(point){var lonlat=OpenLayers.Layer.SphericalMercator.forwardMercator(point.x,point.y);point.x=lonlat.lon;point.y=lonlat.lat;return point;},projectInverse:function(point){var lonlat=OpenLayers.Layer.SphericalMercator.inverseMercator(point.x,point.y);point.x=lonlat.lon;point.y=lonlat.lat;return point;}};OpenLayers.Projection.addTransform(&quot;EPSG:4326&quot;,&quot;EPSG:900913&quot;,OpenLayers.Layer.SphericalMercator.projectForward);OpenLayers.Projection.addTransform(&quot;EPSG:900913&quot;,&quot;EPSG:4326&quot;,OpenLayers.Layer.SphericalMercator.projectInverse);OpenLayers.Tile.WFS=OpenLayers.Class(OpenLayers.Tile,{features:null,url:null,request:null,initialize:function(layer,position,bounds,url,size){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=url;this.features=[];},destroy:function(){OpenLayers.Tile.prototype.destroy.apply(this,arguments);this.destroyAllFeatures();this.features=null;this.url=null;if(this.request){this.request.abort();this.request=null;}},clear:function(){this.destroyAllFeatures();},draw:function(){if(OpenLayers.Tile.prototype.draw.apply(this,arguments)){if(this.isLoading){this.events.triggerEvent(&quot;reload&quot;);}else{this.isLoading=true;this.events.triggerEvent(&quot;loadstart&quot;);}
this.loadFeaturesForRegion(this.requestSuccess);}},loadFeaturesForRegion:function(success,failure){if(this.request){this.request.abort();}
this.request=OpenLayers.Request.GET({url:this.url,success:success,failure:failure,scope:this});},requestSuccess:function(request){if(this.features){var doc=request.responseXML;if(!doc||!doc.documentElement){doc=request.responseText;}
if(this.layer.vectorMode){this.layer.addFeatures(this.layer.formatObject.read(doc));}else{var xml=new OpenLayers.Format.XML();if(typeof doc==&quot;string&quot;){doc=xml.read(doc);}
var resultFeatures=xml.getElementsByTagNameNS(doc,&quot;http://www.opengis.net/gml&quot;,&quot;featureMember&quot;);this.addResults(resultFeatures);}}
if(this.events){this.events.triggerEvent(&quot;loadend&quot;);}
this.request=null;},addResults:function(results){for(var i=0;i&lt;results.length;i++){var feature=new this.layer.featureClass(this.layer,results[i]);this.features.push(feature);}},destroyAllFeatures:function(){while(this.features.length&gt;0){var feature=this.features.shift();feature.destroy();}},CLASS_NAME:&quot;OpenLayers.Tile.WFS&quot;});OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,EVENT_TYPES:[&quot;featureadded&quot;],featureAdded:function(){},handlerOptions:null,initialize:function(layer,handler,options){this.EVENT_TYPES=OpenLayers.Control.DrawFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[options]);this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(vertex,feature){this.layer.events.triggerEvent(&quot;sketchmodified&quot;,{vertex:vertex,feature:feature});},create:function(vertex,feature){this.layer.events.triggerEvent(&quot;sketchstarted&quot;,{vertex:vertex,feature:feature});}},this.callbacks);this.layer=layer;var sketchStyle=this.layer.styleMap&amp;&amp;this.layer.styleMap.styles.temporary;if(sketchStyle){this.handlerOptions=this.handlerOptions||{};this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({&quot;default&quot;:sketchStyle})});}
this.handler=new handler(this,this.callbacks,this.handlerOptions);},drawFeature:function(geometry){var feature=new OpenLayers.Feature.Vector(geometry);var proceed=this.layer.events.triggerEvent(&quot;sketchcomplete&quot;,{feature:feature});if(proceed!==false){feature.state=OpenLayers.State.INSERT;this.layer.addFeatures([feature]);this.featureAdded(feature);this.events.triggerEvent(&quot;featureadded&quot;,{feature:feature});}},CLASS_NAME:&quot;OpenLayers.Control.DrawFeature&quot;});OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:[&apos;measure&apos;,&apos;measurepartial&apos;],handlerOptions:null,callbacks:null,displaySystem:&apos;metric&apos;,geodesic:false,displaySystemUnits:{geographic:[&apos;dd&apos;],english:[&apos;mi&apos;,&apos;ft&apos;,&apos;in&apos;],metric:[&apos;km&apos;,&apos;m&apos;]},partialDelay:300,delayedTrigger:null,persist:false,initialize:function(handler,options){this.EVENT_TYPES=OpenLayers.Control.Measure.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[options]);this.callbacks=OpenLayers.Util.extend({done:this.measureComplete,point:this.measurePartial},this.callbacks);this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new handler(this,this.callbacks,this.handlerOptions);},cancel:function(){this.handler.cancel();},updateHandler:function(handler,options){var active=this.active;if(active){this.deactivate();}
this.handler=new handler(this,this.callbacks,options);if(active){this.activate();}},measureComplete:function(geometry){if(this.delayedTrigger){window.clearTimeout(this.delayedTrigger);}
this.measure(geometry,&quot;measure&quot;);},measurePartial:function(point,geometry){this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.measure(geometry,&quot;measurepartial&quot;);},this),this.partialDelay);},measure:function(geometry,eventType){var stat,order;if(geometry.CLASS_NAME.indexOf(&apos;LineString&apos;)&gt;-1){stat=this.getBestLength(geometry);order=1;}else{stat=this.getBestArea(geometry);order=2;}
this.events.triggerEvent(eventType,{measure:stat[0],units:stat[1],order:order,geometry:geometry});},getBestArea:function(geometry){var units=this.displaySystemUnits[this.displaySystem];var unit,area;for(var i=0,len=units.length;i&lt;len;++i){unit=units[i];area=this.getArea(geometry,unit);if(area&gt;1){break;}}
return[area,unit];},getArea:function(geometry,units){var area,geomUnits;if(this.geodesic){area=geometry.getGeodesicArea(this.map.getProjectionObject());geomUnits=&quot;m&quot;;}else{area=geometry.getArea();geomUnits=this.map.getUnits();}
var inPerDisplayUnit=OpenLayers.INCHES_PER_UNIT[units];if(inPerDisplayUnit){var inPerMapUnit=OpenLayers.INCHES_PER_UNIT[geomUnits];area*=Math.pow((inPerMapUnit/inPerDisplayUnit),2);}
return area;},getBestLength:function(geometry){var units=this.displaySystemUnits[this.displaySystem];var unit,length;for(var i=0,len=units.length;i&lt;len;++i){unit=units[i];length=this.getLength(geometry,unit);if(length&gt;1){break;}}
return[length,unit];},getLength:function(geometry,units){var length,geomUnits;if(this.geodesic){length=geometry.getGeodesicLength(this.map.getProjectionObject());geomUnits=&quot;m&quot;;}else{length=geometry.getLength();geomUnits=this.map.getUnits();}
var inPerDisplayUnit=OpenLayers.INCHES_PER_UNIT[units];if(inPerDisplayUnit){var inPerMapUnit=OpenLayers.INCHES_PER_UNIT[geomUnits];length*=(inPerMapUnit/inPerDisplayUnit);}
return length;},CLASS_NAME:&quot;OpenLayers.Control.Measure&quot;});OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:false,alwaysZoom:false,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask});},zoomBox:function(position){if(position instanceof OpenLayers.Bounds){if(!this.out){var minXY=this.map.getLonLatFromPixel(new OpenLayers.Pixel(position.left,position.bottom));var maxXY=this.map.getLonLatFromPixel(new OpenLayers.Pixel(position.right,position.top));var bounds=new OpenLayers.Bounds(minXY.lon,minXY.lat,maxXY.lon,maxXY.lat);}else{var pixWidth=Math.abs(position.right-position.left);var pixHeight=Math.abs(position.top-position.bottom);var zoomFactor=Math.min((this.map.size.h/pixHeight),(this.map.size.w/pixWidth));var extent=this.map.getExtent();var center=this.map.getLonLatFromPixel(position.getCenterPixel());var xmin=center.lon-(extent.getWidth()/2)*zoomFactor;var xmax=center.lon+(extent.getWidth()/2)*zoomFactor;var ymin=center.lat-(extent.getHeight()/2)*zoomFactor;var ymax=center.lat+(extent.getHeight()/2)*zoomFactor;var bounds=new OpenLayers.Bounds(xmin,ymin,xmax,ymax);}
var lastZoom=this.map.getZoom();this.map.zoomToExtent(bounds);if(lastZoom==this.map.getZoom()&amp;&amp;this.alwaysZoom==true){this.map.zoomTo(lastZoom+(this.out?-1:1));}}else{if(!this.out){this.map.setCenter(this.map.getLonLatFromPixel(position),this.map.getZoom()+1);}else{this.map.setCenter(this.map.getLonLatFromPixel(position),this.map.getZoom()-1);}}},CLASS_NAME:&quot;OpenLayers.Control.ZoomBox&quot;});OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{initialize:function(options){OpenLayers.Format.WFSCapabilities.v1.prototype.initialize.apply(this,[options]);},CLASS_NAME:&quot;OpenLayers.Format.WFSCapabilities.v1_0_0&quot;});OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{initialize:function(options){OpenLayers.Format.WFSCapabilities.v1.prototype.initialize.apply(this,[options]);},CLASS_NAME:&quot;OpenLayers.Format.WFSCapabilities.v1_1_0&quot;});OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(options){this.regExes={&apos;typeStr&apos;:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,&apos;spaces&apos;:/\s+/,&apos;parenComma&apos;:/\)\s*,\s*\(/,&apos;doubleParenComma&apos;:/\)\s*\)\s*,\s*\(\s*\(/,&apos;trimParens&apos;:/^\s*\(?(.*?)\)?\s*$/};OpenLayers.Format.prototype.initialize.apply(this,[options]);},read:function(wkt){var features,type,str;var matches=this.regExes.typeStr.exec(wkt);if(matches){type=matches[1].toLowerCase();str=matches[2];if(this.parse[type]){features=this.parse[type].apply(this,[str]);}
if(this.internalProjection&amp;&amp;this.externalProjection){if(features&amp;&amp;features.CLASS_NAME==&quot;OpenLayers.Feature.Vector&quot;){features.geometry.transform(this.externalProjection,this.internalProjection);}else if(features&amp;&amp;type!=&quot;geometrycollection&quot;&amp;&amp;typeof features==&quot;object&quot;){for(var i=0,len=features.length;i&lt;len;i++){var component=features[i];component.geometry.transform(this.externalProjection,this.internalProjection);}}}}
return features;},write:function(features){var collection,geometry,type,data,isCollection;if(features.constructor==Array){collection=features;isCollection=true;}else{collection=[features];isCollection=false;}
var pieces=[];if(isCollection){pieces.push(&apos;GEOMETRYCOLLECTION(&apos;);}
for(var i=0,len=collection.length;i&lt;len;++i){if(isCollection&amp;&amp;i&gt;0){pieces.push(&apos;,&apos;);}
geometry=collection[i].geometry;type=geometry.CLASS_NAME.split(&apos;.&apos;)[2].toLowerCase();if(!this.extract[type]){return null;}
if(this.internalProjection&amp;&amp;this.externalProjection){geometry=geometry.clone();geometry.transform(this.internalProjection,this.externalProjection);}
data=this.extract[type].apply(this,[geometry]);pieces.push(type.toUpperCase()+&apos;(&apos;+data+&apos;)&apos;);}
if(isCollection){pieces.push(&apos;)&apos;);}
return pieces.join(&apos;&apos;);},extract:{&apos;point&apos;:function(point){return point.x+&apos; &apos;+point.y;},&apos;multipoint&apos;:function(multipoint){var array=[];for(var i=0,len=multipoint.components.length;i&lt;len;++i){array.push(this.extract.point.apply(this,[multipoint.components[i]]));}
return array.join(&apos;,&apos;);},&apos;linestring&apos;:function(linestring){var array=[];for(var i=0,len=linestring.components.length;i&lt;len;++i){array.push(this.extract.point.apply(this,[linestring.components[i]]));}
return array.join(&apos;,&apos;);},&apos;multilinestring&apos;:function(multilinestring){var array=[];for(var i=0,len=multilinestring.components.length;i&lt;len;++i){array.push(&apos;(&apos;+
this.extract.linestring.apply(this,[multilinestring.components[i]])+&apos;)&apos;);}
return array.join(&apos;,&apos;);},&apos;polygon&apos;:function(polygon){var array=[];for(var i=0,len=polygon.components.length;i&lt;len;++i){array.push(&apos;(&apos;+
this.extract.linestring.apply(this,[polygon.components[i]])+&apos;)&apos;);}
return array.join(&apos;,&apos;);},&apos;multipolygon&apos;:function(multipolygon){var array=[];for(var i=0,len=multipolygon.components.length;i&lt;len;++i){array.push(&apos;(&apos;+
this.extract.polygon.apply(this,[multipolygon.components[i]])+&apos;)&apos;);}
return array.join(&apos;,&apos;);}},parse:{&apos;point&apos;:function(str){var coords=OpenLayers.String.trim(str).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(coords[0],coords[1]));},&apos;multipoint&apos;:function(str){var points=OpenLayers.String.trim(str).split(&apos;,&apos;);var components=[];for(var i=0,len=points.length;i&lt;len;++i){components.push(this.parse.point.apply(this,[points[i]]).geometry);}
return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(components));},&apos;linestring&apos;:function(str){var points=OpenLayers.String.trim(str).split(&apos;,&apos;);var components=[];for(var i=0,len=points.length;i&lt;len;++i){components.push(this.parse.point.apply(this,[points[i]]).geometry);}
return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(components));},&apos;multilinestring&apos;:function(str){var line;var lines=OpenLayers.String.trim(str).split(this.regExes.parenComma);var components=[];for(var i=0,len=lines.length;i&lt;len;++i){line=lines[i].replace(this.regExes.trimParens,&apos;$1&apos;);components.push(this.parse.linestring.apply(this,[line]).geometry);}
return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(components));},&apos;polygon&apos;:function(str){var ring,linestring,linearring;var rings=OpenLayers.String.trim(str).split(this.regExes.parenComma);var components=[];for(var i=0,len=rings.length;i&lt;len;++i){ring=rings[i].replace(this.regExes.trimParens,&apos;$1&apos;);linestring=this.parse.linestring.apply(this,[ring]).geometry;linearring=new OpenLayers.Geometry.LinearRing(linestring.components);components.push(linearring);}
return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(components));},&apos;multipolygon&apos;:function(str){var polygon;var polygons=OpenLayers.String.trim(str).split(this.regExes.doubleParenComma);var components=[];for(var i=0,len=polygons.length;i&lt;len;++i){polygon=polygons[i].replace(this.regExes.trimParens,&apos;$1&apos;);components.push(this.parse.polygon.apply(this,[polygon]).geometry);}
return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(components));},&apos;geometrycollection&apos;:function(str){str=str.replace(/,\s*([A-Za-z])/g,&apos;|$1&apos;);var wktArray=OpenLayers.String.trim(str).split(&apos;|&apos;);var components=[];for(var i=0,len=wktArray.length;i&lt;len;++i){components.push(OpenLayers.Format.WKT.prototype.read.apply(this,[wktArray[i]]));}
return components;}},CLASS_NAME:&quot;OpenLayers.Format.WKT&quot;});OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:&quot;1.0.0&quot;,schemaLocation:&quot;http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd&quot;,initialize:function(options){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[options]);},CLASS_NAME:&quot;OpenLayers.Format.WMC.v1_0_0&quot;});OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:&quot;1.1.0&quot;,schemaLocation:&quot;http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd&quot;,initialize:function(options){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[options]);},read_sld_MinScaleDenominator:function(layerInfo,node){layerInfo.options.maxScale=this.getChildValue(node);},read_sld_MaxScaleDenominator:function(layerInfo,node){layerInfo.options.minScale=this.getChildValue(node);},write_wmc_Layer:function(layer){var node=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[layer]);if(layer.options.resolutions||layer.options.scales||layer.options.minResolution||layer.options.maxScale){var minSD=this.createElementNS(this.namespaces.sld,&quot;sld:MinScaleDenominator&quot;);minSD.appendChild(this.createTextNode(layer.maxScale.toPrecision(10)));node.insertBefore(minSD,node.childNodes[3]);}
if(layer.options.resolutions||layer.options.scales||layer.options.maxResolution||layer.options.minScale){var maxSD=this.createElementNS(this.namespaces.sld,&quot;sld:MaxScaleDenominator&quot;);maxSD.appendChild(this.createTextNode(layer.minScale.toPrecision(10)));node.insertBefore(maxSD,node.childNodes[4]);}
return node;},CLASS_NAME:&quot;OpenLayers.Format.WMC.v1_1_0&quot;});OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{initialize:function(name,options){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments);},drawMarker:function(marker){var bounds=marker.bounds;var topleft=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(bounds.left,bounds.top));var botright=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(bounds.right,bounds.bottom));if(botright==null||topleft==null){marker.display(false);}else{var sz=new OpenLayers.Size(Math.max(1,botright.x-topleft.x),Math.max(1,botright.y-topleft.y));var markerDiv=marker.draw(topleft,sz);if(!marker.drawn){this.div.appendChild(markerDiv);marker.drawn=true;}}},removeMarker:function(marker){OpenLayers.Util.removeItem(this.markers,marker);if((marker.div!=null)&amp;&amp;(marker.div.parentNode==this.div)){this.div.removeChild(marker.div);}},CLASS_NAME:&quot;OpenLayers.Layer.Boxes&quot;});OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:true,initialize:function(name,location,options){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[name,options]);this.location=location;this.features=[];},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null;},loadRSS:function(){if(!this.loaded){this.events.triggerEvent(&quot;loadstart&quot;);OpenLayers.Request.GET({url:this.location,success:this.parseData,scope:this});this.loaded=true;}},moveTo:function(bounds,zoomChanged,minor){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);if(this.visibility&amp;&amp;!this.loaded){this.loadRSS();}},parseData:function(ajaxRequest){var doc=ajaxRequest.responseXML;if(!doc||!doc.documentElement){doc=OpenLayers.Format.XML.prototype.read(ajaxRequest.responseText);}
if(this.useFeedTitle){var name=null;try{name=doc.getElementsByTagNameNS(&apos;*&apos;,&apos;title&apos;)[0].firstChild.nodeValue;}
catch(e){name=doc.getElementsByTagName(&apos;title&apos;)[0].firstChild.nodeValue;}
if(name){this.setName(name);}}
var options={};OpenLayers.Util.extend(options,this.formatOptions);if(this.map&amp;&amp;!this.projection.equals(this.map.getProjectionObject())){options.externalProjection=this.projection;options.internalProjection=this.map.getProjectionObject();}
var format=new OpenLayers.Format.GeoRSS(options);var features=format.read(doc);for(var i=0,len=features.length;i&lt;len;i++){var data={};var feature=features[i];if(!feature.geometry){continue;}
var title=feature.attributes.title?feature.attributes.title:&quot;Untitled&quot;;var description=feature.attributes.description?feature.attributes.description:&quot;No description.&quot;;var link=feature.attributes.link?feature.attributes.link:&quot;&quot;;var location=feature.geometry.getBounds().getCenterLonLat();data.icon=this.icon==null?OpenLayers.Marker.defaultIcon():this.icon.clone();data.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120);if(title||description){data.title=title;data.description=description;var contentHTML=&apos;&lt;div class=&quot;olLayerGeoRSSClose&quot;&gt;[x]&lt;/div&gt;&apos;;contentHTML+=&apos;&lt;div class=&quot;olLayerGeoRSSTitle&quot;&gt;&apos;;if(link){contentHTML+=&apos;&lt;a class=&quot;link&quot; href=&quot;&apos;+link+&apos;&quot; target=&quot;_blank&quot;&gt;&apos;;}
contentHTML+=title;if(link){contentHTML+=&apos;&lt;/a&gt;&apos;;}
contentHTML+=&apos;&lt;/div&gt;&apos;;contentHTML+=&apos;&lt;div style=&quot;&quot; class=&quot;olLayerGeoRSSDescription&quot;&gt;&apos;;contentHTML+=description;contentHTML+=&apos;&lt;/div&gt;&apos;;data[&apos;popupContentHTML&apos;]=contentHTML;}
var feature=new OpenLayers.Feature(this,location,data);this.features.push(feature);var marker=feature.createMarker();marker.events.register(&apos;click&apos;,feature,this.markerClick);this.addMarker(marker);}
this.events.triggerEvent(&quot;loadend&quot;);},markerClick:function(evt){var sameMarkerClicked=(this==this.layer.selectedFeature);this.layer.selectedFeature=(!sameMarkerClicked)?this:null;for(var i=0,len=this.layer.map.popups.length;i&lt;len;i++){this.layer.map.removePopup(this.layer.map.popups[i]);}
if(!sameMarkerClicked){var popup=this.createPopup();OpenLayers.Event.observe(popup.div,&quot;click&quot;,OpenLayers.Function.bind(function(){for(var i=0,len=this.layer.map.popups.length;i&lt;len;i++){this.layer.map.removePopup(this.layer.map.popups[i]);}},this));this.layer.map.addPopup(popup);}
OpenLayers.Event.stop(evt);},clearFeatures:function(){if(this.features!=null){while(this.features.length&gt;0){var feature=this.features[0];OpenLayers.Util.removeItem(this.features,feature);feature.destroy();}}},CLASS_NAME:&quot;OpenLayers.Layer.GeoRSS&quot;});OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:19,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062,0.00001072883605957031,0.00000536441802978515,0.00000268220901489257],type:null,sphericalMercator:false,dragObject:null,termsOfUse:null,poweredBy:null,initialize:function(name,options){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);this.addContainerPxFunction();if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters();}},loadMapObject:function(){try{this.mapObject=new GMap2(this.div);if(typeof this.mapObject.getDragObject==&quot;function&quot;){this.dragObject=this.mapObject.getDragObject();}else{this.dragPanMapObject=null;}
this.termsOfUse=this.div.lastChild;this.div.removeChild(this.termsOfUse);if(this.isFixed){this.map.viewPortDiv.appendChild(this.termsOfUse);}else{this.map.layerContainerDiv.appendChild(this.termsOfUse);}
this.termsOfUse.style.zIndex=&quot;1100&quot;;this.termsOfUse.style.display=this.div.style.display;this.termsOfUse.style.right=&quot;&quot;;this.termsOfUse.style.bottom=&quot;&quot;;this.termsOfUse.className=&quot;olLayerGoogleCopyright&quot;;this.poweredBy=this.div.lastChild;this.div.removeChild(this.poweredBy);if(this.isFixed){this.map.viewPortDiv.appendChild(this.poweredBy);}else{this.map.layerContainerDiv.appendChild(this.poweredBy);}
this.poweredBy.style.zIndex=&quot;1100&quot;;this.poweredBy.style.display=this.div.style.display;this.poweredBy.style.right=&quot;&quot;;this.poweredBy.style.bottom=&quot;&quot;;this.poweredBy.className=&quot;olLayerGooglePoweredBy gmnoprint&quot;;}catch(e){OpenLayers.Console.error(e);}},setMap:function(map){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments);if(this.type!=null){this.map.events.register(&quot;moveend&quot;,this,this.setMapType);}},setMapType:function(){if(this.mapObject.getCenter()!=null){if(OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)==-1){this.mapObject.addMapType(this.type);}
this.mapObject.setMapType(this.type);this.map.events.unregister(&quot;moveend&quot;,this,this.setMapType);}},onMapResize:function(){if(this.visibility&amp;&amp;this.mapObject.isLoaded()){this.mapObject.checkResize();}else{if(!this._resized){var layer=this;var handle=GEvent.addListener(this.mapObject,&quot;load&quot;,function(){GEvent.removeListener(handle);delete layer._resized;layer.mapObject.checkResize();layer.moveTo(layer.map.getCenter(),layer.map.getZoom());})}
this._resized=true;}},display:function(display){OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments);this.termsOfUse.style.display=this.div.style.display;this.poweredBy.style.display=this.div.style.display;},removeMap:function(map){if(this.termsOfUse&amp;&amp;this.termsOfUse.parentNode){this.termsOfUse.parentNode.removeChild(this.termsOfUse);this.termsOfUse=null;}
if(this.poweredBy&amp;&amp;this.poweredBy.parentNode){this.poweredBy.parentNode.removeChild(this.poweredBy);this.poweredBy=null;}
OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments);},getOLBoundsFromMapObjectBounds:function(moBounds){var olBounds=null;if(moBounds!=null){var sw=moBounds.getSouthWest();var ne=moBounds.getNorthEast();if(this.sphericalMercator){sw=this.forwardMercator(sw.lng(),sw.lat());ne=this.forwardMercator(ne.lng(),ne.lat());}else{sw=new OpenLayers.LonLat(sw.lng(),sw.lat());ne=new OpenLayers.LonLat(ne.lng(),ne.lat());}
olBounds=new OpenLayers.Bounds(sw.lon,sw.lat,ne.lon,ne.lat);}
return olBounds;},getMapObjectBoundsFromOLBounds:function(olBounds){var moBounds=null;if(olBounds!=null){var sw=this.sphericalMercator?this.inverseMercator(olBounds.bottom,olBounds.left):new OpenLayers.LonLat(olBounds.bottom,olBounds.left);var ne=this.sphericalMercator?this.inverseMercator(olBounds.top,olBounds.right):new OpenLayers.LonLat(olBounds.top,olBounds.right);moBounds=new GLatLngBounds(new GLatLng(sw.lat,sw.lon),new GLatLng(ne.lat,ne.lon));}
return moBounds;},addContainerPxFunction:function(){if((typeof GMap2!=&quot;undefined&quot;)&amp;&amp;!GMap2.prototype.fromLatLngToContainerPixel){GMap2.prototype.fromLatLngToContainerPixel=function(gLatLng){var gPoint=this.fromLatLngToDivPixel(gLatLng);var div=this.getContainer().firstChild.firstChild;gPoint.x+=div.offsetLeft;gPoint.y+=div.offsetTop;return gPoint;};}},getWarningHTML:function(){return OpenLayers.i18n(&quot;googleWarning&quot;);},setMapObjectCenter:function(center,zoom){this.mapObject.setCenter(center,zoom);},dragPanMapObject:function(dX,dY){this.dragObject.moveBy(new GSize(-dX,dY));},getMapObjectCenter:function(){return this.mapObject.getCenter();},getMapObjectZoom:function(){return this.mapObject.getZoom();},getMapObjectLonLatFromMapObjectPixel:function(moPixel){return this.mapObject.fromContainerPixelToLatLng(moPixel);},getMapObjectPixelFromMapObjectLonLat:function(moLonLat){return this.mapObject.fromLatLngToContainerPixel(moLonLat);},getMapObjectZoomFromMapObjectBounds:function(moBounds){return this.mapObject.getBoundsZoomLevel(moBounds);},getLongitudeFromMapObjectLonLat:function(moLonLat){return this.sphericalMercator?this.forwardMercator(moLonLat.lng(),moLonLat.lat()).lon:moLonLat.lng();},getLatitudeFromMapObjectLonLat:function(moLonLat){var lat=this.sphericalMercator?this.forwardMercator(moLonLat.lng(),moLonLat.lat()).lat:moLonLat.lat();return lat;},getMapObjectLonLatFromLonLat:function(lon,lat){var gLatLng;if(this.sphericalMercator){var lonlat=this.inverseMercator(lon,lat);gLatLng=new GLatLng(lonlat.lat,lonlat.lon);}else{gLatLng=new GLatLng(lat,lon);}
return gLatLng;},getXFromMapObjectPixel:function(moPixel){return moPixel.x;},getYFromMapObjectPixel:function(moPixel){return moPixel.y;},getMapObjectPixelFromXY:function(x,y){return new GPoint(x,y);},CLASS_NAME:&quot;OpenLayers.Layer.Google&quot;});OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,grid:null,singleTile:false,ratio:1.5,buffer:2,numLoadingTiles:0,initialize:function(name,url,params,options){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.events.addEventType(&quot;tileloaded&quot;);this.grid=[];},destroy:function(){this.clearGrid();this.grid=null;this.tileSize=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments);},clearGrid:function(){if(this.grid){for(var iRow=0,len=this.grid.length;iRow&lt;len;iRow++){var row=this.grid[iRow];for(var iCol=0,clen=row.length;iCol&lt;clen;iCol++){var tile=row[iCol];this.removeTileMonitoringHooks(tile);tile.destroy();}}
this.grid=[];}},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.options);}
obj=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[obj]);if(this.tileSize!=null){obj.tileSize=this.tileSize.clone();}
obj.grid=[];return obj;},moveTo:function(bounds,zoomChanged,dragging){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);bounds=bounds||this.map.getExtent();if(bounds!=null){var forceReTile=!this.grid.length||zoomChanged;var tilesBounds=this.getTilesBounds();if(this.singleTile){if(forceReTile||(!dragging&amp;&amp;!tilesBounds.containsBounds(bounds))){this.initSingleTile(bounds);}}else{if(forceReTile||!tilesBounds.containsBounds(bounds,true)){this.initGriddedTiles(bounds);}else{this.moveGriddedTiles(bounds);}}}},setTileSize:function(size){if(this.singleTile){size=this.map.getSize().clone();size.h=parseInt(size.h*this.ratio);size.w=parseInt(size.w*this.ratio);}
OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[size]);},getGridBounds:function(){var msg=&quot;The getGridBounds() function is deprecated. It will be &quot;+&quot;removed in 3.0. Please use getTilesBounds() instead.&quot;;OpenLayers.Console.warn(msg);return this.getTilesBounds();},getTilesBounds:function(){var bounds=null;if(this.grid.length){var bottom=this.grid.length-1;var bottomLeftTile=this.grid[bottom][0];var right=this.grid[0].length-1;var topRightTile=this.grid[0][right];bounds=new OpenLayers.Bounds(bottomLeftTile.bounds.left,bottomLeftTile.bounds.bottom,topRightTile.bounds.right,topRightTile.bounds.top);}
return bounds;},initSingleTile:function(bounds){var center=bounds.getCenterLonLat();var tileWidth=bounds.getWidth()*this.ratio;var tileHeight=bounds.getHeight()*this.ratio;var tileBounds=new OpenLayers.Bounds(center.lon-(tileWidth/2),center.lat-(tileHeight/2),center.lon+(tileWidth/2),center.lat+(tileHeight/2));var ul=new OpenLayers.LonLat(tileBounds.left,tileBounds.top);var px=this.map.getLayerPxFromLonLat(ul);if(!this.grid.length){this.grid[0]=[];}
var tile=this.grid[0][0];if(!tile){tile=this.addTile(tileBounds,px);this.addTileMonitoringHooks(tile);tile.draw();this.grid[0][0]=tile;}else{tile.moveTo(tileBounds,px);}
this.removeExcessTiles(1,1);},calculateGridLayout:function(bounds,extent,resolution){var tilelon=resolution*this.tileSize.w;var tilelat=resolution*this.tileSize.h;var offsetlon=bounds.left-extent.left;var tilecol=Math.floor(offsetlon/tilelon)-this.buffer;var tilecolremain=offsetlon/tilelon-tilecol;var tileoffsetx=-tilecolremain*this.tileSize.w;var tileoffsetlon=extent.left+tilecol*tilelon;var offsetlat=bounds.top-(extent.bottom+tilelat);var tilerow=Math.ceil(offsetlat/tilelat)+this.buffer;var tilerowremain=tilerow-offsetlat/tilelat;var tileoffsety=-tilerowremain*this.tileSize.h;var tileoffsetlat=extent.bottom+tilerow*tilelat;return{tilelon:tilelon,tilelat:tilelat,tileoffsetlon:tileoffsetlon,tileoffsetlat:tileoffsetlat,tileoffsetx:tileoffsetx,tileoffsety:tileoffsety};},initGriddedTiles:function(bounds){var viewSize=this.map.getSize();var minRows=Math.ceil(viewSize.h/this.tileSize.h)+
Math.max(1,2*this.buffer);var minCols=Math.ceil(viewSize.w/this.tileSize.w)+
Math.max(1,2*this.buffer);var extent=this.maxExtent;var resolution=this.map.getResolution();var tileLayout=this.calculateGridLayout(bounds,extent,resolution);var tileoffsetx=Math.round(tileLayout.tileoffsetx);var tileoffsety=Math.round(tileLayout.tileoffsety);var tileoffsetlon=tileLayout.tileoffsetlon;var tileoffsetlat=tileLayout.tileoffsetlat;var tilelon=tileLayout.tilelon;var tilelat=tileLayout.tilelat;this.origin=new OpenLayers.Pixel(tileoffsetx,tileoffsety);var startX=tileoffsetx;var startLon=tileoffsetlon;var rowidx=0;var layerContainerDivLeft=parseInt(this.map.layerContainerDiv.style.left);var layerContainerDivTop=parseInt(this.map.layerContainerDiv.style.top);do{var row=this.grid[rowidx++];if(!row){row=[];this.grid.push(row);}
tileoffsetlon=startLon;tileoffsetx=startX;var colidx=0;do{var tileBounds=new OpenLayers.Bounds(tileoffsetlon,tileoffsetlat,tileoffsetlon+tilelon,tileoffsetlat+tilelat);var x=tileoffsetx;x-=layerContainerDivLeft;var y=tileoffsety;y-=layerContainerDivTop;var px=new OpenLayers.Pixel(x,y);var tile=row[colidx++];if(!tile){tile=this.addTile(tileBounds,px);this.addTileMonitoringHooks(tile);row.push(tile);}else{tile.moveTo(tileBounds,px,false);}
tileoffsetlon+=tilelon;tileoffsetx+=this.tileSize.w;}while((tileoffsetlon&lt;=bounds.right+tilelon*this.buffer)||colidx&lt;minCols);tileoffsetlat-=tilelat;tileoffsety+=this.tileSize.h;}while((tileoffsetlat&gt;=bounds.bottom-tilelat*this.buffer)||rowidx&lt;minRows);this.removeExcessTiles(rowidx,colidx);this.spiralTileLoad();},spiralTileLoad:function(){var tileQueue=[];var directions=[&quot;right&quot;,&quot;down&quot;,&quot;left&quot;,&quot;up&quot;];var iRow=0;var iCell=-1;var direction=OpenLayers.Util.indexOf(directions,&quot;right&quot;);var directionsTried=0;while(directionsTried&lt;directions.length){var testRow=iRow;var testCell=iCell;switch(directions[direction]){case&quot;right&quot;:testCell++;break;case&quot;down&quot;:testRow++;break;case&quot;left&quot;:testCell--;break;case&quot;up&quot;:testRow--;break;}
var tile=null;if((testRow&lt;this.grid.length)&amp;&amp;(testRow&gt;=0)&amp;&amp;(testCell&lt;this.grid[0].length)&amp;&amp;(testCell&gt;=0)){tile=this.grid[testRow][testCell];}
if((tile!=null)&amp;&amp;(!tile.queued)){tileQueue.unshift(tile);tile.queued=true;directionsTried=0;iRow=testRow;iCell=testCell;}else{direction=(direction+1)%4;directionsTried++;}}
for(var i=0,len=tileQueue.length;i&lt;len;i++){var tile=tileQueue[i];tile.draw();tile.queued=false;}},addTile:function(bounds,position){},addTileMonitoringHooks:function(tile){tile.onLoadStart=function(){if(this.numLoadingTiles==0){this.events.triggerEvent(&quot;loadstart&quot;);}
this.numLoadingTiles++;};tile.events.register(&quot;loadstart&quot;,this,tile.onLoadStart);tile.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent(&quot;tileloaded&quot;);if(this.numLoadingTiles==0){this.events.triggerEvent(&quot;loadend&quot;);}};tile.events.register(&quot;loadend&quot;,this,tile.onLoadEnd);tile.events.register(&quot;unload&quot;,this,tile.onLoadEnd);},removeTileMonitoringHooks:function(tile){tile.unload();tile.events.un({&quot;loadstart&quot;:tile.onLoadStart,&quot;loadend&quot;:tile.onLoadEnd,&quot;unload&quot;:tile.onLoadEnd,scope:this});},moveGriddedTiles:function(bounds){var buffer=this.buffer||1;while(true){var tlLayer=this.grid[0][0].position;var tlViewPort=this.map.getViewPortPxFromLayerPx(tlLayer);if(tlViewPort.x&gt;-this.tileSize.w*(buffer-1)){this.shiftColumn(true);}else if(tlViewPort.x&lt;-this.tileSize.w*buffer){this.shiftColumn(false);}else if(tlViewPort.y&gt;-this.tileSize.h*(buffer-1)){this.shiftRow(true);}else if(tlViewPort.y&lt;-this.tileSize.h*buffer){this.shiftRow(false);}else{break;}};},shiftRow:function(prepend){var modelRowIndex=(prepend)?0:(this.grid.length-1);var grid=this.grid;var modelRow=grid[modelRowIndex];var resolution=this.map.getResolution();var deltaY=(prepend)?-this.tileSize.h:this.tileSize.h;var deltaLat=resolution*-deltaY;var row=(prepend)?grid.pop():grid.shift();for(var i=0,len=modelRow.length;i&lt;len;i++){var modelTile=modelRow[i];var bounds=modelTile.bounds.clone();var position=modelTile.position.clone();bounds.bottom=bounds.bottom+deltaLat;bounds.top=bounds.top+deltaLat;position.y=position.y+deltaY;row[i].moveTo(bounds,position);}
if(prepend){grid.unshift(row);}else{grid.push(row);}},shiftColumn:function(prepend){var deltaX=(prepend)?-this.tileSize.w:this.tileSize.w;var resolution=this.map.getResolution();var deltaLon=resolution*deltaX;for(var i=0,len=this.grid.length;i&lt;len;i++){var row=this.grid[i];var modelTileIndex=(prepend)?0:(row.length-1);var modelTile=row[modelTileIndex];var bounds=modelTile.bounds.clone();var position=modelTile.position.clone();bounds.left=bounds.left+deltaLon;bounds.right=bounds.right+deltaLon;position.x=position.x+deltaX;var tile=prepend?this.grid[i].pop():this.grid[i].shift();tile.moveTo(bounds,position);if(prepend){row.unshift(tile);}else{row.push(tile);}}},removeExcessTiles:function(rows,columns){while(this.grid.length&gt;rows){var row=this.grid.pop();for(var i=0,l=row.length;i&lt;l;i++){var tile=row[i];this.removeTileMonitoringHooks(tile);tile.destroy();}}
while(this.grid[0].length&gt;columns){for(var i=0,l=this.grid.length;i&lt;l;i++){var row=this.grid[i];var tile=row.pop();this.removeTileMonitoringHooks(tile);tile.destroy();}}},onMapResize:function(){if(this.singleTile){this.clearGrid();this.setTileSize();}},getTileBounds:function(viewPortPx){var maxExtent=this.maxExtent;var resolution=this.getResolution();var tileMapWidth=resolution*this.tileSize.w;var tileMapHeight=resolution*this.tileSize.h;var mapPoint=this.getLonLatFromViewPortPx(viewPortPx);var tileLeft=maxExtent.left+(tileMapWidth*Math.floor((mapPoint.lon-
maxExtent.left)/tileMapWidth));var tileBottom=maxExtent.bottom+(tileMapHeight*Math.floor((mapPoint.lat-
maxExtent.bottom)/tileMapHeight));return new OpenLayers.Bounds(tileLeft,tileBottom,tileLeft+tileMapWidth,tileBottom+tileMapHeight);},CLASS_NAME:&quot;OpenLayers.Layer.Grid&quot;});OpenLayers.Layer.MultiMap=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[9,1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125],type:null,initialize:function(name,options){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters();this.RESOLUTIONS.unshift(10);}},loadMapObject:function(){try{this.mapObject=new MultimapViewer(this.div);}catch(e){}},getWarningHTML:function(){return OpenLayers.i18n(&quot;getLayerWarning&quot;,{&apos;layerType&apos;:&quot;MM&quot;,&apos;layerLib&apos;:&quot;MultiMap&quot;});},setMapObjectCenter:function(center,zoom){this.mapObject.goToPosition(center,zoom);},getMapObjectCenter:function(){return this.mapObject.getCurrentPosition();},getMapObjectZoom:function(){return this.mapObject.getZoomFactor();},getMapObjectLonLatFromMapObjectPixel:function(moPixel){moPixel.x=moPixel.x-(this.map.getSize().w/2);moPixel.y=moPixel.y-(this.map.getSize().h/2);return this.mapObject.getMapPositionAt(moPixel);},getMapObjectPixelFromMapObjectLonLat:function(moLonLat){return this.mapObject.geoPosToContainerPixels(moLonLat);},getLongitudeFromMapObjectLonLat:function(moLonLat){return this.sphericalMercator?this.forwardMercator(moLonLat.lon,moLonLat.lat).lon:moLonLat.lon;},getLatitudeFromMapObjectLonLat:function(moLonLat){return this.sphericalMercator?this.forwardMercator(moLonLat.lon,moLonLat.lat).lat:moLonLat.lat;},getMapObjectLonLatFromLonLat:function(lon,lat){var mmLatLon;if(this.sphericalMercator){var lonlat=this.inverseMercator(lon,lat);mmLatLon=new MMLatLon(lonlat.lat,lonlat.lon);}else{mmLatLon=new MMLatLon(lat,lon);}
return mmLatLon;},getXFromMapObjectPixel:function(moPixel){return moPixel.x;},getYFromMapObjectPixel:function(moPixel){return moPixel.y;},getMapObjectPixelFromXY:function(x,y){return new MMPoint(x,y);},CLASS_NAME:&quot;OpenLayers.Layer.MultiMap&quot;});OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(name,options){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments);this.features=new Array();},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null;},loadText:function(){if(!this.loaded){if(this.location!=null){var onFail=function(e){this.events.triggerEvent(&quot;loadend&quot;);};this.events.triggerEvent(&quot;loadstart&quot;);OpenLayers.Request.GET({url:this.location,success:this.parseData,failure:onFail,scope:this});this.loaded=true;}}},moveTo:function(bounds,zoomChanged,minor){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);if(this.visibility&amp;&amp;!this.loaded){this.loadText();}},parseData:function(ajaxRequest){var text=ajaxRequest.responseText;var options={};OpenLayers.Util.extend(options,this.formatOptions);if(this.map&amp;&amp;!this.projection.equals(this.map.getProjectionObject())){options.externalProjection=this.projection;options.internalProjection=this.map.getProjectionObject();}
var parser=new OpenLayers.Format.Text(options);var features=parser.read(text);for(var i=0,len=features.length;i&lt;len;i++){var data={};var feature=features[i];var location;var iconSize,iconOffset;location=new OpenLayers.LonLat(feature.geometry.x,feature.geometry.y);if(feature.style.graphicWidth&amp;&amp;feature.style.graphicHeight){iconSize=new OpenLayers.Size(feature.style.graphicWidth,feature.style.graphicHeight);}
if(feature.style.graphicXOffset!==undefined&amp;&amp;feature.style.graphicYOffset!==undefined){iconOffset=new OpenLayers.Pixel(feature.style.graphicXOffset,feature.style.graphicYOffset);}
if(feature.style.externalGraphic!=null){data.icon=new OpenLayers.Icon(feature.style.externalGraphic,iconSize,iconOffset);}else{data.icon=OpenLayers.Marker.defaultIcon();if(iconSize!=null){data.icon.setSize(iconSize);}}
if((feature.attributes.title!=null)&amp;&amp;(feature.attributes.description!=null)){data[&apos;popupContentHTML&apos;]=&apos;&lt;h2&gt;&apos;+feature.attributes.title+&apos;&lt;/h2&gt;&apos;+&apos;&lt;p&gt;&apos;+feature.attributes.description+&apos;&lt;/p&gt;&apos;;}
data[&apos;overflow&apos;]=feature.attributes.overflow||&quot;auto&quot;;var markerFeature=new OpenLayers.Feature(this,location,data);this.features.push(markerFeature);var marker=markerFeature.createMarker();if((feature.attributes.title!=null)&amp;&amp;(feature.attributes.description!=null)){marker.events.register(&apos;click&apos;,markerFeature,this.markerClick);}
this.addMarker(marker);}
this.events.triggerEvent(&quot;loadend&quot;);},markerClick:function(evt){var sameMarkerClicked=(this==this.layer.selectedFeature);this.layer.selectedFeature=(!sameMarkerClicked)?this:null;for(var i=0,len=this.layer.map.popups.length;i&lt;len;i++){this.layer.map.removePopup(this.layer.map.popups[i]);}
if(!sameMarkerClicked){this.layer.map.addPopup(this.createPopup());}
OpenLayers.Event.stop(evt);},clearFeatures:function(){if(this.features!=null){while(this.features.length&gt;0){var feature=this.features[0];OpenLayers.Util.removeItem(this.features,feature);feature.destroy();}}},CLASS_NAME:&quot;OpenLayers.Layer.Text&quot;});OpenLayers.Layer.VirtualEarth=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062],type:null,sphericalMercator:false,initialize:function(name,options){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters();}},loadMapObject:function(){var veDiv=OpenLayers.Util.createDiv(this.name);var sz=this.map.getSize();veDiv.style.width=sz.w+&quot;px&quot;;veDiv.style.height=sz.h+&quot;px&quot;;this.div.appendChild(veDiv);try{this.mapObject=new VEMap(this.name);}catch(e){}
if(this.mapObject!=null){try{this.mapObject.LoadMap(null,null,this.type,true);this.mapObject.AttachEvent(&quot;onmousedown&quot;,function(){return true;});}catch(e){}
this.mapObject.HideDashboard();}
if(!this.mapObject||!this.mapObject.vemapcontrol||!this.mapObject.vemapcontrol.PanMap||(typeof this.mapObject.vemapcontrol.PanMap!=&quot;function&quot;)){this.dragPanMapObject=null;}},getWarningHTML:function(){return OpenLayers.i18n(&quot;getLayerWarning&quot;,{&apos;layerType&apos;:&apos;VE&apos;,&apos;layerLib&apos;:&apos;VirtualEarth&apos;});},setMapObjectCenter:function(center,zoom){this.mapObject.SetCenterAndZoom(center,zoom);},getMapObjectCenter:function(){return this.mapObject.GetCenter();},dragPanMapObject:function(dX,dY){this.mapObject.vemapcontrol.PanMap(dX,-dY);},getMapObjectZoom:function(){return this.mapObject.GetZoomLevel();},getMapObjectLonLatFromMapObjectPixel:function(moPixel){return(typeof VEPixel!=&apos;undefined&apos;)?this.mapObject.PixelToLatLong(moPixel):this.mapObject.PixelToLatLong(moPixel.x,moPixel.y);},getMapObjectPixelFromMapObjectLonLat:function(moLonLat){return this.mapObject.LatLongToPixel(moLonLat);},getLongitudeFromMapObjectLonLat:function(moLonLat){return this.sphericalMercator?this.forwardMercator(moLonLat.Longitude,moLonLat.Latitude).lon:moLonLat.Longitude;},getLatitudeFromMapObjectLonLat:function(moLonLat){return this.sphericalMercator?this.forwardMercator(moLonLat.Longitude,moLonLat.Latitude).lat:moLonLat.Latitude;},getMapObjectLonLatFromLonLat:function(lon,lat){var veLatLong;if(this.sphericalMercator){var lonlat=this.inverseMercator(lon,lat);veLatLong=new VELatLong(lonlat.lat,lonlat.lon);}else{veLatLong=new VELatLong(lat,lon);}
return veLatLong;},getXFromMapObjectPixel:function(moPixel){return moPixel.x;},getYFromMapObjectPixel:function(moPixel){return moPixel.y;},getMapObjectPixelFromXY:function(x,y){return(typeof VEPixel!=&apos;undefined&apos;)?new VEPixel(x,y):new Msn.VE.Pixel(x,y);},CLASS_NAME:&quot;OpenLayers.Layer.VirtualEarth&quot;});OpenLayers.Layer.Yahoo=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062,0.00001072883605957031],type:null,sphericalMercator:false,initialize:function(name,options){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters();}},loadMapObject:function(){try{var size=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject=new YMap(this.div,this.type,size);this.mapObject.disableKeyControls();this.mapObject.disableDragMap();if(!this.mapObject.moveByXY||(typeof this.mapObject.moveByXY!=&quot;function&quot;)){this.dragPanMapObject=null;}}catch(e){}},onMapResize:function(){try{var size=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject.resizeTo(size);}catch(e){}},setMap:function(map){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments);this.map.events.register(&quot;moveend&quot;,this,this.fixYahooEventPane);},fixYahooEventPane:function(){var yahooEventPane=OpenLayers.Util.getElement(&quot;ygddfdiv&quot;);if(yahooEventPane!=null){if(yahooEventPane.parentNode!=null){yahooEventPane.parentNode.removeChild(yahooEventPane);}
this.map.events.unregister(&quot;moveend&quot;,this,this.fixYahooEventPane);}},getWarningHTML:function(){return OpenLayers.i18n(&quot;getLayerWarning&quot;,{&apos;layerType&apos;:&apos;Yahoo&apos;,&apos;layerLib&apos;:&apos;Yahoo&apos;});},getOLZoomFromMapObjectZoom:function(moZoom){var zoom=null;if(moZoom!=null){zoom=OpenLayers.Layer.FixedZoomLevels.prototype.getOLZoomFromMapObjectZoom.apply(this,[moZoom]);zoom=18-zoom;}
return zoom;},getMapObjectZoomFromOLZoom:function(olZoom){var zoom=null;if(olZoom!=null){zoom=OpenLayers.Layer.FixedZoomLevels.prototype.getMapObjectZoomFromOLZoom.apply(this,[olZoom]);zoom=18-zoom;}
return zoom;},setMapObjectCenter:function(center,zoom){this.mapObject.drawZoomAndCenter(center,zoom);},getMapObjectCenter:function(){return this.mapObject.getCenterLatLon();},dragPanMapObject:function(dX,dY){this.mapObject.moveByXY({&apos;x&apos;:-dX,&apos;y&apos;:dY});},getMapObjectZoom:function(){return this.mapObject.getZoomLevel();},getMapObjectLonLatFromMapObjectPixel:function(moPixel){return this.mapObject.convertXYLatLon(moPixel);},getMapObjectPixelFromMapObjectLonLat:function(moLonLat){return this.mapObject.convertLatLonXY(moLonLat);},getLongitudeFromMapObjectLonLat:function(moLonLat){return this.sphericalMercator?this.forwardMercator(moLonLat.Lon,moLonLat.Lat).lon:moLonLat.Lon;},getLatitudeFromMapObjectLonLat:function(moLonLat){return this.sphericalMercator?this.forwardMercator(moLonLat.Lon,moLonLat.Lat).lat:moLonLat.Lat;},getMapObjectLonLatFromLonLat:function(lon,lat){var yLatLong;if(this.sphericalMercator){var lonlat=this.inverseMercator(lon,lat);yLatLong=new YGeoPoint(lonlat.lat,lonlat.lon);}else{yLatLong=new YGeoPoint(lat,lon);}
return yLatLong;},getXFromMapObjectPixel:function(moPixel){return moPixel.x;},getYFromMapObjectPixel:function(moPixel){return moPixel.y;},getMapObjectPixelFromXY:function(x,y){return new YCoordPoint(x,y);},getMapObjectSizeFromOLSize:function(olSize){return new YSize(olSize.w,olSize.h);},CLASS_NAME:&quot;OpenLayers.Layer.Yahoo&quot;});OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:false,initialize:function(options){this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);},destroy:function(){this.params=null;this.headers=null;OpenLayers.Protocol.prototype.destroy.apply(this);},createCallback:function(method,response,options){return OpenLayers.Function.bind(function(){method.apply(this,[response,options]);},this);},read:function(options){options=OpenLayers.Util.applyDefaults(options,this.options);var readWithPOST=(options.readWithPOST!==undefined)?options.readWithPOST:this.readWithPOST;var resp=new OpenLayers.Protocol.Response({requestType:&quot;read&quot;});if(options.filter&amp;&amp;options.filter instanceof OpenLayers.Filter.Spatial){if(options.filter.type==OpenLayers.Filter.Spatial.BBOX){options.params=OpenLayers.Util.extend(options.params,{bbox:options.filter.value.toArray()});}}
if(readWithPOST){resp.priv=OpenLayers.Request.POST({url:options.url,callback:this.createCallback(this.handleRead,resp,options),data:OpenLayers.Util.getParameterString(options.params),headers:{&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;}});}else{resp.priv=OpenLayers.Request.GET({url:options.url,callback:this.createCallback(this.handleRead,resp,options),params:options.params,headers:options.headers});}
return resp;},handleRead:function(resp,options){this.handleResponse(resp,options);},create:function(features,options){options=OpenLayers.Util.applyDefaults(options,this.options);var resp=new OpenLayers.Protocol.Response({reqFeatures:features,requestType:&quot;create&quot;});resp.priv=OpenLayers.Request.POST({url:options.url,callback:this.createCallback(this.handleCreate,resp,options),headers:options.headers,data:this.format.write(features)});return resp;},handleCreate:function(resp,options){this.handleResponse(resp,options);},update:function(feature,options){var url=options.url||feature.url||this.options.url;options=OpenLayers.Util.applyDefaults(options,this.options);var resp=new OpenLayers.Protocol.Response({reqFeatures:feature,requestType:&quot;update&quot;});resp.priv=OpenLayers.Request.PUT({url:url,callback:this.createCallback(this.handleUpdate,resp,options),headers:options.headers,data:this.format.write(feature)});return resp;},handleUpdate:function(resp,options){this.handleResponse(resp,options);},&quot;delete&quot;:function(feature,options){var url=options.url||feature.url||this.options.url;options=OpenLayers.Util.applyDefaults(options,this.options);var resp=new OpenLayers.Protocol.Response({reqFeatures:feature,requestType:&quot;delete&quot;});resp.priv=OpenLayers.Request.DELETE({url:url,callback:this.createCallback(this.handleDelete,resp,options),headers:options.headers});return resp;},handleDelete:function(resp,options){this.handleResponse(resp,options);},handleResponse:function(resp,options){var request=resp.priv;if(options.callback){if(request.status&gt;=200&amp;&amp;request.status&lt;300){if(resp.requestType!=&quot;delete&quot;){resp.features=this.parseFeatures(request);}
resp.code=OpenLayers.Protocol.Response.SUCCESS;}else{resp.code=OpenLayers.Protocol.Response.FAILURE;}
options.callback.call(options.scope,resp);}},parseFeatures:function(request){var doc=request.responseXML;if(!doc||!doc.documentElement){doc=request.responseText;}
if(!doc||doc.length&lt;=0){return null;}
return this.format.read(doc);},commit:function(features,options){options=OpenLayers.Util.applyDefaults(options,this.options);var resp=[],nResponses=0;var types={};types[OpenLayers.State.INSERT]=[];types[OpenLayers.State.UPDATE]=[];types[OpenLayers.State.DELETE]=[];var feature,list,requestFeatures=[];for(var i=0,len=features.length;i&lt;len;++i){feature=features[i];list=types[feature.state];if(list){list.push(feature);requestFeatures.push(feature);}}
var nRequests=(types[OpenLayers.State.INSERT].length&gt;0?1:0)+
types[OpenLayers.State.UPDATE].length+
types[OpenLayers.State.DELETE].length;var success=true;var finalResponse=new OpenLayers.Protocol.Response({reqFeatures:requestFeatures});function insertCallback(response){var len=response.features?response.features.length:0;var fids=new Array(len);for(var i=0;i&lt;len;++i){fids[i]=response.features[i].fid;}
finalResponse.insertIds=fids;callback.apply(this,[response]);}
function callback(response){this.callUserCallback(response,options);success=success&amp;&amp;response.success();nResponses++;if(nResponses&gt;=nRequests){if(options.callback){finalResponse.code=success?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE;options.callback.apply(options.scope,[finalResponse]);}}}
var queue=types[OpenLayers.State.INSERT];if(queue.length&gt;0){resp.push(this.create(queue,OpenLayers.Util.applyDefaults({callback:insertCallback,scope:this},options.create)));}
queue=types[OpenLayers.State.UPDATE];for(var i=queue.length-1;i&gt;=0;--i){resp.push(this.update(queue[i],OpenLayers.Util.applyDefaults({callback:callback,scope:this},options.update)));}
queue=types[OpenLayers.State.DELETE];for(var i=queue.length-1;i&gt;=0;--i){resp.push(this[&quot;delete&quot;](queue[i],OpenLayers.Util.applyDefaults({callback:callback,scope:this},options[&quot;delete&quot;])));}
return resp;},abort:function(response){if(response){response.priv.abort();}},callUserCallback:function(resp,options){var opt=options[resp.requestType];if(opt&amp;&amp;opt.callback){opt.callback.call(opt.scope,resp);}},CLASS_NAME:&quot;OpenLayers.Protocol.HTTP&quot;});OpenLayers.Style=OpenLayers.Class({name:null,title:null,description:null,layerName:null,isDefault:false,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:false,propertyStyles:null,initialize:function(style,options){OpenLayers.Util.extend(this,options);this.rules=[];if(options&amp;&amp;options.rules){this.addRules(options.rules);}
this.setDefaultStyle(style||OpenLayers.Feature.Vector.style[&quot;default&quot;]);},destroy:function(){for(var i=0,len=this.rules.length;i&lt;len;i++){this.rules[i].destroy();this.rules[i]=null;}
this.rules=null;this.defaultStyle=null;},createSymbolizer:function(feature){var style=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),feature);var rules=this.rules;var rule,context;var elseRules=[];var appliedRules=false;for(var i=0,len=rules.length;i&lt;len;i++){rule=rules[i];var applies=rule.evaluate(feature);if(applies){if(rule instanceof OpenLayers.Rule&amp;&amp;rule.elseFilter){elseRules.push(rule);}else{appliedRules=true;this.applySymbolizer(rule,style,feature);}}}
if(appliedRules==false&amp;&amp;elseRules.length&gt;0){appliedRules=true;for(var i=0,len=elseRules.length;i&lt;len;i++){this.applySymbolizer(elseRules[i],style,feature);}}
if(rules.length&gt;0&amp;&amp;appliedRules==false){style.display=&quot;none&quot;;}
return style;},applySymbolizer:function(rule,style,feature){var symbolizerPrefix=feature.geometry?this.getSymbolizerPrefix(feature.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0];var symbolizer=rule.symbolizer[symbolizerPrefix]||rule.symbolizer;if(this.defaultsPerSymbolizer===true){var defaults=this.defaultStyle;OpenLayers.Util.applyDefaults(symbolizer,{pointRadius:defaults.pointRadius});if(symbolizer.stroke===true||symbolizer.graphic===true){OpenLayers.Util.applyDefaults(symbolizer,{strokeWidth:defaults.strokeWidth,strokeColor:defaults.strokeColor,strokeOpacity:defaults.strokeOpacity,strokeDashstyle:defaults.strokeDashstyle,strokeLinecap:defaults.strokeLinecap});}
if(symbolizer.fill===true||symbolizer.graphic===true){OpenLayers.Util.applyDefaults(symbolizer,{fillColor:defaults.fillColor,fillOpacity:defaults.fillOpacity});}
if(symbolizer.graphic===true){OpenLayers.Util.applyDefaults(symbolizer,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset});}}
return this.createLiterals(OpenLayers.Util.extend(style,symbolizer),feature);},createLiterals:function(style,feature){var context=this.context||feature.attributes||feature.data;for(var i in this.propertyStyles){style[i]=OpenLayers.Style.createLiteral(style[i],context,feature);}
return style;},findPropertyStyles:function(){var propertyStyles={};var style=this.defaultStyle;this.addPropertyStyles(propertyStyles,style);var rules=this.rules;var symbolizer,value;for(var i=0,len=rules.length;i&lt;len;i++){symbolizer=rules[i].symbolizer;for(var key in symbolizer){value=symbolizer[key];if(typeof value==&quot;object&quot;){this.addPropertyStyles(propertyStyles,value);}else{this.addPropertyStyles(propertyStyles,symbolizer);break;}}}
return propertyStyles;},addPropertyStyles:function(propertyStyles,symbolizer){var property;for(var key in symbolizer){property=symbolizer[key];if(typeof property==&quot;string&quot;&amp;&amp;property.match(/\$\{\w+\}/)){propertyStyles[key]=true;}}
return propertyStyles;},addRules:function(rules){this.rules=this.rules.concat(rules);this.propertyStyles=this.findPropertyStyles();},setDefaultStyle:function(style){this.defaultStyle=style;this.propertyStyles=this.findPropertyStyles();},getSymbolizerPrefix:function(geometry){var prefixes=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var i=0,len=prefixes.length;i&lt;len;i++){if(geometry.CLASS_NAME.indexOf(prefixes[i])!=-1){return prefixes[i];}}},CLASS_NAME:&quot;OpenLayers.Style&quot;});OpenLayers.Style.createLiteral=function(value,context,feature){if(typeof value==&quot;string&quot;&amp;&amp;value.indexOf(&quot;${&quot;)!=-1){value=OpenLayers.String.format(value,context,[feature]);value=(isNaN(value)||!value)?value:parseFloat(value);}
return value;};OpenLayers.Style.SYMBOLIZER_PREFIXES=[&apos;Point&apos;,&apos;Line&apos;,&apos;Polygon&apos;,&apos;Text&apos;];OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,zoomBox:null,zoomWheelEnabled:true,handleRightClicks:false,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,initialize:function(options){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments);},destroy:function(){this.deactivate();if(this.dragPan){this.dragPan.destroy();}
this.dragPan=null;if(this.zoomBox){this.zoomBox.destroy();}
this.zoomBox=null;OpenLayers.Control.prototype.destroy.apply(this,arguments);},activate:function(){this.dragPan.activate();if(this.zoomWheelEnabled){this.handlers.wheel.activate();}
this.handlers.click.activate();this.zoomBox.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments);},deactivate:function(){this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments);},draw:function(){if(this.handleRightClicks){this.map.viewPortDiv.oncontextmenu=function(){return false;};}
var clickCallbacks={&apos;dblclick&apos;:this.defaultDblClick,&apos;dblrightclick&apos;:this.defaultDblRightClick};var clickOptions={&apos;double&apos;:true,&apos;stopDouble&apos;:true};this.handlers.click=new OpenLayers.Handler.Click(this,clickCallbacks,clickOptions);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{&quot;up&quot;:this.wheelUp,&quot;down&quot;:this.wheelDown});this.activate();},defaultDblClick:function(evt){var newCenter=this.map.getLonLatFromViewPortPx(evt.xy);this.map.setCenter(newCenter,this.map.zoom+1);},defaultDblRightClick:function(evt){var newCenter=this.map.getLonLatFromViewPortPx(evt.xy);this.map.setCenter(newCenter,this.map.zoom-1);},wheelChange:function(evt,deltaZ){var newZoom=this.map.getZoom()+deltaZ;if(!this.map.isValidZoomLevel(newZoom)){return;}
var size=this.map.getSize();var deltaX=size.w/2-evt.xy.x;var deltaY=evt.xy.y-size.h/2;var newRes=this.map.baseLayer.getResolutionForZoom(newZoom);var zoomPoint=this.map.getLonLatFromPixel(evt.xy);var newCenter=new OpenLayers.LonLat(zoomPoint.lon+deltaX*newRes,zoomPoint.lat+deltaY*newRes);this.map.setCenter(newCenter,newZoom);},wheelUp:function(evt){this.wheelChange(evt,1);},wheelDown:function(evt){this.wheelChange(evt,-1);},disableZoomWheel:function(){this.zoomWheelEnabled=false;this.handlers.wheel.deactivate();},enableZoomWheel:function(){this.zoomWheelEnabled=true;if(this.active){this.handlers.wheel.activate();}},CLASS_NAME:&quot;OpenLayers.Control.Navigation&quot;});OpenLayers.Filter=OpenLayers.Class({initialize:function(options){OpenLayers.Util.extend(this,options);},destroy:function(){},evaluate:function(context){return true;},clone:function(){return null;},CLASS_NAME:&quot;OpenLayers.Filter&quot;});OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+&quot;_&quot;);},destroy:function(){this.id=null;this.bounds=null;},clone:function(){return new OpenLayers.Geometry();},setBounds:function(bounds){if(bounds){this.bounds=bounds.clone();}},clearBounds:function(){this.bounds=null;if(this.parent){this.parent.clearBounds();}},extendBounds:function(newBounds){var bounds=this.getBounds();if(!bounds){this.setBounds(newBounds);}else{this.bounds.extend(newBounds);}},getBounds:function(){if(this.bounds==null){this.calculateBounds();}
return this.bounds;},calculateBounds:function(){},distanceTo:function(geometry,options){},getVertices:function(nodes){},atPoint:function(lonlat,toleranceLon,toleranceLat){var atPoint=false;var bounds=this.getBounds();if((bounds!=null)&amp;&amp;(lonlat!=null)){var dX=(toleranceLon!=null)?toleranceLon:0;var dY=(toleranceLat!=null)?toleranceLat:0;var toleranceBounds=new OpenLayers.Bounds(this.bounds.left-dX,this.bounds.bottom-dY,this.bounds.right+dX,this.bounds.top+dY);atPoint=toleranceBounds.containsLonLat(lonlat);}
return atPoint;},getLength:function(){return 0.0;},getArea:function(){return 0.0;},getCentroid:function(){return null;},toString:function(){return OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this));},CLASS_NAME:&quot;OpenLayers.Geometry&quot;});OpenLayers.Geometry.fromWKT=function(wkt){var format=arguments.callee.format;if(!format){format=new OpenLayers.Format.WKT();arguments.callee.format=format;}
var geom;var result=format.read(wkt);if(result instanceof OpenLayers.Feature.Vector){geom=result.geometry;}else if(result instanceof Array){var len=result.length;var components=new Array(len);for(var i=0;i&lt;len;++i){components[i]=result[i].geometry;}
geom=new OpenLayers.Geometry.Collection(components);}
return geom;};OpenLayers.Geometry.segmentsIntersect=function(seg1,seg2,options){var point=options&amp;&amp;options.point;var tolerance=options&amp;&amp;options.tolerance;var intersection=false;var x11_21=seg1.x1-seg2.x1;var y11_21=seg1.y1-seg2.y1;var x12_11=seg1.x2-seg1.x1;var y12_11=seg1.y2-seg1.y1;var y22_21=seg2.y2-seg2.y1;var x22_21=seg2.x2-seg2.x1;var d=(y22_21*x12_11)-(x22_21*y12_11);var n1=(x22_21*y11_21)-(y22_21*x11_21);var n2=(x12_11*y11_21)-(y12_11*x11_21);if(d==0){if(n1==0&amp;&amp;n2==0){intersection=true;}}else{var along1=n1/d;var along2=n2/d;if(along1&gt;=0&amp;&amp;along1&lt;=1&amp;&amp;along2&gt;=0&amp;&amp;along2&lt;=1){if(!point){intersection=true;}else{var x=seg1.x1+(along1*x12_11);var y=seg1.y1+(along1*y12_11);intersection=new OpenLayers.Geometry.Point(x,y);}}}
if(tolerance){var dist;if(intersection){if(point){var segs=[seg1,seg2];var seg,x,y;outer:for(var i=0;i&lt;2;++i){seg=segs[i];for(var j=1;j&lt;3;++j){x=seg[&quot;x&quot;+j];y=seg[&quot;y&quot;+j];dist=Math.sqrt(Math.pow(x-intersection.x,2)+
Math.pow(y-intersection.y,2));if(dist&lt;tolerance){intersection.x=x;intersection.y=y;break outer;}}}}}else{var segs=[seg1,seg2];var source,target,x,y,p,result;outer:for(var i=0;i&lt;2;++i){source=segs[i];target=segs[(i+1)%2];for(var j=1;j&lt;3;++j){p={x:source[&quot;x&quot;+j],y:source[&quot;y&quot;+j]};result=OpenLayers.Geometry.distanceToSegment(p,target);if(result.distance&lt;tolerance){if(point){intersection=new OpenLayers.Geometry.Point(p.x,p.y);}else{intersection=true;}
break outer;}}}}}
return intersection;};OpenLayers.Geometry.distanceToSegment=function(point,segment){var x0=point.x;var y0=point.y;var x1=segment.x1;var y1=segment.y1;var x2=segment.x2;var y2=segment.y2;var dx=x2-x1;var dy=y2-y1;var along=((dx*(x0-x1))+(dy*(y0-y1)))/(Math.pow(dx,2)+Math.pow(dy,2));var x,y;if(along&lt;=0.0){x=x1;y=y1;}else if(along&gt;=1.0){x=x2;y=y2;}else{x=x1+along*dx;y=y1+along*dy;}
return{distance:Math.sqrt(Math.pow(x-x0,2)+Math.pow(y-y0,2)),x:x,y:y};};OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:&quot;png&quot;},isBaseLayer:true,initialize:function(name,url,params,options){var newArguments=[];params=OpenLayers.Util.upperCaseObject(params);newArguments.push(name,url,params,options);OpenLayers.Layer.Grid.prototype.initialize.apply(this,newArguments);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(this.params.TRANSPARENT&amp;&amp;this.params.TRANSPARENT.toString().toLowerCase()==&quot;true&quot;){if((options==null)||(!options.isBaseLayer)){this.isBaseLayer=false;}
if(this.params.FORMAT==&quot;jpg&quot;){this.params.FORMAT=OpenLayers.Util.alphaHack()?&quot;gif&quot;:&quot;png&quot;;}}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.options);}
obj=OpenLayers.Layer.Grid.prototype.clone.apply(this,[obj]);return obj;},getURL:function(bounds){bounds=this.adjustBounds(bounds);var projWords=this.projection.getCode().split(&quot;:&quot;);var srid=projWords[projWords.length-1];var imageSize=this.getImageSize();var newParams={&apos;BBOX&apos;:bounds.toBBOX(),&apos;SIZE&apos;:imageSize.w+&quot;,&quot;+imageSize.h,&apos;F&apos;:&quot;image&quot;,&apos;BBOXSR&apos;:srid,&apos;IMAGESR&apos;:srid};if(this.layerDefs){var layerDefStrList=[];var layerID;for(layerID in this.layerDefs){if(this.layerDefs.hasOwnProperty(layerID)){if(this.layerDefs[layerID]){layerDefStrList.push(layerID);layerDefStrList.push(&quot;:&quot;);layerDefStrList.push(this.layerDefs[layerID]);layerDefStrList.push(&quot;;&quot;);}}}
if(layerDefStrList.length&gt;0){newParams[&apos;LAYERDEFS&apos;]=layerDefStrList.join(&quot;&quot;);}}
var requestString=this.getFullRequestString(newParams);return requestString;},setLayerFilter:function(id,queryDef){if(!this.layerDefs){this.layerDefs={};}
if(queryDef){this.layerDefs[id]=queryDef;}else{delete this.layerDefs[id];}},clearLayerFilter:function(id){if(id){delete this.layerDefs[id];}else{delete this.layerDefs;}},mergeNewParams:function(newParams){var upperParams=OpenLayers.Util.upperCaseObject(newParams);var newArguments=[upperParams];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,newArguments);},addTile:function(bounds,position){return new OpenLayers.Tile.Image(this,position,bounds,null,this.tileSize);},CLASS_NAME:&quot;OpenLayers.Layer.ArcGIS93Rest&quot;});OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,units:null,resolution:OpenLayers.DOTS_PER_INCH,DEFAULT_PARAMS:{i:&apos;jpeg&apos;,map:&apos;&apos;},initialize:function(name,url,params,options){var newArguments=[];newArguments.push(name,url,params,options);OpenLayers.Layer.Grid.prototype.initialize.apply(this,newArguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);},getURL:function(bounds){bounds=this.adjustBounds(bounds);var mapRes=this.map.getResolution();var scale=Math.round((this.map.getScale()*10000))/10000;var pX=Math.round(bounds.left/mapRes);var pY=-Math.round(bounds.top/mapRes);return this.getFullRequestString({t:pY,l:pX,s:scale});},addTile:function(bounds,position){var url=this.getURL(bounds);return new OpenLayers.Tile.Image(this,position,bounds,url,this.tileSize);},calculateGridLayout:function(bounds,extent,resolution){var tilelon=resolution*this.tileSize.w;var tilelat=resolution*this.tileSize.h;var offsetlon=bounds.left;var tilecol=Math.floor(offsetlon/tilelon)-this.buffer;var tilecolremain=offsetlon/tilelon-tilecol;var tileoffsetx=-tilecolremain*this.tileSize.w;var tileoffsetlon=tilecol*tilelon;var offsetlat=bounds.top;var tilerow=Math.ceil(offsetlat/tilelat)+this.buffer;var tilerowremain=tilerow-offsetlat/tilelat;var tileoffsety=-(tilerowremain+1)*this.tileSize.h;var tileoffsetlat=tilerow*tilelat;return{tilelon:tilelon,tilelat:tilelat,tileoffsetlon:tileoffsetlon,tileoffsetlat:tileoffsetlat,tileoffsetx:tileoffsetx,tileoffsety:tileoffsety};},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.options);}
obj=OpenLayers.Layer.Grid.prototype.clone.apply(this,[obj]);if(this.tileSize!=null){obj.tileSize=this.tileSize.clone();}
obj.grid=[];return obj;},getTileBounds:function(viewPortPx){var resolution=this.getResolution();var tileMapWidth=resolution*this.tileSize.w;var tileMapHeight=resolution*this.tileSize.h;var mapPoint=this.getLonLatFromViewPortPx(viewPortPx);var tileLeft=tileMapWidth*Math.floor(mapPoint.lon/tileMapWidth);var tileBottom=tileMapHeight*Math.floor(mapPoint.lat/tileMapHeight);return new OpenLayers.Bounds(tileLeft,tileBottom,tileLeft+tileMapWidth,tileBottom+tileMapHeight);},CLASS_NAME:&quot;OpenLayers.Layer.KaMap&quot;});OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,useHttpTile:false,singleTile:false,useOverlay:false,useAsyncOverlay:true,TILE_PARAMS:{operation:&apos;GETTILEIMAGE&apos;,version:&apos;1.2.0&apos;},SINGLE_TILE_PARAMS:{operation:&apos;GETMAPIMAGE&apos;,format:&apos;PNG&apos;,locale:&apos;en&apos;,clip:&apos;1&apos;,version:&apos;1.0.0&apos;},OVERLAY_PARAMS:{operation:&apos;GETDYNAMICMAPOVERLAYIMAGE&apos;,format:&apos;PNG&apos;,locale:&apos;en&apos;,clip:&apos;1&apos;,version:&apos;2.0.0&apos;},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:&apos;png&apos;,querystring:null},defaultSize:new OpenLayers.Size(300,300),initialize:function(name,url,params,options){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);if(options==null||options.isBaseLayer==null){this.isBaseLayer=((this.transparent!=&quot;true&quot;)&amp;&amp;(this.transparent!=true));}
if(options&amp;&amp;options.useOverlay!=null){this.useOverlay=options.useOverlay;}
if(this.singleTile){if(this.useOverlay){OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS);if(!this.useAsyncOverlay){this.params.version=&quot;1.0.0&quot;;}}else{OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS);}}else{if(this.useHttpTile){OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS);}else{OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS);}
this.setTileSize(this.defaultSize);}},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.options);}
obj=OpenLayers.Layer.Grid.prototype.clone.apply(this,[obj]);return obj;},addTile:function(bounds,position){return new OpenLayers.Tile.Image(this,position,bounds,null,this.tileSize);},getURL:function(bounds){var url;var center=bounds.getCenterLonLat();var mapSize=this.map.getCurrentSize();if(this.singleTile){var params={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:mapSize.h*this.ratio,setdisplaywidth:mapSize.w*this.ratio,setviewcenterx:center.lon,setviewcentery:center.lat,setviewscale:this.map.getScale()};if(this.useOverlay&amp;&amp;!this.useAsyncOverlay){var getVisParams={};getVisParams=OpenLayers.Util.extend(getVisParams,params);getVisParams.operation=&quot;GETVISIBLEMAPEXTENT&quot;;getVisParams.version=&quot;1.0.0&quot;;getVisParams.session=this.params.session;getVisParams.mapName=this.params.mapName;getVisParams.format=&apos;text/xml&apos;;url=this.getFullRequestString(getVisParams);OpenLayers.Request.GET({url:url,async:false});}
url=this.getFullRequestString(params);}else{var currentRes=this.map.getResolution();var colidx=Math.floor((bounds.left-this.maxExtent.left)/currentRes);colidx=Math.round(colidx/this.tileSize.w);var rowidx=Math.floor((this.maxExtent.top-bounds.top)/currentRes);rowidx=Math.round(rowidx/this.tileSize.h);if(this.useHttpTile){url=this.getImageFilePath({tilecol:colidx,tilerow:rowidx,scaleindex:this.resolutions.length-this.map.zoom-1});}else{url=this.getFullRequestString({tilecol:colidx,tilerow:rowidx,scaleindex:this.resolutions.length-this.map.zoom-1});}}
return url;},getFullRequestString:function(newParams,altUrl){var url=(altUrl==null)?this.url:altUrl;if(typeof url==&quot;object&quot;){url=url[Math.floor(Math.random()*url.length)];}
var requestString=url;var allParams=OpenLayers.Util.extend({},this.params);allParams=OpenLayers.Util.extend(allParams,newParams);var urlParams=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getArgs(url));for(var key in allParams){if(key.toUpperCase()in urlParams){delete allParams[key];}}
var paramsString=OpenLayers.Util.getParameterString(allParams);paramsString=paramsString.replace(/,/g,&quot;+&quot;);if(paramsString!=&quot;&quot;){var lastServerChar=url.charAt(url.length-1);if((lastServerChar==&quot;&amp;&quot;)||(lastServerChar==&quot;?&quot;)){requestString+=paramsString;}else{if(url.indexOf(&apos;?&apos;)==-1){requestString+=&apos;?&apos;+paramsString;}else{requestString+=&apos;&amp;&apos;+paramsString;}}}
return requestString;},getImageFilePath:function(newParams,altUrl){var url=(altUrl==null)?this.url:altUrl;if(typeof url==&quot;object&quot;){url=url[Math.floor(Math.random()*url.length)];}
var requestString=url;var tileRowGroup=&quot;&quot;;var tileColGroup=&quot;&quot;;if(newParams.tilerow&lt;0){tileRowGroup=&apos;-&apos;;}
if(newParams.tilerow==0){tileRowGroup+=&apos;0&apos;;}else{tileRowGroup+=Math.floor(Math.abs(newParams.tilerow/this.params.tileRowsPerFolder))*this.params.tileRowsPerFolder;}
if(newParams.tilecol&lt;0){tileColGroup=&apos;-&apos;;}
if(newParams.tilecol==0){tileColGroup+=&apos;0&apos;;}else{tileColGroup+=Math.floor(Math.abs(newParams.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder;}
var tilePath=&apos;/S&apos;+Math.floor(newParams.scaleindex)
+&apos;/&apos;+this.params.basemaplayergroupname
+&apos;/R&apos;+tileRowGroup
+&apos;/C&apos;+tileColGroup
+&apos;/&apos;+(newParams.tilerow%this.params.tileRowsPerFolder)
+&apos;_&apos;+(newParams.tilecol%this.params.tileColumnsPerFolder)
+&apos;.&apos;+this.params.format;if(this.params.querystring){tilePath+=&quot;?&quot;+this.params.querystring;}
requestString+=tilePath;return requestString;},calculateGridLayout:function(bounds,extent,resolution){var tilelon=resolution*this.tileSize.w;var tilelat=resolution*this.tileSize.h;var offsetlon=bounds.left-extent.left;var tilecol=Math.floor(offsetlon/tilelon)-this.buffer;var tilecolremain=offsetlon/tilelon-tilecol;var tileoffsetx=-tilecolremain*this.tileSize.w;var tileoffsetlon=extent.left+tilecol*tilelon;var offsetlat=extent.top-bounds.top+tilelat;var tilerow=Math.floor(offsetlat/tilelat)-this.buffer;var tilerowremain=tilerow-offsetlat/tilelat;var tileoffsety=tilerowremain*this.tileSize.h;var tileoffsetlat=extent.top-tilelat*tilerow;return{tilelon:tilelon,tilelat:tilelat,tileoffsetlon:tileoffsetlon,tileoffsetlat:tileoffsetlat,tileoffsetx:tileoffsetx,tileoffsety:tileoffsety};},CLASS_NAME:&quot;OpenLayers.Layer.MapGuide&quot;});OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:&quot;map&quot;,map_imagetype:&quot;png&quot;},initialize:function(name,url,params,options){var newArguments=[];newArguments.push(name,url,params,options);OpenLayers.Layer.Grid.prototype.initialize.apply(this,newArguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);if(options==null||options.isBaseLayer==null){this.isBaseLayer=((this.params.transparent!=&quot;true&quot;)&amp;&amp;(this.params.transparent!=true));}},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.options);}
obj=OpenLayers.Layer.Grid.prototype.clone.apply(this,[obj]);return obj;},addTile:function(bounds,position){return new OpenLayers.Tile.Image(this,position,bounds,null,this.tileSize);},getURL:function(bounds){bounds=this.adjustBounds(bounds);var extent=[bounds.left,bounds.bottom,bounds.right,bounds.top];var imageSize=this.getImageSize();var url=this.getFullRequestString({mapext:extent,imgext:extent,map_size:[imageSize.w,imageSize.h],imgx:imageSize.w/2,imgy:imageSize.h/2,imgxy:[imageSize.w,imageSize.h]});return url;},getFullRequestString:function(newParams,altUrl){var url=(altUrl==null)?this.url:altUrl;var allParams=OpenLayers.Util.extend({},this.params);allParams=OpenLayers.Util.extend(allParams,newParams);var paramsString=OpenLayers.Util.getParameterString(allParams);if(url instanceof Array){url=this.selectUrl(paramsString,url);}
var urlParams=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(url));for(var key in allParams){if(key.toUpperCase()in urlParams){delete allParams[key];}}
paramsString=OpenLayers.Util.getParameterString(allParams);var requestString=url;paramsString=paramsString.replace(/,/g,&quot;+&quot;);if(paramsString!=&quot;&quot;){var lastServerChar=url.charAt(url.length-1);if((lastServerChar==&quot;&amp;&quot;)||(lastServerChar==&quot;?&quot;)){requestString+=paramsString;}else{if(url.indexOf(&apos;?&apos;)==-1){requestString+=&apos;?&apos;+paramsString;}else{requestString+=&apos;&amp;&apos;+paramsString;}}}
return requestString;},CLASS_NAME:&quot;OpenLayers.Layer.MapServer&quot;});OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:&quot;1.0.0&quot;,isBaseLayer:true,tileOrigin:null,serverResolutions:null,initialize:function(name,url,options){var newArguments=[];newArguments.push(name,url,{},options);OpenLayers.Layer.Grid.prototype.initialize.apply(this,newArguments);},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.TMS(this.name,this.url,this.options);}
obj=OpenLayers.Layer.Grid.prototype.clone.apply(this,[obj]);return obj;},getURL:function(bounds){bounds=this.adjustBounds(bounds);var res=this.map.getResolution();var x=Math.round((bounds.left-this.tileOrigin.lon)/(res*this.tileSize.w));var y=Math.round((bounds.bottom-this.tileOrigin.lat)/(res*this.tileSize.h));var z=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,res):this.map.getZoom();var path=this.serviceVersion+&quot;/&quot;+this.layername+&quot;/&quot;+z+&quot;/&quot;+x+&quot;/&quot;+y+&quot;.&quot;+this.type;var url=this.url;if(url instanceof Array){url=this.selectUrl(path,url);}
return url+path;},addTile:function(bounds,position){return new OpenLayers.Tile.Image(this,position,bounds,null,this.tileSize);},setMap:function(map){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom);}},CLASS_NAME:&quot;OpenLayers.Layer.TMS&quot;});OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,format:&apos;image/png&apos;,serverResolutions:null,initialize:function(name,url,layername,options){this.layername=layername;OpenLayers.Layer.Grid.prototype.initialize.apply(this,[name,url,{},options]);this.extension=this.format.split(&apos;/&apos;)[1].toLowerCase();this.extension=(this.extension==&apos;jpg&apos;)?&apos;jpeg&apos;:this.extension;},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.options);}
obj=OpenLayers.Layer.Grid.prototype.clone.apply(this,[obj]);return obj;},getURL:function(bounds){var res=this.map.getResolution();var bbox=this.maxExtent;var size=this.tileSize;var tileX=Math.round((bounds.left-bbox.left)/(res*size.w));var tileY=Math.round((bounds.bottom-bbox.bottom)/(res*size.h));var tileZ=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,res):this.map.getZoom();function zeroPad(number,length){number=String(number);var zeros=[];for(var i=0;i&lt;length;++i){zeros.push(&apos;0&apos;);}
return zeros.join(&apos;&apos;).substring(0,length-number.length)+number;}
var components=[this.layername,zeroPad(tileZ,2),zeroPad(parseInt(tileX/1000000),3),zeroPad((parseInt(tileX/1000)%1000),3),zeroPad((parseInt(tileX)%1000),3),zeroPad(parseInt(tileY/1000000),3),zeroPad((parseInt(tileY/1000)%1000),3),zeroPad((parseInt(tileY)%1000),3)+&apos;.&apos;+this.extension];var path=components.join(&apos;/&apos;);var url=this.url;if(url instanceof Array){url=this.selectUrl(path,url);}
url=(url.charAt(url.length-1)==&apos;/&apos;)?url:url+&apos;/&apos;;return url+path;},addTile:function(bounds,position){var url=this.getURL(bounds);return new OpenLayers.Tile.Image(this,position,bounds,url,this.tileSize);},CLASS_NAME:&quot;OpenLayers.Layer.TileCache&quot;});OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:&quot;WMS&quot;,version:&quot;1.1.1&quot;,request:&quot;GetMap&quot;,styles:&quot;&quot;,exceptions:&quot;application/vnd.ogc.se_inimage&quot;,format:&quot;image/jpeg&quot;},reproject:false,isBaseLayer:true,encodeBBOX:false,noMagic:false,initialize:function(name,url,params,options){var newArguments=[];params=OpenLayers.Util.upperCaseObject(params);newArguments.push(name,url,params,options);OpenLayers.Layer.Grid.prototype.initialize.apply(this,newArguments);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&amp;&amp;this.params.TRANSPARENT&amp;&amp;this.params.TRANSPARENT.toString().toLowerCase()==&quot;true&quot;){if((options==null)||(!options.isBaseLayer)){this.isBaseLayer=false;}
if(this.params.FORMAT==&quot;image/jpeg&quot;){this.params.FORMAT=OpenLayers.Util.alphaHack()?&quot;image/gif&quot;:&quot;image/png&quot;;}}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.options);}
obj=OpenLayers.Layer.Grid.prototype.clone.apply(this,[obj]);return obj;},getURL:function(bounds){bounds=this.adjustBounds(bounds);var imageSize=this.getImageSize();var newParams={&apos;BBOX&apos;:this.encodeBBOX?bounds.toBBOX():bounds.toArray(),&apos;WIDTH&apos;:imageSize.w,&apos;HEIGHT&apos;:imageSize.h};var requestString=this.getFullRequestString(newParams);return requestString;},addTile:function(bounds,position){return new OpenLayers.Tile.Image(this,position,bounds,null,this.tileSize);},mergeNewParams:function(newParams){var upperParams=OpenLayers.Util.upperCaseObject(newParams);var newArguments=[upperParams];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,newArguments);},getFullRequestString:function(newParams,altUrl){var projectionCode=this.map.getProjection();this.params.SRS=(projectionCode==&quot;none&quot;)?null:projectionCode;return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments);},CLASS_NAME:&quot;OpenLayers.Layer.WMS&quot;});OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:true,lzd:null,zoomLevels:null,initialize:function(name,url,lzd,zoomLevels,params,options){this.lzd=lzd;this.zoomLevels=zoomLevels;var newArguments=[];newArguments.push(name,url,params,options);OpenLayers.Layer.Grid.prototype.initialize.apply(this,newArguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);},addTile:function(bounds,position){return new OpenLayers.Tile.Image(this,position,bounds,null,this.tileSize);},getZoom:function(){var zoom=this.map.getZoom();var extent=this.map.getMaxExtent();zoom=zoom-Math.log(this.maxResolution/(this.lzd/512))/Math.log(2);return zoom;},getURL:function(bounds){bounds=this.adjustBounds(bounds);var zoom=this.getZoom();var extent=this.map.getMaxExtent();var deg=this.lzd/Math.pow(2,this.getZoom());var x=Math.floor((bounds.left-extent.left)/deg);var y=Math.floor((bounds.bottom-extent.bottom)/deg);if(this.map.getResolution()&lt;=(this.lzd/512)&amp;&amp;this.getZoom()&lt;=this.zoomLevels){return this.getFullRequestString({L:zoom,X:x,Y:y});}else{return OpenLayers.Util.getImagesLocation()+&quot;blank.gif&quot;;}},CLASS_NAME:&quot;OpenLayers.Layer.WorldWind&quot;});OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,sphericalMercator:false,initialize:function(name,url,options){if(options&amp;&amp;options.sphericalMercator||this.sphericalMercator){options=OpenLayers.Util.extend({maxExtent:new OpenLayers.Bounds(-128*156543.0339,-128*156543.0339,128*156543.0339,128*156543.0339),maxResolution:156543.0339,numZoomLevels:19,units:&quot;m&quot;,projection:&quot;EPSG:900913&quot;},options);}
url=url||this.url;name=name||this.name;var newArguments=[name,url,{},options];OpenLayers.Layer.Grid.prototype.initialize.apply(this,newArguments);},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.XYZ(this.name,this.url,this.options);}
obj=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[obj]);if(this.tileSize!=null){obj.tileSize=this.tileSize.clone();}
obj.grid=[];return obj;},getURL:function(bounds){var res=this.map.getResolution();var x=Math.round((bounds.left-this.maxExtent.left)/(res*this.tileSize.w));var y=Math.round((this.maxExtent.top-bounds.top)/(res*this.tileSize.h));var z=this.map.getZoom();var limit=Math.pow(2,z);var url=this.url;var s=&apos;&apos;+x+y+z;if(url instanceof Array)
{url=this.selectUrl(s,url);}
var path=OpenLayers.String.format(url,{&apos;x&apos;:x,&apos;y&apos;:y,&apos;z&apos;:z});return path;},addTile:function(bounds,position){return new OpenLayers.Tile.Image(this,position,bounds,null,this.tileSize);},setMap:function(map){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom);}},CLASS_NAME:&quot;OpenLayers.Layer.XYZ&quot;});OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:&quot;OpenStreetMap&quot;,attribution:&quot;Data CC-By-SA by &lt;a href=&apos;http://openstreetmap.org/&apos;&gt;OpenStreetMap&lt;/a&gt;&quot;,sphericalMercator:true,url:&apos;http://tile.openstreetmap.org/${z}/${x}/${y}.png&apos;,CLASS_NAME:&quot;OpenLayers.Layer.OSM&quot;});OpenLayers.Protocol.SQL.Gears=OpenLayers.Class(OpenLayers.Protocol.SQL,{FID_PREFIX:&apos;__gears_fid__&apos;,NULL_GEOMETRY:&apos;__gears_null_geometry__&apos;,NULL_FEATURE_STATE:&apos;__gears_null_feature_state__&apos;,jsonParser:null,wktParser:null,fidRegExp:null,saveFeatureState:true,typeOfFid:&quot;string&quot;,db:null,initialize:function(options){if(!this.supported()){return;}
OpenLayers.Protocol.SQL.prototype.initialize.apply(this,[options]);this.jsonParser=new OpenLayers.Format.JSON();this.wktParser=new OpenLayers.Format.WKT();this.fidRegExp=new RegExp(&apos;^&apos;+this.FID_PREFIX);this.initializeDatabase();},initializeDatabase:function(){this.db=google.gears.factory.create(&apos;beta.database&apos;);this.db.open(this.databaseName);this.db.execute(&quot;CREATE TABLE IF NOT EXISTS &quot;+this.tableName+&quot; (fid TEXT UNIQUE, geometry TEXT, properties TEXT,&quot;+&quot;  state TEXT)&quot;);},destroy:function(){this.db.close();this.db=null;this.jsonParser=null;this.wktParser=null;OpenLayers.Protocol.SQL.prototype.destroy.apply(this);},supported:function(){return!!(window.google&amp;&amp;google.gears);},read:function(options){options=OpenLayers.Util.applyDefaults(options,this.options);var feature,features=[];var rs=this.db.execute(&quot;SELECT * FROM &quot;+this.tableName);while(rs.isValidRow()){feature=this.unfreezeFeature(rs);if(this.evaluateFilter(feature,options.filter)){if(!options.noFeatureStateReset){feature.state=null;}
features.push(feature);}
rs.next();}
rs.close();var resp=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:&quot;read&quot;,features:features});if(options&amp;&amp;options.callback){options.callback.call(options.scope,resp);}
return resp;},unfreezeFeature:function(row){var feature;var wkt=row.fieldByName(&apos;geometry&apos;);if(wkt==this.NULL_GEOMETRY){feature=new OpenLayers.Feature.Vector();}else{feature=this.wktParser.read(wkt);}
feature.attributes=this.jsonParser.read(row.fieldByName(&apos;properties&apos;));feature.fid=this.extractFidFromField(row.fieldByName(&apos;fid&apos;));var state=row.fieldByName(&apos;state&apos;);if(state==this.NULL_FEATURE_STATE){state=null;}
feature.state=state;return feature;},extractFidFromField:function(field){if(!field.match(this.fidRegExp)&amp;&amp;this.typeOfFid==&quot;number&quot;){field=parseFloat(field);}
return field;},create:function(features,options){options=OpenLayers.Util.applyDefaults(options,this.options);var resp=this.createOrUpdate(features);resp.requestType=&quot;create&quot;;if(options&amp;&amp;options.callback){options.callback.call(options.scope,resp);}
return resp;},update:function(features,options){options=OpenLayers.Util.applyDefaults(options,this.options);var resp=this.createOrUpdate(features);resp.requestType=&quot;update&quot;;if(options&amp;&amp;options.callback){options.callback.call(options.scope,resp);}
return resp;},createOrUpdate:function(features){if(!(features instanceof Array)){features=[features];}
var i,len=features.length,feature;var insertedFeatures=new Array(len);for(i=0;i&lt;len;i++){feature=features[i];var params=this.freezeFeature(feature);this.db.execute(&quot;REPLACE INTO &quot;+this.tableName+&quot; (fid, geometry, properties, state)&quot;+&quot; VALUES (?, ?, ?, ?)&quot;,params);var clone=feature.clone();clone.fid=this.extractFidFromField(params[0]);insertedFeatures[i]=clone;}
return new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,features:insertedFeatures,reqFeatures:features});},freezeFeature:function(feature){feature.fid=feature.fid!=null?&quot;&quot;+feature.fid:OpenLayers.Util.createUniqueID(this.FID_PREFIX);var geometry=feature.geometry!=null?feature.geometry.toString():this.NULL_GEOMETRY;var properties=this.jsonParser.write(feature.attributes);var state=this.getFeatureStateForFreeze(feature);return[feature.fid,geometry,properties,state];},getFeatureStateForFreeze:function(feature){var state;if(!this.saveFeatureState){state=this.NULL_FEATURE_STATE;}else if(this.createdOffline(feature)){state=OpenLayers.State.INSERT;}else{state=feature.state;}
return state;},&quot;delete&quot;:function(features,options){if(!(features instanceof Array)){features=[features];}
options=OpenLayers.Util.applyDefaults(options,this.options);var i,len,feature;for(i=0,len=features.length;i&lt;len;i++){feature=features[i];if(this.saveFeatureState&amp;&amp;!this.createdOffline(feature)){var toDelete=feature.clone();toDelete.fid=feature.fid;if(toDelete.geometry){toDelete.geometry.destroy();toDelete.geometry=null;}
toDelete.state=feature.state;this.createOrUpdate(toDelete);}else{this.db.execute(&quot;DELETE FROM &quot;+this.tableName+&quot; WHERE fid = ?&quot;,[feature.fid]);}}
var resp=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:&quot;delete&quot;,reqFeatures:features});if(options&amp;&amp;options.callback){options.callback.call(options.scope,resp);}
return resp;},createdOffline:function(feature){return(typeof feature.fid==&quot;string&quot;&amp;&amp;!!(feature.fid.match(this.fidRegExp)));},commit:function(features,options){var opt,resp=[],nRequests=0,nResponses=0;function callback(resp){if(++nResponses&lt;nRequests){resp.last=false;}
this.callUserCallback(options,resp);}
var feature,toCreate=[],toUpdate=[],toDelete=[];for(var i=features.length-1;i&gt;=0;i--){feature=features[i];switch(feature.state){case OpenLayers.State.INSERT:toCreate.push(feature);break;case OpenLayers.State.UPDATE:toUpdate.push(feature);break;case OpenLayers.State.DELETE:toDelete.push(feature);break;}}
if(toCreate.length&gt;0){nRequests++;opt=OpenLayers.Util.applyDefaults({&quot;callback&quot;:callback,&quot;scope&quot;:this},options.create);resp.push(this.create(toCreate,opt));}
if(toUpdate.length&gt;0){nRequests++;opt=OpenLayers.Util.applyDefaults({&quot;callback&quot;:callback,&quot;scope&quot;:this},options.update);resp.push(this.update(toUpdate,opt));}
if(toDelete.length&gt;0){nRequests++;opt=OpenLayers.Util.applyDefaults({&quot;callback&quot;:callback,&quot;scope&quot;:this},options[&quot;delete&quot;]);resp.push(this[&quot;delete&quot;](toDelete,opt));}
return resp;},clear:function(){this.db.execute(&quot;DELETE FROM &quot;+this.tableName);},callUserCallback:function(options,resp){var opt=options[resp.requestType];if(opt&amp;&amp;opt.callback){opt.callback.call(opt.scope,resp);}
if(resp.last&amp;&amp;options.callback){options.callback.call(options.scope);}},CLASS_NAME:&quot;OpenLayers.Protocol.SQL.Gears&quot;});OpenLayers.Rule=OpenLayers.Class({id:null,name:&apos;default&apos;,title:null,description:null,context:null,filter:null,elseFilter:false,symbolizer:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(options){this.symbolizer={};OpenLayers.Util.extend(this,options);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+&quot;_&quot;);},destroy:function(){for(var i in this.symbolizer){this.symbolizer[i]=null;}
this.symbolizer=null;},evaluate:function(feature){var context=this.getContext(feature);var applies=true;if(this.minScaleDenominator||this.maxScaleDenominator){var scale=feature.layer.map.getScale();}
if(this.minScaleDenominator){applies=scale&gt;=OpenLayers.Style.createLiteral(this.minScaleDenominator,context);}
if(applies&amp;&amp;this.maxScaleDenominator){applies=scale&lt;OpenLayers.Style.createLiteral(this.maxScaleDenominator,context);}
if(applies&amp;&amp;this.filter){if(this.filter.CLASS_NAME==&quot;OpenLayers.Filter.FeatureId&quot;){applies=this.filter.evaluate(feature);}else{applies=this.filter.evaluate(context);}}
return applies;},getContext:function(feature){var context=this.context;if(!context){context=feature.attributes||feature.data;}
if(typeof this.context==&quot;function&quot;){context=this.context(feature);}
return context;},clone:function(){var options=OpenLayers.Util.extend({},this);options.symbolizer={};for(var key in this.symbolizer){value=this.symbolizer[key];type=typeof value;if(type===&quot;object&quot;){options.symbolizer[key]=OpenLayers.Util.extend({},value);}else if(type===&quot;string&quot;){options.symbolizer[key]=value;}}
options.filter=this.filter&amp;&amp;this.filter.clone();options.context=this.context&amp;&amp;OpenLayers.Util.extend({},this.context);return new OpenLayers.Rule(options);},CLASS_NAME:&quot;OpenLayers.Rule&quot;});OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:true,initialize:function(style,options){this.styles={&quot;default&quot;:new OpenLayers.Style(OpenLayers.Feature.Vector.style[&quot;default&quot;]),&quot;select&quot;:new OpenLayers.Style(OpenLayers.Feature.Vector.style[&quot;select&quot;]),&quot;temporary&quot;:new OpenLayers.Style(OpenLayers.Feature.Vector.style[&quot;temporary&quot;]),&quot;delete&quot;:new OpenLayers.Style(OpenLayers.Feature.Vector.style[&quot;delete&quot;])};if(style instanceof OpenLayers.Style){this.styles[&quot;default&quot;]=style;this.styles[&quot;select&quot;]=style;this.styles[&quot;temporary&quot;]=style;this.styles[&quot;delete&quot;]=style;}else if(typeof style==&quot;object&quot;){for(var key in style){if(style[key]instanceof OpenLayers.Style){this.styles[key]=style[key];}else if(typeof style[key]==&quot;object&quot;){this.styles[key]=new OpenLayers.Style(style[key]);}else{this.styles[&quot;default&quot;]=new OpenLayers.Style(style);this.styles[&quot;select&quot;]=new OpenLayers.Style(style);this.styles[&quot;temporary&quot;]=new OpenLayers.Style(style);this.styles[&quot;delete&quot;]=new OpenLayers.Style(style);break;}}}
OpenLayers.Util.extend(this,options);},destroy:function(){for(var key in this.styles){this.styles[key].destroy();}
this.styles=null;},createSymbolizer:function(feature,intent){if(!feature){feature=new OpenLayers.Feature.Vector();}
if(!this.styles[intent]){intent=&quot;default&quot;;}
feature.renderIntent=intent;var defaultSymbolizer={};if(this.extendDefault&amp;&amp;intent!=&quot;default&quot;){defaultSymbolizer=this.styles[&quot;default&quot;].createSymbolizer(feature);}
return OpenLayers.Util.extend(defaultSymbolizer,this.styles[intent].createSymbolizer(feature));},addUniqueValueRules:function(renderIntent,property,symbolizers,context){var rules=[];for(var value in symbolizers){rules.push(new OpenLayers.Rule({symbolizer:symbolizers[value],context:context,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:property,value:value})}));}
this.styles[renderIntent].addRules(rules);},CLASS_NAME:&quot;OpenLayers.StyleMap&quot;});OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(options){OpenLayers.Control.Panel.prototype.initialize.apply(this,[options]);this.addControls([new OpenLayers.Control.Navigation(),new OpenLayers.Control.ZoomBox()]);},draw:function(){var div=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);this.activateControl(this.controls[0]);return div;},CLASS_NAME:&quot;OpenLayers.Control.NavToolbar&quot;});OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:true,lowerBoundary:null,upperBoundary:null,initialize:function(options){OpenLayers.Filter.prototype.initialize.apply(this,[options]);},evaluate:function(context){var result=false;switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:var got=context[this.property];var exp=this.value;if(!this.matchCase&amp;&amp;typeof got==&quot;string&quot;&amp;&amp;typeof exp==&quot;string&quot;){result=(got.toUpperCase()==exp.toUpperCase());}else{result=(got==exp);}
break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:var got=context[this.property];var exp=this.value;if(!this.matchCase&amp;&amp;typeof got==&quot;string&quot;&amp;&amp;typeof exp==&quot;string&quot;){result=(got.toUpperCase()!=exp.toUpperCase());}else{result=(got!=exp);}
break;case OpenLayers.Filter.Comparison.LESS_THAN:result=context[this.property]&lt;this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:result=context[this.property]&gt;this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:result=context[this.property]&lt;=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:result=context[this.property]&gt;=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:result=(context[this.property]&gt;=this.lowerBoundary)&amp;&amp;(context[this.property]&lt;=this.upperBoundary);break;case OpenLayers.Filter.Comparison.LIKE:var regexp=new RegExp(this.value,&quot;gi&quot;);result=regexp.test(context[this.property]);break;}
return result;},value2regex:function(wildCard,singleChar,escapeChar){if(wildCard==&quot;.&quot;){var msg=&quot;&apos;.&apos; is an unsupported wildCard character for &quot;+&quot;OpenLayers.Filter.Comparison&quot;;OpenLayers.Console.error(msg);return null;}
wildCard=wildCard?wildCard:&quot;*&quot;;singleChar=singleChar?singleChar:&quot;.&quot;;escapeChar=escapeChar?escapeChar:&quot;!&quot;;this.value=this.value.replace(new RegExp(&quot;\\&quot;+escapeChar+&quot;(.|$)&quot;,&quot;g&quot;),&quot;\\$1&quot;);this.value=this.value.replace(new RegExp(&quot;\\&quot;+singleChar,&quot;g&quot;),&quot;.&quot;);this.value=this.value.replace(new RegExp(&quot;\\&quot;+wildCard,&quot;g&quot;),&quot;.*&quot;);this.value=this.value.replace(new RegExp(&quot;\\\\.\\*&quot;,&quot;g&quot;),&quot;\\&quot;+wildCard);this.value=this.value.replace(new RegExp(&quot;\\\\\\.&quot;,&quot;g&quot;),&quot;\\&quot;+singleChar);return this.value;},regex2value:function(){var value=this.value;value=value.replace(/!/g,&quot;!!&quot;);value=value.replace(/(\\)?\\\./g,function($0,$1){return $1?$0:&quot;!.&quot;;});value=value.replace(/(\\)?\\\*/g,function($0,$1){return $1?$0:&quot;!*&quot;;});value=value.replace(/\\\\/g,&quot;\\&quot;);value=value.replace(/\.\*/g,&quot;*&quot;);return value;},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison(),this);},CLASS_NAME:&quot;OpenLayers.Filter.Comparison&quot;});OpenLayers.Filter.Comparison.EQUAL_TO=&quot;==&quot;;OpenLayers.Filter.Comparison.NOT_EQUAL_TO=&quot;!=&quot;;OpenLayers.Filter.Comparison.LESS_THAN=&quot;&lt;&quot;;OpenLayers.Filter.Comparison.GREATER_THAN=&quot;&gt;&quot;;OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO=&quot;&lt;=&quot;;OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=&quot;&gt;=&quot;;OpenLayers.Filter.Comparison.BETWEEN=&quot;..&quot;;OpenLayers.Filter.Comparison.LIKE=&quot;~&quot;;OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,initialize:function(options){this.fids=[];OpenLayers.Filter.prototype.initialize.apply(this,[options]);},evaluate:function(feature){for(var i=0,len=this.fids.length;i&lt;len;i++){var fid=feature.fid||feature.id;if(fid==this.fids[i]){return true;}}
return false;},clone:function(){var filter=new OpenLayers.Filter.FeatureId();OpenLayers.Util.extend(filter,this);filter.fids=this.fids.slice();return filter;},CLASS_NAME:&quot;OpenLayers.Filter.FeatureId&quot;});OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(options){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[options]);},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this);},evaluate:function(context){switch(this.type){case OpenLayers.Filter.Logical.AND:for(var i=0,len=this.filters.length;i&lt;len;i++){if(this.filters[i].evaluate(context)==false){return false;}}
return true;case OpenLayers.Filter.Logical.OR:for(var i=0,len=this.filters.length;i&lt;len;i++){if(this.filters[i].evaluate(context)==true){return true;}}
return false;case OpenLayers.Filter.Logical.NOT:return(!this.filters[0].evaluate(context));}},clone:function(){var filters=[];for(var i=0,len=this.filters.length;i&lt;len;++i){filters.push(this.filters[i].clone());}
return new OpenLayers.Filter.Logical({type:this.type,filters:filters});},CLASS_NAME:&quot;OpenLayers.Filter.Logical&quot;});OpenLayers.Filter.Logical.AND=&quot;&amp;&amp;&quot;;OpenLayers.Filter.Logical.OR=&quot;||&quot;;OpenLayers.Filter.Logical.NOT=&quot;!&quot;;OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,initialize:function(options){OpenLayers.Filter.prototype.initialize.apply(this,[options]);},evaluate:function(feature){var intersect=false;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(feature.geometry){var geom=this.value;if(this.value.CLASS_NAME==&quot;OpenLayers.Bounds&quot;){geom=this.value.toGeometry();}
if(feature.geometry.intersects(geom)){intersect=true;}}
break;default:OpenLayers.Console.error(OpenLayers.i18n(&quot;filterEvaluateNotImplemented&quot;));break;}
return intersect;},clone:function(){var options=OpenLayers.Util.applyDefaults({value:this.value&amp;&amp;this.value.clone&amp;&amp;this.value.clone()},this);return new OpenLayers.Filter.Spatial(options);},CLASS_NAME:&quot;OpenLayers.Filter.Spatial&quot;});OpenLayers.Filter.Spatial.BBOX=&quot;BBOX&quot;;OpenLayers.Filter.Spatial.INTERSECTS=&quot;INTERSECTS&quot;;OpenLayers.Filter.Spatial.DWITHIN=&quot;DWITHIN&quot;;OpenLayers.Filter.Spatial.WITHIN=&quot;WITHIN&quot;;OpenLayers.Filter.Spatial.CONTAINS=&quot;CONTAINS&quot;;OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(components){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];if(components!=null){this.addComponents(components);}},destroy:function(){this.components.length=0;this.components=null;},clone:function(){var geometry=eval(&quot;new &quot;+this.CLASS_NAME+&quot;()&quot;);for(var i=0,len=this.components.length;i&lt;len;i++){geometry.addComponent(this.components[i].clone());}
OpenLayers.Util.applyDefaults(geometry,this);return geometry;},getComponentsString:function(){var strings=[];for(var i=0,len=this.components.length;i&lt;len;i++){strings.push(this.components[i].toShortString());}
return strings.join(&quot;,&quot;);},calculateBounds:function(){this.bounds=null;if(this.components&amp;&amp;this.components.length&gt;0){this.setBounds(this.components[0].getBounds());for(var i=1,len=this.components.length;i&lt;len;i++){this.extendBounds(this.components[i].getBounds());}}},addComponents:function(components){if(!(components instanceof Array)){components=[components];}
for(var i=0,len=components.length;i&lt;len;i++){this.addComponent(components[i]);}},addComponent:function(component,index){var added=false;if(component){if(this.componentTypes==null||(OpenLayers.Util.indexOf(this.componentTypes,component.CLASS_NAME)&gt;-1)){if(index!=null&amp;&amp;(index&lt;this.components.length)){var components1=this.components.slice(0,index);var components2=this.components.slice(index,this.components.length);components1.push(component);this.components=components1.concat(components2);}else{this.components.push(component);}
component.parent=this;this.clearBounds();added=true;}}
return added;},removeComponents:function(components){if(!(components instanceof Array)){components=[components];}
for(var i=components.length-1;i&gt;=0;--i){this.removeComponent(components[i]);}},removeComponent:function(component){OpenLayers.Util.removeItem(this.components,component);this.clearBounds();},getLength:function(){var length=0.0;for(var i=0,len=this.components.length;i&lt;len;i++){length+=this.components[i].getLength();}
return length;},getArea:function(){var area=0.0;for(var i=0,len=this.components.length;i&lt;len;i++){area+=this.components[i].getArea();}
return area;},getGeodesicArea:function(projection){var area=0.0;for(var i=0,len=this.components.length;i&lt;len;i++){area+=this.components[i].getGeodesicArea(projection);}
return area;},getCentroid:function(){return this.components.length&amp;&amp;this.components[0].getCentroid();},getGeodesicLength:function(projection){var length=0.0;for(var i=0,len=this.components.length;i&lt;len;i++){length+=this.components[i].getGeodesicLength(projection);}
return length;},move:function(x,y){for(var i=0,len=this.components.length;i&lt;len;i++){this.components[i].move(x,y);}},rotate:function(angle,origin){for(var i=0,len=this.components.length;i&lt;len;++i){this.components[i].rotate(angle,origin);}},resize:function(scale,origin,ratio){for(var i=0;i&lt;this.components.length;++i){this.components[i].resize(scale,origin,ratio);}
return this;},distanceTo:function(geometry,options){var edge=!(options&amp;&amp;options.edge===false);var details=edge&amp;&amp;options&amp;&amp;options.details;var result,best;var min=Number.POSITIVE_INFINITY;for(var i=0,len=this.components.length;i&lt;len;++i){result=this.components[i].distanceTo(geometry,options);distance=details?result.distance:result;if(distance&lt;min){min=distance;best=result;if(min==0){break;}}}
return best;},equals:function(geometry){var equivalent=true;if(!geometry||!geometry.CLASS_NAME||(this.CLASS_NAME!=geometry.CLASS_NAME)){equivalent=false;}else if(!(geometry.components instanceof Array)||(geometry.components.length!=this.components.length)){equivalent=false;}else{for(var i=0,len=this.components.length;i&lt;len;++i){if(!this.components[i].equals(geometry.components[i])){equivalent=false;break;}}}
return equivalent;},transform:function(source,dest){if(source&amp;&amp;dest){for(var i=0,len=this.components.length;i&lt;len;i++){var component=this.components[i];component.transform(source,dest);}
this.bounds=null;}
return this;},intersects:function(geometry){var intersect=false;for(var i=0,len=this.components.length;i&lt;len;++i){intersect=geometry.intersects(this.components[i]);if(intersect){break;}}
return intersect;},getVertices:function(nodes){var vertices=[];for(var i=0,len=this.components.length;i&lt;len;++i){Array.prototype.push.apply(vertices,this.components[i].getVertices(nodes));}
return vertices;},CLASS_NAME:&quot;OpenLayers.Geometry.Collection&quot;});OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(x,y){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(x);this.y=parseFloat(y);},clone:function(obj){if(obj==null){obj=new OpenLayers.Geometry.Point(this.x,this.y);}
OpenLayers.Util.applyDefaults(obj,this);return obj;},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y);},distanceTo:function(geometry,options){var edge=!(options&amp;&amp;options.edge===false);var details=edge&amp;&amp;options&amp;&amp;options.details;var distance,x0,y0,x1,y1,result;if(geometry instanceof OpenLayers.Geometry.Point){x0=this.x;y0=this.y;x1=geometry.x;y1=geometry.y;distance=Math.sqrt(Math.pow(x0-x1,2)+Math.pow(y0-y1,2));result=!details?distance:{x0:x0,y0:y0,x1:x1,y1:y1,distance:distance};}else{result=geometry.distanceTo(this,options);if(details){result={x0:result.x1,y0:result.y1,x1:result.x0,y1:result.y0,distance:result.distance};}}
return result;},equals:function(geom){var equals=false;if(geom!=null){equals=((this.x==geom.x&amp;&amp;this.y==geom.y)||(isNaN(this.x)&amp;&amp;isNaN(this.y)&amp;&amp;isNaN(geom.x)&amp;&amp;isNaN(geom.y)));}
return equals;},toShortString:function(){return(this.x+&quot;, &quot;+this.y);},move:function(x,y){this.x=this.x+x;this.y=this.y+y;this.clearBounds();},rotate:function(angle,origin){angle*=Math.PI/180;var radius=this.distanceTo(origin);var theta=angle+Math.atan2(this.y-origin.y,this.x-origin.x);this.x=origin.x+(radius*Math.cos(theta));this.y=origin.y+(radius*Math.sin(theta));this.clearBounds();},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y);},resize:function(scale,origin,ratio){ratio=(ratio==undefined)?1:ratio;this.x=origin.x+(scale*ratio*(this.x-origin.x));this.y=origin.y+(scale*(this.y-origin.y));this.clearBounds();return this;},intersects:function(geometry){var intersect=false;if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.Point&quot;){intersect=this.equals(geometry);}else{intersect=geometry.intersects(this);}
return intersect;},transform:function(source,dest){if((source&amp;&amp;dest)){OpenLayers.Projection.transform(this,source,dest);this.bounds=null;}
return this;},getVertices:function(nodes){return[this];},CLASS_NAME:&quot;OpenLayers.Geometry.Point&quot;});OpenLayers.Geometry.Rectangle=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,width:null,height:null,initialize:function(x,y,width,height){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=x;this.y=y;this.width=width;this.height=height;},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x+this.width,this.y+this.height);},getLength:function(){var length=(2*this.width)+(2*this.height);return length;},getArea:function(){var area=this.width*this.height;return area;},CLASS_NAME:&quot;OpenLayers.Geometry.Rectangle&quot;});OpenLayers.Geometry.Surface=OpenLayers.Class(OpenLayers.Geometry,{initialize:function(){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);},CLASS_NAME:&quot;OpenLayers.Geometry.Surface&quot;});OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{&apos;jpeg&apos;:&apos;jpg&apos;,&apos;gif&apos;:&apos;gif&apos;,&apos;png&apos;:&apos;png&apos;,&apos;png8&apos;:&apos;png&apos;,&apos;png24&apos;:&apos;png&apos;,&apos;dithered&apos;:&apos;png&apos;},DEFAULT_FORMAT:&apos;jpeg&apos;,initialize:function(name,url,params,options){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments);this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||DEFAULT_FORMAT];},getURL:function(bounds){bounds=this.adjustBounds(bounds);var mapRes=this.map.getResolution();var scale=Math.round((this.map.getScale()*10000))/10000;var pX=Math.round(bounds.left/mapRes);var pY=-Math.round(bounds.top/mapRes);var metaX=Math.floor(pX/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w;var metaY=Math.floor(pY/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h;var url=this.url;if(url instanceof Array){url=this.selectUrl(paramsString,url);}
var components=[url,&quot;/&quot;,this.params.map,&quot;/&quot;,scale,&quot;/&quot;,this.params.g.replace(/\s/g,&apos;_&apos;),&quot;/def/t&quot;,metaY,&quot;/l&quot;,metaX,&quot;/t&quot;,pY,&quot;l&quot;,pX,&quot;.&quot;,this.extension];return components.join(&quot;&quot;);},CLASS_NAME:&quot;OpenLayers.Layer.KaMapCache&quot;});OpenLayers.Layer.MapServer.Untiled=OpenLayers.Class(OpenLayers.Layer.MapServer,{singleTile:true,initialize:function(name,url,params,options){OpenLayers.Layer.MapServer.prototype.initialize.apply(this,arguments);var msg=&quot;The OpenLayers.Layer.MapServer.Untiled class is deprecated and &quot;+&quot;will be removed in 3.0. Instead, you should use the &quot;+&quot;normal OpenLayers.Layer.MapServer class, passing it the option &quot;+&quot;&apos;singleTile&apos; as true.&quot;;OpenLayers.Console.warn(msg);},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.MapServer.Untiled(this.name,this.url,this.params,this.options);}
obj=OpenLayers.Layer.MapServer.prototype.clone.apply(this,[obj]);return obj;},CLASS_NAME:&quot;OpenLayers.Layer.MapServer.Untiled&quot;});OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{EVENT_TYPES:[&quot;beforefeatureadded&quot;,&quot;beforefeaturesadded&quot;,&quot;featureadded&quot;,&quot;featuresadded&quot;,&quot;beforefeatureremoved&quot;,&quot;featureremoved&quot;,&quot;featuresremoved&quot;,&quot;beforefeatureselected&quot;,&quot;featureselected&quot;,&quot;featureunselected&quot;,&quot;beforefeaturemodified&quot;,&quot;featuremodified&quot;,&quot;afterfeaturemodified&quot;,&quot;vertexmodified&quot;,&quot;sketchstarted&quot;,&quot;sketchmodified&quot;,&quot;sketchcomplete&quot;,&quot;refresh&quot;],isBaseLayer:false,isFixed:false,isVector:true,features:null,selectedFeatures:null,unrenderedFeatures:null,reportError:true,style:null,styleMap:null,strategies:null,protocol:null,renderers:[&apos;SVG&apos;,&apos;VML&apos;,&apos;Canvas&apos;],renderer:null,rendererOptions:null,geometryType:null,drawn:false,initialize:function(name,options){this.EVENT_TYPES=OpenLayers.Layer.Vector.prototype.EVENT_TYPES.concat(OpenLayers.Layer.prototype.EVENT_TYPES);OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(!this.renderer||!this.renderer.supported()){this.assignRenderer();}
if(!this.renderer||!this.renderer.supported()){this.renderer=null;this.displayError();}
if(!this.styleMap){this.styleMap=new OpenLayers.StyleMap();}
this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies){for(var i=0,len=this.strategies.length;i&lt;len;i++){this.strategies[i].setLayer(this);}}},destroy:function(){if(this.strategies){var strategy,i,len;for(i=0,len=this.strategies.length;i&lt;len;i++){strategy=this.strategies[i];if(strategy.autoDestroy){strategy.destroy();}}
this.strategies=null;}
if(this.protocol){if(this.protocol.autoDestroy){this.protocol.destroy();}
this.protocol=null;}
this.destroyFeatures();this.features=null;this.selectedFeatures=null;this.unrenderedFeatures=null;if(this.renderer){this.renderer.destroy();}
this.renderer=null;this.geometryType=null;this.drawn=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments);},refresh:function(obj){if(this.calculateInRange()&amp;&amp;this.visibility){this.events.triggerEvent(&quot;refresh&quot;,obj);}},assignRenderer:function(){for(var i=0,len=this.renderers.length;i&lt;len;i++){var rendererClass=OpenLayers.Renderer[this.renderers[i]];if(rendererClass&amp;&amp;rendererClass.prototype.supported()){this.renderer=new rendererClass(this.div,this.rendererOptions);break;}}},displayError:function(){if(this.reportError){OpenLayers.Console.userError(OpenLayers.i18n(&quot;browserNotSupported&quot;,{&apos;renderers&apos;:this.renderers.join(&quot;\n&quot;)}));}},setMap:function(map){OpenLayers.Layer.prototype.setMap.apply(this,arguments);if(!this.renderer){this.map.removeLayer(this);}else{this.renderer.map=this.map;this.renderer.setSize(this.map.getSize());}},afterAdd:function(){if(this.strategies){var strategy,i,len;for(i=0,len=this.strategies.length;i&lt;len;i++){strategy=this.strategies[i];if(strategy.autoActivate){strategy.activate();}}}},removeMap:function(map){if(this.strategies){var strategy,i,len;for(i=0,len=this.strategies.length;i&lt;len;i++){strategy=this.strategies[i];if(strategy.autoActivate){strategy.deactivate();}}}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);this.renderer.setSize(this.map.getSize());},moveTo:function(bounds,zoomChanged,dragging){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var coordSysUnchanged=true;if(!dragging){this.renderer.root.style.visibility=&quot;hidden&quot;;this.div.style.left=-parseInt(this.map.layerContainerDiv.style.left)+&quot;px&quot;;this.div.style.top=-parseInt(this.map.layerContainerDiv.style.top)+&quot;px&quot;;var extent=this.map.getExtent();coordSysUnchanged=this.renderer.setExtent(extent,zoomChanged);this.renderer.root.style.visibility=&quot;visible&quot;;if(navigator.userAgent.toLowerCase().indexOf(&quot;gecko&quot;)!=-1){this.div.scrollLeft=this.div.scrollLeft;}
if(!zoomChanged&amp;&amp;coordSysUnchanged){for(var i in this.unrenderedFeatures){var feature=this.unrenderedFeatures[i];this.drawFeature(feature);}}}
if(!this.drawn||zoomChanged||!coordSysUnchanged){this.drawn=true;var feature;for(var i=0,len=this.features.length;i&lt;len;i++){this.renderer.locked=(i!==(len-1));feature=this.features[i];this.drawFeature(feature);}}},display:function(display){OpenLayers.Layer.prototype.display.apply(this,arguments);var currentDisplay=this.div.style.display;if(currentDisplay!=this.renderer.root.style.display){this.renderer.root.style.display=currentDisplay;}},addFeatures:function(features,options){if(!(features instanceof Array)){features=[features];}
var notify=!options||!options.silent;if(notify){var event={features:features};var ret=this.events.triggerEvent(&quot;beforefeaturesadded&quot;,event);if(ret===false){return;}
features=event.features;}
for(var i=0,len=features.length;i&lt;len;i++){if(i!=(features.length-1)){this.renderer.locked=true;}else{this.renderer.locked=false;}
var feature=features[i];if(this.geometryType&amp;&amp;!(feature.geometry instanceof this.geometryType)){var throwStr=OpenLayers.i18n(&apos;componentShouldBe&apos;,{&apos;geomType&apos;:this.geometryType.prototype.CLASS_NAME});throw throwStr;}
this.features.push(feature);feature.layer=this;if(!feature.style&amp;&amp;this.style){feature.style=OpenLayers.Util.extend({},this.style);}
if(notify){if(this.events.triggerEvent(&quot;beforefeatureadded&quot;,{feature:feature})===false){continue;};this.preFeatureInsert(feature);}
this.drawFeature(feature);if(notify){this.events.triggerEvent(&quot;featureadded&quot;,{feature:feature});this.onFeatureInsert(feature);}}
if(notify){this.events.triggerEvent(&quot;featuresadded&quot;,{features:features});}},removeFeatures:function(features,options){if(!features||features.length===0){return;}
if(!(features instanceof Array)){features=[features];}
if(features===this.features){features=features.slice();}
var notify=!options||!options.silent;for(var i=features.length-1;i&gt;=0;i--){if(i!=0&amp;&amp;features[i-1].geometry){this.renderer.locked=true;}else{this.renderer.locked=false;}
var feature=features[i];delete this.unrenderedFeatures[feature.id];if(notify){this.events.triggerEvent(&quot;beforefeatureremoved&quot;,{feature:feature});}
this.features=OpenLayers.Util.removeItem(this.features,feature);feature.layer=null;if(feature.geometry){this.renderer.eraseFeatures(feature);}
if(OpenLayers.Util.indexOf(this.selectedFeatures,feature)!=-1){OpenLayers.Util.removeItem(this.selectedFeatures,feature);}
if(notify){this.events.triggerEvent(&quot;featureremoved&quot;,{feature:feature});}}
if(notify){this.events.triggerEvent(&quot;featuresremoved&quot;,{features:features});}},destroyFeatures:function(features,options){var all=(features==undefined);if(all){features=this.features;}
if(features){this.removeFeatures(features,options);for(var i=features.length-1;i&gt;=0;i--){features[i].destroy();}}},drawFeature:function(feature,style){if(!this.drawn){return}
if(typeof style!=&quot;object&quot;){if(!style&amp;&amp;feature.state===OpenLayers.State.DELETE){style=&quot;delete&quot;;}
var renderIntent=style||feature.renderIntent;style=feature.style||this.style;if(!style){style=this.styleMap.createSymbolizer(feature,renderIntent);}}
if(!this.renderer.drawFeature(feature,style)){this.unrenderedFeatures[feature.id]=feature;}else{delete this.unrenderedFeatures[feature.id];};},eraseFeatures:function(features){this.renderer.eraseFeatures(features);},getFeatureFromEvent:function(evt){if(!this.renderer){OpenLayers.Console.error(OpenLayers.i18n(&quot;getFeatureError&quot;));return null;}
var featureId=this.renderer.getFeatureIdFromEvent(evt);return this.getFeatureById(featureId);},getFeatureById:function(featureId){var feature=null;for(var i=0,len=this.features.length;i&lt;len;++i){if(this.features[i].id==featureId){feature=this.features[i];break;}}
return feature;},onFeatureInsert:function(feature){},preFeatureInsert:function(feature){},getDataExtent:function(){var maxExtent=null;if(this.features&amp;&amp;(this.features.length&gt;0)){maxExtent=new OpenLayers.Bounds();for(var i=0,len=this.features.length;i&lt;len;i++){maxExtent.extend(this.features[i].geometry.getBounds());}}
return maxExtent;},CLASS_NAME:&quot;OpenLayers.Layer.Vector&quot;});OpenLayers.Layer.WMS.Untiled=OpenLayers.Class(OpenLayers.Layer.WMS,{singleTile:true,initialize:function(name,url,params,options){OpenLayers.Layer.WMS.prototype.initialize.apply(this,arguments);var msg=&quot;The OpenLayers.Layer.WMS.Untiled class is deprecated and &quot;+&quot;will be removed in 3.0. Instead, you should use the &quot;+&quot;normal OpenLayers.Layer.WMS class, passing it the option &quot;+&quot;&apos;singleTile&apos; as true.&quot;;OpenLayers.Console.warn(msg);},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.WMS.Untiled(this.name,this.url,this.params,this.options);}
obj=OpenLayers.Layer.WMS.prototype.clone.apply(this,[obj]);return obj;},CLASS_NAME:&quot;OpenLayers.Layer.WMS.Untiled&quot;});OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:false,click:true,clickout:true,toggle:false,clickTolerance:5,hover:false,box:false,maxFeatures:10,features:null,hoverFeature:null,handlerOptions:null,handlers:null,hoverResponse:null,EVENT_TYPES:[&quot;featureselected&quot;,&quot;featureunselected&quot;,&quot;clickout&quot;,&quot;beforefeatureselected&quot;,&quot;hoverfeature&quot;,&quot;outfeature&quot;],initialize:function(options){this.EVENT_TYPES=OpenLayers.Control.GetFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);options.handlerOptions=options.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[options]);this.features={};this.handlers={};if(this.click){this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.selectSingle},this.handlerOptions.click||{})};if(this.box){this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:&quot;olHandlerBoxSelectFeature&quot;}));}
if(this.hover){this.handlers.hover=new OpenLayers.Handler.Hover(this,{&apos;move&apos;:this.cancelHover,&apos;pause&apos;:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{&apos;delay&apos;:250}));}},activate:function(){if(!this.active){for(var i in this.handlers){this.handlers[i].activate();}}
return OpenLayers.Control.prototype.activate.apply(this,arguments);},deactivate:function(){if(this.active){for(var i in this.handlers){this.handlers[i].deactivate();}}
return OpenLayers.Control.prototype.deactivate.apply(this,arguments);},unselectAll:function(options){var feature;for(var i=this.features.length-1;i&gt;=0;--i){feature=this.features[i];if(!options||options.except!=feature){this.unselect(feature);}}},selectSingle:function(evt){OpenLayers.Element.addClass(this.map.viewPortDiv,&quot;olCursorWait&quot;);var bounds=this.pixelToBounds(evt.xy);this.setModifiers(evt);this.request(bounds,{single:true});},selectBox:function(position){if(position instanceof OpenLayers.Bounds){var minXY=this.map.getLonLatFromPixel(new OpenLayers.Pixel(position.left,position.bottom));var maxXY=this.map.getLonLatFromPixel(new OpenLayers.Pixel(position.right,position.top));var bounds=new OpenLayers.Bounds(minXY.lon,minXY.lat,maxXY.lon,maxXY.lat);this.setModifiers(this.handlers.box.dragHandler.evt);this.request(bounds);}},selectHover:function(evt){var bounds=this.pixelToBounds(evt.xy);this.request(bounds,{single:true,hover:true});},cancelHover:function(){if(this.hoverResponse){this.protocol.abort(this.hoverResponse);this.hoverResponse=null;}},request:function(bounds,options){options=options||{};var filter=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:bounds});var response=this.protocol.read({maxFeatures:options.single==true?this.maxFeatures:undefined,filter:filter,callback:function(result){if(result.code==1){if(result.features.length){if(options.single==true){this.selectBestFeature(result.features,bounds.getCenterLonLat(),options);}else{this.select(result.features);}}else if(options.hover){this.hoverSelect();}else{this.events.triggerEvent(&quot;clickout&quot;);if(this.clickout){this.unselectAll();}}}
OpenLayers.Element.removeClass(this.map.viewPortDiv,&quot;olCursorWait&quot;);},scope:this});if(options.hover==true){this.hoverResponse=response;}},selectBestFeature:function(features,clickPosition,options){options=options||{};if(features.length){var point=new OpenLayers.Geometry.Point(clickPosition.lon,clickPosition.lat);var feature,resultFeature,dist;var minDist=Number.MAX_VALUE;for(var i=0;i&lt;features.length;++i){feature=features[i];if(feature.geometry){dist=point.distanceTo(feature.geometry,{edge:false});if(dist&lt;minDist){minDist=dist;resultFeature=feature;if(minDist==0){break;}}}}
if(options.hover==true){this.hoverSelect(resultFeature);}else{this.select(resultFeature||features);}};},setModifiers:function(evt){this.modifiers={multiple:this.multiple||(this.multipleKey&amp;&amp;evt[this.multipleKey]),toggle:this.toggle||(this.toggleKey&amp;&amp;evt[this.toggleKey])}},select:function(features){if(!this.modifiers.multiple&amp;&amp;!this.modifiers.toggle){this.unselectAll();}
if(!(features instanceof Array)){features=[features];}
var feature;for(var i=0,len=features.length;i&lt;len;++i){feature=features[i];if(this.features[feature.fid||feature.id]){if(this.modifiers.toggle){this.unselect(this.features[feature.fid||feature.id]);}}else{cont=this.events.triggerEvent(&quot;beforefeatureselected&quot;,{feature:feature});if(cont!==false){this.features[feature.fid||feature.id]=feature;this.events.triggerEvent(&quot;featureselected&quot;,{feature:feature});}}}},hoverSelect:function(feature){var fid=feature?feature.fid||feature.id:null;var hfid=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;if(hfid&amp;&amp;hfid!=fid){this.events.triggerEvent(&quot;outfeature&quot;,{feature:this.hoverFeature});this.hoverFeature=null;}
if(fid&amp;&amp;fid!=hfid){this.events.triggerEvent(&quot;hoverfeature&quot;,{feature:feature});this.hoverFeature=feature;}},unselect:function(feature){delete this.features[feature.fid||feature.id];this.events.triggerEvent(&quot;featureunselected&quot;,{feature:feature});},unselectAll:function(){for(var fid in this.features){this.unselect(this.features[fid]);}},setMap:function(map){for(var i in this.handlers){this.handlers[i].setMap(map);}
OpenLayers.Control.prototype.setMap.apply(this,arguments);},pixelToBounds:function(pixel){var llPx=pixel.add(-this.clickTolerance/2,this.clickTolerance/2);var urPx=pixel.add(this.clickTolerance/2,-this.clickTolerance/2);var ll=this.map.getLonLatFromPixel(llPx);var ur=this.map.getLonLatFromPixel(urPx);return new OpenLayers.Bounds(ll.lon,ll.lat,ur.lon,ur.lat);},CLASS_NAME:&quot;OpenLayers.Control.GetFeature&quot;});OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:[&quot;beforesnap&quot;,&quot;snap&quot;,&quot;unsnap&quot;],DEFAULTS:{tolerance:10,node:true,edge:true,vertex:true},greedy:true,precedence:[&quot;node&quot;,&quot;vertex&quot;,&quot;edge&quot;],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(options){Array.prototype.push.apply(this.EVENT_TYPES,OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[options]);this.options=options||{};if(this.options.layer){this.setLayer(this.options.layer);}
var defaults=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(defaults,this.DEFAULTS);this.setTargets(this.options.targets);if(this.targets.length===0&amp;&amp;this.layer){this.addTargetLayer(this.layer);}
this.geoToleranceCache={};},setLayer:function(layer){if(this.active){this.deactivate();this.layer=layer;this.activate();}else{this.layer=layer;}},setTargets:function(targets){this.targets=[];if(targets&amp;&amp;targets.length){var target;for(var i=0,len=targets.length;i&lt;len;++i){target=targets[i];if(target instanceof OpenLayers.Layer.Vector){this.addTargetLayer(target);}else{this.addTarget(target);}}}},addTargetLayer:function(layer){this.addTarget({layer:layer});},addTarget:function(target){target=OpenLayers.Util.applyDefaults(target,this.defaults);target.nodeTolerance=target.nodeTolerance||target.tolerance;target.vertexTolerance=target.vertexTolerance||target.tolerance;target.edgeTolerance=target.edgeTolerance||target.tolerance;this.targets.push(target);},removeTargetLayer:function(layer){var target;for(var i=this.targets.length-1;i&gt;=0;--i){target=this.targets[i];if(target.layer===layer){this.removeTarget(target);}}},removeTarget:function(target){return OpenLayers.Util.removeItem(this.targets,target);},activate:function(){var activated=OpenLayers.Control.prototype.activate.call(this);if(activated){if(this.layer&amp;&amp;this.layer.events){this.layer.events.on({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this});}}
return activated;},deactivate:function(){var deactivated=OpenLayers.Control.prototype.deactivate.call(this);if(deactivated){if(this.layer&amp;&amp;this.layer.events){this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this});}}
this.feature=null;this.point=null;return deactivated;},onSketchModified:function(event){this.feature=event.feature;this.considerSnapping(event.vertex,event.vertex);},onVertexModified:function(event){this.feature=event.feature;var loc=this.layer.map.getLonLatFromViewPortPx(event.pixel);this.considerSnapping(event.vertex,new OpenLayers.Geometry.Point(loc.lon,loc.lat));},considerSnapping:function(point,loc){var best={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null};var snapped=false;var result,target;for(var i=0,len=this.targets.length;i&lt;len;++i){target=this.targets[i];result=this.testTarget(target,loc);if(result){if(this.greedy){best=result;best.target=target;snapped=true;break;}else{if((result.rank&lt;best.rank)||(result.rank===best.rank&amp;&amp;result.dist&lt;best.dist)){best=result;best.target=target;snapped=true;}}}}
if(snapped){var proceed=this.events.triggerEvent(&quot;beforesnap&quot;,{point:point,x:best.x,y:best.y,distance:best.dist,layer:best.target.layer,snapType:this.precedence[best.rank]});if(proceed!==false){point.x=best.x;point.y=best.y;this.point=point;this.events.triggerEvent(&quot;snap&quot;,{point:point,snapType:this.precedence[best.rank],layer:best.target.layer,distance:best.dist});}else{snapped=false;}}
if(this.point&amp;&amp;!snapped){point.x=loc.x;point.y=loc.y;this.point=null;this.events.triggerEvent(&quot;unsnap&quot;,{point:point});}},testTarget:function(target,loc){var tolerance={node:this.getGeoTolerance(target.nodeTolerance),vertex:this.getGeoTolerance(target.vertexTolerance),edge:this.getGeoTolerance(target.edgeTolerance)};var maxTolerance=Math.max(tolerance.node,tolerance.vertex,tolerance.edge);var result={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY};var eligible=false;var features=target.layer.features;var feature,type,vertices,vertex,closest,dist,found;var numTypes=this.precedence.length;var ll=new OpenLayers.LonLat(loc.x,loc.y);for(var i=0,len=features.length;i&lt;len;++i){feature=features[i];if(feature!==this.feature&amp;&amp;!feature._sketch&amp;&amp;feature.state!==OpenLayers.State.DELETE&amp;&amp;(!target.filter||target.filter.evaluate(feature.attributes))){if(feature.atPoint(ll,maxTolerance,maxTolerance)){for(var j=0,stop=Math.min(result.rank+1,numTypes);j&lt;stop;++j){type=this.precedence[j];if(target[type]){if(type===&quot;edge&quot;){closest=feature.geometry.distanceTo(loc,{details:true});dist=closest.distance;if(dist&lt;=tolerance[type]&amp;&amp;dist&lt;result.dist){result={rank:j,dist:dist,x:closest.x0,y:closest.y0};eligible=true;break;}}else{vertices=feature.geometry.getVertices(type===&quot;node&quot;);found=false;for(var k=0,klen=vertices.length;k&lt;klen;++k){vertex=vertices[k];dist=vertex.distanceTo(loc);if(dist&lt;=tolerance[type]&amp;&amp;(j&lt;result.rank||(j===result.rank&amp;&amp;dist&lt;result.dist))){result={rank:j,dist:dist,x:vertex.x,y:vertex.y};eligible=true;found=true;}}
if(found){break;}}}}}}}
return eligible?result:null;},getGeoTolerance:function(tolerance){var resolution=this.layer.map.getResolution();if(resolution!==this.resolution){this.resolution=resolution;this.geoToleranceCache={};}
var geoTolerance=this.geoToleranceCache[tolerance];if(geoTolerance===undefined){geoTolerance=tolerance*resolution;this.geoToleranceCache[tolerance]=geoTolerance;}
return geoTolerance;},destroy:function(){if(this.active){this.deactivate();}
delete this.layer;delete this.targets;OpenLayers.Control.prototype.destroy.call(this);},CLASS_NAME:&quot;OpenLayers.Control.Snapping&quot;});OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:&quot;1.0.0&quot;,version:null,parser:null,initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},write:function(filter,options){var version=(options&amp;&amp;options.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=version){var format=OpenLayers.Format.Filter[&quot;v&quot;+version.replace(/\./g,&quot;_&quot;)];if(!format){throw&quot;Can&apos;t find a Filter parser for version &quot;+
version;}
this.parser=new format(this.options);}
return this.parser.write(filter);},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var version=this.version;if(!version){version=this.defaultVersion;}
if(!this.parser||this.parser.VERSION!=version){var format=OpenLayers.Format.Filter[&quot;v&quot;+version.replace(/\./g,&quot;_&quot;)];if(!format){throw&quot;Can&apos;t find a Filter parser for version &quot;+
version;}
this.parser=new format(this.options);}
var filter=this.parser.read(data);return filter;},CLASS_NAME:&quot;OpenLayers.Format.Filter&quot;});OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:&quot;1.0.0&quot;,version:null,namedLayersAsArray:false,parser:null,initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},write:function(sld,options){var version=(options&amp;&amp;options.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=version){var format=OpenLayers.Format.SLD[&quot;v&quot;+version.replace(/\./g,&quot;_&quot;)];if(!format){throw&quot;Can&apos;t find a SLD parser for version &quot;+
version;}
this.parser=new format(this.options);}
var root=this.parser.write(sld);return OpenLayers.Format.XML.prototype.write.apply(this,[root]);},read:function(data,options){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var root=data.documentElement;var version=this.version;if(!version){version=root.getAttribute(&quot;version&quot;);if(!version){version=this.defaultVersion;}}
if(!this.parser||this.parser.VERSION!=version){var format=OpenLayers.Format.SLD[&quot;v&quot;+version.replace(/\./g,&quot;_&quot;)];if(!format){throw&quot;Can&apos;t find a SLD parser for version &quot;+
version;}
this.parser=new format(this.options);}
var sld=this.parser.read(data,options);return sld;},CLASS_NAME:&quot;OpenLayers.Format.SLD&quot;});OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:true,initialize:function(options){options=options||{};if(options.extractStyles!==false){options.defaultStyle={&apos;externalGraphic&apos;:OpenLayers.Util.getImagesLocation()+&quot;marker.png&quot;,&apos;graphicWidth&apos;:21,&apos;graphicHeight&apos;:25,&apos;graphicXOffset&apos;:-10.5,&apos;graphicYOffset&apos;:-12.5};}
OpenLayers.Format.prototype.initialize.apply(this,[options]);},read:function(text){var lines=text.split(&apos;\n&apos;);var columns;var features=[];for(var lcv=0;lcv&lt;(lines.length-1);lcv++){var currLine=lines[lcv].replace(/^\s*/,&apos;&apos;).replace(/\s*$/,&apos;&apos;);if(currLine.charAt(0)!=&apos;#&apos;){if(!columns){columns=currLine.split(&apos;\t&apos;);}else{var vals=currLine.split(&apos;\t&apos;);var geometry=new OpenLayers.Geometry.Point(0,0);var attributes={};var style=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null;var icon,iconSize,iconOffset,overflow;var set=false;for(var valIndex=0;valIndex&lt;vals.length;valIndex++){if(vals[valIndex]){if(columns[valIndex]==&apos;point&apos;){var coords=vals[valIndex].split(&apos;,&apos;);geometry.y=parseFloat(coords[0]);geometry.x=parseFloat(coords[1]);set=true;}else if(columns[valIndex]==&apos;lat&apos;){geometry.y=parseFloat(vals[valIndex]);set=true;}else if(columns[valIndex]==&apos;lon&apos;){geometry.x=parseFloat(vals[valIndex]);set=true;}else if(columns[valIndex]==&apos;title&apos;)
attributes[&apos;title&apos;]=vals[valIndex];else if(columns[valIndex]==&apos;image&apos;||columns[valIndex]==&apos;icon&apos;&amp;&amp;style){style[&apos;externalGraphic&apos;]=vals[valIndex];}else if(columns[valIndex]==&apos;iconSize&apos;&amp;&amp;style){var size=vals[valIndex].split(&apos;,&apos;);style[&apos;graphicWidth&apos;]=parseFloat(size[0]);style[&apos;graphicHeight&apos;]=parseFloat(size[1]);}else if(columns[valIndex]==&apos;iconOffset&apos;&amp;&amp;style){var offset=vals[valIndex].split(&apos;,&apos;);style[&apos;graphicXOffset&apos;]=parseFloat(offset[0]);style[&apos;graphicYOffset&apos;]=parseFloat(offset[1]);}else if(columns[valIndex]==&apos;description&apos;){attributes[&apos;description&apos;]=vals[valIndex];}else if(columns[valIndex]==&apos;overflow&apos;){attributes[&apos;overflow&apos;]=vals[valIndex];}else{attributes[columns[valIndex]]=vals[valIndex];}}}
if(set){if(this.internalProjection&amp;&amp;this.externalProjection){geometry.transform(this.externalProjection,this.internalProjection);}
var feature=new OpenLayers.Feature.Vector(geometry,attributes,style);features.push(feature);}}}}
return features;},CLASS_NAME:&quot;OpenLayers.Format.Text&quot;});OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:[&quot;OpenLayers.Geometry.Point&quot;],initialize:function(components){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments);},addPoint:function(point,index){this.addComponent(point,index);},removePoint:function(point){this.removeComponent(point);},CLASS_NAME:&quot;OpenLayers.Geometry.MultiPoint&quot;});OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:false,drawing:false,mouseDown:false,lastDown:null,lastUp:null,persist:false,layerOptions:null,initialize:function(control,callbacks,options){if(!(options&amp;&amp;options.layerOptions&amp;&amp;options.layerOptions.styleMap)){this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style[&apos;default&apos;],{});}
OpenLayers.Handler.prototype.initialize.apply(this,arguments);},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments)){return false;}
var options=OpenLayers.Util.extend({displayInLayerSwitcher:false,calculateInRange:function(){return true;}},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,options);this.map.addLayer(this.layer);return true;},createFeature:function(pixel){var lonlat=this.map.getLonLatFromPixel(pixel);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(lonlat.lon,lonlat.lat));this.callback(&quot;create&quot;,[this.point.geometry,this.point]);this.point.geometry.clearBounds();this.layer.addFeatures([this.point],{silent:true});},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){return false;}
if(this.drawing){this.cancel();}
this.destroyFeature();if(this.layer.map!=null){this.layer.destroy(false);}
this.layer=null;return true;},destroyFeature:function(){if(this.layer){this.layer.destroyFeatures();}
this.point=null;},finalize:function(cancel){var key=cancel?&quot;cancel&quot;:&quot;done&quot;;this.drawing=false;this.mouseDown=false;this.lastDown=null;this.lastUp=null;this.callback(key,[this.geometryClone()]);if(cancel||!this.persist){this.destroyFeature();}},cancel:function(){this.finalize(true);},click:function(evt){OpenLayers.Event.stop(evt);return false;},dblclick:function(evt){OpenLayers.Event.stop(evt);return false;},modifyFeature:function(pixel){var lonlat=this.map.getLonLatFromPixel(pixel);this.point.geometry.x=lonlat.lon;this.point.geometry.y=lonlat.lat;this.callback(&quot;modify&quot;,[this.point.geometry,this.point]);this.point.geometry.clearBounds();this.drawFeature();},drawFeature:function(){this.layer.drawFeature(this.point,this.style);},getGeometry:function(){var geometry=this.point&amp;&amp;this.point.geometry;if(geometry&amp;&amp;this.multi){geometry=new OpenLayers.Geometry.MultiPoint([geometry]);}
return geometry;},geometryClone:function(){var geom=this.getGeometry();return geom&amp;&amp;geom.clone();},mousedown:function(evt){if(!this.checkModifiers(evt)){return true;}
if(this.lastDown&amp;&amp;this.lastDown.equals(evt.xy)){return true;}
this.drawing=true;if(this.lastDown==null){if(this.persist){this.destroyFeature();}
this.createFeature(evt.xy);}else{this.modifyFeature(evt.xy);}
this.lastDown=evt.xy;return false;},mousemove:function(evt){if(this.drawing){this.modifyFeature(evt.xy);}
return true;},mouseup:function(evt){if(this.drawing){this.finalize();return false;}else{return true;}},CLASS_NAME:&quot;OpenLayers.Handler.Point&quot;});OpenLayers.Layer.GML=OpenLayers.Class(OpenLayers.Layer.Vector,{loaded:false,format:null,formatOptions:null,initialize:function(name,url,options){var newArguments=[];newArguments.push(name,options);OpenLayers.Layer.Vector.prototype.initialize.apply(this,newArguments);this.url=url;},setVisibility:function(visibility,noEvent){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments);if(this.visibility&amp;&amp;!this.loaded){this.loadGML();}},moveTo:function(bounds,zoomChanged,minor){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments);if(this.visibility&amp;&amp;!this.loaded){this.loadGML();}},loadGML:function(){if(!this.loaded){this.events.triggerEvent(&quot;loadstart&quot;);OpenLayers.Request.GET({url:this.url,success:this.requestSuccess,failure:this.requestFailure,scope:this});this.loaded=true;}},setUrl:function(url){this.url=url;this.destroyFeatures();this.loaded=false;this.loadGML();},requestSuccess:function(request){var doc=request.responseXML;if(!doc||!doc.documentElement){doc=request.responseText;}
var options={};OpenLayers.Util.extend(options,this.formatOptions);if(this.map&amp;&amp;!this.projection.equals(this.map.getProjectionObject())){options.externalProjection=this.projection;options.internalProjection=this.map.getProjectionObject();}
var gml=this.format?new this.format(options):new OpenLayers.Format.GML(options);this.addFeatures(gml.read(doc));this.events.triggerEvent(&quot;loadend&quot;);},requestFailure:function(request){OpenLayers.Console.userError(OpenLayers.i18n(&quot;errorLoadingGML&quot;,{&apos;url&apos;:this.url}));this.events.triggerEvent(&quot;loadend&quot;);},CLASS_NAME:&quot;OpenLayers.Layer.GML&quot;});OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,initialize:function(name,options){OpenLayers.Layer.Vector.prototype.initialize.apply(this,arguments);},addNodes:function(pointFeatures){if(pointFeatures.length&lt;2){OpenLayers.Console.error(&quot;At least two point features have to be added to create&quot;+&quot;a line from&quot;);return;}
var lines=new Array(pointFeatures.length-1);var pointFeature,startPoint,endPoint;for(var i=0,len=pointFeatures.length;i&lt;len;i++){pointFeature=pointFeatures[i];endPoint=pointFeature.geometry;if(!endPoint){var lonlat=pointFeature.lonlat;endPoint=new OpenLayers.Geometry.Point(lonlat.lon,lonlat.lat);}else if(endPoint.CLASS_NAME!=&quot;OpenLayers.Geometry.Point&quot;){OpenLayers.Console.error(&quot;Only features with point geometries are supported.&quot;);return;}
if(i&gt;0){var attributes=(this.dataFrom!=null)?(pointFeatures[i+this.dataFrom].data||pointFeatures[i+this.dataFrom].attributes):null;var line=new OpenLayers.Geometry.LineString([startPoint,endPoint]);lines[i-1]=new OpenLayers.Feature.Vector(line,attributes);}
startPoint=endPoint;}
this.addFeatures(lines);},CLASS_NAME:&quot;OpenLayers.Layer.PointTrack&quot;});OpenLayers.Layer.PointTrack.dataFrom={&apos;SOURCE_NODE&apos;:-1,&apos;TARGET_NODE&apos;:0};OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:false,layers:null,initialize:function(name,options){OpenLayers.Layer.Vector.prototype.initialize.apply(this,arguments);},display:function(){},getFeatureFromEvent:function(evt){var layers=this.layers;var feature;for(var i=0;i&lt;layers.length;i++){feature=layers[i].getFeatureFromEvent(evt);if(feature){return feature;}}},setMap:function(map){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();map.events.register(&quot;changelayer&quot;,this,this.handleChangeLayer);},removeMap:function(map){map.events.unregister(&quot;changelayer&quot;,this,this.handleChangeLayer);this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments);},collectRoots:function(){var layer;for(var i=0;i&lt;this.map.layers.length;++i){layer=this.map.layers[i];if(OpenLayers.Util.indexOf(this.layers,layer)!=-1){layer.renderer.moveRoot(this.renderer);}}},resetRoots:function(){var layer;for(var i=0;i&lt;this.layers.length;++i){layer=this.layers[i];if(this.renderer&amp;&amp;layer.renderer.getRenderLayerId()==this.id){this.renderer.moveRoot(layer.renderer);}}},handleChangeLayer:function(evt){var layer=evt.layer;if(evt.property==&quot;order&quot;&amp;&amp;OpenLayers.Util.indexOf(this.layers,layer)!=-1){this.resetRoots();this.collectRoots();}},CLASS_NAME:&quot;OpenLayers.Layer.Vector.RootContainer&quot;});OpenLayers.Layer.WFS=OpenLayers.Class(OpenLayers.Layer.Vector,OpenLayers.Layer.Markers,{isBaseLayer:false,tile:null,ratio:2,DEFAULT_PARAMS:{service:&quot;WFS&quot;,version:&quot;1.0.0&quot;,request:&quot;GetFeature&quot;},featureClass:null,format:null,formatObject:null,formatOptions:null,vectorMode:true,encodeBBOX:false,extractAttributes:false,initialize:function(name,url,params,options){if(options==undefined){options={};}
if(options.featureClass||!OpenLayers.Layer.Vector||!OpenLayers.Feature.Vector){this.vectorMode=false;}
OpenLayers.Util.extend(options,{&apos;reportError&apos;:false});var newArguments=[];newArguments.push(name,options);OpenLayers.Layer.Vector.prototype.initialize.apply(this,newArguments);if(!this.renderer||!this.vectorMode){this.vectorMode=false;if(!options.featureClass){options.featureClass=OpenLayers.Feature.WFS;}
OpenLayers.Layer.Markers.prototype.initialize.apply(this,newArguments);}
if(this.params&amp;&amp;this.params.typename&amp;&amp;!this.options.typename){this.options.typename=this.params.typename;}
if(!this.options.geometry_column){this.options.geometry_column=&quot;the_geom&quot;;}
this.params=OpenLayers.Util.applyDefaults(params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));this.url=url;},destroy:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.destroy.apply(this,arguments);}else{OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);}
if(this.tile){this.tile.destroy();}
this.tile=null;this.ratio=null;this.featureClass=null;this.format=null;if(this.formatObject&amp;&amp;this.formatObject.destroy){this.formatObject.destroy();}
this.formatObject=null;this.formatOptions=null;this.vectorMode=null;this.encodeBBOX=null;this.extractAttributes=null;},setMap:function(map){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);var options={&apos;extractAttributes&apos;:this.extractAttributes};OpenLayers.Util.extend(options,this.formatOptions);if(this.map&amp;&amp;!this.projection.equals(this.map.getProjectionObject())){options.externalProjection=this.projection;options.internalProjection=this.map.getProjectionObject();}
this.formatObject=this.format?new this.format(options):new OpenLayers.Format.GML(options);}else{OpenLayers.Layer.Markers.prototype.setMap.apply(this,arguments);}},moveTo:function(bounds,zoomChanged,dragging){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments);}else{OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);}
if(dragging){return false;}
if(zoomChanged){if(this.vectorMode){this.renderer.clear();}}
if(this.options.minZoomLevel){OpenLayers.Console.warn(OpenLayers.i18n(&apos;minZoomLevelError&apos;));if(this.map.getZoom()&lt;this.options.minZoomLevel){return null;}}
if(bounds==null){bounds=this.map.getExtent();}
var firstRendering=(this.tile==null);var outOfBounds=(!firstRendering&amp;&amp;!this.tile.bounds.containsBounds(bounds));if(zoomChanged||firstRendering||(!dragging&amp;&amp;outOfBounds)){var center=bounds.getCenterLonLat();var tileWidth=bounds.getWidth()*this.ratio;var tileHeight=bounds.getHeight()*this.ratio;var tileBounds=new OpenLayers.Bounds(center.lon-(tileWidth/2),center.lat-(tileHeight/2),center.lon+(tileWidth/2),center.lat+(tileHeight/2));var tileSize=this.map.getSize();tileSize.w=tileSize.w*this.ratio;tileSize.h=tileSize.h*this.ratio;var ul=new OpenLayers.LonLat(tileBounds.left,tileBounds.top);var pos=this.map.getLayerPxFromLonLat(ul);var url=this.getFullRequestString();var params=null;var filter=this.params.filter||this.params.FILTER;if(filter){params={FILTER:filter};}
else{params={BBOX:this.encodeBBOX?tileBounds.toBBOX():tileBounds.toArray()};}
if(this.map&amp;&amp;!this.projection.equals(this.map.getProjectionObject())){var projectedBounds=tileBounds.clone();projectedBounds.transform(this.map.getProjectionObject(),this.projection);if(!filter){params.BBOX=this.encodeBBOX?projectedBounds.toBBOX():projectedBounds.toArray();}}
url+=&quot;&amp;&quot;+OpenLayers.Util.getParameterString(params);if(!this.tile){this.tile=new OpenLayers.Tile.WFS(this,pos,tileBounds,url,tileSize);this.addTileMonitoringHooks(this.tile);this.tile.draw();}else{if(this.vectorMode){this.destroyFeatures();this.renderer.clear();}else{this.clearMarkers();}
this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null;this.tile=new OpenLayers.Tile.WFS(this,pos,tileBounds,url,tileSize);this.addTileMonitoringHooks(this.tile);this.tile.draw();}}},addTileMonitoringHooks:function(tile){tile.onLoadStart=function(){if(this==this.layer.tile){this.layer.events.triggerEvent(&quot;loadstart&quot;);}};tile.events.register(&quot;loadstart&quot;,tile,tile.onLoadStart);tile.onLoadEnd=function(){if(this==this.layer.tile){this.layer.events.triggerEvent(&quot;tileloaded&quot;);this.layer.events.triggerEvent(&quot;loadend&quot;);}};tile.events.register(&quot;loadend&quot;,tile,tile.onLoadEnd);tile.events.register(&quot;unload&quot;,tile,tile.onLoadEnd);},removeTileMonitoringHooks:function(tile){tile.unload();tile.events.un({&quot;loadstart&quot;:tile.onLoadStart,&quot;loadend&quot;:tile.onLoadEnd,&quot;unload&quot;:tile.onLoadEnd,scope:tile});},onMapResize:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.onMapResize.apply(this,arguments);}else{OpenLayers.Layer.Markers.prototype.onMapResize.apply(this,arguments);}},display:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.display.apply(this,arguments);}else{OpenLayers.Layer.Markers.prototype.display.apply(this,arguments);}},mergeNewParams:function(newParams){var upperParams=OpenLayers.Util.upperCaseObject(newParams);var newArguments=[upperParams];return OpenLayers.Layer.HTTPRequest.prototype.mergeNewParams.apply(this,newArguments);},clone:function(obj){if(obj==null){obj=new OpenLayers.Layer.WFS(this.name,this.url,this.params,this.options);}
if(this.vectorMode){obj=OpenLayers.Layer.Vector.prototype.clone.apply(this,[obj]);}else{obj=OpenLayers.Layer.Markers.prototype.clone.apply(this,[obj]);}
return obj;},getFullRequestString:function(newParams,altUrl){var projectionCode=this.projection.getCode()||this.map.getProjection();this.params.SRS=(projectionCode==&quot;none&quot;)?null:projectionCode;return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments);},commit:function(){if(!this.writer){var options={};if(this.map&amp;&amp;!this.projection.equals(this.map.getProjectionObject())){options.externalProjection=this.projection;options.internalProjection=this.map.getProjectionObject();}
this.writer=new OpenLayers.Format.WFS(options,this);}
var data=this.writer.write(this.features);OpenLayers.Request.POST({url:this.url,data:data,success:this.commitSuccess,failure:this.commitFailure,scope:this});},commitSuccess:function(request){var response=request.responseText;if(response.indexOf(&apos;SUCCESS&apos;)!=-1){this.commitReport(OpenLayers.i18n(&quot;commitSuccess&quot;,{&apos;response&apos;:response}));for(var i=0;i&lt;this.features.length;i++){this.features[i].state=null;}}else if(response.indexOf(&apos;FAILED&apos;)!=-1||response.indexOf(&apos;Exception&apos;)!=-1){this.commitReport(OpenLayers.i18n(&quot;commitFailed&quot;,{&apos;response&apos;:response}));}},commitFailure:function(request){},commitReport:function(string,response){OpenLayers.Console.userError(string);},refresh:function(){if(this.tile){if(this.vectorMode){this.renderer.clear();this.features.length=0;}else{this.clearMarkers();this.markers.length=0;}
this.tile.draw();}},getDataExtent:function(){var extent;if(this.vectorMode){extent=OpenLayers.Layer.Vector.prototype.getDataExtent.apply(this);}else{extent=OpenLayers.Layer.Markers.prototype.getDataExtent.apply(this);}
return extent;},setOpacity:function(opacity){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.setOpacity.apply(this,[opacity]);}else{OpenLayers.Layer.Markers.prototype.setOpacity.apply(this,[opacity]);}},CLASS_NAME:&quot;OpenLayers.Layer.WFS&quot;});OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,initialize:function(options){OpenLayers.Strategy.prototype.initialize.apply(this,[options]);},activate:function(){var activated=OpenLayers.Strategy.prototype.activate.call(this);if(activated){this.layer.events.on({&quot;moveend&quot;:this.update,scope:this});this.layer.events.on({&quot;refresh&quot;:this.update,scope:this});}
return activated;},deactivate:function(){var deactivated=OpenLayers.Strategy.prototype.deactivate.call(this);if(deactivated){this.layer.events.un({&quot;moveend&quot;:this.update,scope:this});this.layer.events.un({&quot;refresh&quot;:this.update,scope:this});}
return deactivated;},update:function(options){var mapBounds=this.getMapBounds();if((options&amp;&amp;options.force)||this.invalidBounds(mapBounds)){this.calculateBounds(mapBounds);this.resolution=this.layer.map.getResolution();this.triggerRead();}},getMapBounds:function(){var bounds=this.layer.map.getExtent();if(!this.layer.projection.equals(this.layer.map.getProjectionObject())){bounds=bounds.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection);}
return bounds;},invalidBounds:function(mapBounds){if(!mapBounds){mapBounds=this.getMapBounds();}
var invalid=!this.bounds||!this.bounds.containsBounds(mapBounds);if(!invalid&amp;&amp;this.resFactor){var ratio=this.resolution/this.layer.map.getResolution();invalid=(ratio&gt;=this.resFactor||ratio&lt;=(1/this.resFactor));}
return invalid;},calculateBounds:function(mapBounds){if(!mapBounds){mapBounds=this.getMapBounds();}
var center=mapBounds.getCenterLonLat();var dataWidth=mapBounds.getWidth()*this.ratio;var dataHeight=mapBounds.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(center.lon-(dataWidth/2),center.lat-(dataHeight/2),center.lon+(dataWidth/2),center.lat+(dataHeight/2));},triggerRead:function(){this.layer.protocol.abort(this.response);this.layer.events.triggerEvent(&quot;loadstart&quot;);this.response=this.layer.protocol.read({filter:this.createFilter(),callback:this.merge,scope:this});},createFilter:function(){var filter=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});if(this.layer.filter){filter=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.layer.filter,filter]});}
return filter;},merge:function(resp){this.layer.destroyFeatures();var features=resp.features;if(features&amp;&amp;features.length&gt;0){var remote=this.layer.projection;var local=this.layer.map.getProjectionObject();if(!local.equals(remote)){var geom;for(var i=0,len=features.length;i&lt;len;++i){geom=features[i].geometry;if(geom){geom.transform(remote,local);}}}
this.layer.addFeatures(features);}
this.layer.events.triggerEvent(&quot;loadend&quot;);},CLASS_NAME:&quot;OpenLayers.Strategy.BBOX&quot;});OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:[&quot;beforefeaturehighlighted&quot;,&quot;featurehighlighted&quot;,&quot;featureunhighlighted&quot;],multipleKey:null,toggleKey:null,multiple:false,clickout:true,toggle:false,hover:false,highlightOnly:false,box:false,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:&quot;select&quot;,handlers:null,initialize:function(layers,options){this.EVENT_TYPES=OpenLayers.Control.SelectFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[options]);if(this.scope===null){this.scope=this;}
if(layers instanceof Array){this.layers=layers;this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+&quot;_container&quot;,{layers:layers});}else{this.layer=layers;}
var callbacks={click:this.clickFeature,clickout:this.clickoutFeature};if(this.hover){callbacks.over=this.overFeature;callbacks.out=this.outFeature;}
this.callbacks=OpenLayers.Util.extend(callbacks,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};if(this.box){this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:&quot;olHandlerBoxSelectFeature&quot;});}},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);if(this.layers){this.layer.destroy();}},activate:function(){if(!this.active){if(this.layers){this.map.addLayer(this.layer);}
this.handlers.feature.activate();if(this.box&amp;&amp;this.handlers.box){this.handlers.box.activate();}}
return OpenLayers.Control.prototype.activate.apply(this,arguments);},deactivate:function(){if(this.active){this.handlers.feature.deactivate();if(this.handlers.box){this.handlers.box.deactivate();}
if(this.layers){this.map.removeLayer(this.layer);}}
return OpenLayers.Control.prototype.deactivate.apply(this,arguments);},unselectAll:function(options){var layers=this.layers||[this.layer];var layer,feature;for(var l=0;l&lt;layers.length;++l){layer=layers[l];for(var i=layer.selectedFeatures.length-1;i&gt;=0;--i){feature=layer.selectedFeatures[i];if(!options||options.except!=feature){this.unselect(feature);}}}},clickFeature:function(feature){if(!this.hover){var selected=(OpenLayers.Util.indexOf(feature.layer.selectedFeatures,feature)&gt;-1);if(selected){if(this.toggleSelect()){this.unselect(feature);}else if(!this.multipleSelect()){this.unselectAll({except:feature});}}else{if(!this.multipleSelect()){this.unselectAll({except:feature});}
this.select(feature);}}},multipleSelect:function(){return this.multiple||(this.handlers.feature.evt&amp;&amp;this.handlers.feature.evt[this.multipleKey]);},toggleSelect:function(){return this.toggle||(this.handlers.feature.evt&amp;&amp;this.handlers.feature.evt[this.toggleKey]);},clickoutFeature:function(feature){if(!this.hover&amp;&amp;this.clickout){this.unselectAll();}},overFeature:function(feature){var layer=feature.layer;if(this.hover){if(this.highlightOnly){this.highlight(feature);}else if(OpenLayers.Util.indexOf(layer.selectedFeatures,feature)==-1){this.select(feature);}}},outFeature:function(feature){if(this.hover){if(this.highlightOnly){if(feature._lastHighlighter==this.id){if(feature._prevHighlighter&amp;&amp;feature._prevHighlighter!=this.id){delete feature._lastHighlighter;var control=this.map.getControl(feature._prevHighlighter);if(control){control.highlight(feature);}}else{this.unhighlight(feature);}}}else{this.unselect(feature);}}},highlight:function(feature){var layer=feature.layer;var cont=this.events.triggerEvent(&quot;beforefeaturehighlighted&quot;,{feature:feature});if(cont!==false){feature._prevHighlighter=feature._lastHighlighter;feature._lastHighlighter=this.id;var style=this.selectStyle||this.renderIntent;layer.drawFeature(feature,style);this.events.triggerEvent(&quot;featurehighlighted&quot;,{feature:feature});}},unhighlight:function(feature){var layer=feature.layer;feature._lastHighlighter=feature._prevHighlighter;delete feature._prevHighlighter;layer.drawFeature(feature,feature.style||feature.layer.style||&quot;default&quot;);this.events.triggerEvent(&quot;featureunhighlighted&quot;,{feature:feature});},select:function(feature){var cont=this.onBeforeSelect.call(this.scope,feature);var layer=feature.layer;if(cont!==false){cont=layer.events.triggerEvent(&quot;beforefeatureselected&quot;,{feature:feature});if(cont!==false){layer.selectedFeatures.push(feature);this.highlight(feature);layer.events.triggerEvent(&quot;featureselected&quot;,{feature:feature});this.onSelect.call(this.scope,feature);}}},unselect:function(feature){var layer=feature.layer;this.unhighlight(feature);OpenLayers.Util.removeItem(layer.selectedFeatures,feature);layer.events.triggerEvent(&quot;featureunselected&quot;,{feature:feature});this.onUnselect.call(this.scope,feature);},selectBox:function(position){if(position instanceof OpenLayers.Bounds){var minXY=this.map.getLonLatFromPixel(new OpenLayers.Pixel(position.left,position.bottom));var maxXY=this.map.getLonLatFromPixel(new OpenLayers.Pixel(position.right,position.top));var bounds=new OpenLayers.Bounds(minXY.lon,minXY.lat,maxXY.lon,maxXY.lat);if(!this.multipleSelect()){this.unselectAll();}
var prevMultiple=this.multiple;this.multiple=true;var layers=this.layers||[this.layer];var layer;for(var l=0;l&lt;layers.length;++l){layer=layers[l];for(var i=0,len=layer.features.length;i&lt;len;++i){var feature=layer.features[i];if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,feature.geometry.CLASS_NAME)&gt;-1){if(bounds.toGeometry().intersects(feature.geometry)){if(OpenLayers.Util.indexOf(layer.selectedFeatures,feature)==-1){this.select(feature);}}}}}
this.multiple=prevMultiple;}},setMap:function(map){this.handlers.feature.setMap(map);if(this.box){this.handlers.box.setMap(map);}
OpenLayers.Control.prototype.setMap.apply(this,arguments);},CLASS_NAME:&quot;OpenLayers.Control.SelectFeature&quot;});OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:&quot;http://www.opengis.net/ogc&quot;,gml:&quot;http://www.opengis.net/gml&quot;,xlink:&quot;http://www.w3.org/1999/xlink&quot;,xsi:&quot;http://www.w3.org/2001/XMLSchema-instance&quot;},defaultPrefix:&quot;ogc&quot;,schemaLocation:null,initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},read:function(data){var obj={};this.readers.ogc[&quot;Filter&quot;].apply(this,[data,obj]);return obj.filter;},readers:{&quot;ogc&quot;:{&quot;Filter&quot;:function(node,parent){var obj={fids:[],filters:[]};this.readChildNodes(node,obj);if(obj.fids.length&gt;0){parent.filter=new OpenLayers.Filter.FeatureId({fids:obj.fids});}else if(obj.filters.length&gt;0){parent.filter=obj.filters[0];}},&quot;FeatureId&quot;:function(node,obj){var fid=node.getAttribute(&quot;fid&quot;);if(fid){obj.fids.push(fid);}},&quot;And&quot;:function(node,obj){var filter=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;Or&quot;:function(node,obj){var filter=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;Not&quot;:function(node,obj){var filter=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;PropertyIsLessThan&quot;:function(node,obj){var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;PropertyIsGreaterThan&quot;:function(node,obj){var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;PropertyIsLessThanOrEqualTo&quot;:function(node,obj){var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;PropertyIsGreaterThanOrEqualTo&quot;:function(node,obj){var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;PropertyIsBetween&quot;:function(node,obj){var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;PropertyIsLike&quot;:function(node,obj){var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(node,filter);var wildCard=node.getAttribute(&quot;wildCard&quot;);var singleChar=node.getAttribute(&quot;singleChar&quot;);var esc=node.getAttribute(&quot;escape&quot;);filter.value2regex(wildCard,singleChar,esc);obj.filters.push(filter);},&quot;Literal&quot;:function(node,obj){obj.value=OpenLayers.String.numericIf(this.getChildValue(node));},&quot;PropertyName&quot;:function(node,filter){filter.property=this.getChildValue(node);},&quot;LowerBoundary&quot;:function(node,filter){filter.lowerBoundary=OpenLayers.String.numericIf(this.readOgcExpression(node));},&quot;UpperBoundary&quot;:function(node,filter){filter.upperBoundary=OpenLayers.String.numericIf(this.readOgcExpression(node));},&quot;Intersects&quot;:function(node,obj){this.readSpatial(node,obj,OpenLayers.Filter.Spatial.INTERSECTS);},&quot;Within&quot;:function(node,obj){this.readSpatial(node,obj,OpenLayers.Filter.Spatial.WITHIN);},&quot;Contains&quot;:function(node,obj){this.readSpatial(node,obj,OpenLayers.Filter.Spatial.CONTAINS);},&quot;DWithin&quot;:function(node,obj){this.readSpatial(node,obj,OpenLayers.Filter.Spatial.DWITHIN);},&quot;Distance&quot;:function(node,obj){obj.distance=parseInt(this.getChildValue(node));obj.distanceUnits=node.getAttribute(&quot;units&quot;);}}},readSpatial:function(node,obj,type){var filter=new OpenLayers.Filter.Spatial({type:type});this.readChildNodes(node,filter);filter.value=filter.components[0];delete filter.components;obj.filters.push(filter);},readOgcExpression:function(node){var obj={};this.readChildNodes(node,obj);var value=obj.value;if(!value){value=this.getChildValue(node);}
return value;},write:function(filter){return this.writers.ogc[&quot;Filter&quot;].apply(this,[filter]);},writers:{&quot;ogc&quot;:{&quot;Filter&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:Filter&quot;);var sub=filter.CLASS_NAME.split(&quot;.&quot;).pop();if(sub==&quot;FeatureId&quot;){for(var i=0;i&lt;filter.fids.length;++i){this.writeNode(&quot;FeatureId&quot;,filter.fids[i],node);}}else{this.writeNode(this.getFilterType(filter),filter,node);}
return node;},&quot;FeatureId&quot;:function(fid){return this.createElementNSPlus(&quot;ogc:FeatureId&quot;,{attributes:{fid:fid}});},&quot;And&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:And&quot;);var childFilter;for(var i=0;i&lt;filter.filters.length;++i){childFilter=filter.filters[i];this.writeNode(this.getFilterType(childFilter),childFilter,node);}
return node;},&quot;Or&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:Or&quot;);var childFilter;for(var i=0;i&lt;filter.filters.length;++i){childFilter=filter.filters[i];this.writeNode(this.getFilterType(childFilter),childFilter,node);}
return node;},&quot;Not&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:Not&quot;);var childFilter=filter.filters[0];this.writeNode(this.getFilterType(childFilter),childFilter,node);return node;},&quot;PropertyIsLessThan&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsLessThan&quot;);this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;Literal&quot;,filter.value,node);return node;},&quot;PropertyIsGreaterThan&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsGreaterThan&quot;);this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;Literal&quot;,filter.value,node);return node;},&quot;PropertyIsLessThanOrEqualTo&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsLessThanOrEqualTo&quot;);this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;Literal&quot;,filter.value,node);return node;},&quot;PropertyIsGreaterThanOrEqualTo&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsGreaterThanOrEqualTo&quot;);this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;Literal&quot;,filter.value,node);return node;},&quot;PropertyIsBetween&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsBetween&quot;);this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;LowerBoundary&quot;,filter,node);this.writeNode(&quot;UpperBoundary&quot;,filter,node);return node;},&quot;PropertyIsLike&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsLike&quot;,{attributes:{wildCard:&quot;*&quot;,singleChar:&quot;.&quot;,escape:&quot;!&quot;}});this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;Literal&quot;,filter.regex2value(),node);return node;},&quot;PropertyName&quot;:function(filter){return this.createElementNSPlus(&quot;ogc:PropertyName&quot;,{value:filter.property});},&quot;Literal&quot;:function(value){return this.createElementNSPlus(&quot;ogc:Literal&quot;,{value:value});},&quot;LowerBoundary&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:LowerBoundary&quot;);this.writeNode(&quot;Literal&quot;,filter.lowerBoundary,node);return node;},&quot;UpperBoundary&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:UpperBoundary&quot;);this.writeNode(&quot;Literal&quot;,filter.upperBoundary,node);return node;},&quot;INTERSECTS&quot;:function(filter){return this.writeSpatial(filter,&quot;Intersects&quot;);},&quot;WITHIN&quot;:function(filter){return this.writeSpatial(filter,&quot;Within&quot;);},&quot;CONTAINS&quot;:function(filter){return this.writeSpatial(filter,&quot;Contains&quot;);},&quot;DWITHIN&quot;:function(filter){var node=this.writeSpatial(filter,&quot;DWithin&quot;);this.writeNode(&quot;Distance&quot;,filter,node);return node;},&quot;Distance&quot;:function(filter){return this.createElementNSPlus(&quot;ogc:Distance&quot;,{attributes:{units:filter.distanceUnits},value:filter.distance});}}},getFilterType:function(filter){var filterType=this.filterMap[filter.type];if(!filterType){throw&quot;Filter writing not supported for rule type: &quot;+filter.type;}
return filterType;},filterMap:{&quot;&amp;&amp;&quot;:&quot;And&quot;,&quot;||&quot;:&quot;Or&quot;,&quot;!&quot;:&quot;Not&quot;,&quot;==&quot;:&quot;PropertyIsEqualTo&quot;,&quot;!=&quot;:&quot;PropertyIsNotEqualTo&quot;,&quot;&lt;&quot;:&quot;PropertyIsLessThan&quot;,&quot;&gt;&quot;:&quot;PropertyIsGreaterThan&quot;,&quot;&lt;=&quot;:&quot;PropertyIsLessThanOrEqualTo&quot;,&quot;&gt;=&quot;:&quot;PropertyIsGreaterThanOrEqualTo&quot;,&quot;..&quot;:&quot;PropertyIsBetween&quot;,&quot;~&quot;:&quot;PropertyIsLike&quot;,&quot;BBOX&quot;:&quot;BBOX&quot;,&quot;DWITHIN&quot;:&quot;DWITHIN&quot;,&quot;WITHIN&quot;:&quot;WITHIN&quot;,&quot;CONTAINS&quot;:&quot;CONTAINS&quot;,&quot;INTERSECTS&quot;:&quot;INTERSECTS&quot;},CLASS_NAME:&quot;OpenLayers.Format.Filter.v1&quot;});OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:[&quot;OpenLayers.Geometry.Point&quot;],initialize:function(points){OpenLayers.Geometry.MultiPoint.prototype.initialize.apply(this,arguments);},getLength:function(){var length=0.0;if(this.components&amp;&amp;(this.components.length&gt;1)){for(var i=1,len=this.components.length;i&lt;len;i++){length+=this.components[i-1].distanceTo(this.components[i]);}}
return length;},getGeodesicLength:function(projection){var geom=this;if(projection){var gg=new OpenLayers.Projection(&quot;EPSG:4326&quot;);if(!gg.equals(projection)){geom=this.clone().transform(projection,gg);}}
var length=0.0;if(geom.components&amp;&amp;(geom.components.length&gt;1)){var p1,p2;for(var i=1,len=geom.components.length;i&lt;len;i++){p1=geom.components[i-1];p2=geom.components[i];length+=OpenLayers.Util.distVincenty({lon:p1.x,lat:p1.y},{lon:p2.x,lat:p2.y});}}
return length*1000;},CLASS_NAME:&quot;OpenLayers.Geometry.Curve&quot;});OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,clickout:true,toggle:true,layer:null,feature:null,vertices:null,virtualVertices:null,selectControl:null,dragControl:null,handlers:null,deleteCodes:null,virtualStyle:null,mode:null,modified:false,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(layer,options){this.layer=layer;this.vertices=[];this.virtualVertices=[];this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer());this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(this,[options]);if(!(this.deleteCodes instanceof Array)){this.deleteCodes=[this.deleteCodes];}
var control=this;var selectOptions={geometryTypes:this.geometryTypes,clickout:this.clickout,toggle:this.toggle,onBeforeSelect:this.beforeSelectFeature,onSelect:this.selectFeature,onUnselect:this.unselectFeature,scope:this};this.selectControl=new OpenLayers.Control.SelectFeature(layer,selectOptions);var dragOptions={geometryTypes:[&quot;OpenLayers.Geometry.Point&quot;],snappingOptions:this.snappingOptions,onStart:function(feature,pixel){control.dragStart.apply(control,[feature,pixel]);},onDrag:function(feature,pixel){control.dragVertex.apply(control,[feature,pixel]);},onComplete:function(feature){control.dragComplete.apply(control,[feature]);}};this.dragControl=new OpenLayers.Control.DragFeature(layer,dragOptions);var keyboardOptions={keydown:this.handleKeypress};this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,keyboardOptions)};},destroy:function(){this.layer=null;this.selectControl.destroy();this.dragControl.destroy();OpenLayers.Control.prototype.destroy.apply(this,[]);},activate:function(){return(this.selectControl.activate()&amp;&amp;this.handlers.keyboard.activate()&amp;&amp;OpenLayers.Control.prototype.activate.apply(this,arguments));},deactivate:function(){var deactivated=false;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.vertices,{silent:true});this.layer.removeFeatures(this.virtualVertices,{silent:true});this.vertices=[];this.dragControl.deactivate();if(this.feature&amp;&amp;this.feature.geometry&amp;&amp;this.feature.layer){this.selectControl.unselect.apply(this.selectControl,[this.feature]);}
this.selectControl.deactivate();this.handlers.keyboard.deactivate();deactivated=true;}
return deactivated;},beforeSelectFeature:function(feature){return this.layer.events.triggerEvent(&quot;beforefeaturemodified&quot;,{feature:feature});},selectFeature:function(feature){this.feature=feature;this.modified=false;this.resetVertices();this.dragControl.activate();this.onModificationStart(this.feature);},unselectFeature:function(feature){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[];if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});delete this.dragHandle;}
if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});delete this.radiusHandle;}
this.feature=null;this.dragControl.deactivate();this.onModificationEnd(feature);this.layer.events.triggerEvent(&quot;afterfeaturemodified&quot;,{feature:feature,modified:this.modified});this.modified=false;},dragStart:function(feature,pixel){if(feature!=this.feature&amp;&amp;!feature.geometry.parent&amp;&amp;feature!=this.dragHandle&amp;&amp;feature!=this.radiusHandle){if(this.feature){this.selectControl.clickFeature.apply(this.selectControl,[this.feature]);}
if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,feature.geometry.CLASS_NAME)!=-1){this.selectControl.clickFeature.apply(this.selectControl,[feature]);this.dragControl.overFeature.apply(this.dragControl,[feature]);this.dragControl.lastPixel=pixel;this.dragControl.handlers.drag.started=true;this.dragControl.handlers.drag.start=pixel;this.dragControl.handlers.drag.last=pixel;}}},dragVertex:function(vertex,pixel){this.modified=true;if(this.feature.geometry.CLASS_NAME==&quot;OpenLayers.Geometry.Point&quot;){if(this.feature!=vertex){this.feature=vertex;}
this.layer.events.triggerEvent(&quot;vertexmodified&quot;,{vertex:vertex.geometry,feature:this.feature,pixel:pixel});}else{if(vertex._index){vertex.geometry.parent.addComponent(vertex.geometry,vertex._index);delete vertex._index;OpenLayers.Util.removeItem(this.virtualVertices,vertex);this.vertices.push(vertex);}else if(vertex==this.dragHandle){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[];if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});this.radiusHandle=null;}}else if(vertex!==this.radiusHandle){this.layer.events.triggerEvent(&quot;vertexmodified&quot;,{vertex:vertex.geometry,feature:this.feature,pixel:pixel});}
if(this.virtualVertices.length&gt;0){this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[];}
this.layer.drawFeature(this.feature,this.selectControl.renderIntent);}
this.layer.drawFeature(vertex);},dragComplete:function(vertex){this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent(&quot;featuremodified&quot;,{feature:this.feature});},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&amp;&amp;this.feature.state!=OpenLayers.State.DELETE){this.feature.state=OpenLayers.State.UPDATE;}},resetVertices:function(){if(this.dragControl.feature){this.dragControl.outFeature(this.dragControl.feature);}
if(this.vertices.length&gt;0){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[];}
if(this.virtualVertices.length&gt;0){this.layer.removeFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[];}
if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});this.dragHandle=null;}
if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});this.radiusHandle=null;}
if(this.feature&amp;&amp;this.feature.geometry.CLASS_NAME!=&quot;OpenLayers.Geometry.Point&quot;){if((this.mode&amp;OpenLayers.Control.ModifyFeature.DRAG)){this.collectDragHandle();}
if((this.mode&amp;(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE))){this.collectRadiusHandle();}
if(this.mode&amp;OpenLayers.Control.ModifyFeature.RESHAPE){if(!(this.mode&amp;OpenLayers.Control.ModifyFeature.RESIZE)){this.collectVertices();}}}},handleKeypress:function(evt){var code=evt.keyCode;if(this.feature&amp;&amp;OpenLayers.Util.indexOf(this.deleteCodes,code)!=-1){var vertex=this.dragControl.feature;if(vertex&amp;&amp;OpenLayers.Util.indexOf(this.vertices,vertex)!=-1&amp;&amp;!this.dragControl.handlers.drag.dragging&amp;&amp;vertex.geometry.parent){vertex.geometry.parent.removeComponent(vertex.geometry);this.layer.drawFeature(this.feature,this.selectControl.renderIntent);this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent(&quot;featuremodified&quot;,{feature:this.feature});}}},collectVertices:function(){this.vertices=[];this.virtualVertices=[];var control=this;function collectComponentVertices(geometry){var i,vertex,component,len;if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.Point&quot;){vertex=new OpenLayers.Feature.Vector(geometry);vertex._sketch=true;control.vertices.push(vertex);}else{var numVert=geometry.components.length;if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.LinearRing&quot;){numVert-=1;}
for(i=0;i&lt;numVert;++i){component=geometry.components[i];if(component.CLASS_NAME==&quot;OpenLayers.Geometry.Point&quot;){vertex=new OpenLayers.Feature.Vector(component);vertex._sketch=true;control.vertices.push(vertex);}else{collectComponentVertices(component);}}
if(geometry.CLASS_NAME!=&quot;OpenLayers.Geometry.MultiPoint&quot;){for(i=0,len=geometry.components.length;i&lt;len-1;++i){var prevVertex=geometry.components[i];var nextVertex=geometry.components[i+1];if(prevVertex.CLASS_NAME==&quot;OpenLayers.Geometry.Point&quot;&amp;&amp;nextVertex.CLASS_NAME==&quot;OpenLayers.Geometry.Point&quot;){var x=(prevVertex.x+nextVertex.x)/2;var y=(prevVertex.y+nextVertex.y)/2;var point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(x,y),null,control.virtualStyle);point.geometry.parent=geometry;point._index=i+1;point._sketch=true;control.virtualVertices.push(point);}}}}}
collectComponentVertices.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,{silent:true});this.layer.addFeatures(this.vertices,{silent:true});},collectDragHandle:function(){var geometry=this.feature.geometry;var center=geometry.getBounds().getCenterLonLat();var originGeometry=new OpenLayers.Geometry.Point(center.lon,center.lat);var origin=new OpenLayers.Feature.Vector(originGeometry);originGeometry.move=function(x,y){OpenLayers.Geometry.Point.prototype.move.call(this,x,y);geometry.move(x,y);};origin._sketch=true;this.dragHandle=origin;this.layer.addFeatures([this.dragHandle],{silent:true});},collectRadiusHandle:function(){var geometry=this.feature.geometry;var bounds=geometry.getBounds();var center=bounds.getCenterLonLat();var originGeometry=new OpenLayers.Geometry.Point(center.lon,center.lat);var radiusGeometry=new OpenLayers.Geometry.Point(bounds.right,bounds.bottom);var radius=new OpenLayers.Feature.Vector(radiusGeometry);var resize=(this.mode&amp;OpenLayers.Control.ModifyFeature.RESIZE);var reshape=(this.mode&amp;OpenLayers.Control.ModifyFeature.RESHAPE);var rotate=(this.mode&amp;OpenLayers.Control.ModifyFeature.ROTATE);radiusGeometry.move=function(x,y){OpenLayers.Geometry.Point.prototype.move.call(this,x,y);var dx1=this.x-originGeometry.x;var dy1=this.y-originGeometry.y;var dx0=dx1-x;var dy0=dy1-y;if(rotate){var a0=Math.atan2(dy0,dx0);var a1=Math.atan2(dy1,dx1);var angle=a1-a0;angle*=180/Math.PI;geometry.rotate(angle,originGeometry);}
if(resize){var scale,ratio;if(reshape){scale=dy1/dy0;ratio=(dx1/dx0)/scale;}else{var l0=Math.sqrt((dx0*dx0)+(dy0*dy0));var l1=Math.sqrt((dx1*dx1)+(dy1*dy1));scale=l1/l0;}
geometry.resize(scale,originGeometry,ratio);}};radius._sketch=true;this.radiusHandle=radius;this.layer.addFeatures([this.radiusHandle],{silent:true});},setMap:function(map){this.selectControl.setMap(map);this.dragControl.setMap(map);OpenLayers.Control.prototype.setMap.apply(this,arguments);},CLASS_NAME:&quot;OpenLayers.Control.ModifyFeature&quot;});OpenLayers.Control.ModifyFeature.RESHAPE=1;OpenLayers.Control.ModifyFeature.RESIZE=2;OpenLayers.Control.ModifyFeature.ROTATE=4;OpenLayers.Control.ModifyFeature.DRAG=8;OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{initialize:function(points){OpenLayers.Geometry.Curve.prototype.initialize.apply(this,arguments);},removeComponent:function(point){if(this.components&amp;&amp;(this.components.length&gt;2)){OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);}},intersects:function(geometry){var intersect=false;var type=geometry.CLASS_NAME;if(type==&quot;OpenLayers.Geometry.LineString&quot;||type==&quot;OpenLayers.Geometry.LinearRing&quot;||type==&quot;OpenLayers.Geometry.Point&quot;){var segs1=this.getSortedSegments();var segs2;if(type==&quot;OpenLayers.Geometry.Point&quot;){segs2=[{x1:geometry.x,y1:geometry.y,x2:geometry.x,y2:geometry.y}];}else{segs2=geometry.getSortedSegments();}
var seg1,seg1x1,seg1x2,seg1y1,seg1y2,seg2,seg2y1,seg2y2;outer:for(var i=0,len=segs1.length;i&lt;len;++i){seg1=segs1[i];seg1x1=seg1.x1;seg1x2=seg1.x2;seg1y1=seg1.y1;seg1y2=seg1.y2;inner:for(var j=0,jlen=segs2.length;j&lt;jlen;++j){seg2=segs2[j];if(seg2.x1&gt;seg1x2){break;}
if(seg2.x2&lt;seg1x1){continue;}
seg2y1=seg2.y1;seg2y2=seg2.y2;if(Math.min(seg2y1,seg2y2)&gt;Math.max(seg1y1,seg1y2)){continue;}
if(Math.max(seg2y1,seg2y2)&lt;Math.min(seg1y1,seg1y2)){continue;}
if(OpenLayers.Geometry.segmentsIntersect(seg1,seg2)){intersect=true;break outer;}}}}else{intersect=geometry.intersects(this);}
return intersect;},getSortedSegments:function(){var numSeg=this.components.length-1;var segments=new Array(numSeg);for(var i=0;i&lt;numSeg;++i){point1=this.components[i];point2=this.components[i+1];if(point1.x&lt;point2.x){segments[i]={x1:point1.x,y1:point1.y,x2:point2.x,y2:point2.y};}else{segments[i]={x1:point2.x,y1:point2.y,x2:point1.x,y2:point1.y};}}
function byX1(seg1,seg2){return seg1.x1-seg2.x1;}
return segments.sort(byX1);},splitWithSegment:function(seg,options){var edge=!(options&amp;&amp;options.edge===false);var tolerance=options&amp;&amp;options.tolerance;var lines=[];var verts=this.getVertices();var points=[];var intersections=[];var split=false;var vert1,vert2,point;var node,vertex,target;var interOptions={point:true,tolerance:tolerance};var result=null;for(var i=0,stop=verts.length-2;i&lt;=stop;++i){vert1=verts[i];points.push(vert1.clone());vert2=verts[i+1];target={x1:vert1.x,y1:vert1.y,x2:vert2.x,y2:vert2.y};point=OpenLayers.Geometry.segmentsIntersect(seg,target,interOptions);if(point instanceof OpenLayers.Geometry.Point){if((point.x===seg.x1&amp;&amp;point.y===seg.y1)||(point.x===seg.x2&amp;&amp;point.y===seg.y2)||point.equals(vert1)||point.equals(vert2)){vertex=true;}else{vertex=false;}
if(vertex||edge){if(!point.equals(intersections[intersections.length-1])){intersections.push(point.clone());}
if(i===0){if(point.equals(vert1)){continue;}}
if(point.equals(vert2)){continue;}
split=true;if(!point.equals(vert1)){points.push(point);}
lines.push(new OpenLayers.Geometry.LineString(points));points=[point.clone()];}}}
if(split){points.push(vert2.clone());lines.push(new OpenLayers.Geometry.LineString(points));}
if(intersections.length&gt;0){var xDir=seg.x1&lt;seg.x2?1:-1;var yDir=seg.y1&lt;seg.y2?1:-1;result={lines:lines,points:intersections.sort(function(p1,p2){return(xDir*p1.x-xDir*p2.x)||(yDir*p1.y-yDir*p2.y);})};}
return result;},split:function(target,options){var results=null;var mutual=options&amp;&amp;options.mutual;var sourceSplit,targetSplit,sourceParts,targetParts;if(target instanceof OpenLayers.Geometry.LineString){var verts=this.getVertices();var vert1,vert2,seg,splits,lines,point;var points=[];sourceParts=[];for(var i=0,stop=verts.length-2;i&lt;=stop;++i){vert1=verts[i];vert2=verts[i+1];seg={x1:vert1.x,y1:vert1.y,x2:vert2.x,y2:vert2.y};targetParts=targetParts||[target];if(mutual){points.push(vert1.clone());}
for(var j=0;j&lt;targetParts.length;++j){splits=targetParts[j].splitWithSegment(seg,options);if(splits){lines=splits.lines;if(lines.length&gt;0){lines.unshift(j,1);Array.prototype.splice.apply(targetParts,lines);j+=lines.length-2;}
if(mutual){for(var k=0,len=splits.points.length;k&lt;len;++k){point=splits.points[k];if(!point.equals(vert1)){points.push(point);sourceParts.push(new OpenLayers.Geometry.LineString(points));if(point.equals(vert2)){points=[];}else{points=[point.clone()];}}}}}}}
if(mutual&amp;&amp;sourceParts.length&gt;0&amp;&amp;points.length&gt;0){points.push(vert2.clone());sourceParts.push(new OpenLayers.Geometry.LineString(points));}}else{results=target.splitWith(this,options);}
if(targetParts&amp;&amp;targetParts.length&gt;1){targetSplit=true;}else{targetParts=[];}
if(sourceParts&amp;&amp;sourceParts.length&gt;1){sourceSplit=true;}else{sourceParts=[];}
if(targetSplit||sourceSplit){if(mutual){results=[sourceParts,targetParts];}else{results=targetParts;}}
return results;},splitWith:function(geometry,options){return geometry.split(this,options);},getVertices:function(nodes){var vertices;if(nodes===true){vertices=[this.components[0],this.components[this.components.length-1]];}else if(nodes===false){vertices=this.components.slice(1,this.components.length-1);}else{vertices=this.components.slice();}
return vertices;},distanceTo:function(geometry,options){var edge=!(options&amp;&amp;options.edge===false);var details=edge&amp;&amp;options&amp;&amp;options.details;var result,best={};var min=Number.POSITIVE_INFINITY;if(geometry instanceof OpenLayers.Geometry.Point){var segs=this.getSortedSegments();var x=geometry.x;var y=geometry.y;var seg;for(var i=0,len=segs.length;i&lt;len;++i){seg=segs[i];result=OpenLayers.Geometry.distanceToSegment(geometry,seg);if(result.distance&lt;min){min=result.distance;best=result;if(min===0){break;}}else{if(seg.x2&gt;x&amp;&amp;((y&gt;seg.y1&amp;&amp;y&lt;seg.y2)||(y&lt;seg.y1&amp;&amp;y&gt;seg.y2))){break;}}}
if(details){best={distance:best.distance,x0:best.x,y0:best.y,x1:x,y1:y};}else{best=best.distance;}}else if(geometry instanceof OpenLayers.Geometry.LineString){var segs0=this.getSortedSegments();var segs1=geometry.getSortedSegments();var seg0,seg1,intersection,x0,y0;var len1=segs1.length;var interOptions={point:true};outer:for(var i=0,len=segs0.length;i&lt;len;++i){seg0=segs0[i];x0=seg0.x1;y0=seg0.y1;for(var j=0;j&lt;len1;++j){seg1=segs1[j];intersection=OpenLayers.Geometry.segmentsIntersect(seg0,seg1,interOptions);if(intersection){min=0;best={distance:0,x0:intersection.x,y0:intersection.y,x1:intersection.x,y1:intersection.y};break outer;}else{result=OpenLayers.Geometry.distanceToSegment({x:x0,y:y0},seg1);if(result.distance&lt;min){min=result.distance;best={distance:min,x0:x0,y0:y0,x1:result.x,y1:result.y};}}}}
if(!details){best=best.distance;}
if(min!==0){if(seg0){result=geometry.distanceTo(new OpenLayers.Geometry.Point(seg0.x2,seg0.y2),options);var dist=details?result.distance:result;if(dist&lt;min){if(details){best={distance:min,x0:result.x1,y0:result.y1,x1:result.x0,y1:result.y0};}else{best=dist;}}}}}else{best=geometry.distanceTo(this,options);if(details){best={distance:best.distance,x0:best.x1,y0:best.y1,x1:best.x0,y1:best.y0};}}
return best;},CLASS_NAME:&quot;OpenLayers.Geometry.LineString&quot;});OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{extractWaypoints:true,extractTracks:true,extractRoutes:true,extractAttributes:true,initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},read:function(doc){if(typeof doc==&quot;string&quot;){doc=OpenLayers.Format.XML.prototype.read.apply(this,[doc]);}
var features=[];if(this.extractTracks){var tracks=doc.getElementsByTagName(&quot;trk&quot;);for(var i=0,len=tracks.length;i&lt;len;i++){var attrs={};if(this.extractAttributes){attrs=this.parseAttributes(tracks[i]);}
var segs=this.getElementsByTagNameNS(tracks[i],tracks[i].namespaceURI,&quot;trkseg&quot;);for(var j=0,seglen=segs.length;j&lt;seglen;j++){var track=this.extractSegment(segs[j],&quot;trkpt&quot;);features.push(new OpenLayers.Feature.Vector(track,attrs));}}}
if(this.extractRoutes){var routes=doc.getElementsByTagName(&quot;rte&quot;);for(var k=0,klen=routes.length;k&lt;klen;k++){var attrs={};if(this.extractAttributes){attrs=this.parseAttributes(routes[k]);}
var route=this.extractSegment(routes[k],&quot;rtept&quot;);features.push(new OpenLayers.Feature.Vector(route,attrs));}}
if(this.extractWaypoints){var waypoints=doc.getElementsByTagName(&quot;wpt&quot;);for(var l=0,len=waypoints.length;l&lt;len;l++){var attrs={};if(this.extractAttributes){attrs=this.parseAttributes(waypoints[l]);}
var wpt=new OpenLayers.Geometry.Point(waypoints[l].getAttribute(&quot;lon&quot;),waypoints[l].getAttribute(&quot;lat&quot;));features.push(new OpenLayers.Feature.Vector(wpt,attrs));}}
if(this.internalProjection&amp;&amp;this.externalProjection){for(var g=0,featLength=features.length;g&lt;featLength;g++){features[g].geometry.transform(this.externalProjection,this.internalProjection);}}
return features;},extractSegment:function(segment,segmentType){var points=this.getElementsByTagNameNS(segment,segment.namespaceURI,segmentType);var point_features=[];for(var i=0,len=points.length;i&lt;len;i++){point_features.push(new OpenLayers.Geometry.Point(points[i].getAttribute(&quot;lon&quot;),points[i].getAttribute(&quot;lat&quot;)));}
return new OpenLayers.Geometry.LineString(point_features);},parseAttributes:function(node){var attributes={};var attrNode=node.firstChild;while(attrNode){if(attrNode.nodeType==1){var value=attrNode.firstChild;if(value.nodeType==3||value.nodeType==4){name=(attrNode.prefix)?attrNode.nodeName.split(&quot;:&quot;)[1]:attrNode.nodeName;if(name!=&quot;trkseg&quot;&amp;&amp;name!=&quot;rtept&quot;){attributes[name]=value.nodeValue;}}}
attrNode=attrNode.nextSibling;}
return attributes;},CLASS_NAME:&quot;OpenLayers.Format.GPX&quot;});OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:[&quot;OpenLayers.Geometry.Point&quot;],initialize:function(points){OpenLayers.Geometry.LineString.prototype.initialize.apply(this,arguments);},addComponent:function(point,index){var added=false;var lastPoint=this.components.pop();if(index!=null||!point.equals(lastPoint)){added=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments);}
var firstPoint=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[firstPoint]);return added;},removeComponent:function(point){if(this.components.length&gt;4){this.components.pop();OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var firstPoint=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[firstPoint]);}},move:function(x,y){for(var i=0,len=this.components.length;i&lt;len-1;i++){this.components[i].move(x,y);}},rotate:function(angle,origin){for(var i=0,len=this.components.length;i&lt;len-1;++i){this.components[i].rotate(angle,origin);}},resize:function(scale,origin,ratio){for(var i=0,len=this.components.length;i&lt;len-1;++i){this.components[i].resize(scale,origin,ratio);}
return this;},transform:function(source,dest){if(source&amp;&amp;dest){for(var i=0,len=this.components.length;i&lt;len-1;i++){var component=this.components[i];component.transform(source,dest);}
this.bounds=null;}
return this;},getCentroid:function(){if(this.components&amp;&amp;(this.components.length&gt;2)){var sumX=0.0;var sumY=0.0;for(var i=0;i&lt;this.components.length-1;i++){var b=this.components[i];var c=this.components[i+1];sumX+=(b.x+c.x)*(b.x*c.y-c.x*b.y);sumY+=(b.y+c.y)*(b.x*c.y-c.x*b.y);}
var area=-1*this.getArea();var x=sumX/(6*area);var y=sumY/(6*area);}
return new OpenLayers.Geometry.Point(x,y);},getArea:function(){var area=0.0;if(this.components&amp;&amp;(this.components.length&gt;2)){var sum=0.0;for(var i=0,len=this.components.length;i&lt;len-1;i++){var b=this.components[i];var c=this.components[i+1];sum+=(b.x+c.x)*(c.y-b.y);}
area=-sum/2.0;}
return area;},getGeodesicArea:function(projection){var ring=this;if(projection){var gg=new OpenLayers.Projection(&quot;EPSG:4326&quot;);if(!gg.equals(projection)){ring=this.clone().transform(projection,gg);}}
var area=0.0;var len=ring.components&amp;&amp;ring.components.length;if(len&gt;2){var p1,p2;for(var i=0;i&lt;len-1;i++){p1=ring.components[i];p2=ring.components[i+1];area+=OpenLayers.Util.rad(p2.x-p1.x)*(2+Math.sin(OpenLayers.Util.rad(p1.y))+
Math.sin(OpenLayers.Util.rad(p2.y)));}
area=area*6378137.0*6378137.0/2.0;}
return area;},containsPoint:function(point){var approx=OpenLayers.Number.limitSigDigs;var digs=14;var px=approx(point.x,digs);var py=approx(point.y,digs);function getX(y,x1,y1,x2,y2){return(((x1-x2)*y)+((x2*y1)-(x1*y2)))/(y1-y2);}
var numSeg=this.components.length-1;var start,end,x1,y1,x2,y2,cx,cy;var crosses=0;for(var i=0;i&lt;numSeg;++i){start=this.components[i];x1=approx(start.x,digs);y1=approx(start.y,digs);end=this.components[i+1];x2=approx(end.x,digs);y2=approx(end.y,digs);if(y1==y2){if(py==y1){if(x1&lt;=x2&amp;&amp;(px&gt;=x1&amp;&amp;px&lt;=x2)||x1&gt;=x2&amp;&amp;(px&lt;=x1&amp;&amp;px&gt;=x2)){crosses=-1;break;}}
continue;}
cx=approx(getX(py,x1,y1,x2,y2),digs);if(cx==px){if(y1&lt;y2&amp;&amp;(py&gt;=y1&amp;&amp;py&lt;=y2)||y1&gt;y2&amp;&amp;(py&lt;=y1&amp;&amp;py&gt;=y2)){crosses=-1;break;}}
if(cx&lt;=px){continue;}
if(x1!=x2&amp;&amp;(cx&lt;Math.min(x1,x2)||cx&gt;Math.max(x1,x2))){continue;}
if(y1&lt;y2&amp;&amp;(py&gt;=y1&amp;&amp;py&lt;y2)||y1&gt;y2&amp;&amp;(py&lt;y1&amp;&amp;py&gt;=y2)){++crosses;}}
var contained=(crosses==-1)?1:!!(crosses&amp;1);return contained;},intersects:function(geometry){var intersect=false;if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.Point&quot;){intersect=this.containsPoint(geometry);}else if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.LineString&quot;){intersect=geometry.intersects(this);}else if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.LinearRing&quot;){intersect=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[geometry]);}else{for(var i=0,len=geometry.components.length;i&lt;len;++i){intersect=geometry.components[i].intersects(this);if(intersect){break;}}}
return intersect;},getVertices:function(nodes){return(nodes===true)?[]:this.components.slice(0,this.components.length-1);},CLASS_NAME:&quot;OpenLayers.Geometry.LinearRing&quot;});OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:[&quot;OpenLayers.Geometry.LineString&quot;],initialize:function(components){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments);},split:function(geometry,options){var results=null;var mutual=options&amp;&amp;options.mutual;var splits,sourceLine,sourceLines,sourceSplit,targetSplit;var sourceParts=[];var targetParts=[geometry];for(var i=0,len=this.components.length;i&lt;len;++i){sourceLine=this.components[i];sourceSplit=false;for(var j=0;j&lt;targetParts.length;++j){splits=sourceLine.split(targetParts[j],options);if(splits){if(mutual){sourceLines=splits[0];for(var k=0,klen=sourceLines.length;k&lt;klen;++k){if(k===0&amp;&amp;sourceParts.length){sourceParts[sourceParts.length-1].addComponent(sourceLines[k]);}else{sourceParts.push(new OpenLayers.Geometry.MultiLineString([sourceLines[k]]));}}
sourceSplit=true;splits=splits[1];}
if(splits.length){splits.unshift(j,1);Array.prototype.splice.apply(targetParts,splits);break;}}}
if(!sourceSplit){if(sourceParts.length){sourceParts[sourceParts.length-1].addComponent(sourceLine.clone());}else{sourceParts=[new OpenLayers.Geometry.MultiLineString(sourceLine.clone())];}}}
if(sourceParts&amp;&amp;sourceParts.length&gt;1){sourceSplit=true;}else{sourceParts=[];}
if(targetParts&amp;&amp;targetParts.length&gt;1){targetSplit=true;}else{targetParts=[];}
if(sourceSplit||targetSplit){if(mutual){results=[sourceParts,targetParts];}else{results=targetParts;}}
return results;},splitWith:function(geometry,options){var results=null;var mutual=options&amp;&amp;options.mutual;var splits,targetLine,sourceLines,sourceSplit,targetSplit,sourceParts,targetParts;if(geometry instanceof OpenLayers.Geometry.LineString){targetParts=[];sourceParts=[geometry];for(var i=0,len=this.components.length;i&lt;len;++i){targetSplit=false;targetLine=this.components[i];for(var j=0;j&lt;sourceParts.length;++j){splits=sourceParts[j].split(targetLine,options);if(splits){if(mutual){sourceLines=splits[0];if(sourceLines.length){sourceLines.unshift(j,1);Array.prototype.splice.apply(sourceParts,sourceLines);j+=sourceLines.length-2;}
splits=splits[1];if(splits.length===0){splits=[targetLine.clone()];}}
for(var k=0,klen=splits.length;k&lt;klen;++k){if(k===0&amp;&amp;targetParts.length){targetParts[targetParts.length-1].addComponent(splits[k]);}else{targetParts.push(new OpenLayers.Geometry.MultiLineString([splits[k]]));}}
targetSplit=true;}}
if(!targetSplit){if(targetParts.length){targetParts[targetParts.length-1].addComponent(targetLine.clone());}else{targetParts=[new OpenLayers.Geometry.MultiLineString([targetLine.clone()])];}}}}else{results=geometry.split(this);}
if(sourceParts&amp;&amp;sourceParts.length&gt;1){sourceSplit=true;}else{sourceParts=[];}
if(targetParts&amp;&amp;targetParts.length&gt;1){targetSplit=true;}else{targetParts=[];}
if(sourceSplit||targetSplit){if(mutual){results=[sourceParts,targetParts];}else{results=targetParts;}}
return results;},CLASS_NAME:&quot;OpenLayers.Geometry.MultiLineString&quot;});OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,freehand:false,freehandToggle:&apos;shiftKey&apos;,initialize:function(control,callbacks,options){OpenLayers.Handler.Point.prototype.initialize.apply(this,arguments);},createFeature:function(pixel){var lonlat=this.control.map.getLonLatFromPixel(pixel);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(lonlat.lon,lonlat.lat));this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry]));this.callback(&quot;create&quot;,[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.line,this.point],{silent:true});},destroyFeature:function(){OpenLayers.Handler.Point.prototype.destroyFeature.apply(this);this.line=null;},removePoint:function(){if(this.point){this.layer.removeFeatures([this.point]);}},addPoint:function(pixel){this.layer.removeFeatures([this.point]);var lonlat=this.control.map.getLonLatFromPixel(pixel);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(lonlat.lon,lonlat.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.callback(&quot;point&quot;,[this.point.geometry,this.getGeometry()]);this.callback(&quot;modify&quot;,[this.point.geometry,this.getSketch()]);this.drawFeature();},freehandMode:function(evt){return(this.freehandToggle&amp;&amp;evt[this.freehandToggle])?!this.freehand:this.freehand;},modifyFeature:function(pixel){var lonlat=this.control.map.getLonLatFromPixel(pixel);this.point.geometry.x=lonlat.lon;this.point.geometry.y=lonlat.lat;this.callback(&quot;modify&quot;,[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.drawFeature();},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style);},getSketch:function(){return this.line;},getGeometry:function(){var geometry=this.line&amp;&amp;this.line.geometry;if(geometry&amp;&amp;this.multi){geometry=new OpenLayers.Geometry.MultiLineString([geometry]);}
return geometry;},mousedown:function(evt){if(this.lastDown&amp;&amp;this.lastDown.equals(evt.xy)){return false;}
if(this.lastDown==null){if(this.persist){this.destroyFeature();}
this.createFeature(evt.xy);}else if((this.lastUp==null)||!this.lastUp.equals(evt.xy)){this.addPoint(evt.xy);}
this.mouseDown=true;this.lastDown=evt.xy;this.drawing=true;return false;},mousemove:function(evt){if(this.drawing){if(this.mouseDown&amp;&amp;this.freehandMode(evt)){this.addPoint(evt.xy);}else{this.modifyFeature(evt.xy);}}
return true;},mouseup:function(evt){this.mouseDown=false;if(this.drawing){if(this.freehandMode(evt)){this.removePoint();this.finalize();}else{if(this.lastUp==null){this.addPoint(evt.xy);}
this.lastUp=evt.xy;}
return false;}
return true;},dblclick:function(evt){if(!this.freehandMode(evt)){var index=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[index]);this.removePoint();this.finalize();}
return false;},CLASS_NAME:&quot;OpenLayers.Handler.Path&quot;});OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:[&quot;beforesplit&quot;,&quot;split&quot;,&quot;aftersplit&quot;],layer:null,source:null,sourceOptions:null,tolerance:null,edge:true,deferDelete:false,mutual:true,targetFilter:null,sourceFilter:null,handler:null,initialize:function(options){Array.prototype.push.apply(this.EVENT_TYPES,OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[options]);this.options=options||{};if(this.options.source){this.setSource(this.options.source);}},setSource:function(layer){if(this.active){this.deactivate();if(this.handler){this.handler.destroy();delete this.handler;}
this.source=layer;this.activate();}else{this.source=layer;}},activate:function(){var activated=OpenLayers.Control.prototype.activate.call(this);if(activated){if(!this.source){if(!this.handler){this.handler=new OpenLayers.Handler.Path(this,{done:function(geometry){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(geometry)});}},{layerOptions:this.sourceOptions});}
this.handler.activate();}else if(this.source.events){this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this});}}
return activated;},deactivate:function(){var deactivated=OpenLayers.Control.prototype.deactivate.call(this);if(deactivated){if(this.source&amp;&amp;this.source.events){this.layer.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this});}}
return deactivated;},onSketchComplete:function(event){this.feature=null;return!this.considerSplit(event.feature);},afterFeatureModified:function(event){if(event.modified){var feature=event.feature;if(feature.geometry instanceof OpenLayers.Geometry.LineString||feature.geometry instanceof OpenLayers.Geometry.MultiLineString){this.feature=event.feature;this.considerSplit(event.feature);}}},removeByGeometry:function(features,geometry){for(var i=0,len=features.length;i&lt;len;++i){if(features[i].geometry===geometry){features.splice(i,1);break;}}},isEligible:function(target){return(target.state!==OpenLayers.State.DELETE)&amp;&amp;(target.geometry instanceof OpenLayers.Geometry.LineString||target.geometry instanceof OpenLayers.Geometry.MultiLineString)&amp;&amp;(this.feature!==target)&amp;&amp;(!this.targetFilter||this.targetFilter.evaluate(target.attributes));},considerSplit:function(feature){sourceSplit=false;targetSplit=false;if(!this.sourceFilter||this.sourceFilter.evaluate(feature.attributes)){var features=this.layer&amp;&amp;this.layer.features||[];var target,results,result,proceed;var additions=[],removals=[];var mutual=(this.layer===this.source)&amp;&amp;this.mutual;var options={edge:this.edge,tolerance:this.tolerance,mutual:mutual};var sourceParts=[feature.geometry];var targetFeature,targetParts;var source,parts;for(var i=0,len=features.length;i&lt;len;++i){targetFeature=features[i];if(this.isEligible(targetFeature)){targetParts=[targetFeature.geometry];for(var j=0;j&lt;sourceParts.length;++j){source=sourceParts[j];for(var k=0;k&lt;targetParts.length;++k){target=targetParts[k];if(source.getBounds().intersectsBounds(target.getBounds())){results=source.split(target,options);if(results){proceed=this.events.triggerEvent(&quot;beforesplit&quot;,{source:feature,target:targetFeature});if(proceed!==false){if(mutual){parts=results[0];if(parts.length&gt;1){parts.unshift(j,1);Array.prototype.splice.apply(sourceParts,parts);j+=parts.length-3;}
results=results[1];}
if(results.length&gt;1){results.unshift(k,1);Array.prototype.splice.apply(targetParts,results);k+=results.length-3;}}}}}}
if(targetParts&amp;&amp;targetParts.length&gt;1){this.geomsToFeatures(targetFeature,targetParts);this.events.triggerEvent(&quot;split&quot;,{original:targetFeature,features:targetParts});Array.prototype.push.apply(additions,targetParts);removals.push(targetFeature);targetSplit=true;}}}
if(sourceParts&amp;&amp;sourceParts.length&gt;1){this.geomsToFeatures(feature,sourceParts);this.events.triggerEvent(&quot;split&quot;,{original:feature,features:sourceParts});Array.prototype.push.apply(additions,sourceParts);removals.push(feature);sourceSplit=true;}
if(sourceSplit||targetSplit){if(this.deferDelete){var feat,destroys=[];for(var i=0,len=removals.length;i&lt;len;++i){feat=removals[i];if(feat.state===OpenLayers.State.INSERT){destroys.push(feat);}else{feat.state=OpenLayers.State.DELETE;this.layer.drawFeature(feat);}}
this.layer.destroyFeatures(destroys,{silent:true});for(var i=0,len=additions.length;i&lt;len;++i){additions[i].state=OpenLayers.State.INSERT;}}else{this.layer.destroyFeatures(removals,{silent:true});}
this.layer.addFeatures(additions,{silent:true});this.events.triggerEvent(&quot;aftersplit&quot;,{source:feature,features:additions});}}
return sourceSplit;},geomsToFeatures:function(feature,geoms){var clone=feature.clone();delete clone.geometry;var newFeature;for(var i=0,len=geoms.length;i&lt;len;++i){newFeature=clone.clone();newFeature.geometry=geoms[i];newFeature.state=OpenLayers.State.INSERT;geoms[i]=newFeature;}},destroy:function(){if(this.active){this.deactivate();}
OpenLayers.Control.prototype.destroy.call(this);},CLASS_NAME:&quot;OpenLayers.Control.Split&quot;});OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:[&quot;OpenLayers.Geometry.LinearRing&quot;],initialize:function(components){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments);},getArea:function(){var area=0.0;if(this.components&amp;&amp;(this.components.length&gt;0)){area+=Math.abs(this.components[0].getArea());for(var i=1,len=this.components.length;i&lt;len;i++){area-=Math.abs(this.components[i].getArea());}}
return area;},getGeodesicArea:function(projection){var area=0.0;if(this.components&amp;&amp;(this.components.length&gt;0)){area+=Math.abs(this.components[0].getGeodesicArea(projection));for(var i=1,len=this.components.length;i&lt;len;i++){area-=Math.abs(this.components[i].getGeodesicArea(projection));}}
return area;},containsPoint:function(point){var numRings=this.components.length;var contained=false;if(numRings&gt;0){contained=this.components[0].containsPoint(point);if(contained!==1){if(contained&amp;&amp;numRings&gt;1){var hole;for(var i=1;i&lt;numRings;++i){hole=this.components[i].containsPoint(point);if(hole){if(hole===1){contained=1;}else{contained=false;}
break;}}}}}
return contained;},intersects:function(geometry){var intersect=false;var i,len;if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.Point&quot;){intersect=this.containsPoint(geometry);}else if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.LineString&quot;||geometry.CLASS_NAME==&quot;OpenLayers.Geometry.LinearRing&quot;){for(i=0,len=this.components.length;i&lt;len;++i){intersect=geometry.intersects(this.components[i]);if(intersect){break;}}
if(!intersect){for(i=0,len=geometry.components.length;i&lt;len;++i){intersect=this.containsPoint(geometry.components[i]);if(intersect){break;}}}}else{for(i=0,len=geometry.components.length;i&lt;len;++i){intersect=this.intersects(geometry.components[i]);if(intersect){break;}}}
if(!intersect&amp;&amp;geometry.CLASS_NAME==&quot;OpenLayers.Geometry.Polygon&quot;){var ring=this.components[0];for(i=0,len=ring.components.length;i&lt;len;++i){intersect=geometry.containsPoint(ring.components[i]);if(intersect){break;}}}
return intersect;},distanceTo:function(geometry,options){var edge=!(options&amp;&amp;options.edge===false);var result;if(!edge&amp;&amp;this.intersects(geometry)){result=0;}else{result=OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[geometry,options]);}
return result;},CLASS_NAME:&quot;OpenLayers.Geometry.Polygon&quot;});OpenLayers.Geometry.Polygon.createRegularPolygon=function(origin,radius,sides,rotation){var angle=Math.PI*((1/sides)-(1/2));if(rotation){angle+=(rotation/180)*Math.PI;}
var rotatedAngle,x,y;var points=[];for(var i=0;i&lt;sides;++i){rotatedAngle=angle+(i*2*Math.PI/sides);x=origin.x+(radius*Math.cos(rotatedAngle));y=origin.y+(radius*Math.sin(rotatedAngle));points.push(new OpenLayers.Geometry.Point(x,y));}
var ring=new OpenLayers.Geometry.LinearRing(points);return new OpenLayers.Geometry.Polygon([ring]);};OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:&quot;http://backend.userland.com/rss2&quot;,featureNS:&quot;http://mapserver.gis.umn.edu/mapserver&quot;,georssns:&quot;http://www.georss.org/georss&quot;,geons:&quot;http://www.w3.org/2003/01/geo/wgs84_pos#&quot;,featureTitle:&quot;Untitled&quot;,featureDescription:&quot;No Description&quot;,gmlParser:null,xy:false,initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},createGeometryFromItem:function(item){var point=this.getElementsByTagNameNS(item,this.georssns,&quot;point&quot;);var lat=this.getElementsByTagNameNS(item,this.geons,&apos;lat&apos;);var lon=this.getElementsByTagNameNS(item,this.geons,&apos;long&apos;);var line=this.getElementsByTagNameNS(item,this.georssns,&quot;line&quot;);var polygon=this.getElementsByTagNameNS(item,this.georssns,&quot;polygon&quot;);var where=this.getElementsByTagNameNS(item,this.georssns,&quot;where&quot;);var box=this.getElementsByTagNameNS(item,this.georssns,&quot;box&quot;);if(point.length&gt;0||(lat.length&gt;0&amp;&amp;lon.length&gt;0)){var location;if(point.length&gt;0){location=OpenLayers.String.trim(point[0].firstChild.nodeValue).split(/\s+/);if(location.length!=2){location=OpenLayers.String.trim(point[0].firstChild.nodeValue).split(/\s*,\s*/);}}else{location=[parseFloat(lat[0].firstChild.nodeValue),parseFloat(lon[0].firstChild.nodeValue)];}
var geometry=new OpenLayers.Geometry.Point(parseFloat(location[1]),parseFloat(location[0]));}else if(line.length&gt;0){var coords=OpenLayers.String.trim(this.concatChildValues(line[0])).split(/\s+/);var components=[];var point;for(var i=0,len=coords.length;i&lt;len;i+=2){point=new OpenLayers.Geometry.Point(parseFloat(coords[i+1]),parseFloat(coords[i]));components.push(point);}
geometry=new OpenLayers.Geometry.LineString(components);}else if(polygon.length&gt;0){var coords=OpenLayers.String.trim(this.concatChildValues(polygon[0])).split(/\s+/);var components=[];var point;for(var i=0,len=coords.length;i&lt;len;i+=2){point=new OpenLayers.Geometry.Point(parseFloat(coords[i+1]),parseFloat(coords[i]));components.push(point);}
geometry=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(components)]);}else if(where.length&gt;0){if(!this.gmlParser){this.gmlParser=new OpenLayers.Format.GML({&apos;xy&apos;:this.xy});}
var feature=this.gmlParser.parseFeature(where[0]);geometry=feature.geometry;}else if(box.length&gt;0){var coords=OpenLayers.String.trim(box[0].firstChild.nodeValue).split(/\s+/);var components=[];var point;if(coords.length&gt;3){point=new OpenLayers.Geometry.Point(parseFloat(coords[1]),parseFloat(coords[0]));components.push(point);point=new OpenLayers.Geometry.Point(parseFloat(coords[1]),parseFloat(coords[2]));components.push(point);point=new OpenLayers.Geometry.Point(parseFloat(coords[3]),parseFloat(coords[2]));components.push(point);point=new OpenLayers.Geometry.Point(parseFloat(coords[3]),parseFloat(coords[0]));components.push(point);point=new OpenLayers.Geometry.Point(parseFloat(coords[1]),parseFloat(coords[0]));components.push(point);}
geometry=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(components)]);}
if(geometry&amp;&amp;this.internalProjection&amp;&amp;this.externalProjection){geometry.transform(this.externalProjection,this.internalProjection);}
return geometry;},createFeatureFromItem:function(item){var geometry=this.createGeometryFromItem(item);var title=this.getChildValue(item,&quot;*&quot;,&quot;title&quot;,this.featureTitle);var description=this.getChildValue(item,&quot;*&quot;,&quot;description&quot;,this.getChildValue(item,&quot;*&quot;,&quot;content&quot;,this.getChildValue(item,&quot;*&quot;,&quot;summary&quot;,this.featureDescription)));var link=this.getChildValue(item,&quot;*&quot;,&quot;link&quot;);if(!link){try{link=this.getElementsByTagNameNS(item,&quot;*&quot;,&quot;link&quot;)[0].getAttribute(&quot;href&quot;);}catch(e){link=null;}}
var id=this.getChildValue(item,&quot;*&quot;,&quot;id&quot;,null);var data={&quot;title&quot;:title,&quot;description&quot;:description,&quot;link&quot;:link};var feature=new OpenLayers.Feature.Vector(geometry,data);feature.fid=id;return feature;},getChildValue:function(node,nsuri,name,def){var value;var eles=this.getElementsByTagNameNS(node,nsuri,name);if(eles&amp;&amp;eles[0]&amp;&amp;eles[0].firstChild&amp;&amp;eles[0].firstChild.nodeValue){value=eles[0].firstChild.nodeValue;}else{value=(def==undefined)?&quot;&quot;:def;}
return value;},read:function(doc){if(typeof doc==&quot;string&quot;){doc=OpenLayers.Format.XML.prototype.read.apply(this,[doc]);}
var itemlist=null;itemlist=this.getElementsByTagNameNS(doc,&apos;*&apos;,&apos;item&apos;);if(itemlist.length==0){itemlist=this.getElementsByTagNameNS(doc,&apos;*&apos;,&apos;entry&apos;);}
var numItems=itemlist.length;var features=new Array(numItems);for(var i=0;i&lt;numItems;i++){features[i]=this.createFeatureFromItem(itemlist[i]);}
return features;},write:function(features){var georss;if(features instanceof Array){georss=this.createElementNS(this.rssns,&quot;rss&quot;);for(var i=0,len=features.length;i&lt;len;i++){georss.appendChild(this.createFeatureXML(features[i]));}}else{georss=this.createFeatureXML(features);}
return OpenLayers.Format.XML.prototype.write.apply(this,[georss]);},createFeatureXML:function(feature){var geometryNode=this.buildGeometryNode(feature.geometry);var featureNode=this.createElementNS(this.rssns,&quot;item&quot;);var titleNode=this.createElementNS(this.rssns,&quot;title&quot;);titleNode.appendChild(this.createTextNode(feature.attributes.title?feature.attributes.title:&quot;&quot;));var descNode=this.createElementNS(this.rssns,&quot;description&quot;);descNode.appendChild(this.createTextNode(feature.attributes.description?feature.attributes.description:&quot;&quot;));featureNode.appendChild(titleNode);featureNode.appendChild(descNode);if(feature.attributes.link){var linkNode=this.createElementNS(this.rssns,&quot;link&quot;);linkNode.appendChild(this.createTextNode(feature.attributes.link));featureNode.appendChild(linkNode);}
for(var attr in feature.attributes){if(attr==&quot;link&quot;||attr==&quot;title&quot;||attr==&quot;description&quot;){continue;}
var attrText=this.createTextNode(feature.attributes[attr]);var nodename=attr;if(attr.search(&quot;:&quot;)!=-1){nodename=attr.split(&quot;:&quot;)[1];}
var attrContainer=this.createElementNS(this.featureNS,&quot;feature:&quot;+nodename);attrContainer.appendChild(attrText);featureNode.appendChild(attrContainer);}
featureNode.appendChild(geometryNode);return featureNode;},buildGeometryNode:function(geometry){if(this.internalProjection&amp;&amp;this.externalProjection){geometry=geometry.clone();geometry.transform(this.internalProjection,this.externalProjection);}
var node;if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.Polygon&quot;){node=this.createElementNS(this.georssns,&apos;georss:polygon&apos;);node.appendChild(this.buildCoordinatesNode(geometry.components[0]));}
else if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.LineString&quot;){node=this.createElementNS(this.georssns,&apos;georss:line&apos;);node.appendChild(this.buildCoordinatesNode(geometry));}
else if(geometry.CLASS_NAME==&quot;OpenLayers.Geometry.Point&quot;){node=this.createElementNS(this.georssns,&apos;georss:point&apos;);node.appendChild(this.buildCoordinatesNode(geometry));}else{throw&quot;Couldn&apos;t parse &quot;+geometry.CLASS_NAME;}
return node;},buildCoordinatesNode:function(geometry){var points=null;if(geometry.components){points=geometry.components;}
var path;if(points){var numPoints=points.length;var parts=new Array(numPoints);for(var i=0;i&lt;numPoints;i++){parts[i]=points[i].y+&quot; &quot;+points[i].x;}
path=parts.join(&quot; &quot;);}else{path=geometry.y+&quot; &quot;+geometry.x;}
return this.createTextNode(path);},CLASS_NAME:&quot;OpenLayers.Format.GeoRSS&quot;});OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{kmlns:&quot;http://earth.google.com/kml/2.0&quot;,placemarksDesc:&quot;No description available&quot;,foldersName:&quot;OpenLayers export&quot;,foldersDesc:&quot;Exported on &quot;+new Date(),extractAttributes:true,extractStyles:false,internalns:null,features:null,styles:null,styleBaseUrl:&quot;&quot;,fetched:null,maxDepth:0,initialize:function(options){this.regExes={trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g),kmlColor:(/(\w{2})(\w{2})(\w{2})(\w{2})/),kmlIconPalette:(/root:\/\/icons\/palette-(\d+)(\.\w+)/),straightBracket:(/\$\[(.*?)\]/g)};OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},read:function(data){this.features=[];this.styles={};this.fetched={};var options={depth:0,styleBaseUrl:this.styleBaseUrl};return this.parseData(data,options);},parseData:function(data,options){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var types=[&quot;Link&quot;,&quot;NetworkLink&quot;,&quot;Style&quot;,&quot;StyleMap&quot;,&quot;Placemark&quot;];for(var i=0,len=types.length;i&lt;len;++i){var type=types[i];var nodes=this.getElementsByTagNameNS(data,&quot;*&quot;,type);if(nodes.length==0){continue;}
switch(type.toLowerCase()){case&quot;link&quot;:case&quot;networklink&quot;:this.parseLinks(nodes,options);break;case&quot;style&quot;:if(this.extractStyles){this.parseStyles(nodes,options);}
break;case&quot;stylemap&quot;:if(this.extractStyles){this.parseStyleMaps(nodes,options);}
break;case&quot;placemark&quot;:this.parseFeatures(nodes,options);break;}}
return this.features;},parseLinks:function(nodes,options){if(options.depth&gt;=this.maxDepth){return false;}
var newOptions=OpenLayers.Util.extend({},options);newOptions.depth++;for(var i=0,len=nodes.length;i&lt;len;i++){var href=this.parseProperty(nodes[i],&quot;*&quot;,&quot;href&quot;);if(href&amp;&amp;!this.fetched[href]){this.fetched[href]=true;var data=this.fetchLink(href);if(data){this.parseData(data,newOptions);}}}},fetchLink:function(href){var request=OpenLayers.Request.GET({url:href,async:false});if(request){return request.responseText;}},parseStyles:function(nodes,options){for(var i=0,len=nodes.length;i&lt;len;i++){var style=this.parseStyle(nodes[i]);if(style){styleName=(options.styleBaseUrl||&quot;&quot;)+&quot;#&quot;+style.id;this.styles[styleName]=style;}}},parseStyle:function(node){var style={};var types=[&quot;LineStyle&quot;,&quot;PolyStyle&quot;,&quot;IconStyle&quot;,&quot;BalloonStyle&quot;];var type,nodeList,geometry,parser;for(var i=0,len=types.length;i&lt;len;++i){type=types[i];styleTypeNode=this.getElementsByTagNameNS(node,&quot;*&quot;,type)[0];if(!styleTypeNode){continue;}
switch(type.toLowerCase()){case&quot;linestyle&quot;:var color=this.parseProperty(styleTypeNode,&quot;*&quot;,&quot;color&quot;);if(color){var matches=(color.toString()).match(this.regExes.kmlColor);var alpha=matches[1];style[&quot;strokeOpacity&quot;]=parseInt(alpha,16)/255;var b=matches[2];var g=matches[3];var r=matches[4];style[&quot;strokeColor&quot;]=&quot;#&quot;+r+g+b;}
var width=this.parseProperty(styleTypeNode,&quot;*&quot;,&quot;width&quot;);if(width){style[&quot;strokeWidth&quot;]=width;}
case&quot;polystyle&quot;:var color=this.parseProperty(styleTypeNode,&quot;*&quot;,&quot;color&quot;);if(color){var matches=(color.toString()).match(this.regExes.kmlColor);var alpha=matches[1];style[&quot;fillOpacity&quot;]=parseInt(alpha,16)/255;var b=matches[2];var g=matches[3];var r=matches[4];style[&quot;fillColor&quot;]=&quot;#&quot;+r+g+b;}
var fill=this.parseProperty(styleTypeNode,&quot;*&quot;,&quot;fill&quot;);if(fill==&quot;0&quot;){style[&quot;fillColor&quot;]=&quot;none&quot;;}
break;case&quot;iconstyle&quot;:var scale=parseFloat(this.parseProperty(styleTypeNode,&quot;*&quot;,&quot;scale&quot;)||1);var width=32*scale;var height=32*scale;var iconNode=this.getElementsByTagNameNS(styleTypeNode,&quot;*&quot;,&quot;Icon&quot;)[0];if(iconNode){var href=this.parseProperty(iconNode,&quot;*&quot;,&quot;href&quot;);if(href){var w=this.parseProperty(iconNode,&quot;*&quot;,&quot;w&quot;);var h=this.parseProperty(iconNode,&quot;*&quot;,&quot;h&quot;);var google=&quot;http://maps.google.com/mapfiles/kml&quot;;if(OpenLayers.String.startsWith(href,google)&amp;&amp;!w&amp;&amp;!h){w=64;h=64;scale=scale/2;}
w=w||h;h=h||w;if(w){width=parseInt(w)*scale;}
if(h){height=parseInt(h)*scale;}
var matches=href.match(this.regExes.kmlIconPalette);if(matches){var palette=matches[1];var file_extension=matches[2];var x=this.parseProperty(iconNode,&quot;*&quot;,&quot;x&quot;);var y=this.parseProperty(iconNode,&quot;*&quot;,&quot;y&quot;);var posX=x?x/32:0;var posY=y?(7-y/32):7;var pos=posY*8+posX;href=&quot;http://maps.google.com/mapfiles/kml/pal&quot;
+palette+&quot;/icon&quot;+pos+file_extension;}
style[&quot;graphicOpacity&quot;]=1;style[&quot;externalGraphic&quot;]=href;}}
var hotSpotNode=this.getElementsByTagNameNS(styleTypeNode,&quot;*&quot;,&quot;hotSpot&quot;)[0];if(hotSpotNode){var x=parseFloat(hotSpotNode.getAttribute(&quot;x&quot;));var y=parseFloat(hotSpotNode.getAttribute(&quot;y&quot;));var xUnits=hotSpotNode.getAttribute(&quot;xunits&quot;);if(xUnits==&quot;pixels&quot;){style[&quot;graphicXOffset&quot;]=-x*scale;}
else if(xUnits==&quot;insetPixels&quot;){style[&quot;graphicXOffset&quot;]=-width+(x*scale);}
else if(xUnits==&quot;fraction&quot;){style[&quot;graphicXOffset&quot;]=-width*x;}
var yUnits=hotSpotNode.getAttribute(&quot;yunits&quot;);if(yUnits==&quot;pixels&quot;){style[&quot;graphicYOffset&quot;]=-height+(y*scale)+1;}
else if(yUnits==&quot;insetPixels&quot;){style[&quot;graphicYOffset&quot;]=-(y*scale)+1;}
else if(yUnits==&quot;fraction&quot;){style[&quot;graphicYOffset&quot;]=-height*(1-y)+1;}}
style[&quot;graphicWidth&quot;]=width;style[&quot;graphicHeight&quot;]=height;break;case&quot;balloonstyle&quot;:var balloonStyle=OpenLayers.Util.getXmlNodeValue(styleTypeNode);if(balloonStyle){style[&quot;balloonStyle&quot;]=balloonStyle.replace(this.regExes.straightBracket,&quot;${$1}&quot;);}
break;default:}}
if(!style[&quot;strokeColor&quot;]&amp;&amp;style[&quot;fillColor&quot;]){style[&quot;strokeColor&quot;]=style[&quot;fillColor&quot;];}
var id=node.getAttribute(&quot;id&quot;);if(id&amp;&amp;style){style.id=id;}
return style;},parseStyleMaps:function(nodes,options){for(var i=0,len=nodes.length;i&lt;len;i++){var node=nodes[i];var pairs=this.getElementsByTagNameNS(node,&quot;*&quot;,&quot;Pair&quot;);var id=node.getAttribute(&quot;id&quot;);for(var j=0,jlen=pairs.length;j&lt;jlen;j++){var pair=pairs[j];var key=this.parseProperty(pair,&quot;*&quot;,&quot;key&quot;);var styleUrl=this.parseProperty(pair,&quot;*&quot;,&quot;styleUrl&quot;);if(styleUrl&amp;&amp;key==&quot;normal&quot;){this.styles[(options.styleBaseUrl||&quot;&quot;)+&quot;#&quot;+id]=this.styles[(options.styleBaseUrl||&quot;&quot;)+styleUrl];}
if(styleUrl&amp;&amp;key==&quot;highlight&quot;){}}}},parseFeatures:function(nodes,options){var features=new Array(nodes.length);for(var i=0,len=nodes.length;i&lt;len;i++){var featureNode=nodes[i];var feature=this.parseFeature.apply(this,[featureNode]);if(feature){if(this.extractStyles&amp;&amp;feature.attributes&amp;&amp;feature.attributes.styleUrl){feature.style=this.getStyle(feature.attributes.styleUrl,options);}
if(this.extractStyles){var inlineStyleNode=this.getElementsByTagNameNS(featureNode,&quot;*&quot;,&quot;Style&quot;)[0];if(inlineStyleNode){var inlineStyle=this.parseStyle(inlineStyleNode);if(inlineStyle){feature.style=OpenLayers.Util.extend(feature.style,inlineStyle);}}}
features[i]=feature;}else{throw&quot;Bad Placemark: &quot;+i;}}
this.features=this.features.concat(features);},parseFeature:function(node){var order=[&quot;MultiGeometry&quot;,&quot;Polygon&quot;,&quot;LineString&quot;,&quot;Point&quot;];var type,nodeList,geometry,parser;for(var i=0,len=order.length;i&lt;len;++i){type=order[i];this.internalns=node.namespaceURI?node.namespaceURI:this.kmlns;nodeList=this.getElementsByTagNameNS(node,this.internalns,type);if(nodeList.length&gt;0){var parser=this.parseGeometry[type.toLowerCase()];if(parser){geometry=parser.apply(this,[nodeList[0]]);if(this.internalProjection&amp;&amp;this.externalProjection){geometry.transform(this.externalProjection,this.internalProjection);}}else{OpenLayers.Console.error(OpenLayers.i18n(&quot;unsupportedGeometryType&quot;,{&apos;geomType&apos;:type}));}
break;}}
var attributes;if(this.extractAttributes){attributes=this.parseAttributes(node);}
var feature=new OpenLayers.Feature.Vector(geometry,attributes);var fid=node.getAttribute(&quot;id&quot;)||node.getAttribute(&quot;name&quot;);if(fid!=null){feature.fid=fid;}
return feature;},getStyle:function(styleUrl,options){var styleBaseUrl=OpenLayers.Util.removeTail(styleUrl);var newOptions=OpenLayers.Util.extend({},options);newOptions.depth++;newOptions.styleBaseUrl=styleBaseUrl;if(!this.styles[styleUrl]&amp;&amp;!OpenLayers.String.startsWith(styleUrl,&quot;#&quot;)&amp;&amp;newOptions.depth&lt;=this.maxDepth&amp;&amp;!this.fetched[styleBaseUrl]){var data=this.fetchLink(styleBaseUrl);if(data){this.parseData(data,newOptions);}}
var style=OpenLayers.Util.extend({},this.styles[styleUrl]);return style;},parseGeometry:{point:function(node){var nodeList=this.getElementsByTagNameNS(node,this.internalns,&quot;coordinates&quot;);var coords=[];if(nodeList.length&gt;0){var coordString=nodeList[0].firstChild.nodeValue;coordString=coordString.replace(this.regExes.removeSpace,&quot;&quot;);coords=coordString.split(&quot;,&quot;);}
var point=null;if(coords.length&gt;1){if(coords.length==2){coords[2]=null;}
point=new OpenLayers.Geometry.Point(coords[0],coords[1],coords[2]);}else{throw&quot;Bad coordinate string: &quot;+coordString;}
return point;},linestring:function(node,ring){var nodeList=this.getElementsByTagNameNS(node,this.internalns,&quot;coordinates&quot;);var line=null;if(nodeList.length&gt;0){var coordString=this.getChildValue(nodeList[0]);coordString=coordString.replace(this.regExes.trimSpace,&quot;&quot;);coordString=coordString.replace(this.regExes.trimComma,&quot;,&quot;);var pointList=coordString.split(this.regExes.splitSpace);var numPoints=pointList.length;var points=new Array(numPoints);var coords,numCoords;for(var i=0;i&lt;numPoints;++i){coords=pointList[i].split(&quot;,&quot;);numCoords=coords.length;if(numCoords&gt;1){if(coords.length==2){coords[2]=null;}
points[i]=new OpenLayers.Geometry.Point(coords[0],coords[1],coords[2]);}else{throw&quot;Bad LineString point coordinates: &quot;+
pointList[i];}}
if(numPoints){if(ring){line=new OpenLayers.Geometry.LinearRing(points);}else{line=new OpenLayers.Geometry.LineString(points);}}else{throw&quot;Bad LineString coordinates: &quot;+coordString;}}
return line;},polygon:function(node){var nodeList=this.getElementsByTagNameNS(node,this.internalns,&quot;LinearRing&quot;);var numRings=nodeList.length;var components=new Array(numRings);if(numRings&gt;0){var ring;for(var i=0,len=nodeList.length;i&lt;len;++i){ring=this.parseGeometry.linestring.apply(this,[nodeList[i],true]);if(ring){components[i]=ring;}else{throw&quot;Bad LinearRing geometry: &quot;+i;}}}
return new OpenLayers.Geometry.Polygon(components);},multigeometry:function(node){var child,parser;var parts=[];var children=node.childNodes;for(var i=0,len=children.length;i&lt;len;++i){child=children[i];if(child.nodeType==1){var type=(child.prefix)?child.nodeName.split(&quot;:&quot;)[1]:child.nodeName;var parser=this.parseGeometry[type.toLowerCase()];if(parser){parts.push(parser.apply(this,[child]));}}}
return new OpenLayers.Geometry.Collection(parts);}},parseAttributes:function(node){var attributes={};var edNodes=node.getElementsByTagName(&quot;ExtendedData&quot;);if(edNodes.length){attributes=this.parseExtendedData(edNodes[0]);}
var child,grandchildren,grandchild;var children=node.childNodes;for(var i=0,len=children.length;i&lt;len;++i){child=children[i];if(child.nodeType==1){grandchildren=child.childNodes;if(grandchildren.length==1||grandchildren.length==3){var grandchild;switch(grandchildren.length){case 1:grandchild=grandchildren[0];break;case 3:default:grandchild=grandchildren[1];break;}
if(grandchild.nodeType==3||grandchild.nodeType==4){var name=(child.prefix)?child.nodeName.split(&quot;:&quot;)[1]:child.nodeName;var value=OpenLayers.Util.getXmlNodeValue(grandchild);if(value){value=value.replace(this.regExes.trimSpace,&quot;&quot;);attributes[name]=value;}}}}}
return attributes;},parseExtendedData:function(node){var attributes={};var dataNodes=node.getElementsByTagName(&quot;Data&quot;);for(var i=0,len=dataNodes.length;i&lt;len;i++){var data=dataNodes[i];var key=data.getAttribute(&quot;name&quot;);var ed={};var valueNode=data.getElementsByTagName(&quot;value&quot;);if(valueNode.length){ed[&apos;value&apos;]=this.getChildValue(valueNode[0]);}
var nameNode=data.getElementsByTagName(&quot;displayName&quot;);if(nameNode.length){ed[&apos;displayName&apos;]=this.getChildValue(nameNode[0]);}
attributes[key]=ed;}
return attributes;},parseProperty:function(xmlNode,namespace,tagName){var value;var nodeList=this.getElementsByTagNameNS(xmlNode,namespace,tagName);try{value=OpenLayers.Util.getXmlNodeValue(nodeList[0]);}catch(e){value=null;}
return value;},write:function(features){if(!(features instanceof Array)){features=[features];}
var kml=this.createElementNS(this.kmlns,&quot;kml&quot;);var folder=this.createFolderXML();for(var i=0,len=features.length;i&lt;len;++i){folder.appendChild(this.createPlacemarkXML(features[i]));}
kml.appendChild(folder);return OpenLayers.Format.XML.prototype.write.apply(this,[kml]);},createFolderXML:function(){var folderName=this.createElementNS(this.kmlns,&quot;name&quot;);var folderNameText=this.createTextNode(this.foldersName);folderName.appendChild(folderNameText);var folderDesc=this.createElementNS(this.kmlns,&quot;description&quot;);var folderDescText=this.createTextNode(this.foldersDesc);folderDesc.appendChild(folderDescText);var folder=this.createElementNS(this.kmlns,&quot;Folder&quot;);folder.appendChild(folderName);folder.appendChild(folderDesc);return folder;},createPlacemarkXML:function(feature){var placemarkName=this.createElementNS(this.kmlns,&quot;name&quot;);var name=(feature.attributes.name)?feature.attributes.name:feature.id;placemarkName.appendChild(this.createTextNode(name));var placemarkDesc=this.createElementNS(this.kmlns,&quot;description&quot;);var desc=(feature.attributes.description)?feature.attributes.description:this.placemarksDesc;placemarkDesc.appendChild(this.createTextNode(desc));var placemarkNode=this.createElementNS(this.kmlns,&quot;Placemark&quot;);if(feature.fid!=null){placemarkNode.setAttribute(&quot;id&quot;,feature.fid);}
placemarkNode.appendChild(placemarkName);placemarkNode.appendChild(placemarkDesc);var geometryNode=this.buildGeometryNode(feature.geometry);placemarkNode.appendChild(geometryNode);return placemarkNode;},buildGeometryNode:function(geometry){if(this.internalProjection&amp;&amp;this.externalProjection){geometry=geometry.clone();geometry.transform(this.internalProjection,this.externalProjection);}
var className=geometry.CLASS_NAME;var type=className.substring(className.lastIndexOf(&quot;.&quot;)+1);var builder=this.buildGeometry[type.toLowerCase()];var node=null;if(builder){node=builder.apply(this,[geometry]);}
return node;},buildGeometry:{point:function(geometry){var kml=this.createElementNS(this.kmlns,&quot;Point&quot;);kml.appendChild(this.buildCoordinatesNode(geometry));return kml;},multipoint:function(geometry){return this.buildGeometry.collection.apply(this,[geometry]);},linestring:function(geometry){var kml=this.createElementNS(this.kmlns,&quot;LineString&quot;);kml.appendChild(this.buildCoordinatesNode(geometry));return kml;},multilinestring:function(geometry){return this.buildGeometry.collection.apply(this,[geometry]);},linearring:function(geometry){var kml=this.createElementNS(this.kmlns,&quot;LinearRing&quot;);kml.appendChild(this.buildCoordinatesNode(geometry));return kml;},polygon:function(geometry){var kml=this.createElementNS(this.kmlns,&quot;Polygon&quot;);var rings=geometry.components;var ringMember,ringGeom,type;for(var i=0,len=rings.length;i&lt;len;++i){type=(i==0)?&quot;outerBoundaryIs&quot;:&quot;innerBoundaryIs&quot;;ringMember=this.createElementNS(this.kmlns,type);ringGeom=this.buildGeometry.linearring.apply(this,[rings[i]]);ringMember.appendChild(ringGeom);kml.appendChild(ringMember);}
return kml;},multipolygon:function(geometry){return this.buildGeometry.collection.apply(this,[geometry]);},collection:function(geometry){var kml=this.createElementNS(this.kmlns,&quot;MultiGeometry&quot;);var child;for(var i=0,len=geometry.components.length;i&lt;len;++i){child=this.buildGeometryNode.apply(this,[geometry.components[i]]);if(child){kml.appendChild(child);}}
return kml;}},buildCoordinatesNode:function(geometry){var coordinatesNode=this.createElementNS(this.kmlns,&quot;coordinates&quot;);var path;var points=geometry.components;if(points){var point;var numPoints=points.length;var parts=new Array(numPoints);for(var i=0;i&lt;numPoints;++i){point=points[i];parts[i]=point.x+&quot;,&quot;+point.y;}
path=parts.join(&quot; &quot;);}else{path=geometry.x+&quot;,&quot;+geometry.y;}
var txtNode=this.createTextNode(path);coordinatesNode.appendChild(txtNode);return coordinatesNode;},CLASS_NAME:&quot;OpenLayers.Format.KML&quot;});OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:false,interestingTagsExclude:null,areaTags:null,initialize:function(options){var layer_defaults={&apos;interestingTagsExclude&apos;:[&apos;source&apos;,&apos;source_ref&apos;,&apos;source:ref&apos;,&apos;history&apos;,&apos;attribution&apos;,&apos;created_by&apos;],&apos;areaTags&apos;:[&apos;area&apos;,&apos;building&apos;,&apos;leisure&apos;,&apos;tourism&apos;,&apos;ruins&apos;,&apos;historic&apos;,&apos;landuse&apos;,&apos;military&apos;,&apos;natural&apos;,&apos;sport&apos;]};layer_defaults=OpenLayers.Util.extend(layer_defaults,options);var interesting={};for(var i=0;i&lt;layer_defaults.interestingTagsExclude.length;i++){interesting[layer_defaults.interestingTagsExclude[i]]=true;}
layer_defaults.interestingTagsExclude=interesting;var area={};for(var i=0;i&lt;layer_defaults.areaTags.length;i++){area[layer_defaults.areaTags[i]]=true;}
layer_defaults.areaTags=area;OpenLayers.Format.XML.prototype.initialize.apply(this,[layer_defaults]);},read:function(doc){if(typeof doc==&quot;string&quot;){doc=OpenLayers.Format.XML.prototype.read.apply(this,[doc]);}
var nodes=this.getNodes(doc);var ways=this.getWays(doc);var feat_list=new Array(ways.length);for(var i=0;i&lt;ways.length;i++){var point_list=new Array(ways[i].nodes.length);var poly=this.isWayArea(ways[i])?1:0;for(var j=0;j&lt;ways[i].nodes.length;j++){var node=nodes[ways[i].nodes[j]];var point=new OpenLayers.Geometry.Point(node.lon,node.lat);point.osm_id=parseInt(ways[i].nodes[j]);point_list[j]=point;node.used=true;}
var geometry=null;if(poly){geometry=new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(point_list));}else{geometry=new OpenLayers.Geometry.LineString(point_list);}
if(this.internalProjection&amp;&amp;this.externalProjection){geometry.transform(this.externalProjection,this.internalProjection);}
var feat=new OpenLayers.Feature.Vector(geometry,ways[i].tags);feat.osm_id=parseInt(ways[i].id);feat.fid=&quot;way.&quot;+feat.osm_id;feat_list[i]=feat;}
for(var node_id in nodes){var node=nodes[node_id];if(!node.used||this.checkTags){var tags=null;if(this.checkTags){var result=this.getTags(node.node,true);if(node.used&amp;&amp;!result[1]){continue;}
tags=result[0];}else{tags=this.getTags(node.node);}
var feat=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(node[&apos;lon&apos;],node[&apos;lat&apos;]),tags);if(this.internalProjection&amp;&amp;this.externalProjection){feat.geometry.transform(this.externalProjection,this.internalProjection);}
feat.osm_id=parseInt(node_id);feat.fid=&quot;node.&quot;+feat.osm_id;feat_list.push(feat);}
node.node=null;}
return feat_list;},getNodes:function(doc){var node_list=doc.getElementsByTagName(&quot;node&quot;);var nodes={};for(var i=0;i&lt;node_list.length;i++){var node=node_list[i];var id=node.getAttribute(&quot;id&quot;);nodes[id]={&apos;lat&apos;:node.getAttribute(&quot;lat&quot;),&apos;lon&apos;:node.getAttribute(&quot;lon&quot;),&apos;node&apos;:node};}
return nodes;},getWays:function(doc){var way_list=doc.getElementsByTagName(&quot;way&quot;);var return_ways=[];for(var i=0;i&lt;way_list.length;i++){var way=way_list[i];var way_object={id:way.getAttribute(&quot;id&quot;)};way_object.tags=this.getTags(way);var node_list=way.getElementsByTagName(&quot;nd&quot;);way_object.nodes=new Array(node_list.length);for(var j=0;j&lt;node_list.length;j++){way_object.nodes[j]=node_list[j].getAttribute(&quot;ref&quot;);}
return_ways.push(way_object);}
return return_ways;},getTags:function(dom_node,interesting_tags){var tag_list=dom_node.getElementsByTagName(&quot;tag&quot;);var tags={};var interesting=false;for(var j=0;j&lt;tag_list.length;j++){var key=tag_list[j].getAttribute(&quot;k&quot;);tags[key]=tag_list[j].getAttribute(&quot;v&quot;);if(interesting_tags){if(!this.interestingTagsExclude[key]){interesting=true;}}}
return interesting_tags?[tags,interesting]:tags;},isWayArea:function(way){var poly_shaped=false;var poly_tags=false;if(way.nodes[0]==way.nodes[way.nodes.length-1]){poly_shaped=true;}
if(this.checkTags){for(var key in way.tags){if(this.areaTags[key]){poly_tags=true;break;}}}
return poly_shaped&amp;&amp;(this.checkTags?poly_tags:true);},write:function(features){if(!(features instanceof Array)){features=[features];}
this.osm_id=1;this.created_nodes={};var root_node=this.createElementNS(null,&quot;osm&quot;);root_node.setAttribute(&quot;version&quot;,&quot;0.5&quot;);root_node.setAttribute(&quot;generator&quot;,&quot;OpenLayers &quot;+OpenLayers.VERSION_NUMBER);for(var i=features.length-1;i&gt;=0;i--){var nodes=this.createFeatureNodes(features[i]);for(var j=0;j&lt;nodes.length;j++){root_node.appendChild(nodes[j]);}}
return OpenLayers.Format.XML.prototype.write.apply(this,[root_node]);},createFeatureNodes:function(feature){var nodes=[];var className=feature.geometry.CLASS_NAME;var type=className.substring(className.lastIndexOf(&quot;.&quot;)+1);type=type.toLowerCase();var builder=this.createXML[type];if(builder){nodes=builder.apply(this,[feature]);}
return nodes;},createXML:{&apos;point&apos;:function(point){var id=null;var geometry=point.geometry?point.geometry:point;var already_exists=false;if(point.osm_id){id=point.osm_id;if(this.created_nodes[id]){already_exists=true;}}else{id=-this.osm_id;this.osm_id++;}
if(already_exists){node=this.created_nodes[id];}else{var node=this.createElementNS(null,&quot;node&quot;);}
this.created_nodes[id]=node;node.setAttribute(&quot;id&quot;,id);node.setAttribute(&quot;lon&quot;,geometry.x);node.setAttribute(&quot;lat&quot;,geometry.y);if(point.attributes){this.serializeTags(point,node);}
this.setState(point,node);return already_exists?[]:[node];},linestring:function(feature){var nodes=[];var geometry=feature.geometry;if(feature.osm_id){id=feature.osm_id;}else{id=-this.osm_id;this.osm_id++;}
var way=this.createElementNS(null,&quot;way&quot;);way.setAttribute(&quot;id&quot;,id);for(var i=0;i&lt;geometry.components.length;i++){var node=this.createXML[&apos;point&apos;].apply(this,[geometry.components[i]]);if(node.length){node=node[0];var node_ref=node.getAttribute(&quot;id&quot;);nodes.push(node);}else{node_ref=geometry.components[i].osm_id;node=this.created_nodes[node_ref];}
this.setState(feature,node);var nd_dom=this.createElementNS(null,&quot;nd&quot;);nd_dom.setAttribute(&quot;ref&quot;,node_ref);way.appendChild(nd_dom);}
this.serializeTags(feature,way);nodes.push(way);return nodes;},polygon:function(feature){var attrs=OpenLayers.Util.extend({&apos;area&apos;:&apos;yes&apos;},feature.attributes);var feat=new OpenLayers.Feature.Vector(feature.geometry.components[0],attrs);feat.osm_id=feature.osm_id;return this.createXML[&apos;linestring&apos;].apply(this,[feat]);}},serializeTags:function(feature,node){for(var key in feature.attributes){var tag=this.createElementNS(null,&quot;tag&quot;);tag.setAttribute(&quot;k&quot;,key);tag.setAttribute(&quot;v&quot;,feature.attributes[key]);node.appendChild(tag);}},setState:function(feature,node){if(feature.state){var state=null;switch(feature.state){case OpenLayers.State.UPDATE:state=&quot;modify&quot;;case OpenLayers.State.DELETE:state=&quot;delete&quot;;}
if(state){node.setAttribute(&quot;action&quot;,state);}}},CLASS_NAME:&quot;OpenLayers.Format.OSM&quot;});OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:[&quot;OpenLayers.Geometry.Polygon&quot;],initialize:function(components){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments);},CLASS_NAME:&quot;OpenLayers.Geometry.MultiPolygon&quot;});OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{polygon:null,initialize:function(control,callbacks,options){OpenLayers.Handler.Path.prototype.initialize.apply(this,arguments);},createFeature:function(pixel){var lonlat=this.control.map.getLonLatFromPixel(pixel);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(lonlat.lon,lonlat.lat));this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry]));this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry]));this.callback(&quot;create&quot;,[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:true});},destroyFeature:function(){OpenLayers.Handler.Path.prototype.destroyFeature.apply(this);this.polygon=null;},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style);},getSketch:function(){return this.polygon;},getGeometry:function(){var geometry=this.polygon&amp;&amp;this.polygon.geometry;if(geometry&amp;&amp;this.multi){geometry=new OpenLayers.Geometry.MultiPolygon([geometry]);}
return geometry;},dblclick:function(evt){if(!this.freehandMode(evt)){var index=this.line.geometry.components.length-2;this.line.geometry.removeComponent(this.line.geometry.components[index]);this.removePoint();this.finalize();}
return false;},CLASS_NAME:&quot;OpenLayers.Handler.Polygon&quot;});OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(layer,options){OpenLayers.Control.Panel.prototype.initialize.apply(this,[options]);this.addControls([new OpenLayers.Control.Navigation()]);var controls=[new OpenLayers.Control.DrawFeature(layer,OpenLayers.Handler.Point,{&apos;displayClass&apos;:&apos;olControlDrawFeaturePoint&apos;}),new OpenLayers.Control.DrawFeature(layer,OpenLayers.Handler.Path,{&apos;displayClass&apos;:&apos;olControlDrawFeaturePath&apos;}),new OpenLayers.Control.DrawFeature(layer,OpenLayers.Handler.Polygon,{&apos;displayClass&apos;:&apos;olControlDrawFeaturePolygon&apos;})];this.addControls(controls);},draw:function(){var div=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);this.activateControl(this.controls[0]);return div;},CLASS_NAME:&quot;OpenLayers.Control.EditingToolbar&quot;});OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:[&apos;antialiasing&apos;,&apos;blockout&apos;,&apos;font&apos;,&apos;fontcolor&apos;,&apos;fontsize&apos;,&apos;fontstyle&apos;,&apos;glowing&apos;,&apos;interval&apos;,&apos;outline&apos;,&apos;printmode&apos;,&apos;shadow&apos;,&apos;transparency&apos;],request:null,response:null,initialize:function(options){this.request=new OpenLayers.Format.ArcXML.Request();this.response=new OpenLayers.Format.ArcXML.Response();if(options){if(options.requesttype==&quot;feature&quot;){this.request.get_image=null;var qry=this.request.get_feature.query;this.addCoordSys(qry.featurecoordsys,options.featureCoordSys);this.addCoordSys(qry.filtercoordsys,options.filterCoordSys);if(options.polygon){qry.isspatial=true;qry.spatialfilter.polygon=options.polygon;}else if(options.envelope){qry.isspatial=true;qry.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0};this.parseEnvelope(qry.spatialfilter.envelope,options.envelope);}}else if(options.requesttype==&quot;image&quot;){this.request.get_feature=null;var props=this.request.get_image.properties;this.parseEnvelope(props.envelope,options.envelope);this.addLayers(props.layerlist,options.layers);this.addImageSize(props.imagesize,options.tileSize);this.addCoordSys(props.featurecoordsys,options.featureCoordSys);this.addCoordSys(props.filtercoordsys,options.filterCoordSys);}else{this.request=null;}}
OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},parseEnvelope:function(env,arr){if(arr&amp;&amp;arr.length==4){env.minx=arr[0];env.miny=arr[1];env.maxx=arr[2];env.maxy=arr[3];}},addLayers:function(ll,lyrs){for(var lind=0,len=lyrs.length;lind&lt;len;lind++){ll.push(lyrs[lind]);}},addImageSize:function(imsize,olsize){if(olsize!==null){imsize.width=olsize.w;imsize.height=olsize.h;imsize.printwidth=olsize.w;imsize.printheight=olsize.h;}},addCoordSys:function(featOrFilt,fsys){if(typeof fsys==&quot;string&quot;){featOrFilt.id=parseInt(fsys);featOrFilt.string=fsys;}
else if(typeof fsys==&quot;object&quot;&amp;&amp;fsys.proj!==null){featOrFilt.id=fsys.proj.srsProjNumber;featOrFilt.string=fsys.proj.srsCode;}else{featOrFilt=fsys;}},iserror:function(data){var ret=null;if(!data){ret=(this.response.error!==&apos;&apos;);}else{data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);var errorNodes=data.documentElement.getElementsByTagName(&quot;ERROR&quot;);ret=(errorNodes!==null&amp;&amp;errorNodes.length&gt;0);}
return ret;},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var arcNode=null;if(data&amp;&amp;data.documentElement){if(data.documentElement.nodeName==&quot;ARCXML&quot;){arcNode=data.documentElement;}else{arcNode=data.documentElement.getElementsByTagName(&quot;ARCXML&quot;)[0];}}
if(!arcNode){var error,source;try{error=data.firstChild.nodeValue;source=data.firstChild.childNodes[1].firstChild.nodeValue;}catch(err){}
throw{message:&quot;Error parsing the ArcXML request&quot;,error:error,source:source};}
var response=this.parseResponse(arcNode);return response;},write:function(request){if(!request){request=this.request;}
var root=this.createElementNS(&quot;&quot;,&quot;ARCXML&quot;);root.setAttribute(&quot;version&quot;,&quot;1.1&quot;);var reqElem=this.createElementNS(&quot;&quot;,&quot;REQUEST&quot;);if(request.get_image!=null){var getElem=this.createElementNS(&quot;&quot;,&quot;GET_IMAGE&quot;);reqElem.appendChild(getElem);var propElem=this.createElementNS(&quot;&quot;,&quot;PROPERTIES&quot;);getElem.appendChild(propElem);var props=request.get_image.properties;if(props.featurecoordsys!=null){var feat=this.createElementNS(&quot;&quot;,&quot;FEATURECOORDSYS&quot;);propElem.appendChild(feat);if(props.featurecoordsys.id===0){feat.setAttribute(&quot;string&quot;,props.featurecoordsys[&apos;string&apos;]);}
else{feat.setAttribute(&quot;id&quot;,props.featurecoordsys.id);}}
if(props.filtercoordsys!=null){var filt=this.createElementNS(&quot;&quot;,&quot;FILTERCOORDSYS&quot;);propElem.appendChild(filt);if(props.filtercoordsys.id===0){filt.setAttribute(&quot;string&quot;,props.filtercoordsys.string);}
else{filt.setAttribute(&quot;id&quot;,props.filtercoordsys.id);}}
if(props.envelope!=null){var env=this.createElementNS(&quot;&quot;,&quot;ENVELOPE&quot;);propElem.appendChild(env);env.setAttribute(&quot;minx&quot;,props.envelope.minx);env.setAttribute(&quot;miny&quot;,props.envelope.miny);env.setAttribute(&quot;maxx&quot;,props.envelope.maxx);env.setAttribute(&quot;maxy&quot;,props.envelope.maxy);}
var imagesz=this.createElementNS(&quot;&quot;,&quot;IMAGESIZE&quot;);propElem.appendChild(imagesz);imagesz.setAttribute(&quot;height&quot;,props.imagesize.height);imagesz.setAttribute(&quot;width&quot;,props.imagesize.width);if(props.imagesize.height!=props.imagesize.printheight||props.imagesize.width!=props.imagesize.printwidth){imagesz.setAttribute(&quot;printheight&quot;,props.imagesize.printheight);imagesz.setArrtibute(&quot;printwidth&quot;,props.imagesize.printwidth);}
if(props.background!=null){var backgrnd=this.createElementNS(&quot;&quot;,&quot;BACKGROUND&quot;);propElem.appendChild(backgrnd);backgrnd.setAttribute(&quot;color&quot;,props.background.color.r+&quot;,&quot;+
props.background.color.g+&quot;,&quot;+
props.background.color.b);if(props.background.transcolor!==null){backgrnd.setAttribute(&quot;transcolor&quot;,props.background.transcolor.r+&quot;,&quot;+
props.background.transcolor.g+&quot;,&quot;+
props.background.transcolor.b);}}
if(props.layerlist!=null&amp;&amp;props.layerlist.length&gt;0){var layerlst=this.createElementNS(&quot;&quot;,&quot;LAYERLIST&quot;);propElem.appendChild(layerlst);for(var ld=0;ld&lt;props.layerlist.length;ld++){var ldef=this.createElementNS(&quot;&quot;,&quot;LAYERDEF&quot;);layerlst.appendChild(ldef);ldef.setAttribute(&quot;id&quot;,props.layerlist[ld].id);ldef.setAttribute(&quot;visible&quot;,props.layerlist[ld].visible);if(typeof props.layerlist[ld].query==&quot;object&quot;){var query=props.layerlist[ld].query;if(query.where.length&lt;0){continue;}
var queryElem=null;if(typeof query.spatialfilter==&quot;boolean&quot;&amp;&amp;query.spatialfilter){queryElem=this.createElementNS(&quot;&quot;,&quot;SPATIALQUERY&quot;);}
else{queryElem=this.createElementNS(&quot;&quot;,&quot;QUERY&quot;);}
queryElem.setAttribute(&quot;where&quot;,query.where);if(typeof query.accuracy==&quot;number&quot;&amp;&amp;query.accuracy&gt;0){queryElem.setAttribute(&quot;accuracy&quot;,query.accuracy);}
if(typeof query.featurelimit==&quot;number&quot;&amp;&amp;query.featurelimit&lt;2000){queryElem.setAttribute(&quot;featurelimit&quot;,query.featurelimit);}
if(typeof query.subfields==&quot;string&quot;&amp;&amp;query.subfields!=&quot;#ALL#&quot;){queryElem.setAttribute(&quot;subfields&quot;,query.subfields);}
if(typeof query.joinexpression==&quot;string&quot;&amp;&amp;query.joinexpression.length&gt;0){queryElem.setAttribute(&quot;joinexpression&quot;,query.joinexpression);}
if(typeof query.jointables==&quot;string&quot;&amp;&amp;query.jointables.length&gt;0){queryElem.setAttribute(&quot;jointables&quot;,query.jointables);}
ldef.appendChild(queryElem);}
if(typeof props.layerlist[ld].renderer==&quot;object&quot;){this.addRenderer(ldef,props.layerlist[ld].renderer);}}}}else if(request.get_feature!=null){var getElem=this.createElementNS(&quot;&quot;,&quot;GET_FEATURES&quot;);getElem.setAttribute(&quot;outputmode&quot;,&quot;newxml&quot;);getElem.setAttribute(&quot;checkesc&quot;,&quot;true&quot;);if(request.get_feature.geometry){getElem.setAttribute(&quot;geometry&quot;,request.get_feature.geometry);}
else{getElem.setAttribute(&quot;geometry&quot;,&quot;false&quot;);}
if(request.get_feature.compact){getElem.setAttribute(&quot;compact&quot;,request.get_feature.compact);}
if(request.get_feature.featurelimit==&quot;number&quot;){getElem.setAttribute(&quot;featurelimit&quot;,request.get_feature.featurelimit);}
getElem.setAttribute(&quot;globalenvelope&quot;,&quot;true&quot;);reqElem.appendChild(getElem);if(request.get_feature.layer!=null&amp;&amp;request.get_feature.layer.length&gt;0){var lyrElem=this.createElementNS(&quot;&quot;,&quot;LAYER&quot;);lyrElem.setAttribute(&quot;id&quot;,request.get_feature.layer);getElem.appendChild(lyrElem);}
var fquery=request.get_feature.query;if(fquery!=null){var qElem=null;if(fquery.isspatial){qElem=this.createElementNS(&quot;&quot;,&quot;SPATIALQUERY&quot;);}else{qElem=this.createElementNS(&quot;&quot;,&quot;QUERY&quot;);}
getElem.appendChild(qElem);if(typeof fquery.accuracy==&quot;number&quot;){qElem.setAttribute(&quot;accuracy&quot;,fquery.accuracy);}
if(fquery.featurecoordsys!=null){var fcsElem1=this.createElementNS(&quot;&quot;,&quot;FEATURECOORDSYS&quot;);if(fquery.featurecoordsys.id==0){fcsElem1.setAttribute(&quot;string&quot;,fquery.featurecoordsys.string);}else{fcsElem1.setAttribute(&quot;id&quot;,fquery.featurecoordsys.id);}
qElem.appendChild(fcsElem1);}
if(fquery.filtercoordsys!=null){var fcsElem2=this.createElementNS(&quot;&quot;,&quot;FILTERCOORDSYS&quot;);if(fquery.filtercoordsys.id===0){fcsElem2.setAttribute(&quot;string&quot;,fquery.filtercoordsys.string);}else{fcsElem2.setAttribute(&quot;id&quot;,fquery.filtercoordsys.id);}
qElem.appendChild(fcsElem2);}
if(fquery.buffer&gt;0){var bufElem=this.createElementNS(&quot;&quot;,&quot;BUFFER&quot;);bufElem.setAttribute(&quot;distance&quot;,fquery.buffer);qElem.appendChild(bufElem);}
if(fquery.isspatial){var spfElem=this.createElementNS(&quot;&quot;,&quot;SPATIALFILTER&quot;);spfElem.setAttribute(&quot;relation&quot;,fquery.spatialfilter.relation);qElem.appendChild(spfElem);if(fquery.spatialfilter.envelope){var envElem=this.createElementNS(&quot;&quot;,&quot;ENVELOPE&quot;);envElem.setAttribute(&quot;minx&quot;,fquery.spatialfilter.envelope.minx);envElem.setAttribute(&quot;miny&quot;,fquery.spatialfilter.envelope.miny);envElem.setAttribute(&quot;maxx&quot;,fquery.spatialfilter.envelope.maxx);envElem.setAttribute(&quot;maxy&quot;,fquery.spatialfilter.envelope.maxy);spfElem.appendChild(envElem);}else if(typeof fquery.spatialfilter.polygon==&quot;object&quot;){spfElem.appendChild(this.writePolygonGeometry(fquery.spatialfilter.polygon));}}
if(fquery.where!=null&amp;&amp;fquery.where.length&gt;0){qElem.setAttribute(&quot;where&quot;,fquery.where);}}}
root.appendChild(reqElem);return OpenLayers.Format.XML.prototype.write.apply(this,[root]);},addGroupRenderer:function(ldef,toprenderer){var topRelem=this.createElementNS(&quot;&quot;,&quot;GROUPRENDERER&quot;);ldef.appendChild(topRelem);for(var rind=0;rind&lt;toprenderer.length;rind++){var renderer=toprenderer[rind];this.addRenderer(topRelem,renderer);}},addRenderer:function(topRelem,renderer){if(renderer instanceof Array){this.addGroupRenderer(topRelem,renderer);}else{var renderElem=this.createElementNS(&quot;&quot;,renderer.type.toUpperCase()+&quot;RENDERER&quot;);topRelem.appendChild(renderElem);if(renderElem.tagName==&quot;VALUEMAPRENDERER&quot;){this.addValueMapRenderer(renderElem,renderer);}else if(renderElem.tagName==&quot;VALUEMAPLABELRENDERER&quot;){this.addValueMapLabelRenderer(renderElem,renderer);}else if(renderElem.tagName==&quot;SIMPLELABELRENDERER&quot;){this.addSimpleLabelRenderer(renderElem,renderer);}else if(renderElem.tagName==&quot;SCALEDEPENDENTRENDERER&quot;){this.addScaleDependentRenderer(renderElem,renderer);}}},addScaleDependentRenderer:function(renderElem,renderer){if(typeof renderer.lower==&quot;string&quot;||typeof renderer.lower==&quot;number&quot;){renderElem.setAttribute(&quot;lower&quot;,renderer.lower);}
if(typeof renderer.upper==&quot;string&quot;||typeof renderer.upper==&quot;number&quot;){renderElem.setAttribute(&quot;upper&quot;,renderer.upper);}
this.addRenderer(renderElem,renderer.renderer);},addValueMapLabelRenderer:function(renderElem,renderer){renderElem.setAttribute(&quot;lookupfield&quot;,renderer.lookupfield);renderElem.setAttribute(&quot;labelfield&quot;,renderer.labelfield);if(typeof renderer.exacts==&quot;object&quot;){for(var ext=0,extlen=renderer.exacts.length;ext&lt;extlen;ext++){var exact=renderer.exacts[ext];var eelem=this.createElementNS(&quot;&quot;,&quot;EXACT&quot;);if(typeof exact.value==&quot;string&quot;){eelem.setAttribute(&quot;value&quot;,exact.value);}
if(typeof exact.label==&quot;string&quot;){eelem.setAttribute(&quot;label&quot;,exact.label);}
if(typeof exact.method==&quot;string&quot;){eelem.setAttribute(&quot;method&quot;,exact.method);}
renderElem.appendChild(eelem);if(typeof exact.symbol==&quot;object&quot;){var selem=null;if(exact.symbol.type==&quot;text&quot;){selem=this.createElementNS(&quot;&quot;,&quot;TEXTSYMBOL&quot;);}
if(selem!=null){var keys=this.fontStyleKeys;for(var i=0,len=keys.length;i&lt;len;i++){var key=keys[i];if(exact.symbol[key]){selem.setAttribute(key,exact.symbol[key]);}}
eelem.appendChild(selem);}}}}},addValueMapRenderer:function(renderElem,renderer){renderElem.setAttribute(&quot;lookupfield&quot;,renderer.lookupfield);if(typeof renderer.ranges==&quot;object&quot;){for(var rng=0,rnglen=renderer.ranges.length;rng&lt;rnglen;rng++){var range=renderer.ranges[rng];var relem=this.createElementNS(&quot;&quot;,&quot;RANGE&quot;);relem.setAttribute(&quot;lower&quot;,range.lower);relem.setAttribute(&quot;upper&quot;,range.upper);renderElem.appendChild(relem);if(typeof range.symbol==&quot;object&quot;){var selem=null;if(range.symbol.type==&quot;simplepolygon&quot;){selem=this.createElementNS(&quot;&quot;,&quot;SIMPLEPOLYGONSYMBOL&quot;);}
if(selem!=null){if(typeof range.symbol.boundarycolor==&quot;string&quot;){selem.setAttribute(&quot;boundarycolor&quot;,range.symbol.boundarycolor);}
if(typeof range.symbol.fillcolor==&quot;string&quot;){selem.setAttribute(&quot;fillcolor&quot;,range.symbol.fillcolor);}
if(typeof range.symbol.filltransparency==&quot;number&quot;){selem.setAttribute(&quot;filltransparency&quot;,range.symbol.filltransparency);}
relem.appendChild(selem);}}}}else if(typeof renderer.exacts==&quot;object&quot;){for(var ext=0,extlen=renderer.exacts.length;ext&lt;extlen;ext++){var exact=renderer.exacts[ext];var eelem=this.createElementNS(&quot;&quot;,&quot;EXACT&quot;);if(typeof exact.value==&quot;string&quot;){eelem.setAttribute(&quot;value&quot;,exact.value);}
if(typeof exact.label==&quot;string&quot;){eelem.setAttribute(&quot;label&quot;,exact.label);}
if(typeof exact.method==&quot;string&quot;){eelem.setAttribute(&quot;method&quot;,exact.method);}
renderElem.appendChild(eelem);if(typeof exact.symbol==&quot;object&quot;){var selem=null;if(exact.symbol.type==&quot;simplemarker&quot;){selem=this.createElementNS(&quot;&quot;,&quot;SIMPLEMARKERSYMBOL&quot;);}
if(selem!=null){if(typeof exact.symbol.antialiasing==&quot;string&quot;){selem.setAttribute(&quot;antialiasing&quot;,exact.symbol.antialiasing);}
if(typeof exact.symbol.color==&quot;string&quot;){selem.setAttribute(&quot;color&quot;,exact.symbol.color);}
if(typeof exact.symbol.outline==&quot;string&quot;){selem.setAttribute(&quot;outline&quot;,exact.symbol.outline);}
if(typeof exact.symbol.overlap==&quot;string&quot;){selem.setAttribute(&quot;overlap&quot;,exact.symbol.overlap);}
if(typeof exact.symbol.shadow==&quot;string&quot;){selem.setAttribute(&quot;shadow&quot;,exact.symbol.shadow);}
if(typeof exact.symbol.transparency==&quot;number&quot;){selem.setAttribute(&quot;transparency&quot;,exact.symbol.transparency);}
if(typeof exact.symbol.usecentroid==&quot;string&quot;){selem.setAttribute(&quot;usecentroid&quot;,exact.symbol.usecentroid);}
if(typeof exact.symbol.width==&quot;number&quot;){selem.setAttribute(&quot;width&quot;,exact.symbol.width);}
eelem.appendChild(selem);}}}}},addSimpleLabelRenderer:function(renderElem,renderer){renderElem.setAttribute(&quot;field&quot;,renderer.field);var keys=[&apos;featureweight&apos;,&apos;howmanylabels&apos;,&apos;labelbufferratio&apos;,&apos;labelpriorities&apos;,&apos;labelweight&apos;,&apos;linelabelposition&apos;,&apos;rotationalangles&apos;];for(var i=0,len=keys.length;i&lt;len;i++){var key=keys[i];if(renderer[key]){renderElem.setAttribute(key,renderer[key]);}}
if(renderer.symbol.type==&quot;text&quot;){var symbol=renderer.symbol;var selem=this.createElementNS(&quot;&quot;,&quot;TEXTSYMBOL&quot;);renderElem.appendChild(selem);var keys=this.fontStyleKeys;for(var i=0,len=keys.length;i&lt;len;i++){var key=keys[i];if(symbol[key]){selem.setAttribute(key,renderer[key]);}}}},writePolygonGeometry:function(polygon){if(!(polygon instanceof OpenLayers.Geometry.Polygon)){throw{message:&apos;Cannot write polygon geometry to ArcXML with an &apos;+
polygon.CLASS_NAME+&apos; object.&apos;,geometry:polygon};}
var polyElem=this.createElementNS(&quot;&quot;,&quot;POLYGON&quot;);for(var ln=0,lnlen=polygon.components.length;ln&lt;lnlen;ln++){var ring=polygon.components[ln];var ringElem=this.createElementNS(&quot;&quot;,&quot;RING&quot;);for(var rn=0,rnlen=ring.components.length;rn&lt;rnlen;rn++){var point=ring.components[rn];var pointElem=this.createElementNS(&quot;&quot;,&quot;POINT&quot;);pointElem.setAttribute(&quot;x&quot;,point.x);pointElem.setAttribute(&quot;y&quot;,point.y);ringElem.appendChild(pointElem);}
polyElem.appendChild(ringElem);}
return polyElem;},parseResponse:function(data){if(typeof data==&quot;string&quot;){var newData=new OpenLayers.Format.XML();data=newData.read(data);}
var response=new OpenLayers.Format.ArcXML.Response();var errorNode=data.getElementsByTagName(&quot;ERROR&quot;);if(errorNode!=null&amp;&amp;errorNode.length&gt;0){response.error=this.getChildValue(errorNode,&quot;Unknown error.&quot;);}else{var responseNode=data.getElementsByTagName(&quot;RESPONSE&quot;);if(responseNode==null||responseNode.length==0){response.error=&quot;No RESPONSE tag found in ArcXML response.&quot;;return response;}
var rtype=responseNode[0].firstChild.nodeName;if(rtype==&quot;#text&quot;){rtype=responseNode[0].firstChild.nextSibling.nodeName;}
if(rtype==&quot;IMAGE&quot;){var envelopeNode=data.getElementsByTagName(&quot;ENVELOPE&quot;);var outputNode=data.getElementsByTagName(&quot;OUTPUT&quot;);if(envelopeNode==null||envelopeNode.length==0){response.error=&quot;No ENVELOPE tag found in ArcXML response.&quot;;}else if(outputNode==null||outputNode.length==0){response.error=&quot;No OUTPUT tag found in ArcXML response.&quot;;}else{var envAttr=this.parseAttributes(envelopeNode[0]);var outputAttr=this.parseAttributes(outputNode[0]);if(typeof outputAttr.type==&quot;string&quot;){response.image={envelope:envAttr,output:{type:outputAttr.type,data:this.getChildValue(outputNode[0])}};}else{response.image={envelope:envAttr,output:outputAttr};}}}else if(rtype==&quot;FEATURES&quot;){var features=responseNode[0].getElementsByTagName(&quot;FEATURES&quot;);var featureCount=features[0].getElementsByTagName(&quot;FEATURECOUNT&quot;);response.features.featurecount=featureCount[0].getAttribute(&quot;count&quot;);if(response.features.featurecount&gt;0){var envelope=features[0].getElementsByTagName(&quot;ENVELOPE&quot;);response.features.envelope=this.parseAttributes(envelope[0],typeof(0));var featureList=features[0].getElementsByTagName(&quot;FEATURE&quot;);for(var fn=0;fn&lt;featureList.length;fn++){var feature=new OpenLayers.Feature.Vector();var fields=featureList[fn].getElementsByTagName(&quot;FIELD&quot;);for(var fdn=0;fdn&lt;fields.length;fdn++){var fieldName=fields[fdn].getAttribute(&quot;name&quot;);var fieldValue=fields[fdn].getAttribute(&quot;value&quot;);feature.attributes[fieldName]=fieldValue;}
var geom=featureList[fn].getElementsByTagName(&quot;POLYGON&quot;);if(geom.length&gt;0){var ring=geom[0].getElementsByTagName(&quot;RING&quot;);var polys=[];for(var rn=0;rn&lt;ring.length;rn++){var linearRings=[];linearRings.push(this.parsePointGeometry(ring[rn]));var holes=ring[rn].getElementsByTagName(&quot;HOLE&quot;);for(var hn=0;hn&lt;holes.length;hn++){linearRings.push(this.parsePointGeometry(holes[hn]));}
holes=null;polys.push(new OpenLayers.Geometry.Polygon(linearRings));linearRings=null;}
ring=null;if(polys.length==1){feature.geometry=polys[0];}else
{feature.geometry=new OpenLayers.Geometry.MultiPolygon(polys);}}
response.features.feature.push(feature);}}}else{response.error=&quot;Unidentified response type.&quot;;}}
return response;},parseAttributes:function(node,type){var attributes={};for(var attr=0;attr&lt;node.attributes.length;attr++){if(type==&quot;number&quot;){attributes[node.attributes[attr].nodeName]=parseFloat(node.attributes[attr].nodeValue);}else{attributes[node.attributes[attr].nodeName]=node.attributes[attr].nodeValue;}}
return attributes;},parsePointGeometry:function(node){var ringPoints=[];var coords=node.getElementsByTagName(&quot;COORDS&quot;);if(coords.length&gt;0){var coordArr=this.getChildValue(coords[0]);coordArr=coordArr.split(/;/);for(var cn=0;cn&lt;coordArr.length;cn++){var coordItems=coordArr[cn].split(/ /);ringPoints.push(new OpenLayers.Geometry.Point(parseFloat(coordItems[0]),parseFloat(coordItems[1])));}
coords=null;}else{var point=node.getElementsByTagName(&quot;POINT&quot;);if(point.length&gt;0){for(var pn=0;pn&lt;point.length;pn++){ringPoints.push(new OpenLayers.Geometry.Point(parseFloat(point[pn].getAttribute(&quot;x&quot;)),parseFloat(point[pn].getAttribute(&quot;y&quot;))));}}
point=null;}
return new OpenLayers.Geometry.LinearRing(ringPoints);},CLASS_NAME:&quot;OpenLayers.Format.ArcXML&quot;});OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(params){var defaults={get_image:{properties:{background:null,draw:true,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:&quot;&quot;,datumtransformid:0,datumtransformstring:&quot;&quot;},filtercoordsys:{id:0,string:&quot;&quot;,datumtransformid:0,datumtransformstring:&quot;&quot;},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:false},layerlist:[],output:{baseurl:&quot;&quot;,legendbaseurl:&quot;&quot;,legendname:&quot;&quot;,legendpath:&quot;&quot;,legendurl:&quot;&quot;,name:&quot;&quot;,path:&quot;&quot;,type:&quot;jpg&quot;,url:&quot;&quot;}}},get_feature:{layer:&quot;&quot;,query:{isspatial:false,featurecoordsys:{id:0,string:&quot;&quot;,datumtransformid:0,datumtransformstring:&quot;&quot;},filtercoordsys:{id:0,string:&quot;&quot;,datumtransformid:0,datumtransformstring:&quot;&quot;},buffer:0,where:&quot;&quot;,spatialfilter:{relation:&quot;envelope_intersection&quot;,envelope:null}}},environment:{separators:{cs:&quot; &quot;,ts:&quot;;&quot;}},layer:[],workspaces:[]};return OpenLayers.Util.extend(this,defaults);},CLASS_NAME:&quot;OpenLayers.Format.ArcXML.Request&quot;});OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(params){var defaults={image:{envelope:null,output:&apos;&apos;},features:{featurecount:0,envelope:null,feature:[]},error:&apos;&apos;};return OpenLayers.Util.extend(this,defaults);},CLASS_NAME:&quot;OpenLayers.Format.ArcXML.Response&quot;});OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:&quot;http://mapserver.gis.umn.edu/mapserver&quot;,featurePrefix:&quot;feature&quot;,featureName:&quot;featureMember&quot;,layerName:&quot;features&quot;,geometryName:&quot;geometry&quot;,collectionName:&quot;FeatureCollection&quot;,gmlns:&quot;http://www.opengis.net/gml&quot;,extractAttributes:true,xy:true,initialize:function(options){this.regExes={trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)};OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
var featureNodes=this.getElementsByTagNameNS(data.documentElement,this.gmlns,this.featureName);var features=[];for(var i=0;i&lt;featureNodes.length;i++){var feature=this.parseFeature(featureNodes[i]);if(feature){features.push(feature);}}
return features;},parseFeature:function(node){var order=[&quot;MultiPolygon&quot;,&quot;Polygon&quot;,&quot;MultiLineString&quot;,&quot;LineString&quot;,&quot;MultiPoint&quot;,&quot;Point&quot;,&quot;Envelope&quot;,&quot;Box&quot;];var type,nodeList,geometry,parser;for(var i=0;i&lt;order.length;++i){type=order[i];nodeList=this.getElementsByTagNameNS(node,this.gmlns,type);if(nodeList.length&gt;0){var parser=this.parseGeometry[type.toLowerCase()];if(parser){geometry=parser.apply(this,[nodeList[0]]);if(this.internalProjection&amp;&amp;this.externalProjection){geometry.transform(this.externalProjection,this.internalProjection);}}else{OpenLayers.Console.error(OpenLayers.i18n(&quot;unsupportedGeometryType&quot;,{&apos;geomType&apos;:type}));}
break;}}
var attributes;if(this.extractAttributes){attributes=this.parseAttributes(node);}
var feature=new OpenLayers.Feature.Vector(geometry,attributes);feature.gml={featureType:node.firstChild.nodeName.split(&quot;:&quot;)[1],featureNS:node.firstChild.namespaceURI,featureNSPrefix:node.firstChild.prefix};var childNode=node.firstChild;var fid;while(childNode){if(childNode.nodeType==1){fid=childNode.getAttribute(&quot;fid&quot;)||childNode.getAttribute(&quot;id&quot;);if(fid){break;}}
childNode=childNode.nextSibling;}
feature.fid=fid;return feature;},parseGeometry:{point:function(node){var nodeList,coordString;var coords=[];var nodeList=this.getElementsByTagNameNS(node,this.gmlns,&quot;pos&quot;);if(nodeList.length&gt;0){coordString=nodeList[0].firstChild.nodeValue;coordString=coordString.replace(this.regExes.trimSpace,&quot;&quot;);coords=coordString.split(this.regExes.splitSpace);}
if(coords.length==0){nodeList=this.getElementsByTagNameNS(node,this.gmlns,&quot;coordinates&quot;);if(nodeList.length&gt;0){coordString=nodeList[0].firstChild.nodeValue;coordString=coordString.replace(this.regExes.removeSpace,&quot;&quot;);coords=coordString.split(&quot;,&quot;);}}
if(coords.length==0){nodeList=this.getElementsByTagNameNS(node,this.gmlns,&quot;coord&quot;);if(nodeList.length&gt;0){var xList=this.getElementsByTagNameNS(nodeList[0],this.gmlns,&quot;X&quot;);var yList=this.getElementsByTagNameNS(nodeList[0],this.gmlns,&quot;Y&quot;);if(xList.length&gt;0&amp;&amp;yList.length&gt;0){coords=[xList[0].firstChild.nodeValue,yList[0].firstChild.nodeValue];}}}
if(coords.length==2){coords[2]=null;}
if(this.xy){return new OpenLayers.Geometry.Point(coords[0],coords[1],coords[2]);}
else{return new OpenLayers.Geometry.Point(coords[1],coords[0],coords[2]);}},multipoint:function(node){var nodeList=this.getElementsByTagNameNS(node,this.gmlns,&quot;Point&quot;);var components=[];if(nodeList.length&gt;0){var point;for(var i=0;i&lt;nodeList.length;++i){point=this.parseGeometry.point.apply(this,[nodeList[i]]);if(point){components.push(point);}}}
return new OpenLayers.Geometry.MultiPoint(components);},linestring:function(node,ring){var nodeList,coordString;var coords=[];var points=[];nodeList=this.getElementsByTagNameNS(node,this.gmlns,&quot;posList&quot;);if(nodeList.length&gt;0){coordString=this.getChildValue(nodeList[0]);coordString=coordString.replace(this.regExes.trimSpace,&quot;&quot;);coords=coordString.split(this.regExes.splitSpace);var dim=parseInt(nodeList[0].getAttribute(&quot;dimension&quot;));var j,x,y,z;for(var i=0;i&lt;coords.length/dim;++i){j=i*dim;x=coords[j];y=coords[j+1];z=(dim==2)?null:coords[j+2];if(this.xy){points.push(new OpenLayers.Geometry.Point(x,y,z));}else{points.push(new OpenLayers.Geometry.Point(y,x,z));}}}
if(coords.length==0){nodeList=this.getElementsByTagNameNS(node,this.gmlns,&quot;coordinates&quot;);if(nodeList.length&gt;0){coordString=this.getChildValue(nodeList[0]);coordString=coordString.replace(this.regExes.trimSpace,&quot;&quot;);coordString=coordString.replace(this.regExes.trimComma,&quot;,&quot;);var pointList=coordString.split(this.regExes.splitSpace);for(var i=0;i&lt;pointList.length;++i){coords=pointList[i].split(&quot;,&quot;);if(coords.length==2){coords[2]=null;}
if(this.xy){points.push(new OpenLayers.Geometry.Point(coords[0],coords[1],coords[2]));}else{points.push(new OpenLayers.Geometry.Point(coords[1],coords[0],coords[2]));}}}}
var line=null;if(points.length!=0){if(ring){line=new OpenLayers.Geometry.LinearRing(points);}else{line=new OpenLayers.Geometry.LineString(points);}}
return line;},multilinestring:function(node){var nodeList=this.getElementsByTagNameNS(node,this.gmlns,&quot;LineString&quot;);var components=[];if(nodeList.length&gt;0){var line;for(var i=0;i&lt;nodeList.length;++i){line=this.parseGeometry.linestring.apply(this,[nodeList[i]]);if(line){components.push(line);}}}
return new OpenLayers.Geometry.MultiLineString(components);},polygon:function(node){var nodeList=this.getElementsByTagNameNS(node,this.gmlns,&quot;LinearRing&quot;);var components=[];if(nodeList.length&gt;0){var ring;for(var i=0;i&lt;nodeList.length;++i){ring=this.parseGeometry.linestring.apply(this,[nodeList[i],true]);if(ring){components.push(ring);}}}
return new OpenLayers.Geometry.Polygon(components);},multipolygon:function(node){var nodeList=this.getElementsByTagNameNS(node,this.gmlns,&quot;Polygon&quot;);var components=[];if(nodeList.length&gt;0){var polygon;for(var i=0;i&lt;nodeList.length;++i){polygon=this.parseGeometry.polygon.apply(this,[nodeList[i]]);if(polygon){components.push(polygon);}}}
return new OpenLayers.Geometry.MultiPolygon(components);},envelope:function(node){var components=[];var coordString;var envelope;var lpoint=this.getElementsByTagNameNS(node,this.gmlns,&quot;lowerCorner&quot;);if(lpoint.length&gt;0){var coords=[];if(lpoint.length&gt;0){coordString=lpoint[0].firstChild.nodeValue;coordString=coordString.replace(this.regExes.trimSpace,&quot;&quot;);coords=coordString.split(this.regExes.splitSpace);}
if(coords.length==2){coords[2]=null;}
if(this.xy){var lowerPoint=new OpenLayers.Geometry.Point(coords[0],coords[1],coords[2]);}else{var lowerPoint=new OpenLayers.Geometry.Point(coords[1],coords[0],coords[2]);}}
var upoint=this.getElementsByTagNameNS(node,this.gmlns,&quot;upperCorner&quot;);if(upoint.length&gt;0){var coords=[];if(upoint.length&gt;0){coordString=upoint[0].firstChild.nodeValue;coordString=coordString.replace(this.regExes.trimSpace,&quot;&quot;);coords=coordString.split(this.regExes.splitSpace);}
if(coords.length==2){coords[2]=null;}
if(this.xy){var upperPoint=new OpenLayers.Geometry.Point(coords[0],coords[1],coords[2]);}else{var upperPoint=new OpenLayers.Geometry.Point(coords[1],coords[0],coords[2]);}}
if(lowerPoint&amp;&amp;upperPoint){components.push(new OpenLayers.Geometry.Point(lowerPoint.x,lowerPoint.y));components.push(new OpenLayers.Geometry.Point(upperPoint.x,lowerPoint.y));components.push(new OpenLayers.Geometry.Point(upperPoint.x,upperPoint.y));components.push(new OpenLayers.Geometry.Point(lowerPoint.x,upperPoint.y));components.push(new OpenLayers.Geometry.Point(lowerPoint.x,lowerPoint.y));var ring=new OpenLayers.Geometry.LinearRing(components);envelope=new OpenLayers.Geometry.Polygon([ring]);}
return envelope;}},parseAttributes:function(node){var attributes={};var childNode=node.firstChild;var children,i,child,grandchildren,grandchild,name,value;while(childNode){if(childNode.nodeType==1){children=childNode.childNodes;for(i=0;i&lt;children.length;++i){child=children[i];if(child.nodeType==1){grandchildren=child.childNodes;if(grandchildren.length==1){grandchild=grandchildren[0];if(grandchild.nodeType==3||grandchild.nodeType==4){name=(child.prefix)?child.nodeName.split(&quot;:&quot;)[1]:child.nodeName;value=grandchild.nodeValue.replace(this.regExes.trimSpace,&quot;&quot;);attributes[name]=value;}}else{attributes[child.nodeName.split(&quot;:&quot;).pop()]=null;}}}
break;}
childNode=childNode.nextSibling;}
return attributes;},write:function(features){if(!(features instanceof Array)){features=[features];}
var gml=this.createElementNS(&quot;http://www.opengis.net/wfs&quot;,&quot;wfs:&quot;+this.collectionName);for(var i=0;i&lt;features.length;i++){gml.appendChild(this.createFeatureXML(features[i]));}
return OpenLayers.Format.XML.prototype.write.apply(this,[gml]);},createFeatureXML:function(feature){var geometry=feature.geometry;var geometryNode=this.buildGeometryNode(geometry);var geomContainer=this.createElementNS(this.featureNS,this.featurePrefix+&quot;:&quot;+
this.geometryName);geomContainer.appendChild(geometryNode);var featureNode=this.createElementNS(this.gmlns,&quot;gml:&quot;+this.featureName);var featureContainer=this.createElementNS(this.featureNS,this.featurePrefix+&quot;:&quot;+
this.layerName);var fid=feature.fid||feature.id;featureContainer.setAttribute(&quot;fid&quot;,fid);featureContainer.appendChild(geomContainer);for(var attr in feature.attributes){var attrText=this.createTextNode(feature.attributes[attr]);var nodename=attr.substring(attr.lastIndexOf(&quot;:&quot;)+1);var attrContainer=this.createElementNS(this.featureNS,this.featurePrefix+&quot;:&quot;+
nodename);attrContainer.appendChild(attrText);featureContainer.appendChild(attrContainer);}
featureNode.appendChild(featureContainer);return featureNode;},buildGeometryNode:function(geometry){if(this.externalProjection&amp;&amp;this.internalProjection){geometry=geometry.clone();geometry.transform(this.internalProjection,this.externalProjection);}
var className=geometry.CLASS_NAME;var type=className.substring(className.lastIndexOf(&quot;.&quot;)+1);var builder=this.buildGeometry[type.toLowerCase()];return builder.apply(this,[geometry]);},buildGeometry:{point:function(geometry){var gml=this.createElementNS(this.gmlns,&quot;gml:Point&quot;);gml.appendChild(this.buildCoordinatesNode(geometry));return gml;},multipoint:function(geometry){var gml=this.createElementNS(this.gmlns,&quot;gml:MultiPoint&quot;);var points=geometry.components;var pointMember,pointGeom;for(var i=0;i&lt;points.length;i++){pointMember=this.createElementNS(this.gmlns,&quot;gml:pointMember&quot;);pointGeom=this.buildGeometry.point.apply(this,[points[i]]);pointMember.appendChild(pointGeom);gml.appendChild(pointMember);}
return gml;},linestring:function(geometry){var gml=this.createElementNS(this.gmlns,&quot;gml:LineString&quot;);gml.appendChild(this.buildCoordinatesNode(geometry));return gml;},multilinestring:function(geometry){var gml=this.createElementNS(this.gmlns,&quot;gml:MultiLineString&quot;);var lines=geometry.components;var lineMember,lineGeom;for(var i=0;i&lt;lines.length;++i){lineMember=this.createElementNS(this.gmlns,&quot;gml:lineStringMember&quot;);lineGeom=this.buildGeometry.linestring.apply(this,[lines[i]]);lineMember.appendChild(lineGeom);gml.appendChild(lineMember);}
return gml;},linearring:function(geometry){var gml=this.createElementNS(this.gmlns,&quot;gml:LinearRing&quot;);gml.appendChild(this.buildCoordinatesNode(geometry));return gml;},polygon:function(geometry){var gml=this.createElementNS(this.gmlns,&quot;gml:Polygon&quot;);var rings=geometry.components;var ringMember,ringGeom,type;for(var i=0;i&lt;rings.length;++i){type=(i==0)?&quot;outerBoundaryIs&quot;:&quot;innerBoundaryIs&quot;;ringMember=this.createElementNS(this.gmlns,&quot;gml:&quot;+type);ringGeom=this.buildGeometry.linearring.apply(this,[rings[i]]);ringMember.appendChild(ringGeom);gml.appendChild(ringMember);}
return gml;},multipolygon:function(geometry){var gml=this.createElementNS(this.gmlns,&quot;gml:MultiPolygon&quot;);var polys=geometry.components;var polyMember,polyGeom;for(var i=0;i&lt;polys.length;++i){polyMember=this.createElementNS(this.gmlns,&quot;gml:polygonMember&quot;);polyGeom=this.buildGeometry.polygon.apply(this,[polys[i]]);polyMember.appendChild(polyGeom);gml.appendChild(polyMember);}
return gml;},bounds:function(bounds){var gml=this.createElementNS(this.gmlns,&quot;gml:Box&quot;);gml.appendChild(this.buildCoordinatesNode(bounds));return gml;}},buildCoordinatesNode:function(geometry){var coordinatesNode=this.createElementNS(this.gmlns,&quot;gml:coordinates&quot;);coordinatesNode.setAttribute(&quot;decimal&quot;,&quot;.&quot;);coordinatesNode.setAttribute(&quot;cs&quot;,&quot;,&quot;);coordinatesNode.setAttribute(&quot;ts&quot;,&quot; &quot;);var parts=[];if(geometry instanceof OpenLayers.Bounds){parts.push(geometry.left+&quot;,&quot;+geometry.bottom);parts.push(geometry.right+&quot;,&quot;+geometry.top);}else{var points=(geometry.components)?geometry.components:[geometry];for(var i=0;i&lt;points.length;i++){parts.push(points[i].x+&quot;,&quot;+points[i].y);}}
var txtNode=this.createTextNode(parts.join(&quot; &quot;));coordinatesNode.appendChild(txtNode);return coordinatesNode;},CLASS_NAME:&quot;OpenLayers.Format.GML&quot;});OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{initialize:function(options){OpenLayers.Format.JSON.prototype.initialize.apply(this,[options]);},read:function(json,type,filter){type=(type)?type:&quot;FeatureCollection&quot;;var results=null;var obj=null;if(typeof json==&quot;string&quot;){obj=OpenLayers.Format.JSON.prototype.read.apply(this,[json,filter]);}else{obj=json;}
if(!obj){OpenLayers.Console.error(&quot;Bad JSON: &quot;+json);}else if(typeof(obj.type)!=&quot;string&quot;){OpenLayers.Console.error(&quot;Bad GeoJSON - no type: &quot;+json);}else if(this.isValidType(obj,type)){switch(type){case&quot;Geometry&quot;:try{results=this.parseGeometry(obj);}catch(err){OpenLayers.Console.error(err);}
break;case&quot;Feature&quot;:try{results=this.parseFeature(obj);results.type=&quot;Feature&quot;;}catch(err){OpenLayers.Console.error(err);}
break;case&quot;FeatureCollection&quot;:results=[];switch(obj.type){case&quot;Feature&quot;:try{results.push(this.parseFeature(obj));}catch(err){results=null;OpenLayers.Console.error(err);}
break;case&quot;FeatureCollection&quot;:for(var i=0,len=obj.features.length;i&lt;len;++i){try{results.push(this.parseFeature(obj.features[i]));}catch(err){results=null;OpenLayers.Console.error(err);}}
break;default:try{var geom=this.parseGeometry(obj);results.push(new OpenLayers.Feature.Vector(geom));}catch(err){results=null;OpenLayers.Console.error(err);}}
break;}}
return results;},isValidType:function(obj,type){var valid=false;switch(type){case&quot;Geometry&quot;:if(OpenLayers.Util.indexOf([&quot;Point&quot;,&quot;MultiPoint&quot;,&quot;LineString&quot;,&quot;MultiLineString&quot;,&quot;Polygon&quot;,&quot;MultiPolygon&quot;,&quot;Box&quot;,&quot;GeometryCollection&quot;],obj.type)==-1){OpenLayers.Console.error(&quot;Unsupported geometry type: &quot;+
obj.type);}else{valid=true;}
break;case&quot;FeatureCollection&quot;:valid=true;break;default:if(obj.type==type){valid=true;}else{OpenLayers.Console.error(&quot;Cannot convert types from &quot;+
obj.type+&quot; to &quot;+type);}}
return valid;},parseFeature:function(obj){var feature,geometry,attributes,bbox;attributes=(obj.properties)?obj.properties:{};bbox=(obj.geometry&amp;&amp;obj.geometry.bbox)||obj.bbox;try{geometry=this.parseGeometry(obj.geometry);}catch(err){throw err;}
feature=new OpenLayers.Feature.Vector(geometry,attributes);if(bbox){feature.bounds=OpenLayers.Bounds.fromArray(bbox);}
if(obj.id){feature.fid=obj.id;}
return feature;},parseGeometry:function(obj){if(obj==null){return null;}
var geometry,collection=false;if(obj.type==&quot;GeometryCollection&quot;){if(!(obj.geometries instanceof Array)){throw&quot;GeometryCollection must have geometries array: &quot;+obj;}
var numGeom=obj.geometries.length;var components=new Array(numGeom);for(var i=0;i&lt;numGeom;++i){components[i]=this.parseGeometry.apply(this,[obj.geometries[i]]);}
geometry=new OpenLayers.Geometry.Collection(components);collection=true;}else{if(!(obj.coordinates instanceof Array)){throw&quot;Geometry must have coordinates array: &quot;+obj;}
if(!this.parseCoords[obj.type.toLowerCase()]){throw&quot;Unsupported geometry type: &quot;+obj.type;}
try{geometry=this.parseCoords[obj.type.toLowerCase()].apply(this,[obj.coordinates]);}catch(err){throw err;}}
if(this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;!collection){geometry.transform(this.externalProjection,this.internalProjection);}
return geometry;},parseCoords:{&quot;point&quot;:function(array){if(array.length!=2){throw&quot;Only 2D points are supported: &quot;+array;}
return new OpenLayers.Geometry.Point(array[0],array[1]);},&quot;multipoint&quot;:function(array){var points=[];var p=null;for(var i=0,len=array.length;i&lt;len;++i){try{p=this.parseCoords[&quot;point&quot;].apply(this,[array[i]]);}catch(err){throw err;}
points.push(p);}
return new OpenLayers.Geometry.MultiPoint(points);},&quot;linestring&quot;:function(array){var points=[];var p=null;for(var i=0,len=array.length;i&lt;len;++i){try{p=this.parseCoords[&quot;point&quot;].apply(this,[array[i]]);}catch(err){throw err;}
points.push(p);}
return new OpenLayers.Geometry.LineString(points);},&quot;multilinestring&quot;:function(array){var lines=[];var l=null;for(var i=0,len=array.length;i&lt;len;++i){try{l=this.parseCoords[&quot;linestring&quot;].apply(this,[array[i]]);}catch(err){throw err;}
lines.push(l);}
return new OpenLayers.Geometry.MultiLineString(lines);},&quot;polygon&quot;:function(array){var rings=[];var r,l;for(var i=0,len=array.length;i&lt;len;++i){try{l=this.parseCoords[&quot;linestring&quot;].apply(this,[array[i]]);}catch(err){throw err;}
r=new OpenLayers.Geometry.LinearRing(l.components);rings.push(r);}
return new OpenLayers.Geometry.Polygon(rings);},&quot;multipolygon&quot;:function(array){var polys=[];var p=null;for(var i=0,len=array.length;i&lt;len;++i){try{p=this.parseCoords[&quot;polygon&quot;].apply(this,[array[i]]);}catch(err){throw err;}
polys.push(p);}
return new OpenLayers.Geometry.MultiPolygon(polys);},&quot;box&quot;:function(array){if(array.length!=2){throw&quot;GeoJSON box coordinates must have 2 elements&quot;;}
return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(array[0][0],array[0][1]),new OpenLayers.Geometry.Point(array[1][0],array[0][1]),new OpenLayers.Geometry.Point(array[1][0],array[1][1]),new OpenLayers.Geometry.Point(array[0][0],array[1][1]),new OpenLayers.Geometry.Point(array[0][0],array[0][1])])]);}},write:function(obj,pretty){var geojson={&quot;type&quot;:null};if(obj instanceof Array){geojson.type=&quot;FeatureCollection&quot;;var numFeatures=obj.length;geojson.features=new Array(numFeatures);for(var i=0;i&lt;numFeatures;++i){var element=obj[i];if(!element instanceof OpenLayers.Feature.Vector){var msg=&quot;FeatureCollection only supports collections &quot;+&quot;of features: &quot;+element;throw msg;}
geojson.features[i]=this.extract.feature.apply(this,[element]);}}else if(obj.CLASS_NAME.indexOf(&quot;OpenLayers.Geometry&quot;)==0){geojson=this.extract.geometry.apply(this,[obj]);}else if(obj instanceof OpenLayers.Feature.Vector){geojson=this.extract.feature.apply(this,[obj]);if(obj.layer&amp;&amp;obj.layer.projection){geojson.crs=this.createCRSObject(obj);}}
return OpenLayers.Format.JSON.prototype.write.apply(this,[geojson,pretty]);},createCRSObject:function(object){var proj=object.layer.projection.toString();var crs={};if(proj.match(/epsg:/i)){var code=parseInt(proj.substring(proj.indexOf(&quot;:&quot;)+1));if(code==4326){crs={&quot;type&quot;:&quot;OGC&quot;,&quot;properties&quot;:{&quot;urn&quot;:&quot;urn:ogc:def:crs:OGC:1.3:CRS84&quot;}};}else{crs={&quot;type&quot;:&quot;EPSG&quot;,&quot;properties&quot;:{&quot;code&quot;:code}};}}
return crs;},extract:{&apos;feature&apos;:function(feature){var geom=this.extract.geometry.apply(this,[feature.geometry]);return{&quot;type&quot;:&quot;Feature&quot;,&quot;id&quot;:feature.fid==null?feature.id:feature.fid,&quot;properties&quot;:feature.attributes,&quot;geometry&quot;:geom};},&apos;geometry&apos;:function(geometry){if(geometry==null){return null;}
if(this.internalProjection&amp;&amp;this.externalProjection){geometry=geometry.clone();geometry.transform(this.internalProjection,this.externalProjection);}
var geometryType=geometry.CLASS_NAME.split(&apos;.&apos;)[2];var data=this.extract[geometryType.toLowerCase()].apply(this,[geometry]);var json;if(geometryType==&quot;Collection&quot;){json={&quot;type&quot;:&quot;GeometryCollection&quot;,&quot;geometries&quot;:data};}else{json={&quot;type&quot;:geometryType,&quot;coordinates&quot;:data};}
return json;},&apos;point&apos;:function(point){return[point.x,point.y];},&apos;multipoint&apos;:function(multipoint){var array=[];for(var i=0,len=multipoint.components.length;i&lt;len;++i){array.push(this.extract.point.apply(this,[multipoint.components[i]]));}
return array;},&apos;linestring&apos;:function(linestring){var array=[];for(var i=0,len=linestring.components.length;i&lt;len;++i){array.push(this.extract.point.apply(this,[linestring.components[i]]));}
return array;},&apos;multilinestring&apos;:function(multilinestring){var array=[];for(var i=0,len=multilinestring.components.length;i&lt;len;++i){array.push(this.extract.linestring.apply(this,[multilinestring.components[i]]));}
return array;},&apos;polygon&apos;:function(polygon){var array=[];for(var i=0,len=polygon.components.length;i&lt;len;++i){array.push(this.extract.linestring.apply(this,[polygon.components[i]]));}
return array;},&apos;multipolygon&apos;:function(multipolygon){var array=[];for(var i=0,len=multipolygon.components.length;i&lt;len;++i){array.push(this.extract.polygon.apply(this,[multipolygon.components[i]]));}
return array;},&apos;collection&apos;:function(collection){var len=collection.components.length;var array=new Array(len);for(var i=0;i&lt;len;++i){array[i]=this.extract.geometry.apply(this,[collection.components[i]]);}
return array;}},CLASS_NAME:&quot;OpenLayers.Format.GeoJSON&quot;});OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);},read:function(data){var axl=new OpenLayers.Format.ArcXML();var parsed=axl.read(data);return parsed.features.feature;}});if(!OpenLayers.Format.GML){OpenLayers.Format.GML={};}
OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:&quot;http://www.opengis.net/gml&quot;,xlink:&quot;http://www.w3.org/1999/xlink&quot;,xsi:&quot;http://www.w3.org/2001/XMLSchema-instance&quot;,wfs:&quot;http://www.opengis.net/wfs&quot;},defaultPrefix:&quot;gml&quot;,schemaLocation:null,featureType:null,featureNS:null,geometryName:&quot;geometry&quot;,extractAttributes:true,srsName:null,xy:true,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(options){OpenLayers.Format.XML.prototype.initialize.apply(this,[options]);this.setGeometryTypes();if(options&amp;&amp;options.featureNS){this.setNamespace(&quot;feature&quot;,options.featureNS);}
this.singleFeatureType=!options||(typeof options.featureType===&quot;string&quot;);},read:function(data){if(typeof data==&quot;string&quot;){data=OpenLayers.Format.XML.prototype.read.apply(this,[data]);}
if(data&amp;&amp;data.nodeType==9){data=data.documentElement;}
var features=[];this.readNode(data,{features:features});if(features.length==0){var elements=this.getElementsByTagNameNS(data,this.namespaces.gml,&quot;featureMember&quot;);if(elements.length){for(var i=0,len=elements.length;i&lt;len;++i){this.readNode(elements[i],{features:features});}}else{var elements=this.getElementsByTagNameNS(data,this.namespaces.gml,&quot;featureMembers&quot;);if(elements.length){this.readNode(elements[0],{features:features});}}}
return features;},readers:{&quot;gml&quot;:{&quot;featureMember&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;featureMembers&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;name&quot;:function(node,obj){obj.name=this.getChildValue(node);},&quot;boundedBy&quot;:function(node,obj){var container={};this.readChildNodes(node,container);if(container.components&amp;&amp;container.components.length&gt;0){obj.bounds=container.components[0];}},&quot;Point&quot;:function(node,container){var obj={points:[]};this.readChildNodes(node,obj);if(!container.components){container.components=[];}
container.components.push(obj.points[0]);},&quot;coordinates&quot;:function(node,obj){var str=this.getChildValue(node).replace(this.regExes.trimSpace,&quot;&quot;);str=str.replace(this.regExes.trimComma,&quot;,&quot;);var pointList=str.split(this.regExes.splitSpace);var coords;var numPoints=pointList.length;var points=new Array(numPoints);for(var i=0;i&lt;numPoints;++i){coords=pointList[i].split(&quot;,&quot;);if(this.xy){points[i]=new OpenLayers.Geometry.Point(coords[0],coords[1],coords[2]);}else{points[i]=new OpenLayers.Geometry.Point(coords[1],coords[0],coords[2]);}}
obj.points=points;},&quot;coord&quot;:function(node,obj){var coord={};this.readChildNodes(node,coord);if(!obj.points){obj.points=[];}
obj.points.push(new OpenLayers.Geometry.Point(coord.x,coord.y,coord.z));},&quot;X&quot;:function(node,coord){coord.x=this.getChildValue(node);},&quot;Y&quot;:function(node,coord){coord.y=this.getChildValue(node);},&quot;Z&quot;:function(node,coord){coord.z=this.getChildValue(node);},&quot;MultiPoint&quot;:function(node,container){var obj={components:[]};this.readChildNodes(node,obj);container.components=[new OpenLayers.Geometry.MultiPoint(obj.components)];},&quot;pointMember&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;LineString&quot;:function(node,container){var obj={};this.readChildNodes(node,obj);if(!container.components){container.components=[];}
container.components.push(new OpenLayers.Geometry.LineString(obj.points));},&quot;MultiLineString&quot;:function(node,container){var obj={components:[]};this.readChildNodes(node,obj);container.components=[new OpenLayers.Geometry.MultiLineString(obj.components)];},&quot;lineStringMember&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;Polygon&quot;:function(node,container){var obj={outer:null,inner:[]};this.readChildNodes(node,obj);obj.inner.unshift(obj.outer);if(!container.components){container.components=[];}
container.components.push(new OpenLayers.Geometry.Polygon(obj.inner));},&quot;LinearRing&quot;:function(node,obj){var container={};this.readChildNodes(node,container);obj.components=[new OpenLayers.Geometry.LinearRing(container.points)];},&quot;MultiPolygon&quot;:function(node,container){var obj={components:[]};this.readChildNodes(node,obj);container.components=[new OpenLayers.Geometry.MultiPolygon(obj.components)];},&quot;polygonMember&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;GeometryCollection&quot;:function(node,container){var obj={components:[]};this.readChildNodes(node,obj);container.components=[new OpenLayers.Geometry.Collection(obj.components)];},&quot;geometryMember&quot;:function(node,obj){this.readChildNodes(node,obj);}},&quot;feature&quot;:{&quot;*&quot;:function(node,obj){var name;var local=node.localName||node.nodeName.split(&quot;:&quot;).pop();if(!this.singleFeatureType&amp;&amp;(OpenLayers.Util.indexOf(this.featureType,local)!=-1)){name=&quot;_typeName&quot;;}
else if(local==this.featureType){name=&quot;_typeName&quot;;}else{if(node.childNodes.length==0||(node.childNodes.length==1&amp;&amp;node.firstChild.nodeType==3)){if(this.extractAttributes){name=&quot;_attribute&quot;;}}else{name=&quot;_geometry&quot;;}}
if(name){this.readers.feature[name].apply(this,[node,obj]);}},&quot;_typeName&quot;:function(node,obj){var container={components:[],attributes:{}};this.readChildNodes(node,container);if(container.name){container.attributes.name=container.name;}
var feature=new OpenLayers.Feature.Vector(container.components[0],container.attributes);if(!this.singleFeatureType){feature.type=node.nodeName.split(&quot;:&quot;).pop();feature.namespace=node.namespaceURI;}
var fid=node.getAttribute(&quot;fid&quot;)||this.getAttributeNS(node,this.namespaces[&quot;gml&quot;],&quot;id&quot;);if(fid){feature.fid=fid;}
if(this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;feature.geometry){feature.geometry.transform(this.externalProjection,this.internalProjection);}
if(container.bounds){feature.geometry.bounds=container.bounds;}
obj.features.push(feature);},&quot;_geometry&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;_attribute&quot;:function(node,obj){var local=node.localName||node.nodeName.split(&quot;:&quot;).pop();var value=this.getChildValue(node);obj.attributes[local]=value;}},&quot;wfs&quot;:{&quot;FeatureCollection&quot;:function(node,obj){this.readChildNodes(node,obj);}}},write:function(features){var name;if(features instanceof Array){name=&quot;featureMembers&quot;;}else{name=&quot;featureMember&quot;;}
var root=this.writeNode(&quot;gml:&quot;+name,features);this.setAttributeNS(root,this.namespaces[&quot;xsi&quot;],&quot;xsi:schemaLocation&quot;,this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[root]);},writers:{&quot;gml&quot;:{&quot;featureMember&quot;:function(feature){var node=this.createElementNSPlus(&quot;gml:featureMember&quot;);this.writeNode(&quot;feature:_typeName&quot;,feature,node);return node;},&quot;MultiPoint&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:MultiPoint&quot;);for(var i=0;i&lt;geometry.components.length;++i){this.writeNode(&quot;pointMember&quot;,geometry.components[i],node);}
return node;},&quot;pointMember&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:pointMember&quot;);this.writeNode(&quot;Point&quot;,geometry,node);return node;},&quot;MultiLineString&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:MultiLineString&quot;);for(var i=0;i&lt;geometry.components.length;++i){this.writeNode(&quot;lineStringMember&quot;,geometry.components[i],node);}
return node;},&quot;lineStringMember&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:lineStringMember&quot;);this.writeNode(&quot;LineString&quot;,geometry,node);return node;},&quot;MultiPolygon&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:MultiPolygon&quot;);for(var i=0;i&lt;geometry.components.length;++i){this.writeNode(&quot;polygonMember&quot;,geometry.components[i],node);}
return node;},&quot;polygonMember&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:polygonMember&quot;);this.writeNode(&quot;Polygon&quot;,geometry,node);return node;},&quot;GeometryCollection&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:GeometryCollection&quot;);for(var i=0,len=geometry.components.length;i&lt;len;++i){this.writeNode(&quot;geometryMember&quot;,geometry.components[i],node);}
return node;},&quot;geometryMember&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:geometryMember&quot;);var child=this.writeNode(&quot;feature:_geometry&quot;,geometry);node.appendChild(child.firstChild);return node;}},&quot;feature&quot;:{&quot;_typeName&quot;:function(feature){var node=this.createElementNSPlus(&quot;feature:&quot;+this.featureType,{attributes:{fid:feature.fid}});if(feature.geometry){this.writeNode(&quot;feature:_geometry&quot;,feature.geometry,node);}
for(var name in feature.attributes){var value=feature.attributes[name];if(value!=null){this.writeNode(&quot;feature:_attribute&quot;,{name:name,value:value},node);}}
return node;},&quot;_geometry&quot;:function(geometry){if(this.externalProjection&amp;&amp;this.internalProjection){geometry=geometry.clone().transform(this.internalProjection,this.externalProjection);}
var node=this.createElementNSPlus(&quot;feature:&quot;+this.geometryName);var type=this.geometryTypes[geometry.CLASS_NAME];var child=this.writeNode(&quot;gml:&quot;+type,geometry,node);if(this.srsName){child.setAttribute(&quot;srsName&quot;,this.srsName);}
return node;},&quot;_attribute&quot;:function(obj){return this.createElementNSPlus(&quot;feature:&quot;+obj.name,{value:obj.value});}},&quot;wfs&quot;:{&quot;FeatureCollection&quot;:function(features){var node=this.createElementNSPlus(&quot;wfs:FeatureCollection&quot;);for(var i=0,len=features.length;i&lt;len;++i){this.writeNode(&quot;gml:featureMember&quot;,features[i],node);}
return node;}}},setGeometryTypes:function(){this.geometryTypes={&quot;OpenLayers.Geometry.Point&quot;:&quot;Point&quot;,&quot;OpenLayers.Geometry.MultiPoint&quot;:&quot;MultiPoint&quot;,&quot;OpenLayers.Geometry.LineString&quot;:&quot;LineString&quot;,&quot;OpenLayers.Geometry.MultiLineString&quot;:&quot;MultiLineString&quot;,&quot;OpenLayers.Geometry.Polygon&quot;:&quot;Polygon&quot;,&quot;OpenLayers.Geometry.MultiPolygon&quot;:&quot;MultiPolygon&quot;,&quot;OpenLayers.Geometry.Collection&quot;:&quot;GeometryCollection&quot;};},CLASS_NAME:&quot;OpenLayers.Format.GML.Base&quot;});OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:&quot;http://www.opengis.net/wfs&quot;,ogcns:&quot;http://www.opengis.net/ogc&quot;,initialize:function(options,layer){OpenLayers.Format.GML.prototype.initialize.apply(this,[options]);this.layer=layer;if(this.layer.featureNS){this.featureNS=this.layer.featureNS;}
if(this.layer.options.geometry_column){this.geometryName=this.layer.options.geometry_column;}
if(this.layer.options.typename){this.featureName=this.layer.options.typename;}},write:function(features){var transaction=this.createElementNS(this.wfsns,&apos;wfs:Transaction&apos;);transaction.setAttribute(&quot;version&quot;,&quot;1.0.0&quot;);transaction.setAttribute(&quot;service&quot;,&quot;WFS&quot;);for(var i=0;i&lt;features.length;i++){switch(features[i].state){case OpenLayers.State.INSERT:transaction.appendChild(this.insert(features[i]));break;case OpenLayers.State.UPDATE:transaction.appendChild(this.update(features[i]));break;case OpenLayers.State.DELETE:transaction.appendChild(this.remove(features[i]));break;}}
return OpenLayers.Format.XML.prototype.write.apply(this,[transaction]);},createFeatureXML:function(feature){var geometryNode=this.buildGeometryNode(feature.geometry);var geomContainer=this.createElementNS(this.featureNS,&quot;feature:&quot;+this.geometryName);geomContainer.appendChild(geometryNode);var featureContainer=this.createElementNS(this.featureNS,&quot;feature:&quot;+this.featureName);featureContainer.appendChild(geomContainer);for(var attr in feature.attributes){var attrText=this.createTextNode(feature.attributes[attr]);var nodename=attr;if(attr.search(&quot;:&quot;)!=-1){nodename=attr.split(&quot;:&quot;)[1];}
var attrContainer=this.createElementNS(this.featureNS,&quot;feature:&quot;+nodename);attrContainer.appendChild(attrText);featureContainer.appendChild(attrContainer);}
return featureContainer;},insert:function(feature){var insertNode=this.createElementNS(this.wfsns,&apos;wfs:Insert&apos;);insertNode.appendChild(this.createFeatureXML(feature));return insertNode;},update:function(feature){if(!feature.fid){OpenLayers.Console.userError(OpenLayers.i18n(&quot;noFID&quot;));}
var updateNode=this.createElementNS(this.wfsns,&apos;wfs:Update&apos;);updateNode.setAttribute(&quot;typeName&quot;,this.featurePrefix+&apos;:&apos;+this.featureName);updateNode.setAttribute(&quot;xmlns:&quot;+this.featurePrefix,this.featureNS);var propertyNode=this.createElementNS(this.wfsns,&apos;wfs:Property&apos;);var nameNode=this.createElementNS(this.wfsns,&apos;wfs:Name&apos;);var txtNode=this.createTextNode(this.geometryName);nameNode.appendChild(txtNode);propertyNode.appendChild(nameNode);var valueNode=this.createElementNS(this.wfsns,&apos;wfs:Value&apos;);var geometryNode=this.buildGeometryNode(feature.geometry);if(feature.layer){geometryNode.setAttribute(&quot;srsName&quot;,feature.layer.projection.getCode());}
valueNode.appendChild(geometryNode);propertyNode.appendChild(valueNode);updateNode.appendChild(propertyNode);for(var propName in feature.attributes){propertyNode=this.createElementNS(this.wfsns,&apos;wfs:Property&apos;);nameNode=this.createElementNS(this.wfsns,&apos;wfs:Name&apos;);nameNode.appendChild(this.createTextNode(propName));propertyNode.appendChild(nameNode);valueNode=this.createElementNS(this.wfsns,&apos;wfs:Value&apos;);valueNode.appendChild(this.createTextNode(feature.attributes[propName]));propertyNode.appendChild(valueNode);updateNode.appendChild(propertyNode);}
var filterNode=this.createElementNS(this.ogcns,&apos;ogc:Filter&apos;);var filterIdNode=this.createElementNS(this.ogcns,&apos;ogc:FeatureId&apos;);filterIdNode.setAttribute(&quot;fid&quot;,feature.fid);filterNode.appendChild(filterIdNode);updateNode.appendChild(filterNode);return updateNode;},remove:function(feature){if(!feature.fid){OpenLayers.Console.userError(OpenLayers.i18n(&quot;noFID&quot;));return false;}
var deleteNode=this.createElementNS(this.wfsns,&apos;wfs:Delete&apos;);deleteNode.setAttribute(&quot;typeName&quot;,this.featurePrefix+&apos;:&apos;+this.featureName);deleteNode.setAttribute(&quot;xmlns:&quot;+this.featurePrefix,this.featureNS);var filterNode=this.createElementNS(this.ogcns,&apos;ogc:Filter&apos;);var filterIdNode=this.createElementNS(this.ogcns,&apos;ogc:FeatureId&apos;);filterIdNode.setAttribute(&quot;fid&quot;,feature.fid);filterNode.appendChild(filterIdNode);deleteNode.appendChild(filterNode);return deleteNode;},destroy:function(){this.layer=null;},CLASS_NAME:&quot;OpenLayers.Format.WFS&quot;});OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:&quot;9.2&quot;,ServiceName:&apos;&apos;},tileSize:null,featureCoordSys:&quot;4326&quot;,filterCoordSys:&quot;4326&quot;,layers:null,async:true,name:&quot;ArcIMS&quot;,isBaseLayer:true,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:&quot;4326&quot;,filterCoordSys:&quot;4326&quot;,layers:null,isBaseLayer:true,async:true,name:&quot;ArcIMS&quot;},initialize:function(name,url,options){this.tileSize=new OpenLayers.Size(512,512);this.params=OpenLayers.Util.applyDefaults({ServiceName:options.serviceName},this.DEFAULT_PARAMS);this.options=OpenLayers.Util.applyDefaults(options,this.DEFAULT_OPTIONS);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[name,url,this.params,options]);if(this.transparent){if(!this.isBaseLayer){this.isBaseLayer=false;}
if(this.format==&quot;image/jpeg&quot;){this.format=OpenLayers.Util.alphaHack()?&quot;image/gif&quot;:&quot;image/png&quot;;}}
if(this.options.layers===null){this.options.layers=[];}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);},getURL:function(bounds){var url=&quot;&quot;;bounds=this.adjustBounds(bounds);var axlReq=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:&quot;image&quot;,envelope:bounds.toArray(),tileSize:this.tileSize}));var req=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:axlReq.write(),async:false});if(req!=null){var doc=req.responseXML;if(!doc||!doc.documentElement){doc=req.responseText;}
var axlResp=new OpenLayers.Format.ArcXML();var arcxml=axlResp.read(doc);url=this.getUrlOrImage(arcxml.image.output);}
return url;},getURLasync:function(bounds,scope,prop,callback){bounds=this.adjustBounds(bounds);var axlReq=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:&quot;image&quot;,envelope:bounds.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(),async:true,data:axlReq.write(),callback:function(req){var doc=req.responseXML;if(!doc||!doc.documentElement){doc=req.responseText;}
var axlResp=new OpenLayers.Format.ArcXML();var arcxml=axlResp.read(doc);scope[prop]=this.getUrlOrImage(arcxml.image.output);callback.apply(scope);},scope:this});},getUrlOrImage:function(output){var ret=&quot;&quot;;if(output.url){ret=output.url;}else if(output.data){ret=&quot;data:image/&quot;+output.type+&quot;;base64,&quot;+output.data;}
return ret;},setLayerQuery:function(id,querydef){for(var lyr=0;lyr&lt;this.options.layers.length;lyr++){if(id==this.options.layers[lyr].id){this.options.layers[lyr].query=querydef;return;}}
this.options.layers.push({id:id,visible:true,query:querydef});},getFeatureInfo:function(geometry,layer,options){var buffer=options.buffer||1;var callback=options.callback||function(){};var scope=options.scope||window;var requestOptions={};OpenLayers.Util.extend(requestOptions,this.options);requestOptions.requesttype=&quot;feature&quot;;if(geometry instanceof OpenLayers.LonLat){requestOptions.polygon=null;requestOptions.envelope=[geometry.lon-buffer,geometry.lat-buffer,geometry.lon+buffer,geometry.lat+buffer];}else if(geometry instanceof OpenLayers.Geometry.Polygon){requestOptions.envelope=null;requestOptions.polygon=geometry;}
var arcxml=new OpenLayers.Format.ArcXML(requestOptions);OpenLayers.Util.extend(arcxml.request.get_feature,options);arcxml.request.get_feature.layer=layer.id;if(typeof layer.query.accuracy==&quot;number&quot;){arcxml.request.get_feature.query.accuracy=layer.query.accuracy;}else{var mapCenter=this.map.getCenter();var viewPx=this.map.getViewPortPxFromLonLat(mapCenter);viewPx.x++;var mapOffCenter=this.map.getLonLatFromPixel(viewPx);arcxml.request.get_feature.query.accuracy=mapOffCenter.lon-mapCenter.lon;}
arcxml.request.get_feature.query.where=layer.query.where;arcxml.request.get_feature.query.spatialfilter.relation=&quot;area_intersection&quot;;OpenLayers.Request.POST({url:this.getFullRequestString({&apos;CustomService&apos;:&apos;Query&apos;}),data:arcxml.write(),callback:function(request){var response=arcxml.parseResponse(request.responseText);if(!arcxml.iserror()){callback.call(scope,response.features);}else{callback.call(scope,null);}}});},addTile:function(bounds,position){return new OpenLayers.Tile.Image(this,position,bounds,null,this.tileSize);},CLASS_NAME:&quot;OpenLayers.Layer.ArcIMS&quot;});OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:&quot;http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd&quot;,initialize:function(options){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[options]);},readers:{&quot;gml&quot;:OpenLayers.Util.applyDefaults({&quot;outerBoundaryIs&quot;:function(node,container){var obj={};this.readChildNodes(node,obj);container.outer=obj.components[0];},&quot;innerBoundaryIs&quot;:function(node,container){var obj={};this.readChildNodes(node,obj);container.inner.push(obj.components[0]);},&quot;Box&quot;:function(node,container){var obj={};this.readChildNodes(node,obj);if(!container.components){container.components=[];}
var min=obj.points[0];var max=obj.points[1];container.components.push(new OpenLayers.Bounds(min.x,min.y,max.x,max.y));}},OpenLayers.Format.GML.Base.prototype.readers[&quot;gml&quot;]),&quot;feature&quot;:OpenLayers.Format.GML.Base.prototype.readers[&quot;feature&quot;],&quot;wfs&quot;:OpenLayers.Format.GML.Base.prototype.readers[&quot;wfs&quot;]},write:function(features){var name;if(features instanceof Array){name=&quot;wfs:FeatureCollection&quot;;}else{name=&quot;gml:featureMember&quot;;}
var root=this.writeNode(name,features);this.setAttributeNS(root,this.namespaces[&quot;xsi&quot;],&quot;xsi:schemaLocation&quot;,this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[root]);},writers:{&quot;gml&quot;:OpenLayers.Util.applyDefaults({&quot;Point&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:Point&quot;);this.writeNode(&quot;coordinates&quot;,[geometry],node);return node;},&quot;coordinates&quot;:function(points){var numPoints=points.length;var parts=new Array(numPoints);var point;for(var i=0;i&lt;numPoints;++i){point=points[i];if(this.xy){parts[i]=point.x+&quot;,&quot;+point.y;}else{parts[i]=point.y+&quot;,&quot;+point.x;}
if(point.z!=undefined){parts[i]+=&quot;,&quot;+point.z;}}
return this.createElementNSPlus(&quot;gml:coordinates&quot;,{attributes:{decimal:&quot;.&quot;,cs:&quot;,&quot;,ts:&quot; &quot;},value:(numPoints==1)?parts[0]:parts.join(&quot; &quot;)});},&quot;LineString&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:LineString&quot;);this.writeNode(&quot;coordinates&quot;,geometry.components,node);return node;},&quot;Polygon&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:Polygon&quot;);this.writeNode(&quot;outerBoundaryIs&quot;,geometry.components[0],node);for(var i=1;i&lt;geometry.components.length;++i){this.writeNode(&quot;innerBoundaryIs&quot;,geometry.components[i],node);}
return node;},&quot;outerBoundaryIs&quot;:function(ring){var node=this.createElementNSPlus(&quot;gml:outerBoundaryIs&quot;);this.writeNode(&quot;LinearRing&quot;,ring,node);return node;},&quot;innerBoundaryIs&quot;:function(ring){var node=this.createElementNSPlus(&quot;gml:innerBoundaryIs&quot;);this.writeNode(&quot;LinearRing&quot;,ring,node);return node;},&quot;LinearRing&quot;:function(ring){var node=this.createElementNSPlus(&quot;gml:LinearRing&quot;);this.writeNode(&quot;coordinates&quot;,ring.components,node);return node;},&quot;Box&quot;:function(bounds){var node=this.createElementNSPlus(&quot;gml:Box&quot;);this.writeNode(&quot;coordinates&quot;,[{x:bounds.left,y:bounds.bottom},{x:bounds.right,y:bounds.top}],node);if(this.srsName){node.setAttribute(&quot;srsName&quot;,this.srsName);}
return node;}},OpenLayers.Format.GML.Base.prototype.writers[&quot;gml&quot;]),&quot;feature&quot;:OpenLayers.Format.GML.Base.prototype.writers[&quot;feature&quot;],&quot;wfs&quot;:OpenLayers.Format.GML.Base.prototype.writers[&quot;wfs&quot;]},CLASS_NAME:&quot;OpenLayers.Format.GML.v2&quot;});OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:&quot;http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd&quot;,curve:false,multiCurve:true,surface:false,multiSurface:true,initialize:function(options){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[options]);},readers:{&quot;gml&quot;:OpenLayers.Util.applyDefaults({&quot;featureMembers&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;Curve&quot;:function(node,container){var obj={points:[]};this.readChildNodes(node,obj);if(!container.components){container.components=[];}
container.components.push(new OpenLayers.Geometry.LineString(obj.points));},&quot;segments&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;LineStringSegment&quot;:function(node,container){var obj={};this.readChildNodes(node,obj);if(obj.points){Array.prototype.push.apply(container.points,obj.points);}},&quot;pos&quot;:function(node,obj){var str=this.getChildValue(node).replace(this.regExes.trimSpace,&quot;&quot;);var coords=str.split(this.regExes.splitSpace);var point;if(this.xy){point=new OpenLayers.Geometry.Point(coords[0],coords[1],coords[2]);}else{point=new OpenLayers.Geometry.Point(coords[1],coords[0],coords[2]);}
obj.points=[point];},&quot;posList&quot;:function(node,obj){var str=this.getChildValue(node).replace(this.regExes.trimSpace,&quot;&quot;);var coords=str.split(this.regExes.splitSpace);var dim=parseInt(node.getAttribute(&quot;dimension&quot;))||2;var j,x,y,z;var numPoints=coords.length/dim;var points=new Array(numPoints);for(var i=0,len=coords.length;i&lt;len;i+=dim){x=coords[i];y=coords[i+1];z=(dim==2)?undefined:coords[i+2];if(this.xy){points[i/dim]=new OpenLayers.Geometry.Point(x,y,z);}else{points[i/dim]=new OpenLayers.Geometry.Point(y,x,z);}}
obj.points=points;},&quot;Surface&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;patches&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;PolygonPatch&quot;:function(node,obj){this.readers.gml.Polygon.apply(this,[node,obj]);},&quot;exterior&quot;:function(node,container){var obj={};this.readChildNodes(node,obj);container.outer=obj.components[0];},&quot;interior&quot;:function(node,container){var obj={};this.readChildNodes(node,obj);container.inner.push(obj.components[0]);},&quot;MultiCurve&quot;:function(node,container){var obj={components:[]};this.readChildNodes(node,obj);if(obj.components.length&gt;0){container.components=[new OpenLayers.Geometry.MultiLineString(obj.components)];}},&quot;curveMember&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;MultiSurface&quot;:function(node,container){var obj={components:[]};this.readChildNodes(node,obj);if(obj.components.length&gt;0){container.components=[new OpenLayers.Geometry.MultiPolygon(obj.components)];}},&quot;surfaceMember&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;surfaceMembers&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;pointMembers&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;lineStringMembers&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;polygonMembers&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;geometryMembers&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;Envelope&quot;:function(node,container){var obj={points:new Array(2)};this.readChildNodes(node,obj);if(!container.components){container.components=[];}
var min=obj.points[0];var max=obj.points[1];container.components.push(new OpenLayers.Bounds(min.x,min.y,max.x,max.y));},&quot;lowerCorner&quot;:function(node,container){var obj={};this.readers.gml.pos.apply(this,[node,obj]);container.points[0]=obj.points[0];},&quot;upperCorner&quot;:function(node,container){var obj={};this.readers.gml.pos.apply(this,[node,obj]);container.points[1]=obj.points[0];}},OpenLayers.Format.GML.Base.prototype.readers[&quot;gml&quot;]),&quot;feature&quot;:OpenLayers.Format.GML.Base.prototype.readers[&quot;feature&quot;],&quot;wfs&quot;:OpenLayers.Format.GML.Base.prototype.readers[&quot;wfs&quot;]},write:function(features){var name;if(features instanceof Array){name=&quot;featureMembers&quot;;}else{name=&quot;featureMember&quot;;}
var root=this.writeNode(&quot;gml:&quot;+name,features);this.setAttributeNS(root,this.namespaces[&quot;xsi&quot;],&quot;xsi:schemaLocation&quot;,this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[root]);},writers:{&quot;gml&quot;:OpenLayers.Util.applyDefaults({&quot;featureMembers&quot;:function(features){var node=this.createElementNSPlus(&quot;gml:featureMembers&quot;);for(var i=0,len=features.length;i&lt;len;++i){this.writeNode(&quot;feature:_typeName&quot;,features[i],node);}
return node;},&quot;Point&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:Point&quot;);this.writeNode(&quot;pos&quot;,geometry,node);return node;},&quot;pos&quot;:function(point){var pos=(this.xy)?(point.x+&quot; &quot;+point.y):(point.y+&quot; &quot;+point.x);return this.createElementNSPlus(&quot;gml:pos&quot;,{value:pos});},&quot;LineString&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:LineString&quot;);this.writeNode(&quot;posList&quot;,geometry.components,node);return node;},&quot;Curve&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:Curve&quot;);this.writeNode(&quot;segments&quot;,geometry,node);return node;},&quot;segments&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:segments&quot;);this.writeNode(&quot;LineStringSegment&quot;,geometry,node);return node;},&quot;LineStringSegment&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:LineStringSegment&quot;);this.writeNode(&quot;posList&quot;,geometry.components,node);return node;},&quot;posList&quot;:function(points){var len=points.length;var parts=new Array(len);var point;for(var i=0;i&lt;len;++i){point=points[i];if(this.xy){parts[i]=point.x+&quot; &quot;+point.y;}else{parts[i]=point.y+&quot; &quot;+point.x;}}
return this.createElementNSPlus(&quot;gml:posList&quot;,{value:parts.join(&quot; &quot;)});},&quot;Surface&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:Surface&quot;);this.writeNode(&quot;patches&quot;,geometry,node);return node;},&quot;patches&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:patches&quot;);this.writeNode(&quot;PolygonPatch&quot;,geometry,node);return node;},&quot;PolygonPatch&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:PolygonPatch&quot;,{attributes:{interpolation:&quot;planar&quot;}});this.writeNode(&quot;exterior&quot;,geometry.components[0],node);for(var i=1,len=geometry.components.length;i&lt;len;++i){this.writeNode(&quot;interior&quot;,geometry.components[i],node);}
return node;},&quot;Polygon&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:Polygon&quot;);this.writeNode(&quot;exterior&quot;,geometry.components[0],node);for(var i=1,len=geometry.components.length;i&lt;len;++i){this.writeNode(&quot;interior&quot;,geometry.components[i],node);}
return node;},&quot;exterior&quot;:function(ring){var node=this.createElementNSPlus(&quot;gml:exterior&quot;);this.writeNode(&quot;LinearRing&quot;,ring,node);return node;},&quot;interior&quot;:function(ring){var node=this.createElementNSPlus(&quot;gml:interior&quot;);this.writeNode(&quot;LinearRing&quot;,ring,node);return node;},&quot;LinearRing&quot;:function(ring){var node=this.createElementNSPlus(&quot;gml:LinearRing&quot;);this.writeNode(&quot;posList&quot;,ring.components,node);return node;},&quot;MultiCurve&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:MultiCurve&quot;);for(var i=0,len=geometry.components.length;i&lt;len;++i){this.writeNode(&quot;curveMember&quot;,geometry.components[i],node);}
return node;},&quot;curveMember&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:curveMember&quot;);if(this.curve){this.writeNode(&quot;Curve&quot;,geometry,node);}else{this.writeNode(&quot;LineString&quot;,geometry,node);}
return node;},&quot;MultiSurface&quot;:function(geometry){var node=this.createElementNSPlus(&quot;gml:MultiSurface&quot;);for(var i=0,len=geometry.components.length;i&lt;len;++i){this.writeNode(&quot;surfaceMember&quot;,geometry.components[i],node);}
return node;},&quot;surfaceMember&quot;:function(polygon){var node=this.createElementNSPlus(&quot;gml:surfaceMember&quot;);if(this.surface){this.writeNode(&quot;Surface&quot;,polygon,node);}else{this.writeNode(&quot;Polygon&quot;,polygon,node);}
return node;},&quot;Envelope&quot;:function(bounds){var node=this.createElementNSPlus(&quot;gml:Envelope&quot;);this.writeNode(&quot;lowerCorner&quot;,bounds,node);this.writeNode(&quot;upperCorner&quot;,bounds,node);if(this.srsName){node.setAttribute(&quot;srsName&quot;,this.srsName);}
return node;},&quot;lowerCorner&quot;:function(bounds){var pos=(this.xy)?(bounds.left+&quot; &quot;+bounds.bottom):(bounds.bottom+&quot; &quot;+bounds.left);return this.createElementNSPlus(&quot;gml:lowerCorner&quot;,{value:pos});},&quot;upperCorner&quot;:function(bounds){var pos=(this.xy)?(bounds.right+&quot; &quot;+bounds.top):(bounds.top+&quot; &quot;+bounds.right);return this.createElementNSPlus(&quot;gml:upperCorner&quot;,{value:pos});}},OpenLayers.Format.GML.Base.prototype.writers[&quot;gml&quot;]),&quot;feature&quot;:OpenLayers.Format.GML.Base.prototype.writers[&quot;feature&quot;],&quot;wfs&quot;:OpenLayers.Format.GML.Base.prototype.writers[&quot;wfs&quot;]},setGeometryTypes:function(){this.geometryTypes={&quot;OpenLayers.Geometry.Point&quot;:&quot;Point&quot;,&quot;OpenLayers.Geometry.MultiPoint&quot;:&quot;MultiPoint&quot;,&quot;OpenLayers.Geometry.LineString&quot;:(this.curve===true)?&quot;Curve&quot;:&quot;LineString&quot;,&quot;OpenLayers.Geometry.MultiLineString&quot;:(this.multiCurve===false)?&quot;MultiLineString&quot;:&quot;MultiCurve&quot;,&quot;OpenLayers.Geometry.Polygon&quot;:(this.surface===true)?&quot;Surface&quot;:&quot;Polygon&quot;,&quot;OpenLayers.Geometry.MultiPolygon&quot;:(this.multiSurface===false)?&quot;MultiPolygon&quot;:&quot;MultiSurface&quot;,&quot;OpenLayers.Geometry.Collection&quot;:&quot;GeometryCollection&quot;};},CLASS_NAME:&quot;OpenLayers.Format.GML.v3&quot;});OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:&quot;1.0.0&quot;,schemaLocation:&quot;http://www.opengis.net/ogc/filter/1.0.0/filter.xsd&quot;,initialize:function(options){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[options]);},readers:{&quot;ogc&quot;:OpenLayers.Util.applyDefaults({&quot;PropertyIsEqualTo&quot;:function(node,obj){var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;PropertyIsNotEqualTo&quot;:function(node,obj){var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(node,filter);obj.filters.push(filter);}},OpenLayers.Format.Filter.v1.prototype.readers[&quot;ogc&quot;]),&quot;gml&quot;:OpenLayers.Format.GML.v2.prototype.readers[&quot;gml&quot;],&quot;feature&quot;:OpenLayers.Format.GML.v2.prototype.readers[&quot;feature&quot;]},writers:{&quot;ogc&quot;:OpenLayers.Util.applyDefaults({&quot;PropertyIsEqualTo&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsEqualTo&quot;);this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;Literal&quot;,filter.value,node);return node;},&quot;PropertyIsNotEqualTo&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsNotEqualTo&quot;);this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;Literal&quot;,filter.value,node);return node;},&quot;BBOX&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:BBOX&quot;);this.writeNode(&quot;PropertyName&quot;,filter,node);var box=this.writeNode(&quot;gml:Box&quot;,filter.value,node);if(filter.projection){box.setAttribute(&quot;srsName&quot;,filter.projection);}
return node;}},OpenLayers.Format.Filter.v1.prototype.writers[&quot;ogc&quot;]),&quot;gml&quot;:OpenLayers.Format.GML.v2.prototype.writers[&quot;gml&quot;],&quot;feature&quot;:OpenLayers.Format.GML.v2.prototype.writers[&quot;feature&quot;]},writeSpatial:function(filter,name){var node=this.createElementNSPlus(&quot;ogc:&quot;+name);this.writeNode(&quot;PropertyName&quot;,filter,node);var child;if(filter.value instanceof OpenLayers.Geometry){child=this.writeNode(&quot;feature:_geometry&quot;,filter.value).firstChild;}else{child=this.writeNode(&quot;gml:Box&quot;,filter.value);}
if(filter.projection){child.setAttribute(&quot;srsName&quot;,filter.projection);}
node.appendChild(child);return node;},CLASS_NAME:&quot;OpenLayers.Format.Filter.v1_0_0&quot;});OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:&quot;1.1.0&quot;,schemaLocation:&quot;http://www.opengis.net/ogc/filter/1.1.0/filter.xsd&quot;,initialize:function(options){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[options]);},readers:{&quot;ogc&quot;:OpenLayers.Util.applyDefaults({&quot;PropertyIsEqualTo&quot;:function(node,obj){var matchCase=node.getAttribute(&quot;matchCase&quot;);var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!(matchCase===&quot;false&quot;||matchCase===&quot;0&quot;)});this.readChildNodes(node,filter);obj.filters.push(filter);},&quot;PropertyIsNotEqualTo&quot;:function(node,obj){var matchCase=node.getAttribute(&quot;matchCase&quot;);var filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!(matchCase===&quot;false&quot;||matchCase===&quot;0&quot;)});this.readChildNodes(node,filter);obj.filters.push(filter);}},OpenLayers.Format.Filter.v1.prototype.readers[&quot;ogc&quot;]),&quot;gml&quot;:OpenLayers.Format.GML.v3.prototype.readers[&quot;gml&quot;],&quot;feature&quot;:OpenLayers.Format.GML.v3.prototype.readers[&quot;feature&quot;]},writers:{&quot;ogc&quot;:OpenLayers.Util.applyDefaults({&quot;PropertyIsEqualTo&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsEqualTo&quot;,{attributes:{matchCase:filter.matchCase}});this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;Literal&quot;,filter.value,node);return node;},&quot;PropertyIsNotEqualTo&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:PropertyIsNotEqualTo&quot;,{attributes:{matchCase:filter.matchCase}});this.writeNode(&quot;PropertyName&quot;,filter,node);this.writeNode(&quot;Literal&quot;,filter.value,node);return node;},&quot;BBOX&quot;:function(filter){var node=this.createElementNSPlus(&quot;ogc:BBOX&quot;);this.writeNode(&quot;PropertyName&quot;,filter,node);var box=this.writeNode(&quot;gml:Envelope&quot;,filter.value);if(filter.projection){box.setAttribute(&quot;srsName&quot;,filter.projection);}
node.appendChild(box);return node;}},OpenLayers.Format.Filter.v1.prototype.writers[&quot;ogc&quot;]),&quot;gml&quot;:OpenLayers.Format.GML.v3.prototype.writers[&quot;gml&quot;],&quot;feature&quot;:OpenLayers.Format.GML.v3.prototype.writers[&quot;feature&quot;]},writeSpatial:function(filter,name){var node=this.createElementNSPlus(&quot;ogc:&quot;+name);this.writeNode(&quot;PropertyName&quot;,filter,node);var child;if(filter.value instanceof OpenLayers.Geometry){child=this.writeNode(&quot;feature:_geometry&quot;,filter.value).firstChild;}else{child=this.writeNode(&quot;gml:Envelope&quot;,filter.value);}
if(filter.projection){child.setAttribute(&quot;srsName&quot;,filter.projection);}
node.appendChild(child);return node;},CLASS_NAME:&quot;OpenLayers.Format.Filter.v1_1_0&quot;});OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:&quot;http://www.opengis.net/sld&quot;,ogc:&quot;http://www.opengis.net/ogc&quot;,gml:&quot;http://www.opengis.net/gml&quot;,xlink:&quot;http://www.w3.org/1999/xlink&quot;,xsi:&quot;http://www.w3.org/2001/XMLSchema-instance&quot;},defaultPrefix:&quot;sld&quot;,schemaLocation:null,defaultSymbolizer:{fillColor:&quot;#808080&quot;,fillOpacity:1,strokeColor:&quot;#000000&quot;,strokeOpacity:1,strokeWidth:1,strokeDashstyle:&quot;solid&quot;,pointRadius:3,graphicName:&quot;square&quot;},initialize:function(options){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[options]);},read:function(data,options){options=OpenLayers.Util.applyDefaults(options,this.options);var sld={namedLayers:options.namedLayersAsArray===true?[]:{}};this.readChildNodes(data,sld);return sld;},readers:OpenLayers.Util.applyDefaults({&quot;sld&quot;:{&quot;StyledLayerDescriptor&quot;:function(node,sld){sld.version=node.getAttribute(&quot;version&quot;);this.readChildNodes(node,sld);},&quot;Name&quot;:function(node,obj){obj.name=this.getChildValue(node);},&quot;Title&quot;:function(node,obj){obj.title=this.getChildValue(node);},&quot;Abstract&quot;:function(node,obj){obj.description=this.getChildValue(node);},&quot;NamedLayer&quot;:function(node,sld){var layer={userStyles:[],namedStyles:[]};this.readChildNodes(node,layer);for(var i=0,len=layer.userStyles.length;i&lt;len;++i){layer.userStyles[i].layerName=layer.name;}
if(sld.namedLayers instanceof Array){sld.namedLayers.push(layer);}else{sld.namedLayers[layer.name]=layer;}},&quot;NamedStyle&quot;:function(node,layer){layer.namedStyles.push(this.getChildName(node.firstChild));},&quot;UserStyle&quot;:function(node,layer){var obj={defaultsPerSymbolizer:true,rules:[]};this.readChildNodes(node,obj);var style=new OpenLayers.Style(this.defaultSymbolizer,obj);layer.userStyles.push(style);},&quot;IsDefault&quot;:function(node,style){if(this.getChildValue(node)==&quot;1&quot;){style.isDefault=true;}},&quot;FeatureTypeStyle&quot;:function(node,style){var obj={rules:[]};this.readChildNodes(node,obj);style.rules=obj.rules;},&quot;Rule&quot;:function(node,obj){var rule=new OpenLayers.Rule();this.readChildNodes(node,rule);obj.rules.push(rule);},&quot;ElseFilter&quot;:function(node,rule){rule.elseFilter=true;},&quot;MinScaleDenominator&quot;:function(node,rule){rule.minScaleDenominator=parseFloat(this.getChildValue(node));},&quot;MaxScaleDenominator&quot;:function(node,rule){rule.maxScaleDenominator=parseFloat(this.getChildValue(node));},&quot;TextSymbolizer&quot;:function(node,rule){var symbolizer=rule.symbolizer[&quot;Text&quot;]||{};this.readChildNodes(node,symbolizer);rule.symbolizer[&quot;Text&quot;]=symbolizer;},&quot;Label&quot;:function(node,symbolizer){var obj={};this.readChildNodes(node,obj);if(obj.property){symbolizer.label=&quot;${&quot;+obj.property+&quot;}&quot;;}else{var value=this.readOgcExpression(node);if(value){symbolizer.label=value;}}},&quot;Font&quot;:function(node,symbolizer){this.readChildNodes(node,symbolizer);},&quot;Halo&quot;:function(node,symbolizer){var obj={};this.readChildNodes(node,obj);symbolizer.haloRadius=obj.haloRadius;symbolizer.haloColor=obj.fillColor;symbolizer.haloOpacity=obj.fillOpacity;},&quot;Radius&quot;:function(node,symbolizer){var radius=this.readOgcExpression(node);if(radius!=null){symbolizer.haloRadius=radius;}},&quot;LineSymbolizer&quot;:function(node,rule){var symbolizer=rule.symbolizer[&quot;Line&quot;]||{};this.readChildNodes(node,symbolizer);rule.symbolizer[&quot;Line&quot;]=symbolizer;},&quot;PolygonSymbolizer&quot;:function(node,rule){var symbolizer=rule.symbolizer[&quot;Polygon&quot;]||{};this.readChildNodes(node,symbolizer);rule.symbolizer[&quot;Polygon&quot;]=symbolizer;},&quot;PointSymbolizer&quot;:function(node,rule){var symbolizer=rule.symbolizer[&quot;Point&quot;]||{};this.readChildNodes(node,symbolizer);rule.symbolizer[&quot;Point&quot;]=symbolizer;},&quot;Stroke&quot;:function(node,symbolizer){symbolizer.stroke=true;this.readChildNodes(node,symbolizer);},&quot;Fill&quot;:function(node,symbolizer){symbolizer.fill=true;this.readChildNodes(node,symbolizer);},&quot;CssParameter&quot;:function(node,symbolizer){var cssProperty=node.getAttribute(&quot;name&quot;);var symProperty=this.cssMap[cssProperty];if(symProperty){var value=this.readOgcExpression(node);if(value){symbolizer[symProperty]=value;}}},&quot;Graphic&quot;:function(node,symbolizer){symbolizer.graphic=true;var graphic={};this.readChildNodes(node,graphic);var properties=[&quot;strokeColor&quot;,&quot;strokeWidth&quot;,&quot;strokeOpacity&quot;,&quot;strokeLinecap&quot;,&quot;fillColor&quot;,&quot;fillOpacity&quot;,&quot;graphicName&quot;,&quot;rotation&quot;,&quot;graphicFormat&quot;];var prop,value;for(var i=0,len=properties.length;i&lt;len;++i){prop=properties[i];value=graphic[prop];if(value!=undefined){symbolizer[prop]=value;}}
if(graphic.opacity!=undefined){symbolizer.graphicOpacity=graphic.opacity;}
if(graphic.size!=undefined){symbolizer.pointRadius=graphic.size/2;}
if(graphic.href!=undefined){symbolizer.externalGraphic=graphic.href;}
if(graphic.rotation!=undefined){symbolizer.rotation=graphic.rotation;}},&quot;ExternalGraphic&quot;:function(node,graphic){this.readChildNodes(node,graphic);},&quot;Mark&quot;:function(node,graphic){this.readChildNodes(node,graphic);},&quot;WellKnownName&quot;:function(node,graphic){graphic.graphicName=this.getChildValue(node);},&quot;Opacity&quot;:function(node,obj){var opacity=this.readOgcExpression(node);if(opacity){obj.opacity=opacity;}},&quot;Size&quot;:function(node,obj){var size=this.readOgcExpression(node);if(size){obj.size=size;}},&quot;Rotation&quot;:function(node,obj){var rotation=this.readOgcExpression(node);if(rotation){obj.rotation=rotation;}},&quot;OnlineResource&quot;:function(node,obj){obj.href=this.getAttributeNS(node,this.namespaces.xlink,&quot;href&quot;);},&quot;Format&quot;:function(node,graphic){graphic.graphicFormat=this.getChildValue(node);}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),cssMap:{&quot;stroke&quot;:&quot;strokeColor&quot;,&quot;stroke-opacity&quot;:&quot;strokeOpacity&quot;,&quot;stroke-width&quot;:&quot;strokeWidth&quot;,&quot;stroke-linecap&quot;:&quot;strokeLinecap&quot;,&quot;stroke-dasharray&quot;:&quot;strokeDashstyle&quot;,&quot;fill&quot;:&quot;fillColor&quot;,&quot;fill-opacity&quot;:&quot;fillOpacity&quot;,&quot;font-family&quot;:&quot;fontFamily&quot;,&quot;font-size&quot;:&quot;fontSize&quot;,&quot;font-weight&quot;:&quot;fontWeight&quot;,&quot;font-style&quot;:&quot;fontStyle&quot;},getCssProperty:function(sym){var css=null;for(var prop in this.cssMap){if(this.cssMap[prop]==sym){css=prop;break;}}
return css;},getGraphicFormat:function(href){var format,regex;for(var key in this.graphicFormats){if(this.graphicFormats[key].test(href)){format=key;break;}}
return format||this.defautlGraphicFormat;},defaultGraphicFormat:&quot;image/png&quot;,graphicFormats:{&quot;image/jpeg&quot;:/\.jpe?g$/i,&quot;image/gif&quot;:/\.gif$/i,&quot;image/png&quot;:/\.png$/i},write:function(sld){return this.writers.sld.StyledLayerDescriptor.apply(this,[sld]);},writers:OpenLayers.Util.applyDefaults({&quot;sld&quot;:{&quot;StyledLayerDescriptor&quot;:function(sld){var root=this.createElementNSPlus(&quot;StyledLayerDescriptor&quot;,{attributes:{&quot;version&quot;:this.VERSION,&quot;xsi:schemaLocation&quot;:this.schemaLocation}});if(sld.name){this.writeNode(&quot;Name&quot;,sld.name,root);}
if(sld.title){this.writeNode(&quot;Title&quot;,sld.title,root);}
if(sld.description){this.writeNode(&quot;Abstract&quot;,sld.description,root);}
if(sld.namedLayers instanceof Array){for(var i=0,len=sld.namedLayers.length;i&lt;len;++i){this.writeNode(&quot;NamedLayer&quot;,sld.namedLayers[i],root);}}else{for(var name in sld.namedLayers){this.writeNode(&quot;NamedLayer&quot;,sld.namedLayers[name],root);}}
return root;},&quot;Name&quot;:function(name){return this.createElementNSPlus(&quot;Name&quot;,{value:name});},&quot;Title&quot;:function(title){return this.createElementNSPlus(&quot;Title&quot;,{value:title});},&quot;Abstract&quot;:function(description){return this.createElementNSPlus(&quot;Abstract&quot;,{value:description});},&quot;NamedLayer&quot;:function(layer){var node=this.createElementNSPlus(&quot;NamedLayer&quot;);this.writeNode(&quot;Name&quot;,layer.name,node);if(layer.namedStyles){for(var i=0,len=layer.namedStyles.length;i&lt;len;++i){this.writeNode(&quot;NamedStyle&quot;,layer.namedStyles[i],node);}}
if(layer.userStyles){for(var i=0,len=layer.userStyles.length;i&lt;len;++i){this.writeNode(&quot;UserStyle&quot;,layer.userStyles[i],node);}}
return node;},&quot;NamedStyle&quot;:function(name){var node=this.createElementNSPlus(&quot;NamedStyle&quot;);this.writeNode(&quot;Name&quot;,name,node);return node;},&quot;UserStyle&quot;:function(style){var node=this.createElementNSPlus(&quot;UserStyle&quot;);if(style.name){this.writeNode(&quot;Name&quot;,style.name,node);}
if(style.title){this.writeNode(&quot;Title&quot;,style.title,node);}
if(style.description){this.writeNode(&quot;Abstract&quot;,style.description,node);}
if(style.isDefault){this.writeNode(&quot;IsDefault&quot;,style.isDefault,node);}
this.writeNode(&quot;FeatureTypeStyle&quot;,style,node);return node;},&quot;IsDefault&quot;:function(bool){return this.createElementNSPlus(&quot;IsDefault&quot;,{value:(bool)?&quot;1&quot;:&quot;0&quot;});},&quot;FeatureTypeStyle&quot;:function(style){var node=this.createElementNSPlus(&quot;FeatureTypeStyle&quot;);for(var i=0,len=style.rules.length;i&lt;len;++i){this.writeNode(&quot;Rule&quot;,style.rules[i],node);}
return node;},&quot;Rule&quot;:function(rule){var node=this.createElementNSPlus(&quot;Rule&quot;);if(rule.name){this.writeNode(&quot;Name&quot;,rule.name,node);}
if(rule.title){this.writeNode(&quot;Title&quot;,rule.title,node);}
if(rule.description){this.writeNode(&quot;Abstract&quot;,rule.description,node);}
if(rule.elseFilter){this.writeNode(&quot;ElseFilter&quot;,null,node);}else if(rule.filter){this.writeNode(&quot;ogc:Filter&quot;,rule.filter,node);}
if(rule.minScaleDenominator!=undefined){this.writeNode(&quot;MinScaleDenominator&quot;,rule.minScaleDenominator,node);}
if(rule.maxScaleDenominator!=undefined){this.writeNode(&quot;MaxScaleDenominator&quot;,rule.maxScaleDenominator,node);}
var types=OpenLayers.Style.SYMBOLIZER_PREFIXES;var type,symbolizer;for(var i=0,len=types.length;i&lt;len;++i){type=types[i];symbolizer=rule.symbolizer[type];if(symbolizer){this.writeNode(type+&quot;Symbolizer&quot;,symbolizer,node);}}
return node;},&quot;ElseFilter&quot;:function(){return this.createElementNSPlus(&quot;ElseFilter&quot;);},&quot;MinScaleDenominator&quot;:function(scale){return this.createElementNSPlus(&quot;MinScaleDenominator&quot;,{value:scale});},&quot;MaxScaleDenominator&quot;:function(scale){return this.createElementNSPlus(&quot;MaxScaleDenominator&quot;,{value:scale});},&quot;LineSymbolizer&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;LineSymbolizer&quot;);this.writeNode(&quot;Stroke&quot;,symbolizer,node);return node;},&quot;Stroke&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;Stroke&quot;);if(symbolizer.strokeColor!=undefined){this.writeNode(&quot;CssParameter&quot;,{symbolizer:symbolizer,key:&quot;strokeColor&quot;},node);}
if(symbolizer.strokeOpacity!=undefined){this.writeNode(&quot;CssParameter&quot;,{symbolizer:symbolizer,key:&quot;strokeOpacity&quot;},node);}
if(symbolizer.strokeWidth!=undefined){this.writeNode(&quot;CssParameter&quot;,{symbolizer:symbolizer,key:&quot;strokeWidth&quot;},node);}
return node;},&quot;CssParameter&quot;:function(obj){return this.createElementNSPlus(&quot;CssParameter&quot;,{attributes:{name:this.getCssProperty(obj.key)},value:obj.symbolizer[obj.key]});},&quot;TextSymbolizer&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;TextSymbolizer&quot;);if(symbolizer.label!=null){this.writeNode(&quot;Label&quot;,symbolizer.label,node);}
if(symbolizer.fontFamily!=null||symbolizer.fontSize!=null||symbolizer.fontWeight!=null||symbolizer.fontStyle!=null){this.writeNode(&quot;Font&quot;,symbolizer,node);}
if(symbolizer.haloRadius!=null||symbolizer.haloColor!=null||symbolizer.haloOpacity!=null){this.writeNode(&quot;Halo&quot;,symbolizer,node);}
if(symbolizer.fillColor!=null||symbolizer.fillOpacity!=null){this.writeNode(&quot;Fill&quot;,symbolizer,node);}
return node;},&quot;Font&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;Font&quot;);if(symbolizer.fontFamily){this.writeNode(&quot;CssParameter&quot;,{symbolizer:symbolizer,key:&quot;fontFamily&quot;},node);}
if(symbolizer.fontSize){this.writeNode(&quot;CssParameter&quot;,{symbolizer:symbolizer,key:&quot;fontSize&quot;},node);}
if(symbolizer.fontWeight){this.writeNode(&quot;CssParameter&quot;,{symbolizer:symbolizer,key:&quot;fontWeight&quot;},node);}
if(symbolizer.fontStyle){this.writeNode(&quot;CssParameter&quot;,{symbolizer:symbolizer,key:&quot;fontStyle&quot;},node);}
return node;},&quot;Label&quot;:function(label){var node=this.createElementNSPlus(&quot;Label&quot;);var tokens=label.split(&quot;${&quot;);node.appendChild(this.createTextNode(tokens[0]));var item,last;for(var i=1,len=tokens.length;i&lt;len;i++){item=tokens[i];last=item.indexOf(&quot;}&quot;);if(last&gt;0){this.writeNode(&quot;ogc:PropertyName&quot;,{property:item.substring(0,last)},node);node.appendChild(this.createTextNode(item.substring(++last)));}else{node.appendChild(this.createTextNode(&quot;${&quot;+item));}}
return node;},&quot;Halo&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;Halo&quot;);if(symbolizer.haloRadius){this.writeNode(&quot;Radius&quot;,symbolizer.haloRadius,node);}
if(symbolizer.haloColor||symbolizer.haloOpacity){this.writeNode(&quot;Fill&quot;,{fillColor:symbolizer.haloColor,fillOpacity:symbolizer.haloOpacity},node);}
return node;},&quot;Radius&quot;:function(value){return node=this.createElementNSPlus(&quot;Radius&quot;,{value:value});},&quot;PolygonSymbolizer&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;PolygonSymbolizer&quot;);if(symbolizer.fillColor!=undefined||symbolizer.fillOpacity!=undefined){this.writeNode(&quot;Fill&quot;,symbolizer,node);}
if(symbolizer.strokeWidth!=undefined||symbolizer.strokeColor!=undefined||symbolizer.strokeOpacity!=undefined||symbolizer.strokeDashstyle!=undefined){this.writeNode(&quot;Stroke&quot;,symbolizer,node);}
return node;},&quot;Fill&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;Fill&quot;);if(symbolizer.fillColor){this.writeNode(&quot;CssParameter&quot;,{symbolizer:symbolizer,key:&quot;fillColor&quot;},node);}
if(symbolizer.fillOpacity!=null){this.writeNode(&quot;CssParameter&quot;,{symbolizer:symbolizer,key:&quot;fillOpacity&quot;},node);}
return node;},&quot;PointSymbolizer&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;PointSymbolizer&quot;);this.writeNode(&quot;Graphic&quot;,symbolizer,node);return node;},&quot;Graphic&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;Graphic&quot;);if(symbolizer.externalGraphic!=undefined){this.writeNode(&quot;ExternalGraphic&quot;,symbolizer,node);}else{this.writeNode(&quot;Mark&quot;,symbolizer,node);}
if(symbolizer.graphicOpacity!=undefined){this.writeNode(&quot;Opacity&quot;,symbolizer.graphicOpacity,node);}
if(symbolizer.pointRadius!=undefined){this.writeNode(&quot;Size&quot;,symbolizer.pointRadius*2,node);}
if(symbolizer.rotation!=undefined){this.writeNode(&quot;Rotation&quot;,symbolizer.rotation,node);}
return node;},&quot;ExternalGraphic&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;ExternalGraphic&quot;);this.writeNode(&quot;OnlineResource&quot;,symbolizer.externalGraphic,node);var format=symbolizer.graphicFormat||this.getGraphicFormat(symbolizer.externalGraphic);this.writeNode(&quot;Format&quot;,format,node);return node;},&quot;Mark&quot;:function(symbolizer){var node=this.createElementNSPlus(&quot;Mark&quot;);if(symbolizer.graphicName){this.writeNode(&quot;WellKnownName&quot;,symbolizer.graphicName,node);}
this.writeNode(&quot;Fill&quot;,symbolizer,node);this.writeNode(&quot;Stroke&quot;,symbolizer,node);return node;},&quot;WellKnownName&quot;:function(name){return this.createElementNSPlus(&quot;WellKnownName&quot;,{value:name});},&quot;Opacity&quot;:function(value){return this.createElementNSPlus(&quot;Opacity&quot;,{value:value});},&quot;Size&quot;:function(value){return this.createElementNSPlus(&quot;Size&quot;,{value:value});},&quot;Rotation&quot;:function(value){return this.createElementNSPlus(&quot;Rotation&quot;,{value:value});},&quot;OnlineResource&quot;:function(href){return this.createElementNSPlus(&quot;OnlineResource&quot;,{attributes:{&quot;xlink:type&quot;:&quot;simple&quot;,&quot;xlink:href&quot;:href}});},&quot;Format&quot;:function(format){return this.createElementNSPlus(&quot;Format&quot;,{value:format});}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:&quot;OpenLayers.Format.SLD.v1&quot;});OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:&quot;1.0.0&quot;,schemaLocations:{&quot;wfs&quot;:&quot;http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd&quot;},initialize:function(options){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[options]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[options]);},readers:{&quot;wfs&quot;:OpenLayers.Util.applyDefaults({&quot;WFS_TransactionResponse&quot;:function(node,obj){obj.insertIds=[];obj.success=false;this.readChildNodes(node,obj);},&quot;InsertResult&quot;:function(node,container){var obj={fids:[]};this.readChildNodes(node,obj);container.insertIds.push(obj.fids[0]);},&quot;TransactionResult&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;Status&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;SUCCESS&quot;:function(node,obj){obj.success=true;}},OpenLayers.Format.WFST.v1.prototype.readers[&quot;wfs&quot;]),&quot;gml&quot;:OpenLayers.Format.GML.v2.prototype.readers[&quot;gml&quot;],&quot;feature&quot;:OpenLayers.Format.GML.v2.prototype.readers[&quot;feature&quot;],&quot;ogc&quot;:OpenLayers.Format.Filter.v1_0_0.prototype.readers[&quot;ogc&quot;]},writers:{&quot;wfs&quot;:OpenLayers.Util.applyDefaults({&quot;Query&quot;:function(options){options=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},options);var node=this.createElementNSPlus(&quot;wfs:Query&quot;,{attributes:{typeName:(options.featureNS?options.featurePrefix+&quot;:&quot;:&quot;&quot;)+
options.featureType}});if(options.featureNS){node.setAttribute(&quot;xmlns:&quot;+options.featurePrefix,options.featureNS);}
if(options.propertyNames){for(var i=0,len=options.propertyNames.length;i&lt;len;i++){this.writeNode(&quot;ogc:PropertyName&quot;,{property:options.propertyNames[i]},node);}}
if(options.filter){this.setFilterProperty(options.filter);this.writeNode(&quot;ogc:Filter&quot;,options.filter,node);}
return node;}},OpenLayers.Format.WFST.v1.prototype.writers[&quot;wfs&quot;]),&quot;gml&quot;:OpenLayers.Format.GML.v2.prototype.writers[&quot;gml&quot;],&quot;feature&quot;:OpenLayers.Format.GML.v2.prototype.writers[&quot;feature&quot;],&quot;ogc&quot;:OpenLayers.Format.Filter.v1_0_0.prototype.writers[&quot;ogc&quot;]},CLASS_NAME:&quot;OpenLayers.Format.WFST.v1_0_0&quot;});OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:&quot;1.1.0&quot;,schemaLocations:{&quot;wfs&quot;:&quot;http://schemas.opengis.net/wfs/1.1.0/wfs.xsd&quot;},initialize:function(options){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[options]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[options]);},readers:{&quot;wfs&quot;:OpenLayers.Util.applyDefaults({&quot;TransactionResponse&quot;:function(node,obj){obj.insertIds=[];obj.success=false;this.readChildNodes(node,obj);},&quot;TransactionSummary&quot;:function(node,obj){obj.success=true;},&quot;InsertResults&quot;:function(node,obj){this.readChildNodes(node,obj);},&quot;Feature&quot;:function(node,container){var obj={fids:[]};this.readChildNodes(node,obj);container.insertIds.push(obj.fids[0]);}},OpenLayers.Format.WFST.v1.prototype.readers[&quot;wfs&quot;]),&quot;gml&quot;:OpenLayers.Format.GML.v3.prototype.readers[&quot;gml&quot;],&quot;feature&quot;:OpenLayers.Format.GML.v3.prototype.readers[&quot;feature&quot;],&quot;ogc&quot;:OpenLayers.Format.Filter.v1_1_0.prototype.readers[&quot;ogc&quot;]},writers:{&quot;wfs&quot;:OpenLayers.Util.applyDefaults({&quot;Query&quot;:function(options){options=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},options);var node=this.createElementNSPlus(&quot;wfs:Query&quot;,{attributes:{typeName:(options.featureNS?options.featurePrefix+&quot;:&quot;:&quot;&quot;)+
options.featureType,srsName:options.srsName}});if(options.featureNS){node.setAttribute(&quot;xmlns:&quot;+options.featurePrefix,options.featureNS);}
if(options.propertyNames){for(var i=0,len=options.propertyNames.length;i&lt;len;i++){this.writeNode(&quot;wfs:PropertyName&quot;,{property:options.propertyNames[i]},node);}}
if(options.filter){this.setFilterProperty(options.filter);this.writeNode(&quot;ogc:Filter&quot;,options.filter,node);}
return node;},&quot;PropertyName&quot;:function(obj){return this.createElementNSPlus(&quot;wfs:PropertyName&quot;,{value:obj.property});}},OpenLayers.Format.WFST.v1.prototype.writers[&quot;wfs&quot;]),&quot;gml&quot;:OpenLayers.Format.GML.v3.prototype.writers[&quot;gml&quot;],&quot;feature&quot;:OpenLayers.Format.GML.v3.prototype.writers[&quot;feature&quot;],&quot;ogc&quot;:OpenLayers.Format.Filter.v1_1_0.prototype.writers[&quot;ogc&quot;]},CLASS_NAME:&quot;OpenLayers.Format.WFST.v1_1_0&quot;});OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:&quot;1.0.0&quot;,schemaLocation:&quot;http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd&quot;,initialize:function(options){OpenLayers.Format.SLD.v1.prototype.initialize.apply(this,[options]);},CLASS_NAME:&quot;OpenLayers.Format.SLD.v1_0_0&quot;});OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:&quot;1.0.0&quot;,CLASS_NAME:&quot;OpenLayers.Protocol.WFS.v1_0_0&quot;});OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:&quot;1.1.0&quot;,CLASS_NAME:&quot;OpenLayers.Protocol.WFS.v1_1_0&quot;});</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/OpenLayers.js</java.net.URL>
</httpSample>
<httpSample t="3" it="0" lt="3" ts="1315465022350" s="true" lb="/iceweb/img/printer.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="3980" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=7f90d6fd312899c540586efe2fda093936e6803bda238de51e924b3c1559d1f2; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:21 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/img/printer.png</java.net.URL>
</httpSample>
<httpSample t="2" it="0" lt="2" ts="1315465022354" s="true" lb="/iceweb/img/GvSig_FondoCabecera.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="700" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 332
Set-Cookie: JSESSIONID=8aaf83548994063980f41982f74aabc435e313bc60c032894b933787263e0eb6; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:21 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/styles/style.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/img/GvSig_FondoCabecera.gif</java.net.URL>
</httpSample>
<httpSample t="3" it="0" lt="3" ts="1315465022357" s="true" lb="/iceweb/img/GvSig_cabecera.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="14745" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=cb9adb0e06358345152106bbdc704e2856a1e3216511d07c1200efb203cd1fc1; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:21 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/img/GvSig_cabecera.gif</java.net.URL>
</httpSample>
<httpSample t="5" it="0" lt="5" ts="1315465022361" s="false" lb="/iceweb/styles/img/south-mini.png" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" de="iso-8859-1" by="667" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 500 Internal Server Error
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 304
Set-Cookie: JSESSIONID=2e4ad5010e39835edd0cc1cb9be121e10789ac7d2e245b86c4cec5b711f6a28b; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: text/html; charset=&quot;iso-8859-1&quot;
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Referer: http://localhost:8080/iceweb/styles/style.css
Accept-Encoding: gzip,deflate
Keep-Alive: 115
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
</requestHeader>
  <responseData class="java.lang.String">&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;500 Internal Server Error&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;500 Internal Server Error&lt;/H1&gt;&lt;PRE&gt;Servlet error: An exception occurred. The current application deployment descriptors do not allow for including it in this response. Please consult the application log for details.&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/styles/img/south-mini.png</java.net.URL>
</httpSample>
<httpSample t="3" it="0" lt="3" ts="1315465022368" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/wbg.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="1236" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 868
Set-Cookie: JSESSIONID=325ba1d87b301a963547a94d83756e6f929b02d934605f5b95da53811508a866; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/wbg.gif</java.net.URL>
</httpSample>
<httpSample t="3" it="0" lt="3" ts="1315465022371" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/prev.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="554" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 186
Set-Cookie: JSESSIONID=95bf2d480e1e16006aa9dbf5dbc52154511576bcaf1598fa13927465449d6663; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/prev.gif</java.net.URL>
</httpSample>
<httpSample t="3" it="0" lt="3" ts="1315465022375" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/fhbg.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="1204" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 836
Set-Cookie: JSESSIONID=ad6b5b67c8be402afba126e685e1af6d56758a7a3e134f3b029044b1658f44cc; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/fhbg.gif</java.net.URL>
</httpSample>
<httpSample t="3" it="0" lt="3" ts="1315465022379" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/next.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="553" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 185
Set-Cookie: JSESSIONID=3a3e66390cb26b5850a0a5bc2e4f6b5e5d3bc76fd1f523659fd1251091c5d8ed; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/next.gif</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022383" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/line.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="1185" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 817
Set-Cookie: JSESSIONID=12f94cacb6961edfac92162316b2fce9843769b148f28c8dec171e12f9bcc1cb; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/line.gif</java.net.URL>
</httpSample>
<httpSample t="5" it="0" lt="5" ts="1315465022388" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/load.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="1195" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 827
Set-Cookie: JSESSIONID=d4947a90fe950bc7d67ca593d615b3ee729e2ac0365d0225e76351fd53b55cd7; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/load.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022394" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/first.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="585" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 217
Set-Cookie: JSESSIONID=8a76a619a7c41006d40518150454fbfbddab0bbc96c0e23d0e2d42bcd1dc09ce; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/first.gif</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022399" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/last.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="588" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 220
Set-Cookie: JSESSIONID=bb12eb13ed7db78ed0f36e6d07c3e09d3e834964b9c9bb661b703b53a105302b; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/last.gif</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022404" s="true" lb="/iceweb/js/OpenLayers/img/east-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="3386" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=adf8c14c33932838c54ddd13214091f1a7cd30918953e5bd6846123749a4ee2a; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/img/east-mini.png</java.net.URL>
</httpSample>
<httpSample t="5" it="0" lt="4" ts="1315465022409" s="true" lb="/iceweb/js/OpenLayers/img/zoom-minus-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="3273" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=e58b1a38bde1f43a6d4c2523c36817517ebf6207b9b817b8735f1efa329c7473; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/img/zoom-minus-mini.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022415" s="true" lb="/iceweb/js/OpenLayers/img/layer-switcher-minimize.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="3226" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=140773f06e2e33b4b12c155444ee226804bb2c1f5cf5d8c4e1c8f90a3dbbb840; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/img/layer-switcher-minimize.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022420" s="true" lb="/iceweb/js/OpenLayers/img/zoom-world-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="4108" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=c00b11e6e9c94f1e0b542756d3e069940f80dfd5f4771d098e8c360e2eacdfa6; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/img/zoom-world-mini.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="3" ts="1315465022426" s="true" lb="/iceweb/js/OpenLayers/img/zoom-plus-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="3361" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=2468c301661f7ac6a061937a85a27809f77906855a83c08e52623ba3a6ae3d71; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/img/zoom-plus-mini.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022431" s="true" lb="/iceweb/js/OpenLayers/img/north-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="3381" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=2972fc0983f875ef686850d517a0ac42bdcf5892762fa499ba67987006965537; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/img/north-mini.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="3" ts="1315465022437" s="true" lb="/iceweb/js/OpenLayers/img/south-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="3373" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=71841efa36d1122cb15919acc28bca246e32316855e5d3d7945af711d10901b5; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/img/south-mini.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022442" s="true" lb="/iceweb/js/OpenLayers/img/west-mini.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="3403" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=5ac36182a29dc23740cc209b2d80ab683241b33a36d417b6188bfad66bd2da04; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/img/west-mini.png</java.net.URL>
</httpSample>
<httpSample t="30" it="0" lt="30" ts="1315465022447" s="false" lb="/iceweb/restful/Centro/findPagedByVentanaAndFilter" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" de="iso-8859-1" by="734" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 500 Internal Server Error
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 304
Set-Cookie: JSESSIONID=24601695302ce98a3a88fdac9cbe6b89ef6f7ca8ecb49784d5addac641a1b53e; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: text/html; charset=&quot;iso-8859-1&quot;
Content-Location: /app/restful/Centro/findPagedByVentanaAndFilter
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
X-Requested-With: XMLHttpRequest
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Content-Type: application/json
Accept: application/json, */*
</requestHeader>
  <responseData class="java.lang.String">&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;500 Internal Server Error&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;500 Internal Server Error&lt;/H1&gt;&lt;PRE&gt;Servlet error: An exception occurred. The current application deployment descriptors do not allow for including it in this response. Please consult the application log for details.&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/restful/Centro/findPagedByVentanaAndFilter?pageNumber=1&amp;pageSize=20&amp;sortProp=despecifica&amp;asc=true&amp;filter=%7B%22%40id%22%3A1%2C%22provincias%22%3A%5B%22Val%22%2C%22Ala%22%2C%22Cas%22%5D%2C%22regimenes%22%3A%5B%22PRIV.%22%2C%22PUB.%22%5D%2C%22minNumTicketsAbiertos%22%3Anull%2C%22maxNumTicketsAbiertos%22%3Anull%7D</java.net.URL>
</httpSample>
<httpSample t="27" it="0" lt="27" ts="1315465022479" s="false" lb="/iceweb/restful/Centro/findMarcasCuadriculaByFilter" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" de="iso-8859-1" by="735" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 500 Internal Server Error
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 304
Set-Cookie: JSESSIONID=36bd5ed97dd3ce2ac710efc700da1888cffb2de23cf6ef89f226f1ade7f732e5; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: text/html; charset=&quot;iso-8859-1&quot;
Content-Location: /app/restful/Centro/findMarcasCuadriculaByFilter
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
X-Requested-With: XMLHttpRequest
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Content-Type: application/json
Accept: application/json, */*
</requestHeader>
  <responseData class="java.lang.String">&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;500 Internal Server Error&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;500 Internal Server Error&lt;/H1&gt;&lt;PRE&gt;Servlet error: An exception occurred. The current application deployment descriptors do not allow for including it in this response. Please consult the application log for details.&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/restful/Centro/findMarcasCuadriculaByFilter?filter=%7B%22%40id%22%3A1%2C%22provincias%22%3A%5B%22Val%22%2C%22Ala%22%2C%22Cas%22%5D%2C%22regimenes%22%3A%5B%22PRIV.%22%2C%22PUB.%22%5D%2C%22minNumTicketsAbiertos%22%3Anull%2C%22maxNumTicketsAbiertos%22%3Anull%7D&amp;cuadricula=%7B%22%40id%22%3A1%2C%22infIzq%22%3A%7B%22%40id%22%3A2%2C%22lon%22%3A-1.3712280273438%2C%22lat%22%3A37.68305078125%7D%2C%22supDer%22%3A%7B%22%40id%22%3A3%2C%22lon%22%3A0.27122802734375%2C%22lat%22%3A40.97894921875%7D%2C%22resLon%22%3A19%2C%22resLat%22%3A40%7D</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022508" s="true" lb="/iceweb/js/OpenLayers/img/layer-switcher-maximize.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="3360" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Set-Cookie: JSESSIONID=680ba6cf7de954a9f5c4f586ccc2dc48ece46a0af227608e6804fdaa4a8027e3; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
Transfer-Encoding: chunked
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/OpenLayers/img/layer-switcher-maximize.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022514" s="true" lb="/iceweb/img/pub.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="1335" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 967
Set-Cookie: JSESSIONID=151628a9192c957f09b31c9ba01ca8a05ae0f4e5abd5916f896b16a2af0e1580; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:21 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/img/pub.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022519" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/load.gif" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="2106" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 1737
Set-Cookie: JSESSIONID=66919af5d07a5a87863039ae95234bc49313582d2cb11009ffc621d27bf848f8; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/gif
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/load.gif</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022524" s="true" lb="/iceweb/img/mix.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="1140" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 772
Set-Cookie: JSESSIONID=eee0c424543ddbcda44288fe1bace6dfdf06a6f447983ca7bb75bbe52a00f5fb; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:21 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/img/mix.png</java.net.URL>
</httpSample>
<httpSample t="4" it="0" lt="4" ts="1315465022529" s="true" lb="/iceweb/img/priv.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="1199" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 831
Set-Cookie: JSESSIONID=2f58f9f505deeac2bb63bc1cc0911a284967c048ef74235fcdfd2438a901a04a; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:21 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/img/priv.png</java.net.URL>
</httpSample>
<sample t="378" it="0" lt="237" ts="1315465022157" s="false" lb="HOME" rc="" rm="Number of samples in transaction : 37, number of failing samples : 4" tn="Thread Group 1-1" dt="" de="" by="1031843" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String"></responseHeader>
  <requestHeader class="java.lang.String"></requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
</sample>
<httpSample t="30" it="0" lt="30" ts="1315465022535" s="false" lb="/iceweb/restful/Centro/findPagedByVentanaAndFilter" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" de="iso-8859-1" by="734" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 500 Internal Server Error
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 304
Set-Cookie: JSESSIONID=be5beeb0c4b62a2a1b868f017d39c735736ef31d1f0cb8e5210b840130ff8143; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: text/html; charset=&quot;iso-8859-1&quot;
Content-Location: /app/restful/Centro/findPagedByVentanaAndFilter
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
X-Requested-With: XMLHttpRequest
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Content-Type: application/json
Accept: application/json, */*
</requestHeader>
  <responseData class="java.lang.String">&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;500 Internal Server Error&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;500 Internal Server Error&lt;/H1&gt;&lt;PRE&gt;Servlet error: An exception occurred. The current application deployment descriptors do not allow for including it in this response. Please consult the application log for details.&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/restful/Centro/findPagedByVentanaAndFilter?pageNumber=154&amp;pageSize=20&amp;sortProp=despecifica&amp;asc=true&amp;filter=%7B%22%40id%22%3A1%2C%22provincias%22%3A%5B%22Val%22%2C%22Ala%22%2C%22Cas%22%5D%2C%22regimenes%22%3A%5B%22PRIV.%22%2C%22PUB.%22%5D%2C%22minNumTicketsAbiertos%22%3Anull%2C%22maxNumTicketsAbiertos%22%3Anull%7D&amp;cuadricula=%7B%22%40id%22%3A1%2C%22infIzq%22%3A%7B%22%40id%22%3A2%2C%22lon%22%3A-1.3712280273438%2C%22lat%22%3A37.68305078125%7D%2C%22supDer%22%3A%7B%22%40id%22%3A3%2C%22lon%22%3A0.27122802734375%2C%22lat%22%3A40.97894921875%7D%2C%22resLon%22%3A19%2C%22resLat%22%3A40%7D</java.net.URL>
</httpSample>
<sample t="31" it="0" lt="30" ts="1315465022535" s="false" lb="PAGE" rc="" rm="Number of samples in transaction : 1, number of failing samples : 1" tn="Thread Group 1-1" dt="" de="" by="734" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String"></responseHeader>
  <requestHeader class="java.lang.String"></requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
</sample>
<httpSample t="4" it="0" lt="4" ts="1315465022566" s="true" lb="/iceweb/js/flexigrid/css/flexigrid/images/hl.png" rc="200" rm="OK" tn="Thread Group 1-1" dt="bin" de="" by="557" sc="1" ec="0" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 200 OK
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 189
Set-Cookie: JSESSIONID=3b821321e55142538699d850d569c91645100310401ecd3998f9bdad5c3100fc; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: image/png
Last-Modified: Fri, 11 Mar 2011 09:31:20 GMT
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/js/flexigrid/css/flexigrid/flexigrid.css
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Cache-Control: max-age=0
</requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/js/flexigrid/css/flexigrid/images/hl.png</java.net.URL>
</httpSample>
<httpSample t="16" it="0" lt="16" ts="1315465022570" s="false" lb="/iceweb/centroDetalle" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" de="iso-8859-1" by="705" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 500 Internal Server Error
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 304
Set-Cookie: JSESSIONID=ad06c2aefe055c659d95a0f58b896b5f50843f1606aaacdd083a971f9eaa4415; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: text/html; charset=&quot;iso-8859-1&quot;
Content-Location: /app/centroDetalle
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Referer: http://localhost:8080/iceweb/
Accept-Encoding: gzip,deflate
Keep-Alive: 115
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Connection: keep-alive
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
</requestHeader>
  <responseData class="java.lang.String">&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;500 Internal Server Error&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;500 Internal Server Error&lt;/H1&gt;&lt;PRE&gt;Servlet error: An exception occurred. The current application deployment descriptors do not allow for including it in this response. Please consult the application log for details.&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/centroDetalle?codigo=12003811</java.net.URL>
</httpSample>
<httpSample t="20" it="0" lt="20" ts="1315465022588" s="false" lb="/iceweb/restful/Centro/12003811" rc="500" rm="Internal Server Error" tn="Thread Group 1-1" dt="text" de="iso-8859-1" by="715" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String">HTTP/1.1 500 Internal Server Error
Date: Thu, 08 Sep 2011 06:57:02 GMT
Server: Oracle Containers for J2EE
Content-Length: 304
Set-Cookie: JSESSIONID=993b64db0e7622efece701bd8ec359fb541f46dfcd28924a4c91c4f050156606; path=/iceweb
Cache-Control: private
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
Content-Type: text/html; charset=&quot;iso-8859-1&quot;
Content-Location: /app/restful/Centro/12003811
</responseHeader>
  <requestHeader class="java.lang.String">Accept-Language: en-us,en;q=0.5
X-Requested-With: XMLHttpRequest
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding: gzip,deflate
Referer: http://localhost:8080/iceweb/centroDetalle?codigo=12003811
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13
Keep-Alive: 115
Connection: keep-alive
Content-Type: application/json
Accept: application/json, */*
</requestHeader>
  <responseData class="java.lang.String">&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;500 Internal Server Error&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;500 Internal Server Error&lt;/H1&gt;&lt;PRE&gt;Servlet error: An exception occurred. The current application deployment descriptors do not allow for including it in this response. Please consult the application log for details.&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</responseData>
  <responseFile class="java.lang.String"></responseFile>
  <cookies class="java.lang.String"></cookies>
  <method class="java.lang.String">GET</method>
  <queryString class="java.lang.String"></queryString>
  <java.net.URL>http://localhost:8888/iceweb/restful/Centro/12003811?codigo=12003811</java.net.URL>
</httpSample>
<sample t="43" it="0" lt="40" ts="1315465022566" s="false" lb="DETAIL" rc="" rm="Number of samples in transaction : 3, number of failing samples : 2" tn="Thread Group 1-1" dt="" de="" by="1977" sc="1" ec="1" ng="1" na="1" hn="sam">
  <responseHeader class="java.lang.String"></responseHeader>
  <requestHeader class="java.lang.String"></requestHeader>
  <responseData class="java.lang.String"/>
  <responseFile class="java.lang.String"></responseFile>
</sample>

</testResults>
