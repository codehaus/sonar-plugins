<?xml version="1.0" encoding="UTF-8"?>
<!-- =======================================================================
 Sonar, open source software quality management tool.
 Copyright (C) 2009 SonarSource SA
 mailto:contact AT sonarsource DOT com

 Sonar is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
 version 3 of the License, or (at your option) any later version.

 Sonar is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 Lesser General Public License for more details.

 You should have received a copy of the GNU Lesser General Public
 License along with Sonar; if not, write to the Free Software
 Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02
 
 author : Romain PELISSE belaran@gmail.com
======================================================================= -->
<project name="SonarSquid Ant integration : test script" 
         default="sonar-squid" 
         basedir="../../../">
     
  <echo>
target:${target}
target.classes:${target.classes}
repository:${repository}
squid version:${squid.version}
  </echo>

    <path id="squid.classpath">
      <path path="${squid.classes}"/>
      <fileset dir="${repository}">
        <!-- Checkstyle and its dependencies -->
        <include name="checkstyle/checkstyle/4.4/checkstyle-4.4.jar"/>
        <include name="antlr/antlr/2.7.6/antlr-2.7.6.jar"/>
        <include name="commons-beanutils/commons-beanutils/1.7.0/commons-beanutils-1.7.0.jar"/>
        <include name="commons-cli/commons-cli/1.0/commons-cli-1.0.jar"/>
        <include name="commons-collections/commons-collections/2.1/commons-collections-2.1.jar"/>      
        <include name="commons-logging/commons-logging/1.0.3/commons-logging-1.0.3.jar"/>
        <!-- PMD and its dependencies -->
        <include name="net/java/dev/javacc/javacc/4.0/javacc-4.0.jar"/> <!-- FIXME: PMD uses 3.0 but mvn didn't download it... -->
        <include name="jaxen/1.1.1/jaxen-1.1.1.jar"/>
        <!-- PMD needs this asm but maybe having all in his classpath will suffice...
        <include name="asm/asm/3.2/asm-3.2.jar"/> -->
	<!-- Squid dependency -->
	<include name="asm/asm-all/3.2/asm-all-3.2.jar"/>
        <include name="commons-lang/commons-lang/2.4/commons-lang-2.4.jar"/>	
    	<include name="commons-io/commons-io/1.4/commons-io-1.4.jar"/>	
    	<include name="org/slf4j/slf4j-api/1.5.8/slf4j-api-1.5.8.jar"/>
    	<include name="org/slf4j/jcl-over-slf4j/1.5.8/jcl-over-slf4j-1.5.8.jar"/>
    	<include name="ch/qos/logback/logback-classic/0.9.15/logback-classic-0.9.15.jar"/>
  	<include name="ch/qos/logback/logback-core/0.9.15/logback-core-0.9.15.jar"/>
        <include name="org/picocontainer/picocontainer/2.8.2/picocontainer-2.8.2.jar"/>
        <!-- Squid Ant Task related dependency -->
        <include name="com/thoughtworks/xstream/xstream/1.3.1/xstream-1.3.1.jar"/>	    
        <!-- Finally just need squid itself ! -->
	<include name="org/codehaus/sonar/sonar-squid/${squid.version}/sonar-squid-${squid.version}.jar"/>
      </fileset>
    </path>


  <target name="sonar-squid">
  	
    <taskdef name="squid" 
    		 classname="org.sonar.squid.ant.SquidTask">
      <classpath refid="squid.classpath" />
    </taskdef>
  
    <property name="ant.dir" value="${target}/ant-integration-test/"/>
    <mkdir dir="${ant.dir}"/>
    <squid   src="${src}" 
             classes="${target.classes}"
             reportFile="${ant.dir}/ant-report.xml"/>
  </target>
</project>
